/*! For license information please see main.127eba7a.js.LICENSE.txt */
!function(){var t={3007:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(s){i=[6,s],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(7803),o=n(8337),s=n(7202),u=n(9465),c=n(8337),l=function(t){return t.packageVersion=t.packageVersion||u.version,t.packageName="@teachablemachine/pose",t.timeStamp=t.timeStamp||(new Date).toISOString(),t.userMetadata=t.userMetadata||{},t.modelName=t.modelName||"untitled",t.labels=t.labels||[],t.modelSettings=f(t.modelSettings),t},p=function(t){return r(void 0,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return"string"!==typeof t?[3,3]:[4,fetch(t)];case 1:return[4,n.sent().json()];case 2:return e=n.sent(),[3,4];case 3:if(!(r=t)||!Array.isArray(r.labels))throw new Error("Invalid Metadata provided");e=t,n.label=4;case 4:return[2,l(e)]}var r}))}))},f=function(t){return void 0===t&&(t={}),t.posenet||(t.posenet={}),t.posenet.architecture=t.posenet.architecture||"MobileNetV1",t.posenet.outputStride=t.posenet.outputStride||16,t.posenet.inputResolution=t.posenet.inputResolution||257,t.posenet.multiplier=t.posenet.multiplier||.75,t};function h(t,e,n){return void 0===n&&(n=3),r(this,void 0,void 0,(function(){var r;return a(this,(function(a){switch(a.label){case 0:return[4,e.data()];case 1:return r=a.sent(),[2,i.tidy((function(){n=Math.min(n,r.length);for(var e=[],a=0;a<r.length;a++)e.push({value:r[a],index:a});e.sort((function(t,e){return e.value-t.value}));var i=new Float32Array(n),o=new Int32Array(n);for(a=0;a<n;a++)i[a]=e[a].value,o[a]=e[a].index;var s=[];for(a=0;a<o.length;a++)s.push({className:t[o[a]],probability:i[a]});return s}))]}}))}))}e.getTopKClasses=h;var d=function(){function t(t,e,n){this.model=t,this.posenetModel=e,this._metadata=l(n)}return t.prototype.getMetadata=function(){return this._metadata},t.prototype.getClassLabels=function(){return this._metadata.labels},t.prototype.getTotalClasses=function(){return this.model.output.shape[1]},t.prototype.estimatePose=function(t,e){return void 0===e&&(e=!1),r(this,void 0,void 0,(function(){var n,r,i,o,s,u,c;return a(this,(function(a){switch(a.label){case 0:return[4,this.estimatePoseOutputs(t)];case 1:return n=a.sent(),r=n.heatmapScores,i=n.offsets,o=n.displacementFwd,s=n.displacementBwd,u=n.padding,c=this.poseOutputsToAray(r,i,o,s),[4,this.poseOutputsToKeypoints(t,r,i,o,s,u,e)];case 2:return[2,{pose:a.sent(),posenetOutput:c}]}}))}))},t.prototype.estimatePoseOutputs=function(t){return r(this,void 0,void 0,(function(){var e,n,r,i,o,u,c,l,p;return a(this,(function(a){switch(a.label){case 0:return e=this.posenetModel.inputResolution,n=s.padAndResizeTo(t,e),r=n.resized,i=n.padding,[4,this.posenetModel.baseModel.predict(r)];case 1:return o=a.sent(),u=o.heatmapScores,c=o.offsets,l=o.displacementFwd,p=o.displacementBwd,r.dispose(),[2,{heatmapScores:u,offsets:c,displacementFwd:l,displacementBwd:p,padding:i}]}}))}))},t.prototype.poseOutputsToAray=function(t,e,n,r){var a=i.concat([t,e],2),o=a.dataSync();return a.dispose(),o},t.prototype.poseOutputsToKeypoints=function(t,e,n,i,o,u,l){return void 0===l&&(l=!1),r(this,void 0,void 0,(function(){var r,p,f,h,d,m,v,g,y,b,w,x,k;return a(this,(function(a){switch(a.label){case 0:return r={maxDetections:3,scoreThreshold:.5,nmsRadius:20},p=s.getInputTensorDimensions(t),f=p[0],h=p[1],d=this.posenetModel.baseModel.outputStride,m=this.posenetModel.inputResolution,[4,s.toTensorBuffers3D([e,n,i,o])];case 1:return v=a.sent(),g=v[0],y=v[1],b=v[2],w=v[3],[4,c.decodeMultiplePoses(g,y,b,w,d,r.maxDetections,r.scoreThreshold,r.nmsRadius)];case 2:return x=a.sent(),k=s.scaleAndFlipPoses(x,[f,h],m,u,l),e.dispose(),n.dispose(),i.dispose(),o.dispose(),[2,k[0]]}}))}))},t.prototype.predict=function(t){return r(this,void 0,void 0,(function(){var e,n,r,o,s;return a(this,(function(a){switch(a.label){case 0:return e=i.tensor([t]),[4,(n=this.model.predict(e)).data()];case 1:for(r=a.sent(),o=[],s=0;s<r.length;s++)o.push({className:this._metadata.labels[s],probability:r[s]});return e.dispose(),n.dispose(),[2,o]}}))}))},t.prototype.predictTopK=function(t,e){return void 0===e&&(e=3),r(this,void 0,void 0,(function(){var n,r,o;return a(this,(function(a){switch(a.label){case 0:return n=i.tensor([t]),r=this.model.predict(n),[4,h(this._metadata.labels,r,e)];case 1:return o=a.sent(),n.dispose(),r.dispose(),[2,o]}}))}))},t.prototype.dispose=function(){this.posenetModel.dispose()},t}();function m(t){return void 0===t&&(t={}),r(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return t=f(t),[4,o.load({architecture:t.posenet.architecture,outputStride:t.posenet.outputStride,inputResolution:t.posenet.inputResolution,multiplier:t.posenet.multiplier})];case 1:return[2,e.sent()]}}))}))}e.CustomPoseNet=d,e.loadPoseNet=m,e.load=function(t,e){return r(this,void 0,void 0,(function(){var n,r,o,s;return a(this,(function(a){switch(a.label){case 0:return[4,i.loadLayersModel(t)];case 1:return n=a.sent(),e?[4,p(e)]:[3,3];case 2:return o=a.sent(),[3,4];case 3:o=null,a.label=4;case 4:return[4,m((r=o).modelSettings)];case 5:return s=a.sent(),[2,new d(n,s,r)]}}))}))},e.loadFromFiles=function(t,e,n){return r(this,void 0,void 0,(function(){var r,o,s,u,c;return a(this,(function(a){switch(a.label){case 0:return[4,i.loadLayersModel(i.io.browserFiles([t,e]))];case 1:return r=a.sent(),[4,new Response(n).json()];case 2:return o=a.sent(),n?[4,p(o)]:[3,4];case 3:return u=a.sent(),[3,5];case 4:u=null,a.label=5;case 5:return[4,m((s=u).modelSettings)];case 6:return c=a.sent(),[2,new d(r,c,s)]}}))}))}},6342:function(t,e,n){"use strict";var r=n(3007);r.CustomPoseNet,e.zD=r.load,r.loadFromFiles;var a=n(7716);a.TeachablePoseNet,a.createTeachable;var i=n(4540);e.bb=i.Webcam,n(1461).createCanvas;var o=n(1246);e.kp=o.drawKeypoints,e.iZ=o.drawSkeleton,o.drawPoint,o.drawSegment,n(9465).version},7716:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(s){i=[6,s],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(7803),s=n(7803),u=n(3007),c=n(6699);function l(t,e){for(var n,r=t.length,a=t.slice(),i=r-1;i>0;i-=1){var o=void 0;n=[a[o=e?Math.floor(e()*(i+1)):Math.floor(Math.random()*(i+1))],a[i]],a[i]=n[0],a[o]=n[1]}return a}var p=function(t){function e(e,n,r){var a=t.call(this,e,n,r)||this;return a.model=e,a.posenetModel=n,a.examples=[],a}return r(e,t),Object.defineProperty(e.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!0,configurable:!0}),e.prototype.addExample=function(t,e){return a(this,void 0,void 0,(function(){return i(this,(function(n){return this.examples[t].push(e),[2]}))}))},e.prototype.predict=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(n){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,t.prototype.predict.call(this,e)]}))}))},e.prototype.predictTopK=function(e,n){return void 0===n&&(n=3),a(this,void 0,void 0,(function(){return i(this,(function(r){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,t.prototype.predictTopK.call(this,e,n)]}))}))},e.prototype.prepare=function(){for(var t in this.examples)if(0===t.length)throw new Error("Add some examples before training");var e=this.convertToTfDataset();this.trainDataset=e.trainDataset,this.validationDataset=e.validationDataset},e.prototype.convertToTfDataset=function(){for(var t=0;t<this.examples.length;t++)this.examples[t]=l(this.examples[t],this.seed);var e=[],n=[],r=function(t){var r=function(t,e){var n=new Array(e).fill(0);return n[t]=1,n}(t,a.numClasses),i=a.examples[t].length,o=i-Math.ceil(.15*i),s=a.examples[t].slice(0,o).map((function(t){return{data:t,label:r}})),u=a.examples[t].slice(o).map((function(t){return{data:t,label:r}}));e=e.concat(s),n=n.concat(u)},a=this;for(t=0;t<this.examples.length;t++)r(t);e=l(e,this.seed),n=l(n,this.seed);var i=o.data.array(e.map((function(t){return t.data}))),s=o.data.array(n.map((function(t){return t.data}))),u=o.data.array(e.map((function(t){return t.label}))),c=o.data.array(n.map((function(t){return t.label})));return{trainDataset:o.data.zip({xs:i,ys:u}),validationDataset:o.data.zip({xs:s,ys:c})}},e.prototype.save=function(t,e){return a(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.model.save(t,e)]}))}))},e.prototype.train=function(t,e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var n,r,a,u,c,l,p,f=this;return i(this,(function(i){switch(i.label){case 0:if(n=e.onTrainEnd||function(){},e.onTrainEnd=function(t){f.__stopTrainingResolve&&(f.__stopTrainingResolve(),f.__stopTrainingResolve=null),n(t)},this.isPrepared||this.prepare(),r=this.getLabels().length,s.util.assert(r===this.numClasses,(function(){return"Can not train, has "+r+" labels and "+f.numClasses+" classes"})),a=this.examples[0][1].length,u=this.seed?o.initializers.varianceScaling({seed:3.14}):o.initializers.varianceScaling({}),this.model=o.sequential({layers:[o.layers.dense({inputShape:[a],units:t.denseUnits,activation:"relu",kernelInitializer:u,useBias:!0}),o.layers.dropout({rate:.5}),o.layers.dense({units:this.numClasses,kernelInitializer:u,useBias:!1,activation:"softmax"})]}),c=o.train.rmsprop(t.learningRate),this.model.compile({optimizer:c,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(t.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return l=this.trainDataset.batch(t.batchSize),p=this.validationDataset.batch(t.batchSize),[4,this.model.fitDataset(l,{epochs:t.epochs,validationData:p,callbacks:e})];case 1:return i.sent(),c.dispose(),[2,this.model]}}))}))},e.prototype.prepareDataset=function(){for(var t=0;t<this.numClasses;t++)this.examples[t]=[]},e.prototype.stopTraining=function(){var t=this;return new Promise((function(e,n){t.model.stopTraining=!0,t.__stopTrainingResolve=e}))},e.prototype.dispose=function(){this.model.dispose(),t.prototype.dispose.call(this)},e.prototype.setLabel=function(t,e){this._metadata.labels[t]=e},e.prototype.setLabels=function(t){this._metadata.labels=t,this.prepareDataset()},e.prototype.getLabel=function(t){return this._metadata.labels[t]},e.prototype.getLabels=function(){return this._metadata.labels},e.prototype.setName=function(t){this._metadata.modelName=t},e.prototype.getName=function(){return this._metadata.modelName},e.prototype.calculateAccuracyPerClass=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x=this;return i(this,(function(k){switch(k.label){case 0:return t=this.validationDataset.mapAsync((function(t){return a(x,void 0,void 0,(function(){return i(this,(function(e){return[2,t.xs]}))}))})),e=this.validationDataset.mapAsync((function(t){return a(x,void 0,void 0,(function(){return i(this,(function(e){return[2,t.ys]}))}))})),n=Math.min(e.size,32),r=Math.ceil(e.size/n),s=t.batch(n),u=e.batch(n),[4,s.iterator()];case 1:return c=k.sent(),[4,u.iterator()];case 2:l=k.sent(),p=[],f=[],w=0,k.label=3;case 3:return w<r?[4,c.next()]:[3,7];case 4:return h=k.sent(),d=this.model.predict(h.value),m=d.argMax(1),p.push(m),[4,l.next()];case 5:v=k.sent(),g=v.value.argMax(1),f.push(g),h.value.dispose(),d.dispose(),v.value.dispose(),k.label=6;case 6:return w++,[3,3];case 7:if(y=o.concat(f),b=o.concat(p),1!==r)for(w=0;w<p.length;w++)p[w].dispose(),f[w].dispose();return[2,{reference:y,predictions:b}]}}))}))},e.prototype.setSeed=function(t){this.seed=c(t)},e}(u.CustomPoseNet);e.TeachablePoseNet=p,e.createTeachable=function(t){return a(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return[4,u.loadPoseNet(t.modelSettings)];case 1:return e=n.sent(),[2,new p(o.sequential(),e,t)]}}))}))}},1461:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.createCanvas=function(t,e,n){void 0===t&&(t=200),void 0===e&&(e=200),void 0===n&&(n=!1);var r=document.createElement("canvas");if(r.width=t,r.height=e,n){var a=r.getContext("2d");a.translate(t,0),a.scale(-1,1)}return r},e.cropTo=function(t,e,n,r){void 0===n&&(n=!1),void 0===r&&(r=document.createElement("canvas"));var a=t.width,i=t.height;t instanceof HTMLVideoElement&&(a=t.videoWidth,i=t.videoHeight);var o=e/Math.min(a,i),s=Math.ceil(a*o),u=Math.ceil(i*o),c=s-e,l=u-e;r.width=r.height=e;var p=r.getContext("2d");return p.drawImage(t,-1*~~(c/2),-1*~~(l/2),s,u),n&&(p.scale(-1,1),p.drawImage(r,-1*e,0)),r}},1246:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7202),a="aqua";function i(t,e,n,r,a,i){t.fillStyle=a,t.strokeStyle=i,t.beginPath(),t.arc(n,e,r,0,2*Math.PI),t.fill(),t.stroke()}function o(t){return[t.y,t.x]}function s(t,e,n,r,a,i){var o=t[0],s=t[1],u=e[0],c=e[1];n.beginPath(),n.moveTo(s*i,o*i),n.lineTo(c*i,u*i),n.lineWidth=r,n.strokeStyle=a,n.stroke()}e.drawKeypoints=function(t,e,n,r,o,s,u){void 0===r&&(r=4),void 0===o&&(o="aqua"),void 0===s&&(s=a),void 0===u&&(u=1);for(var c=0;c<t.length;c++){var l=t[c];if(!(l.score<e)){var p=l.position;i(n,p.y*u,p.x*u,r,o,s)}}},e.drawPoint=i,e.toTuple=o,e.drawSkeleton=function(t,e,n,i,u,c){void 0===i&&(i=2),void 0===u&&(u=a),void 0===c&&(c=1),r.getAdjacentKeyPoints(t,e).forEach((function(t){s(o(t[0].position),o(t[1].position),n,i,u,c)}))},e.drawSegment=s},4540:function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var a,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(i<3?a(o):i>3?a(e,n,o):a(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o},a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(s){i=[6,s],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(221),s=n(1461),u={facingMode:"user",frameRate:24},c=function(){function t(t,e,n){void 0===t&&(t=400),void 0===e&&(e=400),void 0===n&&(n=!1),this.width=t,this.height=e,this.flip=n}return t.prototype.getWebcam=function(t){if(void 0===t&&(t={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");t.width=640;var e=function(t){return t.facingMode=t.facingMode||u.facingMode,t.frameRate=t.frameRate||u.frameRate,t.aspectRatio=t.aspectRatio||u.aspectRatio,t}(t),n=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:e}).then((function(t){return n.srcObject=t,n.addEventListener("loadedmetadata",(function(t){var e=n.videoWidth,r=n.videoHeight;n.width=e,n.height=r})),n}),(function(){return Promise.reject("Could not open your camera. You may have denied access.")}))},t.prototype.setup=function(t){return void 0===t&&(t={}),a(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return this.webcam?[3,2]:(e=this,[4,this.getWebcam(t)]);case 1:e.webcam=n.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),n.label=2;case 2:return[2]}}))}))},t.prototype.play=function(){return this.webcam.play()},t.prototype.pause=function(){this.webcam.pause()},t.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},t.prototype.update=function(){this.renderCameraToCanvas()},t.prototype.stopStreamedVideo=function(t){t.srcObject.getTracks().forEach((function(t){t.stop()})),t.srcObject=null},t.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var t=this.canvas.getContext("2d");if(0!==this.webcam.videoWidth){var e=s.cropTo(this.webcam,this.width,this.flip);t.drawImage(e,0,0)}}},r([o.default],t.prototype,"getWebcam",null),r([o.default],t.prototype,"setup",null),r([o.default],t.prototype,"play",null),r([o.default],t.prototype,"pause",null),r([o.default],t.prototype,"stop",null),r([o.default],t.prototype,"update",null),r([o.default],t.prototype,"stopStreamedVideo",null),r([o.default],t.prototype,"renderCameraToCanvas",null),t}();e.Webcam=c},9465:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.version="0.8.6"},4718:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.partNames=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],e.NUM_KEYPOINTS=e.partNames.length,e.partIds=e.partNames.reduce((function(t,e,n){return t[e]=n,t}),{});e.poseChain=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]],e.connectedPartIndices=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]].map((function(t){var n=t[0],r=t[1];return[e.partIds[n],e.partIds[r]]})),e.partChannels=["left_face","right_face","right_upper_leg_front","right_lower_leg_back","right_upper_leg_back","left_lower_leg_front","left_upper_leg_front","left_upper_leg_back","left_lower_leg_back","right_feet","right_lower_leg_front","left_feet","torso_front","torso_back","right_upper_arm_front","right_upper_arm_back","right_lower_arm_back","left_lower_arm_front","left_upper_arm_front","left_upper_arm_back","left_lower_arm_back","right_hand","right_lower_arm_front","left_hand"]},8337:function(t,e,n){"use strict";n.r(e),n.d(e,{MobileNet:function(){return Se},PoseNet:function(){return Sn},decodeMultiplePoses:function(){return qe},decodeSinglePose:function(){return Xe},getAdjacentKeyPoints:function(){return tn},getBoundingBox:function(){return rn},getBoundingBoxPoints:function(){return an},load:function(){return Cn},partChannels:function(){return De},partIds:function(){return _e},partNames:function(){return Te},poseChain:function(){return Ae},scaleAndFlipPoses:function(){return mn},scalePose:function(){return sn},version:function(){return Tn}});var r={};n.r(r),n.d(r,{json:function(){return W}});var a={};n.r(a),n.d(a,{json:function(){return U}});var i={};n.r(i),n.d(i,{json:function(){return j}});var o={};n.r(o),n.d(o,{json:function(){return H}});var s={};n.r(s),n.d(s,{json:function(){return q}});var u={};n.r(u),n.d(u,{json:function(){return G}});var c={};n.r(c),n.d(c,{json:function(){return Z}});var l={};n.r(l),n.d(l,{json:function(){return K}});var p={};n.r(p),n.d(p,{json:function(){return X}});var f={};n.r(f),n.d(f,{json:function(){return $}});var h={};n.r(h),n.d(h,{json:function(){return Y}});var d={};n.r(d),n.d(d,{json:function(){return Q}});var m={};n.r(m),n.d(m,{json:function(){return J}});var v={};n.r(v),n.d(v,{json:function(){return tt}});var g={};n.r(g),n.d(g,{json:function(){return et}});var y={};n.r(y),n.d(y,{json:function(){return nt}});var b={};n.r(b),n.d(b,{json:function(){return rt}});var w={};n.r(w),n.d(w,{json:function(){return at}});var x={};n.r(x),n.d(x,{json:function(){return it}});var k={};n.r(k),n.d(k,{OP_SCOPE_SUFFIX:function(){return kt.zvA},abs:function(){return kt.WnP},acos:function(){return kt.Khb},acosh:function(){return kt.__u},add:function(){return kt.IHx},addN:function(){return kt.QBD},all:function(){return kt.$6P},any:function(){return kt.YjB},argMax:function(){return kt.NqF},argMin:function(){return kt.vHJ},asin:function(){return kt.ZRM},asinh:function(){return kt.VfV},atan:function(){return kt.z4N},atan2:function(){return kt.fvJ},atanh:function(){return kt.C80},avgPool:function(){return kt.wS1},avgPool3d:function(){return kt.uR5},basicLSTMCell:function(){return kt.zEQ},batchNorm:function(){return kt.tgs},batchNorm2d:function(){return kt.Dxk},batchNorm3d:function(){return kt.JY5},batchNorm4d:function(){return kt.p3b},batchToSpaceND:function(){return kt.E4h},bincount:function(){return kt.yE8},booleanMaskAsync:function(){return kt.anm},broadcastArgs:function(){return kt.XsQ},broadcastTo:function(){return kt.UFq},buffer:function(){return kt.f3b},cast:function(){return kt.pju},ceil:function(){return kt.mDi},clipByValue:function(){return kt.iUl},clone:function(){return kt.d9v},complex:function(){return kt.PYB},concat:function(){return kt.zoF},concat1d:function(){return kt.gME},concat2d:function(){return kt.Izb},concat3d:function(){return kt.MNy},concat4d:function(){return kt.ZaL},conv1d:function(){return kt.PAt},conv2d:function(){return kt.Tek},conv2dTranspose:function(){return kt.bc},conv3d:function(){return kt.pdZ},conv3dTranspose:function(){return kt.$QV},cos:function(){return kt.mCk},cosh:function(){return kt.f9Y},cosineWindow:function(){return kt.mew},cumprod:function(){return kt.$Gn},cumsum:function(){return kt.zbp},denseBincount:function(){return kt.ppE},depthToSpace:function(){return kt.nTT},depthwiseConv2d:function(){return kt.B10},diag:function(){return kt.Ka3},dilation2d:function(){return kt.WmZ},div:function(){return kt.hiC},divNoNan:function(){return kt.NTj},dot:function(){return kt.AKD},dropout:function(){return kt.rvX},einsum:function(){return kt.WYO},elu:function(){return kt.pyx},enclosingPowerOfTwo:function(){return kt.GRh},equal:function(){return kt.DgJ},erf:function(){return kt.qNN},euclideanNorm:function(){return kt.d2q},exp:function(){return kt.Qqt},expandDims:function(){return kt.dt4},expm1:function(){return kt.t$B},eye:function(){return kt.iyy},fft:function(){return kt.kp_},fill:function(){return kt.hlL},floor:function(){return kt.GWj},floorDiv:function(){return kt.qPi},fused:function(){return kt.imm},gather:function(){return kt.Iqj},gatherND:function(){return kt.dbB},greater:function(){return kt.pjt},greaterEqual:function(){return kt.brS},ifft:function(){return kt.Sxn},imag:function(){return kt.asL},image:function(){return kt.BHj},inTopKAsync:function(){return kt.V3u},irfft:function(){return kt.wx0},isFinite:function(){return kt.xVT},isInf:function(){return kt.UWc},isNaN:function(){return kt.i2d},leakyRelu:function(){return kt.hi7},less:function(){return kt.d9m},lessEqual:function(){return kt.zN1},linalg:function(){return kt.$r2},linspace:function(){return kt.SX3},localResponseNormalization:function(){return kt.G9k},log:function(){return kt.cM7},log1p:function(){return kt.Krr},logSigmoid:function(){return kt.e_t},logSoftmax:function(){return kt.CmS},logSumExp:function(){return kt.l_t},logicalAnd:function(){return kt.HvI},logicalNot:function(){return kt.hJK},logicalOr:function(){return kt.K5V},logicalXor:function(){return kt.egP},losses:function(){return kt.MB5},lowerBound:function(){return kt.eab},matMul:function(){return kt.OI3},max:function(){return kt.Fp7},maxPool:function(){return kt._sB},maxPool3d:function(){return kt.YQQ},maxPoolWithArgmax:function(){return kt.Ip$},maximum:function(){return kt.gWQ},mean:function(){return kt.J69},meshgrid:function(){return kt.ry_},min:function(){return kt.VV$},minimum:function(){return kt.LTh},mirrorPad:function(){return kt.VdP},mod:function(){return kt.wQq},moments:function(){return kt.Gi7},movingAverage:function(){return kt.p_},mul:function(){return kt.dC7},multiRNNCell:function(){return kt.rq4},multinomial:function(){return kt.SJ_},neg:function(){return kt.W76},norm:function(){return kt.KOy},notEqual:function(){return kt.Quu},oneHot:function(){return kt.lfX},ones:function(){return kt.iUs},onesLike:function(){return kt.JpU},op:function(){return kt.op},outerProduct:function(){return kt.N2O},pad:function(){return kt.vku},pad1d:function(){return kt.pNR},pad2d:function(){return kt.koy},pad3d:function(){return kt.t1L},pad4d:function(){return kt.lGY},pool:function(){return kt.d_R},pow:function(){return kt.sQ3},prelu:function(){return kt.AL3},print:function(){return kt.S0v},prod:function(){return kt.WVs},raggedGather:function(){return kt.$gW},raggedTensorToTensor:function(){return kt.N89},rand:function(){return kt.TN_},randomGamma:function(){return kt.wzB},randomNormal:function(){return kt.nGf},randomStandardNormal:function(){return kt.ruB},randomUniform:function(){return kt.LGj},range:function(){return kt.w6H},real:function(){return kt.kwC},reciprocal:function(){return kt.M25},relu:function(){return kt.UYe},relu6:function(){return kt.btT},reshape:function(){return kt.XLQ},reverse:function(){return kt.GYS},reverse1d:function(){return kt.SDf},reverse2d:function(){return kt.diP},reverse3d:function(){return kt.sx7},reverse4d:function(){return kt.mG2},rfft:function(){return kt.QEs},round:function(){return kt.NMM},rsqrt:function(){return kt.bp0},scalar:function(){return kt.iD$},scatterND:function(){return kt.snQ},searchSorted:function(){return kt.zcT},selu:function(){return kt.U8D},separableConv2d:function(){return kt.U_I},setdiff1dAsync:function(){return kt.ODp},sigmoid:function(){return kt.XD2},sign:function(){return kt.Xxe},signal:function(){return kt.tdS},sin:function(){return kt.O$l},sinh:function(){return kt.R_K},slice:function(){return kt.tPi},slice1d:function(){return kt.jZU},slice2d:function(){return kt.SmN},slice3d:function(){return kt.CnO},slice4d:function(){return kt.p0P},softmax:function(){return kt.XAC},softplus:function(){return kt.Wvh},spaceToBatchND:function(){return kt.fBT},sparse:function(){return kt.rVs},sparseToDense:function(){return kt.ers},spectral:function(){return kt.uN7},split:function(){return kt.Vl2},sqrt:function(){return kt._b3},square:function(){return kt.h62},squaredDifference:function(){return kt.$i},squeeze:function(){return kt.L9e},stack:function(){return kt.knu},step:function(){return kt.Nbs},stridedSlice:function(){return kt.NXj},string:function(){return kt.Z_8},sub:function(){return kt.luU},sum:function(){return kt.Smz},tan:function(){return kt.ORZ},tanh:function(){return kt.AEp},tensor:function(){return kt.XeE},tensor1d:function(){return kt.RRF},tensor2d:function(){return kt.odF},tensor3d:function(){return kt.wOQ},tensor4d:function(){return kt.yXz},tensor5d:function(){return kt.Bfx},tensor6d:function(){return kt.xZs},tile:function(){return kt.Gg6},topk:function(){return kt.hg7},transpose:function(){return kt.p4s},truncatedNormal:function(){return kt.Xu6},unique:function(){return kt.Two},unsortedSegmentSum:function(){return kt.pUJ},unstack:function(){return kt.HHK},upperBound:function(){return kt.GaM},variable:function(){return kt.VD$},where:function(){return kt.arb},whereAsync:function(){return kt.itS},zeros:function(){return kt.lls},zerosLike:function(){return kt.P84}});var S=n(7519);(0,S.env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(t){t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}));var N,E,C=n(4165),T=n(5861),I=n(5671),_=n(3144),A=n(9439),R=n(3433);!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"}(N||(N={})),function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(E||(E={}));var D={};function O(t){return D[t]}function M(t,e,n,r,a){var i=e.inputParams[t];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd;if("tensor"===i.type)return F(e.inputNames[i.inputIndexStart],n,r,a);if("tensors"===i.type)return e.inputNames.slice(o,s).map((function(t){return F(t,n,r,a)}));var u=F(e.inputNames.slice(o)[0],n,r,a),c=u.dataSync();return"number"===i.type?c[0]:S.util.toNestedArray(u.shape,c)}var l=e.attrParams[t];return l&&l.value}function F(t,e,n,r){var a=L(t),i=(0,A.Z)(a,2),o=i[0],s=i[1];if(null!=r){var u=r.getHashTableHandleByName(o);if(null!=u)return u}var c=n.currentContextIds.find((function(t){return!!e[B(o,t)]}));return void 0!==c?e[B(o,c)][s]:void 0}function z(t,e){var n=L(t),r=(0,A.Z)(n,3),a=r[0],i=r[1],o=r[2];return[B(a,e&&e.currentContextId),i,o]}function B(t,e){return e?"".concat(t,"-").concat(e):t}function L(t){var e=t.split(":");if(1===e.length)return[t,0,void 0];var n=e[0],r=3===e.length?e[1]:void 0;return[n,Number(e[e.length-1]),r]}function P(t,e,n){var r=M("pad",t,e,n);if("explicit"===r){r=M("explicitPaddings",t,e,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function V(t){return t.kept?t:(0,S.clone)(t)}var W=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],U=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],j=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],H=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],q=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],G=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Z=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],K=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],X=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],$=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Y=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Q=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],J=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],tt=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],et=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],nt=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],rt=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],at=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],it=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],ot=function(){function t(){var e;(0,I.Z)(this,t);var n=[r,a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x],k=(e=[]).concat.apply(e,(0,R.Z)(n.map((function(t){return t.json}))));this.opMappers=k.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return(0,_.Z)(t,[{key:"transformGraph",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.node,a=[],i=[],o=[],s=r.reduce((function(t,n){return t[n.name]=e.mapNode(n),n.op.startsWith("Placeholder")?a.push(t[n.name]):"Const"===n.op?i.push(t[n.name]):null!=n.input&&0!==n.input.length||o.push(t[n.name]),t}),{}),u=[],c=[],l={},p={};null!=n&&(l=this.mapSignatureEntries(n.inputs),p=this.mapSignatureEntries(n.outputs));var f=Object.keys(s);f.forEach((function(t){var e=s[t];e.inputNames.forEach((function(t,n){var r=z(t),a=(0,A.Z)(r,3),i=a[0],o=a[2],u=s[i];if(null!=u.outputs){var c=u.outputs.indexOf(o);if(-1!==c){var l="".concat(i,":").concat(c);e.inputNames[n]=l}}e.inputs.push(u),u.children.push(e)}))})),0===Object.keys(p).length?f.forEach((function(t){var e=s[t];0===e.children.length&&c.push(e)})):Object.keys(p).forEach((function(t){var e=z(t),n=(0,A.Z)(e,1)[0],r=s[n];null!=r&&(r.signatureKey=p[t],c.push(r))})),Object.keys(l).length>0?Object.keys(l).forEach((function(t){var e=z(t),n=(0,A.Z)(e,1)[0],r=s[n];r&&(r.signatureKey=l[t],u.push(r))})):u=a;var h={};null!=t.library&&null!=t.library.function&&(h=t.library.function.reduce((function(t,n){return t[n.signature.name]=e.mapFunction(n),t}),{}));var d={nodes:s,inputs:u,outputs:c,weights:i,placeholders:a,signature:n,functions:h};return o.length>0&&(d.initNodes=o),d}},{key:"mapSignatureEntries",value:function(t){return Object.keys(t||{}).reduce((function(e,n){return e[t[n].name]=n,e}),{})}},{key:"mapNode",value:function(t){var e=O(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.slice(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=ut(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ut(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=yt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=yt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=lt(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=lt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=gt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=gt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=ct(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ct(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=wt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=wt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=vt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=vt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=bt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=bt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=ht(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ht(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=dt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=dt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=ft(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ft(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(t.op))}return e[n.name]={value:a,type:r},e}),{})),n}},{key:"mapFunction",value:function(t){var e=this,n=t.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(t,n){return t[n.name]=e.mapNode(n),"Const"===n.op&&r.push(t[n.name]),t}),{}));var i=[],o=[];t.signature.inputArg.forEach((function(t){var e=z(t.name),n=(0,A.Z)(e,1)[0],r={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:pt(t.type),type:"dtype"}},children:[]};r.signatureKey=t.name,i.push(r),a[n]=r})),Object.keys(a).forEach((function(t){var e=a[t];e.inputNames.forEach((function(t,n){var r=z(t),i=(0,A.Z)(r,3),o=i[0],s=i[2],u=a[o];if(null!=u.outputs){var c=u.outputs.indexOf(s);if(-1!==c){var l="".concat(o,":").concat(c);e.inputNames[n]=l}}e.inputs.push(u),u.children.push(e)}))}));var s=t.ret;t.signature.outputArg.forEach((function(t){var e=z(s[t.name]),n=(0,A.Z)(e,2),r=n[0],i=n[1],u=a[r];null!=u&&(u.defaultOutput=i,o.push(u))}));var u=this.mapArgsToSignature(t);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(t){var e=this;return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((function(t,n){return t[n.name]=e.mapArgToTensorInfo(n),t}),{}),outputs:t.signature.outputArg.reduce((function(n,r){return n[r.name]=e.mapArgToTensorInfo(r,t.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(t,e){var n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();function st(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var e=(0,S.env)().global;if("undefined"!==typeof e.atob)return e.atob(t);if("undefined"!==typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function ut(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t[e];return null!=a?st(a.s,r):n}function ct(t,e,n){var r=t[e];return r?r.b:n}function lt(t,e,n){var r=t[e]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function pt(t){switch("string"===typeof t&&(t=N[t]),t){case N.DT_FLOAT:case N.DT_HALF:return"float32";case N.DT_INT32:case N.DT_INT64:case N.DT_INT8:case N.DT_UINT8:return"int32";case N.DT_BOOL:return"bool";case N.DT_DOUBLE:return"float32";case N.DT_STRING:return"string";default:return null}}function ft(t,e,n){var r=t[e];return r&&r.func?r.func.name:n}function ht(t,e,n){var r=t[e];return r&&r.type?pt(r.type):n}function dt(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return pt(t)})):n}function mt(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"===typeof t.size?t.size:parseInt(t.size,10)})):[]}function vt(t,e,n){var r=t[e];return r&&r.shape?mt(r.shape):n}function gt(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"===typeof t?t:parseInt(t,10)})):n}function yt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t[e];return a&&a.list&&a.list.s?a.list.s.map((function(t){return st(t,r)})):n}function bt(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return mt(t)})):n}function wt(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var xt=function(){function t(e,n,r){var a=this;(0,I.Z)(this,t),this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((function(t){return a.getInput(t)})),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((function(t,e){return t[e]=a.getAttr(e),t}),{}))}return(0,_.Z)(t,[{key:"getInput",value:function(t){return F(t,this.tensorMap,this.context)}},{key:"getAttr",value:function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return F(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return lt(this.node.rawAttrs,t,e);if(null!=n.s)return ut(this.node.rawAttrs,t,e);if(null!=n.b)return ct(this.node.rawAttrs,t,e);if(null!=n.shape)return vt(this.node.rawAttrs,t,e);if(null!=n.type)return ht(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return gt(this.node.rawAttrs,t,e);if(null!=n.list.s)return yt(this.node.rawAttrs,t,e);if(null!=n.list.shape)return bt(this.node.rawAttrs,t,e);if(null!=n.list.b)return wt(this.node.rawAttrs,t,e);if(null!=n.list.type)return dt(this.node.rawAttrs,t,e)}return e}}]),t}(),kt=n(1674),St=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(M("a",t,e,n),M("b",t,e,n))];case"AddN":return[r.addN(M("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(M("a",t,e,n),M("b",t,e,n))];case"Mul":return[r.mul(M("a",t,e,n),M("b",t,e,n))];case"RealDiv":case"Div":return[r.div(M("a",t,e,n),M("b",t,e,n))];case"DivNoNan":return[r.divNoNan(M("a",t,e,n),M("b",t,e,n))];case"FloorDiv":return[r.floorDiv(M("a",t,e,n),M("b",t,e,n))];case"Sub":return[r.sub(M("a",t,e,n),M("b",t,e,n))];case"Minimum":return[r.minimum(M("a",t,e,n),M("b",t,e,n))];case"Maximum":return[r.maximum(M("a",t,e,n),M("b",t,e,n))];case"Pow":return[r.pow(M("a",t,e,n),M("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(M("a",t,e,n),M("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Nt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(M("x",t,e,n))];case"Acos":return[r.acos(M("x",t,e,n))];case"Acosh":return[r.acosh(M("x",t,e,n))];case"Asin":return[r.asin(M("x",t,e,n))];case"Asinh":return[r.asinh(M("x",t,e,n))];case"Atan":return[r.atan(M("x",t,e,n))];case"Atan2":return[r.atan2(M("x",t,e,n),M("y",t,e,n))];case"Atanh":return[r.atanh(M("x",t,e,n))];case"Ceil":return[r.ceil(M("x",t,e,n))];case"Complex":return[r.complex(M("real",t,e,n),M("imag",t,e,n))];case"Cos":return[r.cos(M("x",t,e,n))];case"Cosh":return[r.cosh(M("x",t,e,n))];case"Elu":return[r.elu(M("x",t,e,n))];case"Erf":return[r.erf(M("x",t,e,n))];case"Exp":return[r.exp(M("x",t,e,n))];case"Expm1":return[r.expm1(M("x",t,e,n))];case"Floor":return[r.floor(M("x",t,e,n))];case"Log":return[r.log(M("x",t,e,n))];case"Log1p":return[r.log1p(M("x",t,e,n))];case"Imag":return[r.imag(M("x",t,e,n))];case"Neg":return[r.neg(M("x",t,e,n))];case"Reciprocal":return[r.reciprocal(M("x",t,e,n))];case"Real":return[r.real(M("x",t,e,n))];case"Relu":return[r.relu(M("x",t,e,n))];case"Round":return[r.round(M("x",t,e,n))];case"Selu":return[r.selu(M("x",t,e,n))];case"Sigmoid":return[r.sigmoid(M("x",t,e,n))];case"Sin":return[r.sin(M("x",t,e,n))];case"Sign":return[r.sign(M("x",t,e,n))];case"Sinh":return[r.sinh(M("x",t,e,n))];case"Softplus":return[r.softplus(M("x",t,e,n))];case"Sqrt":return[r.sqrt(M("x",t,e,n))];case"Square":return[r.square(M("x",t,e,n))];case"Tanh":return[r.tanh(M("x",t,e,n))];case"Tan":return[r.tan(M("x",t,e,n))];case"ClipByValue":return[r.clipByValue(M("x",t,e,n),M("clipValueMin",t,e,n),M("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(M("x",t,e,n))];case"Rsqrt":return[r.rsqrt(F(t.inputNames[0],e,n))];case"Prod":return[r.prod(M("x",t,e,n),M("axes",t,e,n))];case"LeakyRelu":return[r.leakyRelu(M("x",t,e,n),M("alpha",t,e,n))];case"Prelu":return[r.prelu(M("x",t,e,n),M("alpha",t,e,n))];case"IsNan":return[r.isNaN(F(t.inputNames[0],e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}};function Et(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof t&&"number"!==typeof e){S.util.assert(t.length===e.length,(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}));for(var r=0;r<t.length;r++){var a=t[r],i=e[r];S.util.assert(a<0||i<0||a===i,(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}}}function Ct(t){return"number"!==typeof t&&!t.some((function(t){return t<0}))}function Tt(t,e,n){var r=It(t,n),a=!Ct(r);if(a&&0===e.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&e.forEach((function(t){r=It(t.shape,r)})),!Ct(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function It(t,e){if("number"===typeof t)return e;if("number"===typeof e)return t;if(t.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(t," vs. ").concat(e));for(var n=[],r=0;r<t.length;++r){var a=t[r],i=e[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(t," vs. ").concat(e));n[r]=a>=0?a:i}return n}var _t=function(){function t(e,n,r,a,i,o,s){(0,I.Z)(this,t),this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=(0,S.scalar)(0),(0,S.keep)(this.idTensor)}return(0,_.Z)(t,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(t){this.tensors.forEach((function(e){null!=t&&t.has(e.tensor.id)||e.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}},{key:"readMany",value:function(t){var e=this;return t.map((function(t){return e.read(t)}))}},{key:"write",value:function(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),Et(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,(0,S.keep)(e),n.written=!0,this.tensors[t]=n}},{key:"writeMany",value:function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach((function(t,r){return n.write(t,e[r])}))}},{key:"gather",value:function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return(0,S.tensor)([],[0].concat(this.elementShape));var r=this.readMany(t);return Et(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),(0,S.stack)(r,0)}},{key:"concat",value:function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return(0,S.tensor)([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return Et(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),(0,S.concat)(r,0)}},{key:"scatter",value:function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var n=Math.max.apply(Math,(0,R.Z)(t));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,(0,S.unstack)(e,0))}},{key:"split",value:function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));var r=0,a=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:e.size/r,o=[];(0,S.tidy)((function(){e=(0,S.reshape)(e,[1,r,i]);for(var s=0;s<t.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,t[s],i];o[s]=(0,S.reshape)((0,S.slice)(e,u,c),n.elementShape)}return o}));for(var s=[],u=0;u<t.length;u++)s[u]=u;this.writeMany(s,o)}}]),t}(),At=function(){function t(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;(0,I.Z)(this,t),this.tensors=e,this.elementShape=n,this.elementDtype=r,null!=e&&e.forEach((function(t){if(r!==t.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(t.dtype));Et(n,t.shape,"TensorList shape mismatch: "),(0,S.keep)(t)})),this.idTensor=(0,S.scalar)(0),this.maxNumElements=a,(0,S.keep)(this.idTensor)}return(0,_.Z)(t,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new t((0,R.Z)(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(t){this.tensors.forEach((function(e){null!=t&&t.has(e.id)||e.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));Et(t,this.elementShape,"TensorList shape mismatch: ");var a=Tt(this.elementShape,this.tensors,t);return(0,S.tidy)((function(){var t=n.tensors.map((function(t){return(0,S.reshape)(t,a)}));return(0,S.stack)(t,0)}))}},{key:"popBack",value:function(t,e){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=Tt(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,Et(r.shape,t,"TensorList shape mismatch: "),(0,S.reshape)(r,n)}},{key:"pushBack",value:function(t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(Et(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");(0,S.keep)(t),this.tensors.push(t)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));var n=new t([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(var r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}},{key:"getItem",value:function(t,e,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(t<0||t>this.tensors.length)throw new Error("Trying to access element ".concat(t," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[t])throw new Error("element at index ".concat(t," is null."));Et(this.tensors[t].shape,e,"TensorList shape mismatch: ");var r=Tt(this.elementShape,this.tensors,e);return(0,S.reshape)(this.tensors[t],r)}},{key:"setItem",value:function(t,e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error("Trying to set element ".concat(t," in a list with max ").concat(this.maxNumElements," elements."));Et(this.elementShape,e.shape,"TensorList shape mismatch: "),(0,S.keep)(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e}},{key:"gather",value:function(t,e,n){var r=this;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));Et(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());var a=Tt(this.elementShape,this.tensors,n);return 0===t.length?(0,S.tensor)([],[0].concat(a)):(0,S.tidy)((function(){var e=t.map((function(t){return(0,S.reshape)(r.tensors[t],a)}));return(0,S.stack)(e,0)}))}},{key:"concat",value:function(t,e){var n=this;if(t&&t!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(t));Et(this.elementShape,e,"TensorList shape mismatch: ");var r=Tt(this.elementShape,this.tensors,e);return 0===this.size()?(0,S.tensor)([],[0].concat(r)):(0,S.tidy)((function(){var t=n.tensors.map((function(t){return(0,S.reshape)(t,r)}));return(0,S.concat)(t,0)}))}}]),t}();function Rt(t,e,n){var r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(t.shape));if(t.dtype!==n)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(n));Et(t.shape.slice(1),e,"TensorList shape mismatch: ");var a=(0,S.unstack)(t);return new At(a,e,r)}function Dt(t,e,n,r){return new At([],t,e,r)}function Ot(t,e,n,r){if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var a=Math.max.apply(Math,(0,R.Z)(e));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new At([],n,t.dtype,r),o=(0,S.unstack)(t,0);return e.forEach((function(t,e){i.setItem(t,o[e])})),i}function Mt(t,e,n){var r=0,a=e.map((function(t){return r+=t}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));for(var i=It(t.shape.slice(1),n),o=0===r?0:t.size/r,s=(0,S.tidy)((function(){var n=[];t=(0,S.reshape)(t,[1,r,o]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,e[s],o];n[s]=(0,S.reshape)((0,S.slice)(t,u,c),i)}return t.dispose(),n})),u=new At([],n,t.dtype,e.length),c=0;c<s.length;c++)u.setItem(c,s[c]);return u}var Ft=function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n,r){var a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k,N,E,T,I,_,A,R,D,O,z,B,L,P,W,U,j,H,q,G,Z,K,X,$,Y,Q,J,tt,et,nt,rt,at,it,ot,st,ut,ct,lt,pt,ft,ht,dt,mt,vt,gt,yt,bt,wt,xt,kt,St,Nt,Et,Ct,Tt,It,At,Ft,zt,Bt,Lt,Pt,Vt,Wt,Ut,jt,Ht,qt,Gt,Zt,Kt,Xt,$t,Yt,Qt,Jt,te,ee,ne,re,ae,ie,oe,se,ue;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.op,t.next="If"===t.t0||"StatelessIf"===t.t0?3:"While"===t.t0||"StatelessWhile"===t.t0?15:"LoopCond"===t.t0?19:"Switch"===t.t0?21:"Merge"===t.t0?32:"Enter"===t.t0?37:"Exit"===t.t0?41:"NextIteration"===t.t0?44:"TensorArrayV3"===t.t0?47:"TensorArrayWriteV3"===t.t0?57:"TensorArrayReadV3"===t.t0?63:"TensorArrayGatherV3"===t.t0?67:"TensorArrayScatterV3"===t.t0?72:"TensorArrayConcatV3"===t.t0?78:"TensorArraySplitV3"===t.t0?82:"TensorArraySizeV3"===t.t0?88:"TensorArrayCloseV3"===t.t0?91:"TensorListSetItem"===t.t0?95:"TensorListGetItem"===t.t0?101:"TensorListScatterV2"===t.t0||"TensorListScatter"===t.t0?107:"TensorListReserve"===t.t0||"EmptyTensorList"===t.t0?114:"TensorListGather"===t.t0?122:"TensorListStack"===t.t0?128:"TensorListFromTensor"===t.t0?134:"TensorListConcat"===t.t0||"TensorListConcatV2"===t.t0?140:"TensorListPushBack"===t.t0?145:"TensorListPopBack"===t.t0?150:"TensorListSplit"===t.t0?155:"TensorListLength"===t.t0?161:"TensorListResize"===t.t0?164:170;break;case 3:return a=M("thenBranch",e,n,r),i=M("elseBranch",e,n,r),o=M("cond",e,n,r),s=M("args",e,n,r),t.next=9,o.data();case 9:if(!t.sent[0]){t.next=14;break}return t.abrupt("return",r.functionMap[a].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 14:return t.abrupt("return",r.functionMap[i].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap));case 15:return t.delegateYield((0,C.Z)().mark((function t(){var a,i,o,s,u,c,l,p;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=M("body",e,n,r),i=M("cond",e,n,r),o=M("args",e,n,r),t.next=5,r.functionMap[i].executeFunctionAsync(o,r.tensorArrayMap,r.tensorListMap);case 5:return s=t.sent,u=o.map((function(t){return t.id})),t.next=9,s[0].data();case 9:c=t.sent,s.forEach((function(t){t.kept||-1!==u.indexOf(t.id)||t.dispose()})),l=o,p=(0,C.Z)().mark((function t(){var e,n,o;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=l,t.next=3,r.functionMap[a].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 3:return l=t.sent,n=l.map((function(t){return t.id})),e.forEach((function(t){t.kept||-1!==u.indexOf(t.id)||-1!==n.indexOf(t.id)||t.dispose()})),t.next=8,r.functionMap[i].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 8:return o=t.sent,t.next=11,o[0].data();case 11:c=t.sent,o.forEach((function(t){t.kept||-1!==u.indexOf(t.id)||-1!==n.indexOf(t.id)||t.dispose()}));case 13:case"end":return t.stop()}}),t)}));case 13:if(!c[0]){t.next=17;break}return t.delegateYield(p(),"t0",15);case 15:t.next=13;break;case 17:return t.abrupt("return",{v:l});case 18:case"end":return t.stop()}}),t)}))(),"t1",16);case 16:if("object"!==typeof(u=t.t1)){t.next=19;break}return t.abrupt("return",u.v);case 19:return c=M("pred",e,n,r),t.abrupt("return",[V(c)]);case 21:return l=M("pred",e,n,r),(p=M("data",e,n,r)).kept||(p=V(p)),t.next=26,l.data();case 26:if(!t.sent[0]){t.next=30;break}t.t2=[void 0,p],t.next=31;break;case 30:t.t2=[p,void 0];case 31:return t.abrupt("return",t.t2);case 32:if(f=e.inputNames.find((function(t){return void 0!==F(t,n,r)})),!f){t.next=36;break}return h=F(f,n,r),t.abrupt("return",[V(h)]);case 36:return t.abrupt("return",void 0);case 37:return d=M("frameName",e,n,r),m=M("tensor",e,n,r),r.enterFrame(d),t.abrupt("return",[V(m)]);case 41:return v=M("tensor",e,n,r),r.exitFrame(),t.abrupt("return",[V(v)]);case 44:return g=M("tensor",e,n,r),r.nextIteration(),t.abrupt("return",[V(g)]);case 47:return y=M("size",e,n,r),b=M("dtype",e,n,r),w=M("elementShape",e,n,r),x=M("dynamicSize",e,n,r),k=M("clearAfterRead",e,n,r),N=M("identicalElementShapes",e,n,r),E=M("name",e,n,r),T=new _t(E,b,y,w,N,x,k),r.addTensorArray(T),t.abrupt("return",[T.idTensor,(0,S.scalar)(1)]);case 57:return I=M("tensorArrayId",e,n,r),_=M("index",e,n,r),A=M("tensor",e,n,r),(R=r.getTensorArray(I.id)).write(_,A),t.abrupt("return",[R.idTensor]);case 63:return D=M("tensorArrayId",e,n,r),O=M("index",e,n,r),z=r.getTensorArray(D.id),t.abrupt("return",[z.read(O)]);case 67:return B=M("tensorArrayId",e,n,r),L=M("indices",e,n,r),P=M("dtype",e,n,r),W=r.getTensorArray(B.id),t.abrupt("return",[W.gather(L,P)]);case 72:return U=M("tensorArrayId",e,n,r),j=M("indices",e,n,r),H=M("tensor",e,n,r),(q=r.getTensorArray(U.id)).scatter(j,H),t.abrupt("return",[q.idTensor]);case 78:return G=M("tensorArrayId",e,n,r),Z=r.getTensorArray(G.id),K=M("dtype",e,n,r),t.abrupt("return",[Z.concat(K)]);case 82:return X=M("tensorArrayId",e,n,r),$=M("tensor",e,n,r),Y=M("lengths",e,n,r),(Q=r.getTensorArray(X.id)).split(Y,$),t.abrupt("return",[Q.idTensor]);case 88:return J=M("tensorArrayId",e,n,r),tt=r.getTensorArray(J.id),t.abrupt("return",[(0,S.scalar)(tt.size(),"int32")]);case 91:return et=M("tensorArrayId",e,n,r),(nt=r.getTensorArray(et.id)).clearAndClose(),t.abrupt("return",[nt.idTensor]);case 95:return rt=M("tensorListId",e,n,r),at=M("index",e,n,r),it=M("tensor",e,n,r),(ot=r.getTensorList(rt.id)).setItem(at,it),t.abrupt("return",[ot.idTensor]);case 101:return st=M("tensorListId",e,n,r),ut=M("index",e,n,r),ct=M("elementShape",e,n,r),lt=M("elementDType",e,n,r),pt=r.getTensorList(st.id),t.abrupt("return",[pt.getItem(ut,ct,lt)]);case 107:return ft=M("indices",e,n,r),ht=M("tensor",e,n,r),dt=M("elementShape",e,n,r),mt=M("numElements",e,n,r),vt=Ot(ht,ft,dt,mt),r.addTensorList(vt),t.abrupt("return",[vt.idTensor]);case 114:return gt=M("elementShape",e,n,r),yt=M("elementDType",e,n,r),bt="TensorListReserve"===e.op?"numElements":"maxNumElements",wt=M(bt,e,n,r),xt="TensorListReserve"===e.op?-1:wt,kt=Dt(gt,yt,0,xt),r.addTensorList(kt),t.abrupt("return",[kt.idTensor]);case 122:return St=M("tensorListId",e,n,r),Nt=M("indices",e,n,r),Et=M("elementShape",e,n,r),Ct=M("elementDType",e,n,r),Tt=r.getTensorList(St.id),t.abrupt("return",[Tt.gather(Nt,Ct,Et)]);case 128:return It=M("tensorListId",e,n,r),At=M("elementShape",e,n,r),Ft=M("elementDType",e,n,r),zt=M("numElements",e,n,r),Bt=r.getTensorList(It.id),t.abrupt("return",[Bt.stack(At,Ft,zt)]);case 134:return Lt=M("tensor",e,n,r),Pt=M("elementShape",e,n,r),Vt=M("elementDType",e,n,r),Wt=Rt(Lt,Pt,Vt),r.addTensorList(Wt),t.abrupt("return",[Wt.idTensor]);case 140:return Ut=M("tensorListId",e,n,r),jt=r.getTensorList(Ut.id),Ht=M("dtype",e,n,r),qt=M("elementShape",e,n,r),t.abrupt("return",[jt.concat(Ht,qt)]);case 145:return Gt=M("tensorListId",e,n,r),Zt=M("tensor",e,n,r),(Kt=r.getTensorList(Gt.id)).pushBack(Zt),t.abrupt("return",[Kt.idTensor]);case 150:return Xt=M("tensorListId",e,n,r),$t=M("elementShape",e,n,r),Yt=M("elementDType",e,n,r),Qt=r.getTensorList(Xt.id),t.abrupt("return",[Qt.popBack($t,Yt)]);case 155:return Jt=M("tensor",e,n,r),te=M("elementShape",e,n,r),ee=M("lengths",e,n,r),ne=Mt(Jt,ee,te),r.addTensorList(ne),t.abrupt("return",[ne.idTensor]);case 161:return re=M("tensorListId",e,n,r),ae=r.getTensorList(re.id),t.abrupt("return",[(0,S.scalar)(ae.size(),"int32")]);case 164:return ie=M("tensorListId",e,n,r),oe=M("size",e,n,r),se=r.getTensorList(ie.id),ue=se.resize(oe),r.addTensorList(ue),t.abrupt("return",[ue.idTensor]);case 170:throw TypeError("Node type ".concat(e.op," is not implemented"));case 171:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();function zt(t,e,n){var r=M("fusedOps",t,e,n),a=(0,A.Z)(r,2),i=a[0],o=a[1],s="biasadd"===i,u=!s,c="prelu"===o,l="fusedbatchnorm"===i,p=M("numArgs",t,e,n);if(s){if(c&&2!==p)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&s&&1!==p)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var f=M("strides",t,e,n),h=P(t,e,n),d=M("dataFormat",t,e,n).toUpperCase(),m=M("dilations",t,e,n),v=M("args",t,e,n),g=(0,A.Z)(v,2),y=g[0],b=g[1];return u&&(b=y,y=void 0),{stride:f,pad:h,dataFormat:d,dilations:m,biasArg:y,preluArg:b,activationFunc:o,leakyreluAlpha:M("leakyreluAlpha",t,e,n)}}var Bt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Conv1D":var a=M("stride",t,e,n),i=M("pad",t,e,n),o=M("dataFormat",t,e,n).toUpperCase(),s=M("dilation",t,e,n);return[r.conv1d(M("x",t,e,n),M("filter",t,e,n),a,i,o,s)];case"Conv2D":var u=M("strides",t,e,n),c=P(t,e,n),l=M("dataFormat",t,e,n).toUpperCase(),p=M("dilations",t,e,n);return[r.conv2d(M("x",t,e,n),M("filter",t,e,n),[u[1],u[2]],c,l,[p[1],p[2]])];case"_FusedConv2D":var f=zt(t,e,n),h=f.stride,d=f.pad,m=f.dataFormat,v=f.dilations,g=f.biasArg,y=f.preluArg,b=f.activationFunc,w=f.leakyreluAlpha;return[r.fused.conv2d({x:M("x",t,e,n),filter:M("filter",t,e,n),strides:[h[1],h[2]],pad:d,dataFormat:m,dilations:[v[1],v[2]],bias:g,activation:b,preluActivationWeights:y,leakyreluAlpha:w})];case"FusedDepthwiseConv2dNative":var x=zt(t,e,n),S=x.stride,N=x.pad,E=x.dataFormat,C=x.dilations,T=x.biasArg,I=x.preluArg,_=x.activationFunc,A=x.leakyreluAlpha;return[r.fused.depthwiseConv2d({x:M("x",t,e,n),filter:M("filter",t,e,n),strides:[S[1],S[2]],pad:N,dataFormat:E,dilations:[C[1],C[2]],bias:T,activation:_,preluActivationWeights:I,leakyreluAlpha:A})];case"Conv2DBackpropInput":case"Conv2dTranspose":var R=M("outputShape",t,e,n),D=M("strides",t,e,n),O=P(t,e,n);return[r.conv2dTranspose(M("x",t,e,n),M("filter",t,e,n),R,[D[1],D[2]],O)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var F=M("strides",t,e,n),z=P(t,e,n),B=M("dilations",t,e,n),L=M("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(M("input",t,e,n),M("filter",t,e,n),[F[1],F[2]],z,L,[B[1],B[2]])];case"Conv3D":var V=M("strides",t,e,n),W=M("pad",t,e,n),U=M("dataFormat",t,e,n).toUpperCase(),j=M("dilations",t,e,n);return[r.conv3d(M("x",t,e,n),M("filter",t,e,n),[V[1],V[2],V[3]],W,U,[j[1],j[2],j[3]])];case"AvgPool":var H=M("strides",t,e,n),q=M("pad",t,e,n),G=M("kernelSize",t,e,n);return[r.avgPool(M("x",t,e,n),[G[1],G[2]],[H[1],H[2]],q)];case"MaxPool":var Z=M("strides",t,e,n),K=M("pad",t,e,n),X=M("kernelSize",t,e,n);return[r.maxPool(M("x",t,e,n),[X[1],X[2]],[Z[1],Z[2]],K)];case"MaxPoolWithArgmax":var $=M("strides",t,e,n),Y=M("pad",t,e,n),Q=M("kernelSize",t,e,n),J=M("includeBatchInIndex",t,e,n),tt=r.maxPoolWithArgmax(M("x",t,e,n),[Q[1],Q[2]],[$[1],$[2]],Y,J),et=tt.result,nt=tt.indexes;return[et,nt];case"AvgPool3D":var rt=M("strides",t,e,n),at=M("pad",t,e,n),it=M("kernelSize",t,e,n);return[r.avgPool3d(M("x",t,e,n),[it[1],it[2],it[3]],[rt[1],rt[2],rt[3]],at)];case"MaxPool3D":var ot=M("strides",t,e,n),st=M("pad",t,e,n),ut=M("kernelSize",t,e,n);return[r.maxPool3d(M("x",t,e,n),[ut[1],ut[2],ut[3]],[ot[1],ot[2],ot[3]],st)];case"Dilation2D":var ct=M("strides",t,e,n),lt=M("pad",t,e,n),pt=M("dilations",t,e,n),ft=ct[1],ht=ct[2],dt=pt[1],mt=pt[2];return[r.dilation2d(M("x",t,e,n),M("filter",t,e,n),[ft,ht],lt,[dt,mt],"NHWC")];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Lt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Fill":var a=M("shape",t,e,n),i=M("dtype",t,e,n),o=M("value",t,e,n);return[r.fill(a,o,i)];case"LinSpace":var s=M("start",t,e,n),u=M("stop",t,e,n),c=M("num",t,e,n);return[r.linspace(s,u,c)];case"Multinomial":var l=M("logits",t,e,n),p=M("numSamples",t,e,n),f=M("seed",t,e,n);return[r.multinomial(l,p,f)];case"OneHot":var h=M("indices",t,e,n),d=M("depth",t,e,n),m=M("onValue",t,e,n),v=M("offValue",t,e,n),g=M("dtype",t,e,n);return[r.oneHot(h,d,m,v,g)];case"Ones":return[r.ones(M("shape",t,e,n),M("dtype",t,e,n))];case"OnesLike":return[r.onesLike(M("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(M("shape",t,e,n),M("dtype",t,e,n),M("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(M("shape",t,e,n),M("minval",t,e,n),M("maxval",t,e,n),M("dtype",t,e,n))];case"Range":var y=M("start",t,e,n),b=M("stop",t,e,n),w=M("step",t,e,n);return[r.range(y,b,w,M("dtype",t,e,n))];case"TruncatedNormal":var x=M("shape",t,e,n),S=M("mean",t,e,n),N=M("stdDev",t,e,n),E=M("seed",t,e,n);return[r.truncatedNormal(x,S,N,M("dtype",t,e,n),E)];case"Zeros":return[r.zeros(M("shape",t,e,n),M("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(M("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}};function Pt(t,e,n){return{boxes:M("boxes",t,e,n),scores:M("scores",t,e,n),maxOutputSize:M("maxOutputSize",t,e,n),iouThreshold:M("iouThreshold",t,e,n),scoreThreshold:M("scoreThreshold",t,e,n),softNmsSigma:M("softNmsSigma",t,e,n)}}var Vt=function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n,r,a){var i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,S,N,E,T,I,_,A,R,D=arguments;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=D.length>4&&void 0!==D[4]?D[4]:k,t.t0=e.op,t.next="NonMaxSuppressionV5"===t.t0?4:"NonMaxSuppressionV4"===t.t0?9:"NonMaxSuppressionV3"===t.t0||"NonMaxSuppressionV2"===t.t0?15:"Where"===t.t0?20:"ListDiff"===t.t0?27:28;break;case 4:return o=Pt(e,n,r),s=o.boxes,u=o.scores,c=o.maxOutputSize,l=o.iouThreshold,p=o.scoreThreshold,f=o.softNmsSigma,t.next=7,i.image.nonMaxSuppressionWithScoreAsync(s,u,c,l,p,f);case 7:return h=t.sent,t.abrupt("return",[h.selectedIndices,h.selectedScores]);case 9:return d=Pt(e,n,r),m=d.boxes,v=d.scores,g=d.maxOutputSize,y=d.iouThreshold,b=d.scoreThreshold,w=M("padToMaxOutputSize",e,n,r),t.next=13,i.image.nonMaxSuppressionPaddedAsync(m,v,g,y,b,w);case 13:return x=t.sent,t.abrupt("return",[x.selectedIndices,x.validOutputs]);case 15:return S=Pt(e,n,r),N=S.boxes,E=S.scores,T=S.maxOutputSize,I=S.iouThreshold,_=S.scoreThreshold,t.next=18,i.image.nonMaxSuppressionAsync(N,E,T,I,_);case 18:return t.t1=t.sent,t.abrupt("return",[t.t1]);case 20:return A=i.cast(M("condition",e,n,r),"bool"),t.next=23,i.whereAsync(A);case 23:return t.t2=t.sent,R=[t.t2],A.dispose(),t.abrupt("return",R);case 27:return t.abrupt("return",i.setdiff1dAsync(M("x",e,n,r),M("y",e,n,r)));case 28:throw TypeError("Node type ".concat(e.op," is not implemented"));case 29:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),Wt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"LowerBound":var a=M("sortedSequence",t,e,n),i=M("values",t,e,n);return[r.lowerBound(a,i)];case"TopKV2":var o=M("x",t,e,n),s=M("k",t,e,n),u=M("sorted",t,e,n),c=r.topk(o,s,u);return[c.values,c.indices];case"UpperBound":var l=M("sortedSequence",t,e,n),p=M("values",t,e,n);return[r.upperBound(l,p)];case"Unique":var f=M("x",t,e,n),h=r.unique(f);return[h.values,h.indices];case"UniqueV2":var d=M("x",t,e,n),m=M("axis",t,e,n),v=r.unique(d,m);return[v.values,v.indices];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Ut=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var a=M("default",t,e,n);return[F(t.name,e,n)||a];case"Placeholder":return[F(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":var i=M("x",t,e,n);return[V(i)];case"IdentityN":return M("x",t,e,n).map((function(t){return V(t)}));case"Snapshot":var o=M("x",t,e,n);return[V(o)];case"Shape":return[r.tensor1d(M("x",t,e,n).shape,"int32")];case"ShapeN":return M("x",t,e,n).map((function(t){return r.tensor1d(t.shape)}));case"Size":return[r.scalar(M("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(M("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":var s=M("x",t,e,n),u=M("data",t,e,n),c=M("message",t,e,n),l=M("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(var p=0;p<u.length;p++)console.log(Array.prototype.slice.call(u[p].dataSync()).slice(0,l));return[s];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},jt=n(7067),Ht=function(){function t(e,n){(0,I.Z)(this,t),this.keyDType=e,this.valueDType=n,this.handle=(0,S.scalar)(0),this.tensorMap=new Map,(0,S.keep)(this.handle)}return(0,_.Z)(t,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(t){return t.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return jt.i(this.size(),"int32")}},{key:"import",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n){var r,a=this;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.checkKeyAndValueTensor(e,n),t.next=3,e.data();case 3:return r=t.sent,this.tensorMap.forEach((function(t){return t.dispose()})),this.tensorMap.clear(),t.abrupt("return",(0,S.tidy)((function(){var t=(0,S.unstack)(n),e=r.length,i=t.length;S.util.assert(e===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(e," elements, the values has ").concat(i," ")+"elements."}));for(var o=0;o<e;o++){var s=r[o],u=t[o];(0,S.keep)(u),a.tensorMap.set(s,u)}return a.handle})));case 7:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"find",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n){var r,a=this;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.checkKeyAndValueTensor(e,n),t.next=3,e.data();case 3:return r=t.sent,t.abrupt("return",(0,S.tidy)((function(){for(var t=[],e=0;e<r.length;e++){var i=r[e],o=a.findWithDefault(i,n);t.push(o)}return(0,S.stack)(t)})));case 5:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"findWithDefault",value:function(t,e){var n=this.tensorMap.get(t);return null!=n?n:e}},{key:"checkKeyAndValueTensor",value:function(t,e){if(t.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(t.dtype));if(e.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(e.dtype))}}]),t}(),qt=function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n,r,a){var i,o,s,u,c,l,p,f,h,d,m,v,g;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.op,t.next="HashTable"===t.t0||"HashTableV2"===t.t0?3:"LookupTableImport"===t.t0||"LookupTableImportV2"===t.t0?8:"LookupTableFind"===t.t0||"LookupTableFindV2"===t.t0?16:"LookupTableSize"===t.t0||"LookupTableSizeV2"===t.t0?24:27;break;case 3:return i=M("keyDType",e,n,r),o=M("valueDType",e,n,r),s=new Ht(i,o),a.addHashTable(e.name,s),t.abrupt("return",[s.handle]);case 8:return u=M("tableHandle",e,n,r,a),c=M("keys",e,n,r),l=M("values",e,n,r),p=a.getHashTableById(u.id),t.next=14,p.import(c,l);case 14:return t.t1=t.sent,t.abrupt("return",[t.t1]);case 16:return f=M("tableHandle",e,n,r,a),h=M("keys",e,n,r),d=M("defaultValue",e,n,r),m=a.getHashTableById(f.id),t.next=22,m.find(h,d);case 22:return t.t2=t.sent,t.abrupt("return",[t.t2]);case 24:return v=M("tableHandle",e,n,r,a),g=a.getHashTableById(v.id),t.abrupt("return",[g.tensorSize()]);case 27:throw TypeError("Node type ".concat(e.op," is not implemented"));case 28:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),Gt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"ResizeBilinear":var a=M("images",t,e,n),i=M("size",t,e,n),o=M("alignCorners",t,e,n),s=M("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)];case"ResizeNearestNeighbor":var u=M("images",t,e,n),c=M("size",t,e,n),l=M("alignCorners",t,e,n),p=M("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(u,[c[0],c[1]],l,p)];case"CropAndResize":var f=M("image",t,e,n),h=M("boxes",t,e,n),d=M("boxInd",t,e,n),m=M("cropSize",t,e,n),v=M("method",t,e,n),g=M("extrapolationValue",t,e,n);return[r.image.cropAndResize(f,h,d,m,v,g)];case"ImageProjectiveTransformV3":var y=M("images",t,e,n),b=M("transforms",t,e,n),w=M("outputShape",t,e,n),x=M("fillValue",t,e,n),S=M("interpolation",t,e,n),N=M("fillMode",t,e,n);return[r.image.transform(y,b,S.toLowerCase(),N.toLowerCase(),x,w)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Zt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Equal":return[r.equal(M("a",t,e,n),M("b",t,e,n))];case"NotEqual":return[r.notEqual(M("a",t,e,n),M("b",t,e,n))];case"Greater":return[r.greater(M("a",t,e,n),M("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(M("a",t,e,n),M("b",t,e,n))];case"Less":return[r.less(M("a",t,e,n),M("b",t,e,n))];case"LessEqual":return[r.lessEqual(M("a",t,e,n),M("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(M("a",t,e,n),M("b",t,e,n))];case"LogicalNot":return[r.logicalNot(M("a",t,e,n))];case"LogicalOr":return[r.logicalOr(M("a",t,e,n),M("b",t,e,n))];case"Select":case"SelectV2":return[r.where(M("condition",t,e,n),M("a",t,e,n),M("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Kt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(M("a",t,e,n),M("b",t,e,n),M("transposeA",t,e,n),M("transposeB",t,e,n))];case"Einsum":return[r.einsum.apply(r,[M("equation",t,e,n)].concat((0,R.Z)(M("tensors",t,e,n))))];case"Transpose":return[r.transpose(M("x",t,e,n),M("perm",t,e,n))];case"_FusedMatMul":var a=M("fusedOps",t,e,n),i=(0,A.Z)(a,2),o=i[0],s=i[1],u="biasadd"===o,c="prelu"===s,l=M("numArgs",t,e,n),p=M("leakyreluAlpha",t,e,n);if(u){if(c&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var f=M("args",t,e,n),h=(0,A.Z)(f,2),d=h[0],m=h[1];return[r.fused.matMul({a:M("a",t,e,n),b:M("b",t,e,n),transposeA:M("transposeA",t,e,n),transposeB:M("transposeB",t,e,n),bias:d,activation:s,preluActivationWeights:m,leakyreluAlpha:p})];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Xt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(M("x",t,e,n),M("axis",t,e,n),M("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(M("x",t,e,n),M("mean",t,e,n),M("variance",t,e,n),M("offset",t,e,n),M("scale",t,e,n),M("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(M("x",t,e,n),M("radius",t,e,n),M("bias",t,e,n),M("alpha",t,e,n),M("beta",t,e,n))];case"Softmax":return[r.softmax(M("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(M("x",t,e,n))];case"SparseToDense":return[r.sparseToDense(M("sparseIndices",t,e,n),M("outputShape",t,e,n),M("sparseValues",t,e,n),M("defaultValue",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},$t=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Max":var a=M("axis",t,e,n),i=M("keepDims",t,e,n);return[r.max(M("x",t,e,n),a,i)];case"Mean":var o=M("axis",t,e,n),s=M("keepDims",t,e,n);return[r.mean(M("x",t,e,n),o,s)];case"Min":var u=M("axis",t,e,n),c=M("keepDims",t,e,n);return[r.min(M("x",t,e,n),u,c)];case"Sum":var l=M("axis",t,e,n),p=M("keepDims",t,e,n);return[r.sum(M("x",t,e,n),l,p)];case"All":var f=M("axis",t,e,n),h=M("keepDims",t,e,n);return[r.all(M("x",t,e,n),f,h)];case"Any":var d=M("axis",t,e,n),m=M("keepDims",t,e,n);return[r.any(M("x",t,e,n),d,m)];case"ArgMax":var v=M("axis",t,e,n);return[r.argMax(M("x",t,e,n),v)];case"ArgMin":var g=M("axis",t,e,n);return[r.argMin(M("x",t,e,n),g)];case"Prod":var y=M("axis",t,e,n),b=M("keepDims",t,e,n);return[r.prod(M("x",t,e,n),y,b)];case"Cumprod":var w=M("axis",t,e,n),x=M("exclusive",t,e,n),S=M("reverse",t,e,n);return[r.cumprod(M("x",t,e,n),w,x,S)];case"Cumsum":var N=M("axis",t,e,n),E=M("exclusive",t,e,n),C=M("reverse",t,e,n);return[r.cumsum(M("x",t,e,n),N,E,C)];case"Bincount":var T=M("x",t,e,n),I=M("weights",t,e,n),_=M("size",t,e,n);return[r.bincount(T,I,_)];case"DenseBincount":var A=M("x",t,e,n),R=M("weights",t,e,n),D=M("size",t,e,n),O=M("binaryOutput",t,e,n);return[r.denseBincount(A,R,D,O)];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Yt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"ConcatV2":case"Concat":var a=M("n",t,e,n),i=M("axis",t,e,n),o=M("tensors",t,e,n);return o=o.slice(0,a),[r.concat(o,i)];case"Gather":var s=M("x",t,e,n),u=M("indices",t,e,n);return[r.gather(s,r.cast(u,"int32"),0)];case"GatherV2":var c=M("axis",t,e,n),l=M("batchDims",t,e,n),p=M("x",t,e,n),f=M("indices",t,e,n);return[r.gather(p,r.cast(f,"int32"),c,l)];case"Reverse":for(var h=M("dims",t,e,n),d=[],m=0;m<h.length;m++)h[m]&&d.push(m);var v=M("x",t,e,n);return[r.reverse(v,d)];case"ReverseV2":var g=M("axis",t,e,n),y=M("x",t,e,n);return[r.reverse(y,g)];case"Slice":var b=M("begin",t,e,n),w=M("size",t,e,n);return[r.slice(M("x",t,e,n),b,w)];case"StridedSlice":var x=M("begin",t,e,n),N=M("end",t,e,n),E=M("strides",t,e,n),C=M("beginMask",t,e,n),T=M("endMask",t,e,n),I=M("ellipsisMask",t,e,n),_=M("newAxisMask",t,e,n),A=M("shrinkAxisMask",t,e,n),R=M("x",t,e,n);return[r.stridedSlice(R,x,N,E,C,T,I,_,A)];case"Pack":return(0,S.tidy)((function(){var a=M("axis",t,e,n),i=M("tensors",t,e,n),o=i[0].shape,s=r.squeeze(i[0]).shape,u=i.map((function(t){var e=S.util.arraysEqual(t.shape,o);if(!e&&!S.util.arraysEqual(r.squeeze(t).shape,s))throw new Error("the input tensors shape does not match");return e?t:r.reshape(t,o)}));return[r.stack(u,a)]}));case"Unpack":var D=M("axis",t,e,n),O=M("tensor",t,e,n);return r.unstack(O,D);case"Tile":var F=M("reps",t,e,n);return[r.tile(M("x",t,e,n),F)];case"Split":case"SplitV":var z=M("axis",t,e,n),B=M("numOrSizeSplits",t,e,n),L=M("x",t,e,n);return r.split(L,B,z);case"ScatterNd":var P=M("indices",t,e,n),V=M("values",t,e,n),W=M("shape",t,e,n);return[r.scatterND(P,V,W)];case"GatherNd":var U=M("x",t,e,n),j=M("indices",t,e,n);return[r.gatherND(U,j)];case"SparseToDense":var H=M("sparseIndices",t,e,n),q=M("outputShape",t,e,n),G=M("sparseValues",t,e,n),Z=M("defaultValue",t,e,n);return[r.sparseToDense(H,G,q,G.dtype===Z.dtype?Z:r.cast(Z,G.dtype))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Qt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"SparseFillEmptyRows":var a=r.sparse.sparseFillEmptyRows(M("indices",t,e,n),M("values",t,e,n),M("denseShape",t,e,n),M("defaultValue",t,e,n)),i=a.outputIndices,o=a.outputValues,s=a.emptyRowIndicator,u=a.reverseIndexMap;return[i,o,s,u];case"SparseReshape":var c=r.sparse.sparseReshape(M("inputIndices",t,e,n),M("inputShape",t,e,n),M("newShape",t,e,n)),l=c.outputIndices,p=c.outputShape;return[l,p];case"SparseSegmentMean":var f=r.sparse.sparseSegmentMean(M("data",t,e,n),M("indices",t,e,n),M("segmentIds",t,e,n));return[f];case"SparseSegmentSum":var h=r.sparse.sparseSegmentSum(M("data",t,e,n),M("indices",t,e,n),M("segmentIds",t,e,n));return[h];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},Jt=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"FFT":return[r.fft(M("x",t,e,n))];case"IFFT":return[r.ifft(M("x",t,e,n))];case"RFFT":return[r.rfft(M("x",t,e,n))];case"IRFFT":return[r.irfft(M("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},te=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"StringNGrams":var a=r.string.stringNGrams(M("data",t,e,n),M("dataSplits",t,e,n),M("separator",t,e,n),M("nGramWidths",t,e,n),M("leftPad",t,e,n),M("rightPad",t,e,n),M("padWidth",t,e,n),M("preserveShortSequences",t,e,n)),i=a.nGrams,o=a.nGramsSplits;return[i,o];case"StringSplit":var s=r.string.stringSplit(M("input",t,e,n),M("delimiter",t,e,n),M("skipEmpty",t,e,n)),u=s.indices,c=s.values,l=s.shape;return[u,c,l];case"StringToHashBucketFast":var p=r.string.stringToHashBucketFast(M("input",t,e,n),M("numBuckets",t,e,n));return[p];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}},ee=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:k;switch(t.op){case"Cast":return[r.cast(M("x",t,e,n),M("dtype",t,e,n))];case"ExpandDims":var a=M("axis",t,e,n);return[r.expandDims(M("x",t,e,n),a)];case"Squeeze":var i=M("axis",t,e,n);return[r.squeeze(M("x",t,e,n),i)];case"Reshape":return[r.reshape(M("x",t,e,n),M("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(M("x",t,e,n),M("padding",t,e,n),M("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(M("x",t,e,n),M("padding",t,e,n),M("constantValue",t,e,n))];case"SpaceToBatchND":var o=M("blockShape",t,e,n),s=M("paddings",t,e,n);return[r.spaceToBatchND(M("x",t,e,n),o,s)];case"BatchToSpaceND":var u=M("blockShape",t,e,n),c=M("crops",t,e,n);return[r.batchToSpaceND(M("x",t,e,n),u,c)];case"DepthToSpace":var l=M("blockSize",t,e,n),p=M("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(M("x",t,e,n),l,p)];case"BroadcastTo":return[r.broadcastTo(M("x",t,e,n),M("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(M("s0",t,e,n),M("s1",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}};function ne(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:S.tidy,i=function(t,e,n){switch(t.category){case"arithmetic":return a((function(){return St(t,e,n)}));case"basic_math":return a((function(){return Nt(t,e,n)}));case"control":return Ft(t,e,n);case"convolution":return a((function(){return Bt(t,e,n)}));case"creation":return a((function(){return Lt(t,e,n)}));case"dynamic":return Vt(t,e,n);case"evaluation":return a((function(){return Wt(t,e,n)}));case"image":return a((function(){return Gt(t,e,n)}));case"graph":return a((function(){return Ut(t,e,n)}));case"logical":return a((function(){return Zt(t,e,n)}));case"matrices":return a((function(){return Kt(t,e,n)}));case"normalization":return a((function(){return Xt(t,e,n)}));case"reduction":return a((function(){return $t(t,e,n)}));case"slice_join":return a((function(){return Yt(t,e,n)}));case"sparse":return a((function(){return Qt(t,e,n)}));case"spectral":return a((function(){return Jt(t,e,n)}));case"string":return a((function(){return te(t,e,n)}));case"transformation":return a((function(){return ee(t,e,n)}));case"hash_table":return qt(t,e,n,r);case"custom":var i=O(t.op);if(i&&i.customExecutor)return i.customExecutor(new xt(t,e,n));throw TypeError("Custom op ".concat(t.op," is not registered."));default:throw TypeError("Unknown op '".concat(t.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return S.util.isPromise(i)?i.then((function(t){return[].concat(t)})):[].concat(i)}var re=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,I.Z)(this,t),this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return(0,_.Z)(t,[{key:"newFrame",value:function(t,e){return{id:t,frameName:e,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}},{key:"contextIdforContexts",value:function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":"".concat(t.frameName,"-").concat(t.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(t){return this.weightMap[t]}},{key:"addTensorArray",value:function(t){this.tensorArrayMap[t.id]=t}},{key:"getTensorArray",value:function(t){return this.tensorArrayMap[t]}},{key:"addTensorList",value:function(t){this.tensorListMap[t.id]=t}},{key:"getTensorList",value:function(t){return this.tensorListMap[t]}},{key:"dispose",value:function(t){for(var e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}]),t}();function ae(t,e,n,r){var a=new Set,i=[],o=null,s=null,u=new Set,c=Object.keys(t).map((function(t){return L(t)[0]})),l=[];null!=r&&(l=r.map((function(t){return L(t.name)[0]})));for(var p=(0,R.Z)(e);p.length>0;){var f=p.pop();(ue(f)||ce(f)||le(f))&&null==o&&(s=(o=f).children.map((function(t){return t.name})).filter((function(t){return a.has(t)}))),a.add(f.name),null==n[f.name]&&(-1===c.indexOf(f.name)&&-1===l.indexOf(f.name)&&(0!==f.inputs.length?f.inputs.forEach((function(t){u.has(t.name)||(u.add(t.name),p.push(t))})):i.push(f.name)))}return{inputs:t,outputs:e,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}var ie=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],oe=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],se=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function ue(t){return ie.indexOf(t.op)>=0}function ce(t){return oe.indexOf(t.op)>=0}function le(t){return se.indexOf(t.op)>=0}var pe=function(){function t(e,n){var r=this;(0,I.Z)(this,t),this.graph=e,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((function(n){r._functionExecutorMap[n]=new t(e.functions[n],r)}))}return(0,_.Z)(t,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(t){var e,n=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this._weightIds=(e=[]).concat.apply(e,(0,R.Z)(n)),this._weightMap=t}},{key:"resourceManager",set:function(t){this._resourceManager=t}},{key:"inputs",get:function(){return this._inputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(t){return t.signatureKey||t.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(t){var e=t.signatureKey||t.name;return t.defaultOutput?"".concat(e,":").concat(t.defaultOutput):e}))}},{key:"functions",get:function(){var t=this;return Object.keys(this._functions).reduce((function(e,n){return e[n]=t._functions[n].signature,e}),{})}},{key:"getCompilationKey",value:function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(t,e){var n=ae(t,e,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=e.map((function(t){return t.name})),s=Object.keys(t);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}return function(t,e,n){var r=n.usedNodes,a=n.inputs,i=[],o=Object.keys(a).map((function(t){return L(t)[0]})).map((function(e){return t.nodes[e]})),s=t.initNodes;o.forEach((function(t){r.has(t.name)&&i.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&i.push(t)})),null!=s&&s.forEach((function(t){r.has(t.name)&&i.push(t)}));for(var u=new Set,c=[];i.length>0;){var l=i.pop();u.add(l.name),e[l.name]||c.push(l),l.children.forEach((function(t){!u.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return u.has(t.name)}))&&i.push(t)}))}return c}(this.graph,this.weightMap,n)}},{key:"execute",value:function(t,e){var n=this;t=this.mapInputs(t);var r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);var a=r.map((function(t){return n.graph.nodes[L(t)[0]]})),i=e.map((function(t){return L(t)[0]})),o=i.map((function(t){return n.graph.nodes[t]}));this.resetIntermediateTensors(),0===o.length&&(o=this._outputs);var s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);null==u&&(u=this.compile(t,o),this.compiledMap.set(s,u));var c={},l={};return(0,S.tidy)((function(){var r=new re(n.weightMap,c,l,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(t).forEach((function(e){var n=L(e),r=(0,A.Z)(n,2),i=r[0],o=[];o[r[1]]=t[e],a[i]=o}));for(var o=n.getFrozenTensorIds(a),s={},p=0;p<u.length;p++){var f=u[p];if(!a[f.name]){var h=ne(f,a,r,n._resourceManager);if(S.util.isPromise(h))throw new Error("The execution of the op '".concat(f.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[f.name]=h,n.checkTensorForDisposal(f.name,f,a,r,o,i,s)}}return null==n.parent&&r.dispose(o),e.map((function(t){return F(t,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)}},{key:"checkTensorForDisposal",value:function(t,e,n,r,a,i,o){var s=this;"control"!==e.category&&-1===i.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var i=function(t,e,n){return e[B(t,n.currentContextId)]}(t.name,n,r);null!=i&&i.forEach((function(t){if(t&&!t.kept&&!a.has(t.id)){var n=o[t.id];if(1===n){if(s.keepTensorForDebug){var i=z(e.name,r),u=(0,A.Z)(i,2),c=u[0],l=u[1];s.intermediateTensors[c]||(s.intermediateTensors[c]=[]),s.intermediateTensors[c][l]=t}else t.dispose();delete o[t.id]}else null!=n&&o[t.id]--}}))}})))}},{key:"executeAsync",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n){return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._executeAsync(e,n));case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"disposeIntermediateTensors",value:function(){var t=this;this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach((function(e){return t.intermediateTensors[e].forEach((function(t){return t.dispose()}))})),this.disposeTensorsMap())}},{key:"disposeTensorsMap",value:function(){var t=this;this.tensorsMap&&Object.keys(this.tensorsMap).forEach((function(e){t.tensorsMap[e].forEach((function(e){!e||e.kept||e.isDisposed||t.keepIds.has(e.id)||e.dispose()}))}))}},{key:"getIntermediateTensors",value:function(){return this.tensorsMap}},{key:"resetIntermediateTensors",value:function(){for(var t in this.intermediateTensors)this.intermediateTensors[t].forEach((function(t){return t.dispose()})),delete this.intermediateTensors[t]}},{key:"_executeAsync",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n){var r,a,i,o,s,u,c,l=this,p=arguments;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=p.length>2&&void 0!==p[2]&&p[2],a=p.length>3&&void 0!==p[3]?p[3]:{},i=p.length>4&&void 0!==p[4]?p[4]:{},r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepTensorForDebug=(0,S.env)().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){console.warn(f.message)}return this.resetIntermediateTensors(),o=new re(this.weightMap,a,i,this.functionExecutorMap),t.next=9,this.executeWithControlFlow(e,o,n,r);case 9:return this.tensorsMap=t.sent,s=n.map((function(t){return F(t,l.tensorsMap,o)})),u=s.map((function(t){return t.id})),c=Object.keys(e).map((function(t){return e[t].id})),this.keepIds=new Set([].concat((0,R.Z)(u),(0,R.Z)(c),(0,R.Z)(this.weightIds))),this.keepTensorForDebug||this.disposeTensorsMap(),null==this.parent&&o.dispose(this.keepIds),t.abrupt("return",s);case 17:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n,r){var a,i=this;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.reduce((function(t,e,n){return t[i.inputs[n].name]=e,t}),{}),t.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n,r,a){var i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k=this;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=Object.keys(e),o=i.map((function(t){return k.graph.nodes[L(t)[0]]})),s=r.map((function(t){return L(t)[0]})),0===(u=s.map((function(t){return k.graph.nodes[t]}))).length&&(u=this._outputs),c=ae(e,u,this.weightMap,this._initNodes),l=c.usedNodes,p=c.missingInputs,f=c.dynamicNode,h=c.syncInputs,d=[].concat((0,R.Z)(o),(0,R.Z)(this.graph.weights),(0,R.Z)(this._initNodes||[])).map((function(t){return{node:t,contexts:n.currentContext}})),m=Object.assign({},this.weightMap),Object.keys(e).forEach((function(t){var n=L(t),r=(0,A.Z)(n,2),a=r[0],i=[];i[r[1]]=e[t],m[a]=i})),v={},g=this.getFrozenTensorIds(m),y={};case 12:if(!(d.length>0)){t.next=18;break}return b=this.processStack(o,d,n,m,y,g,s,v,l),t.next=16,Promise.all(b);case 16:t.next=12;break;case 18:if(null!=f||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((w=u.filter((function(t){return!ue(t)&&!F(t.name,m,n)})).map((function(t){return t.name}))).length>0)){t.next=24;break}throw x="",null!=f&&(x="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(w,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(p,"]. ").concat(x));case 24:return t.abrupt("return",m);case 25:case"end":return t.stop()}}),t,this)})));return function(e,n,r,a){return t.apply(this,arguments)}}()},{key:"processStack",value:function(t,e,n,r,a,i,o,s,u){for(var c=this,l=[],p=function(){var t=e.pop();n.currentContext=t.contexts;var p="";if("Enter"===t.node.op&&M("isConstant",t.node,r,n)){var f=z(t.node.name,n),h=(0,A.Z)(f,1);p=h[0]}if(null==r[t.node.name]){var d=ne(t.node,r,n,c._resourceManager);if(!p){var m=z(t.node.name,n),v=(0,A.Z)(m,1);p=v[0]}var g=n.currentContext;S.util.isPromise(d)?l.push(d.then((function(l){return r[p]=l,n.currentContext=g,c.checkTensorForDisposal(p,t.node,r,n,i,o,s),c.processChildNodes(t.node,e,n,r,a,u),l}))):(r[p]=d,c.checkTensorForDisposal(p,t.node,r,n,i,o,s),c.processChildNodes(t.node,e,n,r,a,u))}else c.processChildNodes(t.node,e,n,r,a,u)};e.length>0;)p();return l}},{key:"processChildNodes",value:function(t,e,n,r,a,i){t.children.forEach((function(t){var o=z(t.name,n),s=(0,A.Z)(o,1)[0];!a[s]&&i.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!F(t,r,n)}))&&(a[s]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!F(t,r,n)}))&&(a[s]=!0,e.push({contexts:n.currentContext,node:t})))}))}},{key:"dispose",value:function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],a=L(n),i=(0,A.Z)(a,1)[0],o=e.graph.nodes[i];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===r.shape.length&&r.shape.every((function(t,e){return-1===s[e]||s[e]===t}));S.util.assert(u,(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(s,"], but was ")+"[".concat(r.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&S.util.assert(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(t){var e={};for(var n in t){if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n])e[this._signature.inputs[n].name]=t[n];else e[n]=t[n]}return e}},{key:"checkInputs",value:function(t){var e=this,n=Object.keys(t).filter((function(t){var n=L(t),r=(0,A.Z)(n,1)[0];return null==e.graph.nodes[r]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(t){var e=this;return t.map((function(t){return null!=e._signature&&null!=e._signature.outputs&&null!=e._signature.outputs[t]?e._signature.outputs[t].name:t}),{})}},{key:"checkOutputs",value:function(t){var e=this;t.forEach((function(t){var n=L(t),r=(0,A.Z)(n,1)[0];if(!e.graph.nodes[r])throw new Error("The output '".concat(t,"' is not found in the graph"))}))}}]),t}(),fe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,I.Z)(this,t),this.hashTableNameToHandle=e,this.hashTableMap=n}return(0,_.Z)(t,[{key:"addHashTable",value:function(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}},{key:"getHashTableHandleByName",value:function(t){return this.hashTableNameToHandle[t]}},{key:"getHashTableById",value:function(t){return this.hashTableMap[t]}},{key:"dispose",value:function(){for(var t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(var e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}]),t}(),he=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S.io;(0,I.Z)(this,t),this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,null==n&&(this.loadOptions={}),this.resourceManager=new fe}return(0,_.Z)(t,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"modelStructuredOutputKeys",get:function(){return this.structuredOutputKeys}},{key:"findIOHandler",value:function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{var e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one (".concat(e.length,") load handlers for ")+"URL '".concat([t],"'"));this.handler=e[0]}}},{key:"load",value:function(){var t=this;if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");var e=this.handler.load();return S.util.isPromise(e)?e.then((function(e){return t.loadSync(e)})):this.loadSync(e)}},{key:"loadSync",value:function(t){this.artifacts=t;var e=this.artifacts.modelTopology,n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){var r=this.artifacts.userDefinedMetadata;null!=r.signature&&(n=r.signature),null!=r.structuredOutputKeys&&(this.structuredOutputKeys=r.structuredOutputKeys)}this.signature=n,this.version="".concat(e.versions.producer,".").concat(e.versions.minConsumer);var a=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new pe(ot.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){var i=ot.Instance.transformGraph(t.modelInitializer);this.initializer=new pe(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}},{key:"save",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n){var r;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e){t.next=9;break}if(0!==(r=this.io.getSaveHandlers(e)).length){t.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(e,"'"));case 6:if(!(r.length>1)){t.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(e,"'"));case 8:e=r[0];case 9:if(null!=e.save){t.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.abrupt("return",e.save(this.artifacts));case 12:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"predict",value:function(t,e){var n=this,r=this.execute(t,this.outputNodes);if(this.structuredOutputKeys){var a=r instanceof S.Tensor?[r]:r,i={};return a.forEach((function(t,e){return i[n.structuredOutputKeys[e]]=t})),i}return r}},{key:"normalizeInputs",value:function(t){if(!(t instanceof S.Tensor)&&!Array.isArray(t))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(t.length," input tensors."));return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})}},{key:"normalizeOutputs",value:function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}},{key:"execute",value:function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var t=(0,T.Z)((0,C.Z)().mark((function t(e,n){var r;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.normalizeInputs(e),n=this.normalizeOutputs(n),t.next=4,this.executor.executeAsync(e,n);case 4:return r=t.sent,t.abrupt("return",r.length>1?r:r[0]);case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getIntermediateTensors",value:function(){return this.executor.getIntermediateTensors()}},{key:"disposeIntermediateTensors",value:function(){this.executor.disposeIntermediateTensors()}},{key:"convertTensorMapToTensorsMap",value:function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}]),t}();function de(t){return me.apply(this,arguments)}function me(){return me=(0,T.Z)((0,C.Z)().mark((function t(e){var n,r,a,i=arguments;return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=i.length>2&&void 0!==i[2]?i[2]:S.io,null!=e){t.next=4;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 4:return null==n&&(n={}),n.fromTFHub&&"string"===typeof e&&(e=ve(e)),a=new he(e,n,r),t.next=9,a.load();case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)}))),me.apply(this,arguments)}function ve(t){return t.endsWith("/")||(t+="/"),"".concat(t).concat("model.json").concat("?tfjs-format=file")}var ge=function(t,e){return(ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function ye(t,e){function n(){this.constructor=t}ge(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var be=function(){return(be=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function we(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function xe(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var ke=function(){function t(t,e){this.model=t,this.outputStride=e;var n=this.model.inputs[0].shape;S.util.assert(-1===n[1]&&-1===n[2],(function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"}))}return t.prototype.predict=function(t){var e=this;return(0,S.tidy)((function(){var n=e.preprocessInput((0,S.cast)(t,"float32")),r=(0,S.expandDims)(n,0),a=e.model.predict(r).map((function(t){return(0,S.squeeze)(t,[0])})),i=e.nameOutputResults(a);return{heatmapScores:(0,S.sigmoid)(i.heatmap),offsets:i.offsets,displacementFwd:i.displacementFwd,displacementBwd:i.displacementBwd}}))},t.prototype.dispose=function(){this.model.dispose()},t}(),Se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ye(e,t),e.prototype.preprocessInput=function(t){return(0,S.tidy)((function(){return(0,S.sub)((0,S.div)(t,127.5),1)}))},e.prototype.nameOutputResults=function(t){return{offsets:t[0],heatmap:t[1],displacementFwd:t[2],displacementBwd:t[3]}},e}(ke);function Ne(t){return Math.floor(t/2)}var Ee=function(){function t(t,e){this.priorityQueue=new Array(t),this.numberOfElements=-1,this.getElementValue=e}return t.prototype.enqueue=function(t){this.priorityQueue[++this.numberOfElements]=t,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var t=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,t},t.prototype.empty=function(){return-1===this.numberOfElements},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(t){for(;t>0&&this.less(Ne(t),t);)this.exchange(t,Ne(t)),t=Ne(t)},t.prototype.sink=function(t){for(;2*t<=this.numberOfElements;){var e=2*t;if(e<this.numberOfElements&&this.less(e,e+1)&&e++,!this.less(t,e))break;this.exchange(t,e),t=e}},t.prototype.getValueAt=function(t){return this.getElementValue(this.priorityQueue[t])},t.prototype.less=function(t,e){return this.getValueAt(t)<this.getValueAt(e)},t.prototype.exchange=function(t,e){var n=this.priorityQueue[t];this.priorityQueue[t]=this.priorityQueue[e],this.priorityQueue[e]=n},t}();function Ce(t,e,n,r,a,i){for(var o=i.shape,s=o[0],u=o[1],c=!0,l=Math.max(n-a,0),p=Math.min(n+a+1,s),f=l;f<p;++f){for(var h=Math.max(r-a,0),d=Math.min(r+a+1,u),m=h;m<d;++m)if(i.get(f,m,t)>e){c=!1;break}if(!c)break}return c}var Te=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],Ie=Te.length,_e=Te.reduce((function(t,e,n){return t[e]=n,t}),{}),Ae=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]],Re=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]].map((function(t){var e=t[0],n=t[1];return[_e[e],_e[n]]})),De=["left_face","right_face","right_upper_leg_front","right_lower_leg_back","right_upper_leg_back","left_lower_leg_front","left_upper_leg_front","left_upper_leg_back","left_lower_leg_back","right_feet","right_lower_leg_front","left_feet","torso_front","torso_back","right_upper_arm_front","right_upper_arm_back","right_lower_arm_back","left_lower_arm_front","left_upper_arm_front","left_upper_arm_back","left_lower_arm_back","right_hand","right_lower_arm_front","left_hand"];function Oe(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+Ie)}}function Me(t,e,n){var r=Oe(t.heatmapY,t.heatmapX,t.id,n),a=r.y,i=r.x;return{x:t.heatmapX*e+i,y:t.heatmapY*e+a}}function Fe(t,e,n){return t<e?e:t>n?n:t}function ze(t,e){return{x:t.x+e.x,y:t.y+e.y}}var Be=Ae.map((function(t){var e=t[0],n=t[1];return[_e[e],_e[n]]})),Le=Be.map((function(t){return t[1]})),Pe=Be.map((function(t){return t[0]}));function Ve(t,e,n,r){return{y:Fe(Math.round(t.y/e),0,n-1),x:Fe(Math.round(t.x/e),0,r-1)}}function We(t,e,n,r,a,i,o,s){void 0===s&&(s=2);for(var u=r.shape,c=u[0],l=u[1],p=function(t,e,n){var r=n.shape[2]/2;return{y:n.get(e.y,e.x,t),x:n.get(e.y,e.x,r+t)}}(t,Ve(e.position,i,c,l),o),f=ze(e.position,p),h=0;h<s;h++){var d=Ve(f,i,c,l),m=Oe(d.y,d.x,n,a);f=ze({x:d.x*i,y:d.y*i},{x:m.x,y:m.y})}var v=Ve(f,i,c,l),g=r.get(v.y,v.x,n);return{position:f,part:Te[n],score:g}}function Ue(t,e,n,r,a,i){var o=e.shape[2],s=Le.length,u=new Array(o),c=t.part,l=t.score,p=Me(c,r,n);u[c.id]={score:l,part:Te[c.id],position:p};for(var f=s-1;f>=0;--f){var h=Le[f],d=Pe[f];u[h]&&!u[d]&&(u[d]=We(f,u[h],d,e,n,r,i))}for(f=0;f<s;++f)h=Pe[f],d=Le[f],u[h]&&!u[d]&&(u[d]=We(f,u[h],d,e,n,r,a));return u}function je(t,e,n,r){var a=n.x,i=n.y;return t.some((function(t){var n=t.keypoints[r].position;return function(t,e,n,r){var a=n-t,i=r-e;return a*a+i*i}(i,a,n.y,n.x)<=e}))}function He(t,e,n){return n.reduce((function(n,r,a){var i=r.position,o=r.score;return je(t,e,i,a)||(n+=o),n}),0)/n.length}function qe(t,e,n,r,a,i,o,s){void 0===o&&(o=.5),void 0===s&&(s=20);for(var u=[],c=function(t,e,n){for(var r=n.shape,a=r[0],i=r[1],o=r[2],s=new Ee(a*i*o,(function(t){return t.score})),u=0;u<a;++u)for(var c=0;c<i;++c)for(var l=0;l<o;++l){var p=n.get(u,c,l);p<t||Ce(l,p,u,c,e,n)&&s.enqueue({score:p,part:{heatmapY:u,heatmapX:c,id:l}})}return s}(o,1,t),l=s*s;u.length<i&&!c.empty();){var p=c.dequeue();if(!je(u,l,Me(p.part,a,e),p.part.id)){var f=Ue(p,t,e,a,n,r),h=He(u,l,f);u.push({keypoints:f,score:h})}}return u}function Ge(t){var e=t.shape,n=e[0],r=e[1],a=e[2];return(0,S.tidy)((function(){var e=(0,S.reshape)(t,[n*r,a]),i=(0,S.argMax)(e,0),o=(0,S.expandDims)((0,S.div)(i,(0,S.scalar)(r,"int32")),1),s=(0,S.expandDims)(function(t,e){return(0,S.tidy)((function(){var n=(0,S.div)(t,(0,S.scalar)(e,"int32"));return(0,S.sub)(t,(0,S.mul)(n,(0,S.scalar)(e,"int32")))}))}(i,r),1);return(0,S.concat)([o,s],1)}))}function Ze(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+Ie)}}function Ke(t,e,n){return(0,S.tidy)((function(){var r=function(t,e){for(var n=[],r=0;r<Ie;r++){var a=Ze(t.get(r,0).valueOf(),t.get(r,1).valueOf(),r,e),i=a.x,o=a.y;n.push(o),n.push(i)}return(0,S.tensor2d)(n,[Ie,2])}(t,n);return(0,S.add)((0,S.cast)((0,S.mul)(t.toTensor(),(0,S.scalar)(e,"int32")),"float32"),r)}))}function Xe(t,e,n){return we(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,p,f;return xe(this,(function(h){switch(h.label){case 0:return r=0,a=Ge(t),[4,Promise.all([t.buffer(),e.buffer(),a.buffer()])];case 1:return i=h.sent(),o=i[0],s=i[1],u=i[2],[4,(c=Ke(u,n,s)).buffer()];case 2:return l=h.sent(),p=Array.from(function(t,e){for(var n=e.shape[0],r=new Float32Array(n),a=0;a<n;a++){var i=e.get(a,0),o=e.get(a,1);r[a]=t.get(i,o,a)}return r}(o,u)),f=p.map((function(t,e){return r+=t,{position:{y:l.get(e,0),x:l.get(e,1)},part:Te[e],score:t}})),a.dispose(),c.dispose(),[2,{keypoints:f,score:r/f.length}]}}))}))}var $e="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",Ye="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";var Qe=[-123.15,-115.9,-103.06],Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ye(e,t),e.prototype.preprocessInput=function(t){return(0,S.add)(t,Qe)},e.prototype.nameOutputResults=function(t){var e=t[0],n=t[1];return{offsets:t[2],heatmap:t[3],displacementFwd:e,displacementBwd:n}},e}(ke);function tn(t,e){return Re.reduce((function(n,r){var a=r[0],i=r[1];return function(t,e,n){return t<n||e<n}(t[a].score,t[i].score,e)||n.push([t[a],t[i]]),n}),[])}var en=Number.NEGATIVE_INFINITY,nn=Number.POSITIVE_INFINITY;function rn(t){return t.reduce((function(t,e){var n=t.maxX,r=t.maxY,a=t.minX,i=t.minY,o=e.position,s=o.x,u=o.y;return{maxX:Math.max(n,s),maxY:Math.max(r,u),minX:Math.min(a,s),minY:Math.min(i,u)}}),{maxX:en,maxY:en,minX:nn,minY:nn})}function an(t){var e=rn(t),n=e.minX,r=e.minY,a=e.maxX,i=e.maxY;return[{x:n,y:r},{x:a,y:r},{x:a,y:i},{x:n,y:i}]}function on(t){return we(this,void 0,void 0,(function(){return xe(this,(function(e){return[2,Promise.all(t.map((function(t){return t.buffer()})))]}))}))}function sn(t,e,n,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),{score:t.score,keypoints:t.keypoints.map((function(t){var i=t.score,o=t.part,s=t.position;return{score:i,part:o,position:{x:s.x*n+a,y:s.y*e+r}}}))}}function un(t,e){return fn(t,e)?t:Math.floor(t/e)*e+1}function cn(t){S.util.assert("number"==typeof t||"object"==typeof t,(function(){return"Invalid inputResolution "+t+". Should be a number or an object with width and height"})),"object"==typeof t&&(S.util.assert("number"==typeof t.width,(function(){return"inputResolution.width has a value of "+t.width+" which is invalid; it must be a number"})),S.util.assert("number"==typeof t.height,(function(){return"inputResolution.height has a value of "+t.height+" which is invalid; it must be a number"})))}function ln(t,e){return cn(t),"object"==typeof t?[un(t.height,e),un(t.width,e)]:[un(t,e),un(t,e)]}var pn=[8,16,32];function fn(t,e){return(t-1)%e==0}function hn(t){return t instanceof S.Tensor?[t.shape[0],t.shape[1]]:[t.height,t.width]}function dn(t,e){var n=e[0],r=e[1],a=hn(t),i=a[0],o=a[1],s=r/n,u=[0,0,0,0],c=u[0],l=u[1],p=u[2],f=u[3];return o/i<s?(c=0,l=0,p=Math.round(.5*(s*i-o)),f=Math.round(.5*(s*i-o))):(c=Math.round(.5*(1/s*o-i)),l=Math.round(.5*(1/s*o-i)),p=0,f=0),{resized:(0,S.tidy)((function(){var e=function(t){return t instanceof S.Tensor?t:S.browser.fromPixels(t)}(t);return e=(0,S.pad3d)(e,[[c,l],[p,f],[0,0]]),S.image.resizeBilinear(e,[n,r])})),padding:{top:c,left:p,right:f,bottom:l}}}function mn(t,e,n,r,a){var i=e[0],o=e[1],s=n[0],u=n[1],c=function(t,e,n,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),1===n&&1===e&&0===r&&0===a?t:t.map((function(t){return sn(t,e,n,r,a)}))}(t,(i+r.top+r.bottom)/s,(o+r.left+r.right)/u,-r.top,-r.left);return a?function(t,e){return e<=0?t:t.map((function(t){return function(t,e){return{score:t.score,keypoints:t.keypoints.map((function(t){var n=t.score,r=t.part,a=t.position;return{score:n,part:r,position:{x:e-1-a.x,y:a.y}}}))}}(t,e)}))}(c,o):c}var vn={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:257},gn=["MobileNetV1","ResNet50"],yn={MobileNetV1:[8,16,32],ResNet50:[32,16]},bn={MobileNetV1:[.5,.75,1],ResNet50:[1]},wn=[1,2,4];var xn={flipHorizontal:!1},kn={flipHorizontal:!1,maxDetections:5,scoreThreshold:.5,nmsRadius:20};var Sn=function(){function t(t,e){(function(t){S.util.assert("number"==typeof t,(function(){return"outputStride is not a number"})),S.util.assert(pn.indexOf(t)>=0,(function(){return"outputStride of "+t+" is invalid. It must be either 8, 16, or 32"}))})(t.outputStride),function(t,e){S.util.assert("number"==typeof t[0]&&"number"==typeof t[1],(function(){return"both resolution values must be a number but had values "+t})),S.util.assert(fn(t[0],e),(function(){return"height of "+t[0]+" is invalid for output stride "+e+"."})),S.util.assert(fn(t[1],e),(function(){return"width of "+t[1]+" is invalid for output stride "+e+"."}))}(e,t.outputStride),this.baseModel=t,this.inputResolution=e}return t.prototype.estimateMultiplePoses=function(t,e){return void 0===e&&(e=kn),we(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k;return xe(this,(function(S){switch(S.label){case 0:return n=be({},kn,e),function(t){var e=t.maxDetections,n=t.scoreThreshold,r=t.nmsRadius;if(e<=0)throw new Error("Invalid maxDetections "+e+". Should be > 0");if(n<0||n>1)throw new Error("Invalid scoreThreshold "+n+". Should be in range [0.0, 1.0]");if(r<=0)throw new Error("Invalid nmsRadius "+r+".")}(e),r=this.baseModel.outputStride,a=this.inputResolution,i=hn(t),o=i[0],s=i[1],u=dn(t,a),c=u.resized,l=u.padding,p=this.baseModel.predict(c),f=p.heatmapScores,h=p.offsets,d=p.displacementFwd,m=p.displacementBwd,[4,on([f,h,d,m])];case 1:return v=S.sent(),g=v[0],y=v[1],b=v[2],w=v[3],[4,qe(g,y,b,w,r,n.maxDetections,n.scoreThreshold,n.nmsRadius)];case 2:return x=S.sent(),k=mn(x,[o,s],a,l,n.flipHorizontal),f.dispose(),h.dispose(),d.dispose(),m.dispose(),c.dispose(),[2,k]}}))}))},t.prototype.estimateSinglePose=function(t,e){return void 0===e&&(e=xn),we(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,p,f,h,d,m,v,g;return xe(this,(function(y){switch(y.label){case 0:return n=be({},xn,e),r=this.baseModel.outputStride,a=this.inputResolution,i=hn(t),o=i[0],s=i[1],u=dn(t,a),c=u.resized,l=u.padding,p=this.baseModel.predict(c),f=p.heatmapScores,h=p.offsets,d=p.displacementFwd,m=p.displacementBwd,[4,Xe(f,h,r)];case 1:return v=y.sent(),g=mn([v],[o,s],a,l,n.flipHorizontal),f.dispose(),h.dispose(),d.dispose(),m.dispose(),c.dispose(),[2,g[0]]}}))}))},t.prototype.estimatePoses=function(t,e){return we(this,void 0,void 0,(function(){return xe(this,(function(n){switch(n.label){case 0:return"single-person"!==e.decodingMethod?[3,2]:[4,this.estimateSinglePose(t,e)];case 1:return[2,[n.sent()]];case 2:return[2,this.estimateMultiplePoses(t,e)]}}))}))},t.prototype.dispose=function(){this.baseModel.dispose()},t}();function Nn(t){return we(this,void 0,void 0,(function(){var e,n,r,a,i,o,s;return xe(this,(function(u){switch(u.label){case 0:if(e=t.outputStride,n=t.quantBytes,r=t.multiplier,null==S)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return a=function(t,e,n){var r={1:"100",.75:"075",.5:"050"},a="model-stride"+t+".json";return 4===n?$e+"float/"+r[e]+"/"+a:$e+"quant"+n+"/"+r[e]+"/"+a}(e,r,n),[4,de(t.modelUrl||a)];case 1:return i=u.sent(),o=new Se(i,e),s=ln(t.inputResolution,o.outputStride),[2,new Sn(o,s)]}}))}))}function En(t){return we(this,void 0,void 0,(function(){var e,n,r,a,i,o;return xe(this,(function(s){switch(s.label){case 0:if(e=t.outputStride,n=t.quantBytes,null==S)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return r=function(t,e){var n="model-stride"+t+".json";return 4===e?Ye+"float/"+n:Ye+"quant"+e+"/"+n}(e,n),[4,de(t.modelUrl||r)];case 1:return a=s.sent(),i=new Je(a,e),o=ln(t.inputResolution,i.outputStride),[2,new Sn(i,o)]}}))}))}function Cn(t){return void 0===t&&(t=vn),we(this,void 0,void 0,(function(){return xe(this,(function(e){return"ResNet50"===(t=function(t){if(null==(t=t||vn).architecture&&(t.architecture="MobileNetV1"),gn.indexOf(t.architecture)<0)throw new Error("Invalid architecture "+t.architecture+". Should be one of "+gn);if(null==t.inputResolution&&(t.inputResolution=257),cn(t.inputResolution),null==t.outputStride&&(t.outputStride=16),yn[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride "+t.outputStride+". Should be one of "+yn[t.architecture]+" for architecture "+t.architecture+".");if(null==t.multiplier&&(t.multiplier=1),bn[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier "+t.multiplier+". Should be one of "+bn[t.architecture]+" for architecture "+t.architecture+".");if(null==t.quantBytes&&(t.quantBytes=4),wn.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes "+t.quantBytes+". Should be one of "+wn+" for architecture "+t.architecture+".");if("MobileNetV1"===t.architecture&&32===t.outputStride&&1!==t.multiplier)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return t}(t)).architecture?[2,En(t)]:"MobileNetV1"===t.architecture?[2,Nn(t)]:[2,null]}))}))}var Tn="2.2.2"},7202:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(s){i=[6,s],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(7519),o=n(4718);e.getAdjacentKeyPoints=function(t,e){return o.connectedPartIndices.reduce((function(n,r){var a=r[0],i=r[1];return function(t,e,n){return t<n||e<n}(t[a].score,t[i].score,e)||n.push([t[a],t[i]]),n}),[])};var s=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY;function c(t){return t.reduce((function(t,e){var n=t.maxX,r=t.maxY,a=t.minX,i=t.minY,o=e.position,s=o.x,u=o.y;return{maxX:Math.max(n,s),maxY:Math.max(r,u),minX:Math.min(a,s),minY:Math.min(i,u)}}),{maxX:s,maxY:s,minX:u,minY:u})}function l(t,e,n,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),{score:t.score,keypoints:t.keypoints.map((function(t){var i=t.score,o=t.part,s=t.position;return{score:i,part:o,position:{x:s.x*n+a,y:s.y*e+r}}}))}}function p(t,e,n,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),1===n&&1===e&&0===r&&0===a?t:t.map((function(t){return l(t,e,n,r,a)}))}function f(t,e){return{score:t.score,keypoints:t.keypoints.map((function(t){var n=t.score,r=t.part,a=t.position;return{score:n,part:r,position:{x:e-1-a.x,y:a.y}}}))}}function h(t,e){return e<=0?t:t.map((function(t){return f(t,e)}))}function d(t,e){return g(t,e)?t:Math.floor(t/e)*e+1}function m(t){i.util.assert("number"===typeof t||"object"===typeof t,(function(){return"Invalid inputResolution "+t+". Should be a number or an object with width and height"})),"object"===typeof t&&(i.util.assert("number"===typeof t.width,(function(){return"inputResolution.width has a value of "+t.width+" which is invalid; it must be a number"})),i.util.assert("number"===typeof t.height,(function(){return"inputResolution.height has a value of "+t.height+" which is invalid; it must be a number"})))}e.getBoundingBox=c,e.getBoundingBoxPoints=function(t){var e=c(t),n=e.minX,r=e.minY,a=e.maxX,i=e.maxY;return[{x:n,y:r},{x:a,y:r},{x:a,y:i},{x:n,y:i}]},e.toTensorBuffers3D=function(t){return r(this,void 0,void 0,(function(){return a(this,(function(e){return[2,Promise.all(t.map((function(t){return t.buffer()})))]}))}))},e.scalePose=l,e.scalePoses=p,e.flipPoseHorizontal=f,e.flipPosesHorizontal=h,e.toValidInputResolution=d,e.validateInputResolution=m,e.getValidInputResolutionDimensions=function(t,e){return m(t),"object"===typeof t?[d(t.height,e),d(t.width,e)]:[d(t,e),d(t,e)]};var v=[8,16,32];function g(t,e){return(t-1)%e===0}function y(t){return t instanceof i.Tensor?[t.shape[0],t.shape[1]]:[t.height,t.width]}function b(t){return t instanceof i.Tensor?t:i.browser.fromPixels(t)}e.assertValidOutputStride=function(t){i.util.assert("number"===typeof t,(function(){return"outputStride is not a number"})),i.util.assert(v.indexOf(t)>=0,(function(){return"outputStride of "+t+" is invalid. It must be either 8, 16, or 32"}))},e.assertValidResolution=function(t,e){i.util.assert("number"===typeof t[0]&&"number"===typeof t[1],(function(){return"both resolution values must be a number but had values "+t})),i.util.assert(g(t[0],e),(function(){return"height of "+t[0]+" is invalid for output stride "+e+"."})),i.util.assert(g(t[1],e),(function(){return"width of "+t[1]+" is invalid for output stride "+e+"."}))},e.getInputTensorDimensions=y,e.toInputTensor=b,e.toResizedInputTensor=function(t,e,n,r){return i.tidy((function(){var a=b(t);return r?i.image.resizeBilinear(i.reverse(a,1),[e,n]):i.image.resizeBilinear(a,[e,n])}))},e.padAndResizeTo=function(t,e){var n=e[0],r=e[1],a=y(t),o=a[0],s=a[1],u=r/n,c=[0,0,0,0],l=c[0],p=c[1],f=c[2],h=c[3];return s/o<u?(l=0,p=0,f=Math.round(.5*(u*o-s)),h=Math.round(.5*(u*o-s))):(l=Math.round(.5*(1/u*s-o)),p=Math.round(.5*(1/u*s-o)),f=0,h=0),{resized:i.tidy((function(){var e=b(t);return e=i.pad3d(e,[[l,p],[f,h],[0,0]]),i.image.resizeBilinear(e,[n,r])})),padding:{top:l,left:f,right:h,bottom:p}}},e.scaleAndFlipPoses=function(t,e,n,r,a){var i=e[0],o=e[1],s=n[0],u=n[1],c=p(t,(i+r.top+r.bottom)/s,(o+r.left+r.right)/u,-r.top,-r.left);return a?h(c,o):c}},4679:function(t,e,n){"use strict";n.d(e,{JL:function(){return i},Zu:function(){return o}});var r=n(5671),a=n(3144),i=function(){function t(e,n){(0,r.Z)(this,t),this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return(0,a.Z)(t,[{key:"get",value:function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}},{key:"set",value:function(t,e){this.dataIdsCount++,this.data.set(t,e)}},{key:"has",value:function(t){return this.data.has(t)}},{key:"delete",value:function(t){return this.dataIdsCount--,this.data.delete(t)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),t}(),o=function(){function t(){(0,r.Z)(this,t)}return(0,a.Z)(t,[{key:"refCount",value:function(t){return s("refCount")}},{key:"incRef",value:function(t){return s("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(t){return s("time")}},{key:"read",value:function(t){return s("read")}},{key:"readSync",value:function(t){return s("readSync")}},{key:"readToGPU",value:function(t,e){return s("readToGPU")}},{key:"numDataIds",value:function(){return s("numDataIds")}},{key:"disposeData",value:function(t,e){return s("disposeData")}},{key:"write",value:function(t,e,n){return s("write")}},{key:"move",value:function(t,e,n,r,a){return s("move")}},{key:"memory",value:function(){return s("memory")}},{key:"floatPrecision",value:function(){return s("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return s("dispose")}}]),t}();function s(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},745:function(t,e,n){"use strict";n.d(e,{GP:function(){return o},qP:function(){return s},pA:function(){return u}});var r=n(3433);function a(t,e,n){var r=function(t,e,n){return function(t,e,n){var r=0,a=t.length,i=0,o=!1;for(;r<a;){var s=n(e,t[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(t,e,n||i)}(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function i(t,e){return t>e?1:t<e?-1:0}function o(t,e,n,r,a){return c(t,e,n,r,a,0)}function s(t,e,n,r,a,i){return c(t,e,n,r,a,0,!1,i,!0)}function u(t,e,n,r,a,i){return c(t,e,n,r,a,i,!0)}function c(t,e,n,i,o,s){for(var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=[],m=0;m<e.length;m++)e[m]>o&&d.push({score:e[m],boxIndex:m,suppressBeginIndex:0});d.sort(f);for(var v=s>0?-.5/s:0,g=[],y=[];g.length<n&&d.length>0;){var b=d.pop(),w=b.score,x=b.boxIndex,k=b.suppressBeginIndex;if(w<o)break;for(var S=!1,N=g.length-1;N>=k;--N){var E=l(t,x,g[N]);if(E>=i){S=!0;break}if(b.score=b.score*p(i,v,E),b.score<=o)break}b.suppressBeginIndex=g.length,S||(b.score===w?(g.push(x),y.push(b.score)):b.score>o&&a(d,b,f))}var C=g.length,T=n-C;c&&T>0&&(g.push.apply(g,(0,r.Z)(new Array(T).fill(0))),y.push.apply(y,(0,r.Z)(new Array(T).fill(0))));var I={selectedIndices:g};return u&&(I.selectedScores=y),h&&(I.validOutputs=C),I}function l(t,e,n){var r=t.subarray(4*e,4*e+4),a=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),p=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),h=(s-i)*(u-o),d=(p-c)*(f-l);if(h<=0||d<=0)return 0;var m=Math.max(i,c),v=Math.max(o,l),g=Math.min(s,p),y=Math.min(u,f),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(h+d-b)}function p(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function f(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}},4189:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(7039);function a(t,e){for(var n=[],a=0;a<e.length;a++)e[a]&&n.push(a);for(var i=(0,r.f)(t,"int32"),o=(0,r.f)([n.length,t.length],"int32"),s=0;s<n.length;s++){var u=i.indexToLoc(n[s]),c=s*t.length;o.values.set(u,c)}return o.toTensor()}},318:function(t,e,n){"use strict";n.d(e,{BV:function(){return I},wv:function(){return T}});var r=n(7762),a=n(3433),i=n(4165),o=n(5861),s=n(5671),u=n(3144),c=n(4679),l=n(5050),p=n(6581),f=n(2145),h=n(8864),d=n(7269),m=n(115),v=n(6147),g=function(){function t(e,n){(0,s.Z)(this,t),this.backendTimer=e,this.logger=n,null==n&&(this.logger=new y)}return(0,u.Z)(t,[{key:"profileKernel",value:function(t,e,n){var a,i,o=function(){a=n()},s=m.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();var u,c=(0,r.Z)(a);try{for(c.s();!(u=c.n()).done;){u.value.dataSync()}}catch(h){c.e(h)}finally{c.f()}i=Promise.resolve({kernelMs:m.now()-s})}if((0,l.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var p=function(e){var n=a[e];n.data().then((function(e){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var a=t[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(e,n.dtype,t)}))},f=0;f<a.length;f++)p(f);return{kernelName:t,outputs:a,inputs:e,timeMs:i.then((function(t){return t.kernelMs})),extraInfo:i.then((function(t){return null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(t){var e=this,n=t.kernelName,r=t.outputs,a=t.timeMs,i=t.inputs,o=t.extraInfo;r.forEach((function(t){Promise.all([t.data(),a,o]).then((function(r){e.logger.logKernelProfile(n,t,r[0],r[1],i,r[2])}))}))}}]),t}();var y=function(){function t(){(0,s.Z)(this,t)}return(0,u.Z)(t,[{key:"logKernelProfile",value:function(t,e,n,r,a,i){var o="number"===typeof r?v.oj("".concat(r,"ms"),9):r.error,s=v.oj(t,25),u=e.rank,c=e.size,l=v.oj(e.shape.toString(),14),p="";for(var f in a){var h=a[f];if(null!=h){var d=h.shape||e.shape,m=d.length;p+="".concat(f,": ").concat(m,"D ").concat(m>0?d:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(p,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),t}();function b(t,e,n){for(var r={},a={},i=0;i<e.length;i++)r[e[i].id]=!0;for(var o=0;o<t.length;o++){var s=t[o],u=s.inputs;for(var c in u){for(var l=u[c],p=!1,f=0;f<e.length;f++)if(r[l.id]){s.outputs.forEach((function(t){return r[t.id]=!0})),p=!0,a[s.id]=!0;break}if(p)break}}var h={};h[n.id]=!0;for(var d={},m=t.length-1;m>=0;m--)for(var v=t[m],g=v.inputs,y=0;y<v.outputs.length;y++)if(h[v.outputs[y].id]){for(var b in g)h[g[b].id]=!0,d[v.id]=!0;break}for(var w=[],x=0;x<t.length;x++){var k=t[x];if(a[k.id]&&d[k.id]){var S={};for(var N in k.inputs){var E=k.inputs[N];r[E.id]&&(S[N]=E)}var C=Object.assign({},k);C.inputs=S,C.outputs=k.outputs,w.push(C)}}return w}function w(t,e,n,r){for(var a=function(a){var i=e[a],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var s=i.gradient(o),u=function(e){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var a=n((function(){return s[e]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[e];if(!v.cO(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=a;else{var u=t[o.id];t[o.id]=r(u,a),u.dispose()}};for(var c in i.inputs)u(c)},i=e.length-1;i>=0;i--)a(i)}var x=n(4376),k=n(9064);function S(t){return null!=t.kernelName}var N=function(){function t(){(0,s.Z)(this,t),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(t){return t.name}))))}}}return(0,u.Z)(t,[{key:"dispose",value:function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()}}]),t}(),E=function(){function t(e){(0,s.Z)(this,t),this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new N}return(0,u.Z)(t,[{key:"ready",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(){var e,n,r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.pendingBackendInit){t.next=2;break}return t.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){t.next=4;break}return t.abrupt("return");case 4:e=this.getSortedBackends(),n=0;case 6:if(!(n<e.length)){t.next=18;break}return r=e[n],t.next=10,this.initializeBackend(r).success;case 10:if(!t.sent){t.next=15;break}return t.next=14,this.setBackend(r);case 14:return t.abrupt("return");case 15:n++,t.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]}},{key:"findBackendFactory",value:function(t){return t in this.registryFactory?this.registryFactory[t].factory:null}},{key:"registerBackend",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(d.Z("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}},{key:"setBackend",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(e){var n,r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=this.registryFactory[e]){t.next=2;break}throw new Error("Backend name '".concat(e,"' not found in registry"));case 2:if(this.backendName=e,null!=this.registry[e]){t.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,!n.asyncInit){t.next=12;break}return t.next=9,r;case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0=r;case 13:if(t.t0){t.next=16;break}return t.abrupt("return",!1);case 16:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new g(this.backendInstance),t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var t=this;(0,h.tr)(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(t){var e=this;(0,h.tr)(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))}},{key:"initializeBackend",value:function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{var r=n.factory();if(!r||r instanceof c.Zu||"function"!==typeof r.then)return this.registry[t]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<e.pendingBackendInitId)&&(e.registry[t]=n,e.pendingBackendInit=null,!0)})).catch((function(n){return a<e.pendingBackendInitId||(e.pendingBackendInit=null,d.Z("Initialization of backend ".concat(t," failed")),d.Z(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return d.Z("Initialization of backend ".concat(t," failed")),d.Z(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e),i=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(t,e){var n,r=this,a=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(t,e,n){t();try{var r=n();return e(),r}catch(a){throw e(),a}}},{key:"nextTensorId",value:function(){return t.nextTensorId++}},{key:"nextVariableId",value:function(){return t.nextVariableId++}},{key:"clone",value:function(t){var e=I.runKernel(f.iJz,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){var e={x:t},n={dtype:"float32"};return I.runKernel(f.RFZ,e,n)}}}),[],{}),e}},{key:"runKernel",value:function(t,e,n){if(null==this.backendName&&this.backend,!(null!=(0,h.pI)(t,this.backendName)))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(t,e,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(t){a+="complex64"===t.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))}},{key:"runKernelFunc",value:function(t){var e,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=S(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(S(t)){var l=t.kernelName,p=t.inputs,f=t.attrs;null==this.backendName&&this.backend;var d=(0,h.pI)(l,this.backendName);v.hu(null!=d,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var t=a.backend.numDataIds();r=d.kernelFunc({inputs:p,attrs:f,backend:a.backend});var e=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,t,e);var n=e.map((function(t){return null!=t.rank?t:a.makeTensorFromTensorInfo(t)}));if(o){var s=a.getTensorsForGradient(l,p,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var m=t.forwardFunc,g=function(t){o&&(i=t.map((function(t){return a.keep(a.clone(t))})))};n=function(){var t=a.backend.numDataIds();r=a.tidy((function(){return m(a.backend,g)}));var e=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,t,e),e}}var y,b=t.inputs,w=t.attrs,x=S(t)?null:t.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(y=a.profiler.profileKernel(c,b,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(y),e=y.outputs):e=n()})),o&&this.addTapeNode(c,b,e,x,i,w),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map((function(t){return null!=b[t]?b[t].shape:null})),outputShapes:e.map((function(t){return t.shape})),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(r)?e:e[0]}},{key:"saveTensorsForBackwardMode",value:function(t){var e=this,n=t.map((function(t){return e.keep(e.clone(t))}));return n}},{key:"getTensorsForGradient",value:function(t,e,n){var r=(0,h.uk)(t);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(v.hu(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(e).map((function(t){return e[t]}))):a=i.map((function(t){return e[t]}));var s=n.filter((function(t,e){return o[e]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=t;"string"===n&&v.HD(t[0])&&(a=t.map((function(t){return m.encodeString(t)})));var i=r.write(a,e,n),o=new x.es(e,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=(0,v.Ub)(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(t,e,n,r){var a={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(t,e){var n=t.dataId,r=t.shape,a=t.dtype,i=new x.es(r,a,n,this.nextTensorId());return this.trackTensor(i,e),i}},{key:"makeVariable",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));var a=new x._w(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*v.bT(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof x._w||this.track(t)}},{key:"incRef",value:function(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}},{key:"removeDataId",value:function(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(t){if(this.state.tensorInfo.has(t.dataId)){var e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){var n=t.size*v.bT(t.dtype);this.state.numBytes-=n}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}}},{key:"disposeVariables",value:function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}}},{key:"disposeVariable",value:function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}},{key:"memory",value:function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}},{key:"profile",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(e){var n,o,s,u,c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,o=this.state.numTensors,this.state.activeProfile.kernels=[],t.next=6,e();case 6:this.state.activeProfile.result=t.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,(0,a.Z)(this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-o,s=(0,r.Z)(this.state.activeProfile.kernels),t.prev=12,s.s();case 14:if((u=s.n()).done){t.next=24;break}return c=u.value,t.next=18,c.kernelTimeMs;case 18:return c.kernelTimeMs=t.sent,t.next=21,c.extraInfo;case 21:c.extraInfo=t.sent;case 22:t.next=14;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(12),s.e(t.t0);case 29:return t.prev=29,s.f(),t.finish(29);case 32:return t.abrupt("return",this.state.activeProfile);case 33:case"end":return t.stop()}}),t,this,[[12,26,29,32]])})));return function(e){return t.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(t,e,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:a},u=(0,h.uk)(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],a=v.wT(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(t){return t.kept=!0,t}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}},{key:"endScope",value:function(t){for(var e=this,n=(0,k.getTensorsInContainer)(t),r=new Set(n.map((function(t){return t.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))}},{key:"gradients",value:function(t,e,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(v.hu(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",t)}));v.hu(o instanceof x.es,(function(){return"The result y returned by f() must be a tensor."}));var s=b(this.state.activeTape,e,o);if(!i&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t={};t[o.id]=null==n?C(o.shape):n,w(t,s,(function(t){return a.tidy(t)}),_);var i=e.map((function(e){return t[e.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(t){var e,n=(0,r.Z)(t.saved);try{for(n.s();!(e=n.n()).done;){e.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:o,grads:i}}))}},{key:"customGrad",value:function(t){var e=this;return v.hu(v.mf(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;v.hu(r.every((function(t){return t instanceof x.es})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(t,e){o[e]=t}));var s=function(e,n){return i=t.apply(void 0,[].concat(r,[n])),v.hu(i.value instanceof x.es,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),v.hu(v.mf(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},u=function(t,e){var n=i.gradFunc(t,e),a=Array.isArray(n)?n:[n];v.hu(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),v.hu(a.every((function(t){return t instanceof x.es})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(t,e){o[e]=function(){return t}})),o};return e.runKernelFunc({forwardFunc:s,backwardsFunc:u,inputs:o})}}},{key:"readSync",value:function(t){return this.state.tensorInfo.get(t).backend.readSync(t)}},{key:"read",value:function(t){return this.state.tensorInfo.get(t).backend.read(t)}},{key:"readToGPU",value:function(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}},{key:"time",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(e){var n,r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,m.now)(),t.next=3,this.backend.time(e);case 3:return(r=t.sent).wallMs=(0,m.now)()-n,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"track",value:function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new N,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),t}();function C(t){var e=(0,v.p8)((0,v.NA)(t),"float32");return I.makeTensor(e,t,"float32")}function T(){var t=(0,p.D)();if(null==t._tfengine){var e=new l.qA(t);t._tfengine=new E(e)}return(0,l.iG)(t._tfengine.ENV),(0,x.Vi)((function(){return t._tfengine})),t._tfengine}E.nextTensorId=0,E.nextVariableId=0;var I=T();function _(t,e){var n={a:t,b:e};return I.runKernel(f.mm_,n)}},5050:function(t,e,n){"use strict";n.d(e,{OB:function(){return h},Vi:function(){return d},iG:function(){return m},qA:function(){return l}});var r=n(9439),a=n(4165),i=n(5861),o=n(5671),s=n(3144),u=n(6147),c="tfjsflags",l=function(){function t(e){(0,o.Z)(this,t),this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=p,this.populateURLFlags()}return(0,s.Z)(t,[{key:"setPlatform",value:function(t,e){null!=this.platform&&(h().getBool("IS_TEST")||h().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e}},{key:"registerFlag",value:function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];h().getBool("IS_TEST")||h().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(r,".")),this.set(t,r)}}},{key:"getAsync",value:function(){var t=(0,i.Z)((0,a.Z)().mark((function t(e){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e in this.flags)){t.next=2;break}return t.abrupt("return",this.flags[e]);case 2:return t.next=4,this.evaluateFlag(e);case 4:return this.flags[e]=t.sent,t.abrupt("return",this.flags[e]);case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"get",value:function(t){if(t in this.flags)return this.flags[t];var e=this.evaluateFlag(t);if((0,u.tI)(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}},{key:"getNumber",value:function(t){return this.get(t)}},{key:"getBool",value:function(t){return this.get(t)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}},{key:"evaluateFlag",value:function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}},{key:"setFlags",value:function(t){this.flags=Object.assign({},t)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var t=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var e=this.getQueryParams(this.global.location.search);if(c in e)e.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),a=(0,r.Z)(n,2),i=a[0],o=a[1];t.urlFlags[i]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if("".concat(+e)===e)return+e;throw new Error("Could not parse value flag value ".concat(e," for flag ").concat(t,"."))}(i,o)}))}}}]),t}();function p(t){var e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return f(e,r[0],r[1]),r.join("=")})),e}function f(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function h(){return d}var d=null;function m(t){d=t}},6581:function(t,e,n){"use strict";var r;function a(){if(null==r){var t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof n.g)t=n.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}r=t}return r}function i(t,e){var n=function(){var t=a();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);var r=e();return n.set(t,r),n.get(t)}n.d(e,{D:function(){return a},R:function(){return i}})},5875:function(t,e,n){"use strict";n.d(e,{B9:function(){return v},CQ:function(){return b},Cd:function(){return w},Cn:function(){return g},G4:function(){return s},MX:function(){return l},N5:function(){return d},N8:function(){return p},N_:function(){return x},R:function(){return u},SR:function(){return f},VY:function(){return T},XV:function(){return y},cF:function(){return c},cj:function(){return k},jq:function(){return E},lu:function(){return m},sq:function(){return h},x3:function(){return S},y3:function(){return C},ze:function(){return N}});var r=n(318),a=n(5050),i=n(4376),o=n(9064);function s(){(0,a.OB)().set("PROD",!0)}function u(){(0,a.OB)().set("DEBUG",!0)}function c(){(0,a.OB)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(t){(0,a.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function p(){r.BV.disposeVariables()}function f(){return r.BV}function h(){return r.BV.memory()}function d(t){return r.BV.profile(t)}function m(t,e){return r.BV.tidy(t,e)}function v(t){(0,o.getTensorsInContainer)(t).forEach((function(t){return t.dispose()}))}function g(t){return r.BV.keep(t)}function y(t){return r.BV.time(t)}function b(t){return r.BV.setBackend(t)}function w(){return r.BV.ready()}function x(){return r.BV.backendName}function k(t){r.BV.removeBackend(t)}function S(t){return r.BV.findBackend(t)}function N(t){return r.BV.findBackendFactory(t)}function E(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.BV.registerBackend(t,e,n)}function C(){return r.BV.backend}function T(t,e){(0,a.OB)().setPlatform(t,e)}(0,i.FZ)(l)},6450:function(t,e,n){"use strict";n.d(e,{UQ:function(){return u},cb:function(){return h},fN:function(){return p},h7:function(){return l},pn:function(){return f},ti:function(){return c}});var r=n(3433),a=n(318),i=n(4376),o=n(8354),s=n(6147);function u(t){return s.hu(s.mf(t),(function(){return"The f passed in grad(f) must be a function"})),function(e,n){var r=(0,o._1)(e,"x","tf.grad","string_or_numeric"),i=null!=n?(0,o._1)(n,"dy","tf.grad"):null;return a.BV.tidy((function(){var e=a.BV.gradients((function(){return t(r)}),[r],i),n=e.value,o=e.grads;return null!=i&&s.k5(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),d(o),o[0]}))}}function c(t){return s.hu(s.mf(t),(function(){return"The f passed in grads(f) must be a function"})),function(e,n){s.hu(Array.isArray(e),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var i=(0,o.sI)(e,"args","tf.grads","string_or_numeric"),u=null!=n?(0,o._1)(n,"dy","tf.grads"):null;return a.BV.tidy((function(){var e=a.BV.gradients((function(){return t.apply(void 0,(0,r.Z)(i))}),i,u),n=e.value,o=e.grads;return null!=u&&s.k5(n.shape,u.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),d(o),o}))}}function l(t){return s.hu(s.mf(t),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(e,n){s.hu(e instanceof i.es,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),s.hu(null==n||n instanceof i.es,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=a.BV.gradients((function(){return t(e)}),[e],n),o=r.grads,u=r.value;return d(o),{grad:o[0],value:u}}}function p(t){return s.hu(s.mf(t),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(e,n){s.hu(Array.isArray(e)&&e.every((function(t){return t instanceof i.es})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),s.hu(null==n||n instanceof i.es,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var o=a.BV.gradients((function(){return t.apply(void 0,(0,r.Z)(e))}),e,n);return null!=n&&s.k5(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),d(o.grads),o}}function f(t,e){s.hu(s.mf(t),(function(){return"The f passed in variableGrads(f) must be a function"})),s.hu(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof i._w})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],a.BV.registeredVariables)e.push(a.BV.registeredVariables[r]);var o=n?e.filter((function(t){return!t.trainable})):null,u=e.length;e=e.filter((function(t){return t.trainable})),s.hu(e.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(u," variables is ")+"trainable."}));var c=a.BV.gradients(t,e,null,!0),l=c.value,p=c.grads;s.hu(p.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),s.hu(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var f={};return e.forEach((function(t,e){null!=p[e]&&(f[t.name]=p[e])})),null!=o&&o.forEach((function(t){return f[t.name]=null})),{value:l,grads:f}}function h(t){return a.BV.customGrad(t)}function d(t){if(t.filter((function(t){return null==t})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},7519:function(t,e,n){"use strict";n.r(e),n.d(e,{Abs:function(){return xe.SYM},Acos:function(){return xe.VGw},Acosh:function(){return xe.SpW},AdadeltaOptimizer:function(){return _n},AdagradOptimizer:function(){return Rn},AdamOptimizer:function(){return Mn},AdamaxOptimizer:function(){return Bn},Add:function(){return xe.mm_},AddN:function(){return xe.Xze},All:function(){return xe.oT6},Any:function(){return xe.IKK},ArgMax:function(){return xe.sJF},ArgMin:function(){return xe.aJk},Asin:function(){return xe.M2y},Asinh:function(){return xe.qw7},Atan:function(){return xe.jMg},Atan2:function(){return xe.QCc},Atanh:function(){return xe.Oyi},AvgPool:function(){return xe.JhU},AvgPool3D:function(){return xe._k9},AvgPool3DGrad:function(){return xe.IMb},AvgPoolGrad:function(){return xe.ROF},BatchMatMul:function(){return xe.XLW},BatchToSpaceND:function(){return xe.zws},Bincount:function(){return xe.zvY},BroadcastArgs:function(){return xe.eEB},BroadcastTo:function(){return xe.Ly9},Cast:function(){return xe.RFZ},Ceil:function(){return xe.gJX},ClipByValue:function(){return xe.xnO},Complex:function(){return xe.Zz9},ComplexAbs:function(){return xe.yj2},Concat:function(){return xe.Eh3},Conv2D:function(){return xe.mhS},Conv2DBackpropFilter:function(){return xe.wUP},Conv2DBackpropInput:function(){return xe.wm},Conv3D:function(){return xe.x12},Conv3DBackpropFilterV2:function(){return xe.o2y},Conv3DBackpropInputV2:function(){return xe.ik2},Cos:function(){return xe.mc4},Cosh:function(){return xe.TR1},CropAndResize:function(){return xe.VcC},Cumprod:function(){return xe.Byc},Cumsum:function(){return xe.iHb},DataStorage:function(){return ra.JL},DenseBincount:function(){return xe.QRR},DepthToSpace:function(){return xe.T0n},DepthwiseConv2dNative:function(){return xe.cie},DepthwiseConv2dNativeBackpropFilter:function(){return xe.sL$},DepthwiseConv2dNativeBackpropInput:function(){return xe.y7R},Diag:function(){return xe.$w},Dilation2D:function(){return xe.p4S},Dilation2DBackpropFilter:function(){return xe.Vn9},Dilation2DBackpropInput:function(){return xe.ekb},ENV:function(){return b.Vi},Einsum:function(){return xe.$g6},Elu:function(){return xe.SX0},EluGrad:function(){return xe.HEU},Environment:function(){return b.qA},Equal:function(){return xe.hdR},Erf:function(){return xe.Omj},Exp:function(){return xe.NEP},ExpandDims:function(){return xe.YFo},Expm1:function(){return xe.Y0y},FFT:function(){return xe.vwp},Fill:function(){return xe.deh},FlipLeftRight:function(){return xe.Uyb},Floor:function(){return xe.OR},FloorDiv:function(){return xe.jeX},FromPixels:function(){return xe.eBW},FusedBatchNorm:function(){return xe.sHE},FusedConv2D:function(){return xe._V0},FusedDepthwiseConv2D:function(){return xe.luS},GatherNd:function(){return xe.q1x},GatherV2:function(){return xe.qi_},Greater:function(){return xe.iZT},GreaterEqual:function(){return xe.Acj},IFFT:function(){return xe.Qg5},Identity:function(){return xe.iJz},Imag:function(){return xe.J_u},IsFinite:function(){return xe.avt},IsInf:function(){return xe.iWB},IsNan:function(){return xe.r7n},KernelBackend:function(){return ra.Zu},LRN:function(){return xe.eZ0},LRNGrad:function(){return xe.Hhh},LeakyRelu:function(){return xe.J$2},Less:function(){return xe.vtC},LessEqual:function(){return xe.CAk},LinSpace:function(){return xe.e7N},Log:function(){return xe.ZbH},Log1p:function(){return xe.kU},LogSoftmax:function(){return xe.qCd},LogicalAnd:function(){return xe.PYm},LogicalNot:function(){return xe.VfG},LogicalOr:function(){return xe.MZg},LogicalXor:function(){return xe.w6g},LowerBound:function(){return xe.qIC},Max:function(){return xe.YoZ},MaxPool:function(){return xe.mTV},MaxPool3D:function(){return xe.OAf},MaxPool3DGrad:function(){return xe.OU7},MaxPoolGrad:function(){return xe.OV7},MaxPoolWithArgmax:function(){return xe.vFR},Maximum:function(){return xe.BMI},Mean:function(){return xe.q2K},Min:function(){return xe.c17},Minimum:function(){return xe.q8u},MirrorPad:function(){return xe.jQs},Mod:function(){return xe.Vbg},MomentumOptimizer:function(){return Pn},Multinomial:function(){return xe.NZg},Multiply:function(){return xe.wYn},Neg:function(){return xe.kuV},NonMaxSuppressionV3:function(){return xe.uv1},NonMaxSuppressionV4:function(){return xe.cye},NonMaxSuppressionV5:function(){return xe.W0H},NotEqual:function(){return xe.yQU},OP_SCOPE_SUFFIX:function(){return jn.zvA},OneHot:function(){return xe.we_},OnesLike:function(){return xe.qWM},Optimizer:function(){return In},OptimizerConstructors:function(){return Wn},Pack:function(){return xe.QiL},PadV2:function(){return xe.lyA},Pool:function(){return xe.Kgp},Pow:function(){return xe.pe_},Prelu:function(){return xe.o0g},Prod:function(){return xe.DlI},RMSPropOptimizer:function(){return Vn},RaggedGather:function(){return xe.dDz},RaggedTensorToTensor:function(){return xe.BiW},Range:function(){return xe.e6w},Rank:function(){return Un.yw},Real:function(){return xe.xJR},RealDiv:function(){return xe.oHH},Reciprocal:function(){return xe.$HU},Reduction:function(){return Hn.I},Relu:function(){return xe.qkr},Relu6:function(){return xe.SbG},Reshape:function(){return xe.HZH},ResizeBilinear:function(){return xe._Yw},ResizeBilinearGrad:function(){return xe.zbQ},ResizeNearestNeighbor:function(){return xe.dpD},ResizeNearestNeighborGrad:function(){return xe.Hmb},Reverse:function(){return xe.mKl},RotateWithOffset:function(){return xe.b9H},Round:function(){return xe.e07},Rsqrt:function(){return xe.bV0},SGDOptimizer:function(){return Ln},ScatterNd:function(){return xe.xQA},SearchSorted:function(){return xe.nr8},Select:function(){return xe.PhF},Selu:function(){return xe.oFR},Sigmoid:function(){return xe.a5O},Sign:function(){return xe.i5y},Sin:function(){return xe.RQH},Sinh:function(){return xe.wYB},Slice:function(){return xe.p2w},Softmax:function(){return xe.Gcp},Softplus:function(){return xe.MRv},SpaceToBatchND:function(){return xe.TQc},SparseFillEmptyRows:function(){return xe.O3z},SparseReshape:function(){return xe.nhH},SparseSegmentMean:function(){return xe.w3H},SparseSegmentSum:function(){return xe.ZjV},SparseToDense:function(){return xe.D2d},SplitV:function(){return xe.L8s},Sqrt:function(){return xe.FKq},Square:function(){return xe.bK0},SquaredDifference:function(){return xe._tC},Step:function(){return xe.h8e},StridedSlice:function(){return xe.jQk},StringNGrams:function(){return xe._JP},StringSplit:function(){return xe.s1s},StringToHashBucketFast:function(){return xe.XkS},Sub:function(){return xe.Tr8},Sum:function(){return xe.GBy},Tan:function(){return xe.sEM},Tanh:function(){return xe.MIZ},Tensor:function(){return Ut.es},TensorBuffer:function(){return Ut.YD},Tile:function(){return xe.n9L},TopK:function(){return xe.cWu},Transform:function(){return xe.wx7},Transpose:function(){return xe.G3Y},Unique:function(){return xe.kpP},Unpack:function(){return xe.ToN},UnsortedSegmentSum:function(){return xe.Qvg},UpperBound:function(){return xe.XDQ},Variable:function(){return Ut._w},ZerosLike:function(){return xe.RuY},_FusedMatMul:function(){return xe.usg},abs:function(){return jn.WnP},acos:function(){return jn.Khb},acosh:function(){return jn.__u},add:function(){return jn.IHx},addN:function(){return jn.QBD},all:function(){return jn.$6P},any:function(){return jn.YjB},argMax:function(){return jn.NqF},argMin:function(){return jn.vHJ},asin:function(){return jn.ZRM},asinh:function(){return jn.VfV},atan:function(){return jn.z4N},atan2:function(){return jn.fvJ},atanh:function(){return jn.C80},avgPool:function(){return jn.wS1},avgPool3d:function(){return jn.uR5},backend:function(){return bn.y3},backend_util:function(){return f},basicLSTMCell:function(){return jn.zEQ},batchNorm:function(){return jn.tgs},batchNorm2d:function(){return jn.Dxk},batchNorm3d:function(){return jn.JY5},batchNorm4d:function(){return jn.p3b},batchToSpaceND:function(){return jn.E4h},bincount:function(){return jn.yE8},booleanMaskAsync:function(){return jn.anm},broadcastArgs:function(){return jn.XsQ},broadcastTo:function(){return jn.UFq},broadcast_util:function(){return we},browser:function(){return o},buffer:function(){return jn.f3b},cast:function(){return jn.pju},ceil:function(){return jn.mDi},clipByValue:function(){return jn.iUl},clone:function(){return jn.d9v},complex:function(){return jn.PYB},concat:function(){return jn.zoF},concat1d:function(){return jn.gME},concat2d:function(){return jn.Izb},concat3d:function(){return jn.MNy},concat4d:function(){return jn.ZaL},conv1d:function(){return jn.PAt},conv2d:function(){return jn.Tek},conv2dTranspose:function(){return jn.bc},conv3d:function(){return jn.pdZ},conv3dTranspose:function(){return jn.$QV},copyRegisteredKernels:function(){return ke.T3},cos:function(){return jn.mCk},cosh:function(){return jn.f9Y},cosineWindow:function(){return jn.mew},cumprod:function(){return jn.$Gn},cumsum:function(){return jn.zbp},customGrad:function(){return Cn.cb},denseBincount:function(){return jn.ppE},deprecationWarn:function(){return bn.MX},depthToSpace:function(){return jn.nTT},depthwiseConv2d:function(){return jn.B10},device_util:function(){return r},diag:function(){return jn.Ka3},dilation2d:function(){return jn.WmZ},disableDeprecationWarnings:function(){return bn.cF},dispose:function(){return bn.B9},disposeVariables:function(){return bn.N8},div:function(){return jn.hiC},divNoNan:function(){return jn.NTj},dot:function(){return jn.AKD},dropout:function(){return jn.rvX},einsum:function(){return jn.WYO},elu:function(){return jn.pyx},enableDebugMode:function(){return bn.R},enableProdMode:function(){return bn.G4},enclosingPowerOfTwo:function(){return jn.GRh},engine:function(){return bn.SR},env:function(){return b.OB},equal:function(){return jn.DgJ},erf:function(){return jn.qNN},euclideanNorm:function(){return jn.d2q},exp:function(){return jn.Qqt},expandDims:function(){return jn.dt4},expm1:function(){return jn.t$B},eye:function(){return jn.iyy},fft:function(){return jn.kp_},fill:function(){return jn.hlL},findBackend:function(){return bn.x3},findBackendFactory:function(){return bn.ze},floor:function(){return jn.GWj},floorDiv:function(){return jn.qPi},fused:function(){return jn.imm},gather:function(){return jn.Iqj},gatherND:function(){return jn.dbB},gather_util:function(){return s},getBackend:function(){return bn.N_},getGradient:function(){return ke.uk},getKernel:function(){return ke.pI},getKernelsForBackend:function(){return ke.tr},grad:function(){return Cn.UQ},grads:function(){return Cn.ti},greater:function(){return jn.pjt},greaterEqual:function(){return jn.brS},ifft:function(){return jn.Sxn},imag:function(){return jn.asL},image:function(){return jn.BHj},inTopKAsync:function(){return jn.V3u},io:function(){return a},irfft:function(){return jn.wx0},isFinite:function(){return jn.xVT},isInf:function(){return jn.UWc},isNaN:function(){return jn.i2d},keep:function(){return bn.Cn},kernel_impls:function(){return h},leakyRelu:function(){return jn.hi7},less:function(){return jn.d9m},lessEqual:function(){return jn.zN1},linalg:function(){return jn.$r2},linspace:function(){return jn.SX3},localResponseNormalization:function(){return jn.G9k},log:function(){return jn.cM7},log1p:function(){return jn.Krr},logSigmoid:function(){return jn.e_t},logSoftmax:function(){return jn.CmS},logSumExp:function(){return jn.l_t},logicalAnd:function(){return jn.HvI},logicalNot:function(){return jn.hJK},logicalOr:function(){return jn.K5V},logicalXor:function(){return jn.egP},losses:function(){return jn.MB5},lowerBound:function(){return jn.eab},matMul:function(){return jn.OI3},math:function(){return i},max:function(){return jn.Fp7},maxPool:function(){return jn._sB},maxPool3d:function(){return jn.YQQ},maxPoolWithArgmax:function(){return jn.Ip$},maximum:function(){return jn.gWQ},mean:function(){return jn.J69},memory:function(){return bn.sq},meshgrid:function(){return jn.ry_},min:function(){return jn.VV$},minimum:function(){return jn.LTh},mirrorPad:function(){return jn.VdP},mod:function(){return jn.wQq},moments:function(){return jn.Gi7},movingAverage:function(){return jn.p_},mul:function(){return jn.dC7},multiRNNCell:function(){return jn.rq4},multinomial:function(){return jn.SJ_},neg:function(){return jn.W76},nextFrame:function(){return Zn},norm:function(){return jn.KOy},notEqual:function(){return jn.Quu},oneHot:function(){return jn.lfX},ones:function(){return jn.iUs},onesLike:function(){return jn.JpU},op:function(){return jn.op},outerProduct:function(){return jn.N2O},pad:function(){return jn.vku},pad1d:function(){return jn.pNR},pad2d:function(){return jn.koy},pad3d:function(){return jn.t1L},pad4d:function(){return jn.lGY},pool:function(){return jn.d_R},pow:function(){return jn.sQ3},prelu:function(){return jn.AL3},print:function(){return jn.S0v},prod:function(){return jn.WVs},profile:function(){return bn.N5},raggedGather:function(){return jn.$gW},raggedTensorToTensor:function(){return jn.N89},rand:function(){return jn.TN_},randomGamma:function(){return jn.wzB},randomNormal:function(){return jn.nGf},randomStandardNormal:function(){return jn.ruB},randomUniform:function(){return jn.LGj},range:function(){return jn.w6H},ready:function(){return bn.Cd},real:function(){return jn.kwC},reciprocal:function(){return jn.M25},registerBackend:function(){return bn.jq},registerGradient:function(){return ke.Li},registerKernel:function(){return ke.wC},relu:function(){return jn.UYe},relu6:function(){return jn.btT},removeBackend:function(){return bn.cj},reshape:function(){return jn.XLQ},reverse:function(){return jn.GYS},reverse1d:function(){return jn.SDf},reverse2d:function(){return jn.diP},reverse3d:function(){return jn.sx7},reverse4d:function(){return jn.mG2},rfft:function(){return jn.QEs},round:function(){return jn.NMM},rsqrt:function(){return jn.bp0},scalar:function(){return jn.iD$},scatterND:function(){return jn.snQ},scatter_util:function(){return De},searchSorted:function(){return jn.zcT},selu:function(){return jn.U8D},separableConv2d:function(){return jn.U_I},serialization:function(){return c},setBackend:function(){return bn.CQ},setPlatform:function(){return bn.VY},setdiff1dAsync:function(){return jn.ODp},sigmoid:function(){return jn.XD2},sign:function(){return jn.Xxe},signal:function(){return jn.tdS},sin:function(){return jn.O$l},sinh:function(){return jn.R_K},slice:function(){return jn.tPi},slice1d:function(){return jn.jZU},slice2d:function(){return jn.SmN},slice3d:function(){return jn.CnO},slice4d:function(){return jn.p0P},slice_util:function(){return u},softmax:function(){return jn.XAC},softplus:function(){return jn.Wvh},spaceToBatchND:function(){return jn.fBT},sparse:function(){return jn.rVs},sparseToDense:function(){return jn.ers},spectral:function(){return jn.uN7},split:function(){return jn.Vl2},sqrt:function(){return jn._b3},square:function(){return jn.h62},squaredDifference:function(){return jn.$i},squeeze:function(){return jn.L9e},stack:function(){return jn.knu},step:function(){return jn.Nbs},stridedSlice:function(){return jn.NXj},string:function(){return jn.Z_8},sub:function(){return jn.luU},sum:function(){return jn.Smz},sumOutType:function(){return Un.z4},tan:function(){return jn.ORZ},tanh:function(){return jn.AEp},tensor:function(){return jn.XeE},tensor1d:function(){return jn.RRF},tensor2d:function(){return jn.odF},tensor3d:function(){return jn.wOQ},tensor4d:function(){return jn.yXz},tensor5d:function(){return jn.Bfx},tensor6d:function(){return jn.xZs},tensor_util:function(){return Je},test_util:function(){return l},tidy:function(){return bn.lu},tile:function(){return jn.Gg6},time:function(){return bn.XV},topk:function(){return jn.hg7},train:function(){return qn},transpose:function(){return jn.p4s},truncatedNormal:function(){return jn.Xu6},unique:function(){return jn.Two},unregisterGradient:function(){return ke.bt},unregisterKernel:function(){return ke.nE},unsortedSegmentSum:function(){return jn.pUJ},unstack:function(){return jn.HHK},upcastType:function(){return Un.x8},upperBound:function(){return jn.GaM},util:function(){return tn},valueAndGrad:function(){return Cn.h7},valueAndGrads:function(){return Cn.fN},variable:function(){return jn.VD$},variableGrads:function(){return Cn.pn},version_core:function(){return vn},where:function(){return jn.arb},whereAsync:function(){return jn.itS},zeros:function(){return jn.lls},zerosLike:function(){return jn.P84}});var r={};n.r(r),n.d(r,{isBrowser:function(){return y},isMobile:function(){return g},mockIsMobile:function(){return v}});var a={};n.r(a),n.d(a,{browserFiles:function(){return Zt},browserHTTPRequest:function(){return ie},concatenateArrayBuffers:function(){return V},copyModel:function(){return At},decodeWeights:function(){return M},encodeWeights:function(){return D},fromMemory:function(){return ce},fromMemorySync:function(){return le},getLoadHandlers:function(){return J},getModelArtifactsForJSON:function(){return H},getModelArtifactsForJSONSync:function(){return j},getModelArtifactsInfoForJSON:function(){return G},getSaveHandlers:function(){return Q},getWeightSpecs:function(){return Z},http:function(){return ae},isHTTPScheme:function(){return ne},listModels:function(){return Ct},loadWeights:function(){return Yt},moveModel:function(){return Dt},registerLoadRouter:function(){return Y},registerSaveRouter:function(){return $},removeModel:function(){return It},weightsLoaderFactory:function(){return Jt},withSaveHandler:function(){return pe},withSaveHandlerSync:function(){return fe}});var i={};n.r(i),n.d(i,{confusionMatrix:function(){return be}});var o={};n.r(o),n.d(o,{fromPixels:function(){return Ae},fromPixelsAsync:function(){return Ce},toPixels:function(){return Ie}});var s={};n.r(s),n.d(s,{prepareAndValidate:function(){return Re}});var u={};n.r(u),n.d(u,{assertParamsValid:function(){return Oe},computeFlatOffset:function(){return Ge},computeOutShape:function(){return Fe},getNormalizedAxes:function(){return Pe},isSliceContinous:function(){return qe},maskToAxes:function(){return Me},parseSliceParams:function(){return Ze},sliceInfo:function(){return Ke},startForAxis:function(){return je},startIndicesWithElidedDims:function(){return Ve},stopForAxis:function(){return He},stopIndicesWithElidedDims:function(){return We},stridesForAxis:function(){return Ue},stridesWithElidedDims:function(){return ze}});var c={};n.r(c),n.d(c,{Serializable:function(){return $e},SerializationMap:function(){return Ye},registerClass:function(){return Qe}});var l={};n.r(l),n.d(l,{TEST_EPSILON_FLOAT16:function(){return en},createVideoElement:function(){return hn},encodeStrings:function(){return fn},expectArrayBuffersEqual:function(){return pn},expectArraysClose:function(){return nn},expectArraysEqual:function(){return sn},expectNumbersClose:function(){return un},expectPromiseToFail:function(){return on},expectValuesInRange:function(){return ln},play:function(){return dn},testEpsilon:function(){return rn}});var p={};n.r(p),n.d(p,{collectGatherOpShapeInfo:function(){return Qr},computeOutShape:function(){return Yr},segOpComputeOptimalWindowSize:function(){return $r}});var f={};n.r(f),n.d(f,{ERF_A1:function(){return mr},ERF_A2:function(){return vr},ERF_A3:function(){return gr},ERF_A4:function(){return yr},ERF_A5:function(){return br},ERF_P:function(){return dr},PARALLELIZE_THRESHOLD:function(){return ar},RowPartitionType:function(){return Yn},SELU_SCALE:function(){return hr},SELU_SCALEALPHA:function(){return fr},applyActivation:function(){return Jn.QH},assertAndGetBroadcastShape:function(){return we.assertAndGetBroadcastShape},assertAxesAreInnerMostDims:function(){return Kn.lB},assertParamsConsistent:function(){return Xn},assignToTypedArray:function(){return Cr},axesAreInnerMostDims:function(){return Kn.YB},calculateShapes:function(){return De.calculateShapes},checkEinsumDimSizes:function(){return Or},checkPadOnDimRoundingMode:function(){return Qn.m},combineLocations:function(){return Kn.Vh},combineRaggedTensorToTensorShapes:function(){return tr},complexWithEvenIndex:function(){return Sr},complexWithOddIndex:function(){return Nr},computeConv2DInfo:function(){return Qn.Ix},computeConv3DInfo:function(){return Qn.jw},computeDefaultPad:function(){return Qn.aO},computeDilation2DInfo:function(){return Qn.Rf},computeOptimalWindowSize:function(){return ir},computeOutAndReduceShapes:function(){return Kn.kz},computeOutShape:function(){return $n},computePool2DInfo:function(){return Qn.Xw},computePool3DInfo:function(){return Qn.pl},convertConv2DDataFormat:function(){return Qn.sl},decodeEinsumEquation:function(){return Rr},eitherStridesOrDilationsAreOne:function(){return Qn.jT},expandShapeToKeepDim:function(){return Kn.rv},exponent:function(){return Ir},exponents:function(){return Tr},fromStringArrayToUint8:function(){return ta},fromUint8ToStringArray:function(){return Jr},getAxesPermutation:function(){return Kn.Q3},getBroadcastDims:function(){return we.getBroadcastDims},getComplexWithIndex:function(){return Er},getEinsumComputePath:function(){return Mr},getEinsumPermutation:function(){return Dr},getFusedBiasGradient:function(){return Jn.pf},getFusedDyActivation:function(){return Jn.Fr},getImageCenter:function(){return or},getInnerMostAxes:function(){return Kn.sY},getPermuted:function(){return ur},getRaggedRank:function(){return nr},getReductionAxes:function(){return we.getReductionAxes},getReshaped:function(){return sr},getReshapedPermuted:function(){return cr},getRowPartitionTypesHelper:function(){return er},getSliceBeginCoords:function(){return lr},getSliceSize:function(){return pr},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(){return Lr},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(){return Pr},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(){return Vr},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return jr},getSparseReshapeInputOutputMismatchErrorMessage:function(){return qr},getSparseReshapeInputOutputMultipleErrorMessage:function(){return Hr},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(){return Wr},getSparseReshapeNegativeOutputDimErrorMessage:function(){return Ur},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(){return Xr},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return Gr},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return Zr},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(){return Kr},getUndoAxesPermutation:function(){return Kn.LJ},isIdentityPermutation:function(){return Fr},log:function(){return wr.c},mergeRealAndImagArrays:function(){return xr},prepareAndValidate:function(){return Re},prepareSplitSize:function(){return Br},segment_util:function(){return p},shouldFuse:function(){return Jn.uy},slice_util:function(){return u},splitRealAndImagArrays:function(){return kr},tupleValuesAreOne:function(){return Qn.I0},upcastType:function(){return Un.x8},validateDefaultValueShape:function(){return rr},validateInput:function(){return De.validateInput},validateUpdateShape:function(){return De.validateUpdateShape},warn:function(){return wr.Z}});var h={};n.r(h),n.d(h,{nonMaxSuppressionV3Impl:function(){return ea.GP},nonMaxSuppressionV4Impl:function(){return ea.qP},nonMaxSuppressionV5Impl:function(){return ea.pA},whereImpl:function(){return na.Z}});var d,m=n(318);function v(t){d=t}function g(t){if(void 0!==d)return d;if(t||"undefined"!==typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;var e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){var n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function y(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var b=n(5050),w=(0,b.OB)();w.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),w.registerFlag("IS_BROWSER",(function(){return y()})),w.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),w.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),w.registerFlag("PROD",(function(){return!1})),w.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return w.getBool("DEBUG")})),w.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),w.registerFlag("IS_TEST",(function(){return!1})),w.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),w.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),w.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1})),w.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),w.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var x=n(5671),k=n(3144),S=n(7762),N=n(4165),E=n(5861),C=n(9439),T=n(3433),I=n(9253),_=n(2442),A=n(6147),R={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function D(t,e){return O.apply(this,arguments)}function O(){return O=(0,E.Z)((0,N.Z)().mark((function t(e,n){var r,a,i,o,s,u;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=[],a=[],i=Array.isArray(e)?e.map((function(t){return t.name})):Object.keys(e),o=function(t){var o=i[t],s=Array.isArray(e)?e[t].tensor:e[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));var u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var c=new Promise(function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i,o,u,c;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.bytes();case 2:for(n=t.sent,r=n.reduce((function(t,e){return t+e.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],c=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(c,i),i+=4,a.set(u,i),i+=u.length;e(a);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());a.push(c)}else a.push(s.data());null!=n&&(u.group=n),r.push(u)},s=0;s<i.length;++s)o(s);return t.next=7,Promise.all(a);case 7:return u=t.sent,t.abrupt("return",{data:F(u),specs:r});case 9:case"end":return t.stop()}}),t)}))),O.apply(this,arguments)}function M(t,e){var n,r,a={},i=0,o=(0,S.Z)(e);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,c=s.dtype,l=s.shape,p=(0,A.NA)(l),f=void 0;if("quantization"in s){var h=s.quantization;if("uint8"===h.dtype||"uint16"===h.dtype){if(!("min"in h)||!("scale"in h))throw new Error("Weight ".concat(s.name," with quantization ").concat(h.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==h.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(h.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(s.name," is quantized with ").concat(h.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var d=R[h.dtype],m=t.slice(i,i+p*d),v="uint8"===h.dtype?new Uint8Array(m):new Uint16Array(m);if("float32"===c)if("uint8"===h.dtype||"uint16"===h.dtype){f=new Float32Array(v.length);for(var g=0;g<v.length;g++){var y=v[g];f[g]=y*h.scale+h.min}}else{if("float16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type float32.");void 0===n&&(n=K()),f=n(v)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type int32.");f=new Int32Array(v.length);for(var b=0;b<v.length;b++){var w=v[b];f[b]=Math.round(w*h.scale+h.min)}}i+=p*d}else if("string"===c){var x=(0,A.NA)(s.shape);f=[];for(var k=0;k<x;k++){var N=new Uint32Array(t.slice(i,i+4))[0];i+=4;var E=new Uint8Array(t.slice(i,i+N));f.push(E),i+=N}}else{var C=R[c],T=t.slice(i,i+p*C);if("float32"===c)f=new Float32Array(T);else if("int32"===c)f=new Int32Array(T);else if("bool"===c)f=new Uint8Array(T);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));f=new Float32Array(T);for(var D=new Float32Array(f.length/2),O=new Float32Array(f.length/2),M=0;M<D.length;M++)D[M]=f[2*M],O[M]=f[2*M+1];var F=(0,_.X)(D,l,"float32"),z=(0,_.X)(O,l,"float32");a[u]=(0,I.P)(F,z),F.dispose(),z.dispose()}i+=p*C}"complex64"!==c&&(a[u]=(0,_.X)(f,l,c))}}catch(B){o.e(B)}finally{o.f()}return a}function F(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));var r=new Uint8Array(e),a=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),a),a+=t.byteLength})),r.buffer}var z="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function B(t){return z?Buffer.byteLength(t):new Blob([t]).size}function L(t){if(z)return Buffer.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function P(t){if(z){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function V(t){if(1===t.length)return t[0];var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function W(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function U(t,e){var n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function j(t,e,n){var r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),r}function H(t,e){return q.apply(this,arguments)}function q(){return q=(0,E.Z)((0,N.Z)().mark((function t(e,n){var r,a,i,o;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e.weightsManifest){t.next=7;break}return t.next=3,n(e.weightsManifest);case 3:i=t.sent,o=(0,C.Z)(i,2),r=o[0],a=o[1];case 7:return t.abrupt("return",j(e,r,a));case 8:case"end":return t.stop()}}),t)}))),q.apply(this,arguments)}function G(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:B(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:B(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function Z(t){var e,n=[],r=(0,S.Z)(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;n.push.apply(n,(0,T.Z)(a.weights))}}catch(i){r.e(i)}finally{r.f()}return n}function K(){var t=function(){var t=function(t){for(var e=t<<13,n=0;0===(8388608&e);)n-=8388608,e<<=1;return(e&=-8388609)|n+947912704},e=new Uint32Array(2048);e[0]=0;for(var n=1;n<1024;n++)e[n]=t(n);for(var r=1024;r<2048;r++)e[r]=939524096+(r-1024<<13);return e}(),e=function(){var t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(var e=1;e<31;e++)t[e]=e<<23;for(var n=33;n<63;n++)t[n]=2147483648+(n-32<<23);return t}(),n=function(){for(var t=new Uint32Array(64),e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=t[n[s>>10]+(1023&s)]+e[s>>10];i[o]=u}return new Float32Array(a)}}var X=function(){function t(){(0,x.Z)(this,t),this.saveRouters=[],this.loadRouters=[]}return(0,k.Z)(t,null,[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"registerSaveRouter",value:function(e){t.getInstance().saveRouters.push(e)}},{key:"registerLoadRouter",value:function(e){t.getInstance().loadRouters.push(e)}},{key:"getSaveHandlers",value:function(e){return t.getHandlers(e,"save")}},{key:"getLoadHandlers",value:function(e,n){return t.getHandlers(e,"load",n)}},{key:"getHandlers",value:function(e,n,r){var a=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&a.push(n)})),a}}]),t}(),$=function(t){return X.registerSaveRouter(t)},Y=function(t){return X.registerLoadRouter(t)},Q=function(t){return X.getSaveHandlers(t)},J=function(t,e){return X.getLoadHandlers(t,e)},tt="tensorflowjs",et="models_store",nt="model_info_store";function rt(){if(!(0,b.OB)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function at(t){var e=t.result;e.createObjectStore(et,{keyPath:"modelPath"}),e.createObjectStore(nt,{keyPath:"modelPath"})}var it=function(){function t(e){if((0,x.Z)(this,t),this.indexedDB=rt(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return(0,k.Z)(t,[{key:"save",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return t.abrupt("return",this.databaseAction(this.modelPath,e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"load",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"databaseAction",value:function(t,e){var n=this;return new Promise((function(t,r){var a=n.indexedDB.open(tt,1);a.onupgradeneeded=function(){return at(a)},a.onsuccess=function(){var i=a.result;if(null==e){var o=i.transaction(et,"readonly"),s=o.objectStore(et).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=G(e),l=i.transaction(nt,"readwrite"),p=l.objectStore(nt),f=p.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var a=(u=i.transaction(et,"readwrite")).objectStore(et).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});a.onsuccess=function(){return t({modelArtifactsInfo:c})},a.onerror=function(t){var e=(p=l.objectStore(nt)).delete(n.modelPath);e.onsuccess=function(){return i.close(),r(a.error)},e.onerror=function(t){return i.close(),r(a.error)}}},f.onerror=function(t){return i.close(),r(f.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(t){return r(a.error)}}))}}]),t}();it.URL_SCHEME="indexeddb://";var ot=function(t){return(0,b.OB)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(it.URL_SCHEME)?(e=t.slice(it.URL_SCHEME.length),new it(e)):null;var e};X.registerSaveRouter(ot),X.registerLoadRouter(ot);var st=function(){function t(){(0,x.Z)(this,t),this.indexedDB=rt()}return(0,k.Z)(t,[{key:"listModels",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e=this;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.indexedDB.open(tt,1);r.onupgradeneeded=function(){return at(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(nt,"readonly"),i=a.objectStore(nt).getAll();i.onsuccess=function(){var e,n={},r=(0,S.Z)(i.result);try{for(r.s();!(e=r.n()).done;){var a=e.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}t(n)},i.onerror=function(t){return e.close(),n(i.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(t){return n(r.error)}})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"removeModel",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n=this;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(r=e).startsWith(it.URL_SCHEME)?r.slice(it.URL_SCHEME.length):r,t.abrupt("return",new Promise((function(t,r){var a=n.indexedDB.open(tt,1);a.onupgradeneeded=function(){return at(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(nt,"readwrite"),s=o.objectStore(nt),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));var a=s.delete(e),o=function(){var a=(n=i.transaction(et,"readwrite")).objectStore(et).delete(e);a.onsuccess=function(){return t(u.result.modelArtifactsInfo)},a.onerror=function(t){return r(u.error)}};a.onsuccess=o,a.onerror=function(t){return o(),i.close(),r(u.error)}},u.onerror=function(t){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(t){return r(a.error)}})));case 2:case"end":return t.stop()}var r}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),ut="/",ct="tensorflowjs_models",lt="info",pt="model_topology",ft="weight_specs",ht="weight_data",dt="model_metadata";function mt(t){return{info:[ct,t,lt].join(ut),topology:[ct,t,pt].join(ut),weightSpecs:[ct,t,ft].join(ut),weightData:[ct,t,ht].join(ut),modelMetadata:[ct,t,dt].join(ut)}}function vt(t){for(var e=0,n=Object.values(t);e<n.length;e++){var r=n[e];window.localStorage.removeItem(r)}}function gt(t){var e=t.split(ut);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(ut)}var yt=function(){function t(e){if((0,x.Z)(this,t),!(0,b.OB)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=mt(this.modelPath)}return(0,k.Z)(t,[{key:"save",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=G(e),t.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,L(e.weightData)),i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),t.abrupt("return",{modelArtifactsInfo:a});case 17:throw t.prev=17,t.t0=t.catch(7),vt(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 21:case"end":return t.stop()}}),t,this,[[7,17]])})));return function(e){return t.apply(this,arguments)}}()},{key:"load",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e,n,r,a,i,o,s;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(e=JSON.parse(this.LS.getItem(this.keys.info)))){t.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===e.modelTopologyType){t.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){t.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){t.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(s=this.LS.getItem(this.keys.weightData))){t.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=P(s),t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}();yt.URL_SCHEME="localstorage://";var bt=function(t){return(0,b.OB)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(yt.URL_SCHEME)?(e=t.slice(yt.URL_SCHEME.length),new yt(e)):null;var e};X.registerSaveRouter(bt),X.registerLoadRouter(bt);var wt=function(){function t(){(0,x.Z)(this,t),(0,A.hu)((0,b.OB)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),(0,A.hu)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return(0,k.Z)(t,[{key:"listModels",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e,n,r,a,i,o;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e={},n=ct+ut,r=ut+lt,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=gt(i),e[o]=JSON.parse(this.LS.getItem(i)));return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"removeModel",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=(a=e).startsWith(yt.URL_SCHEME)?a.slice(yt.URL_SCHEME.length):a,n=mt(e),null!=this.LS.getItem(n.info)){t.next=4;break}throw new Error("Cannot find model at path '".concat(e,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),vt(n),t.abrupt("return",r);case 7:case"end":return t.stop()}var a}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),xt="://",kt=function(){function t(){(0,x.Z)(this,t),this.managers={}}return(0,k.Z)(t,null,[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"registerManager",value:function(e,n){(0,A.hu)(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(xt)&&(e=e.slice(0,e.indexOf(xt))),(0,A.hu)(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();(0,A.hu)(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '".concat(e,"'.")})),r.managers[e]=n}},{key:"getManager",value:function(e){var n=t.getInstance().managers[e];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(t.getInstance().managers)}}]),t}();function St(t){if(-1===t.indexOf(xt))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(kt.getSchemes().join(",")));return{scheme:t.split(xt)[0],path:t.split(xt)[1]}}function Nt(t,e){return Et.apply(this,arguments)}function Et(){return Et=(0,E.Z)((0,N.Z)().mark((function t(e,n){var r,a,i,o,s,u,c,l,p,f,h=arguments;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>2&&void 0!==h[2]&&h[2],(0,A.hu)(e!==n,(function(){return"Old path and new path are the same: '".concat(e,"'")})),a=X.getLoadHandlers(e),(0,A.hu)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(e,".")})),(0,A.hu)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(e,".")})),i=a[0],o=X.getSaveHandlers(n),(0,A.hu)(o.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),(0,A.hu)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=St(e).scheme,c=St(e).path,l=u===St(e).scheme,t.next=15,i.load();case 15:if(p=t.sent,!r||!l){t.next=19;break}return t.next=19,kt.getManager(u).removeModel(c);case 19:return t.next=21,s.save(p);case 21:if(f=t.sent,!r||l){t.next=25;break}return t.next=25,kt.getManager(u).removeModel(c);case 25:return t.abrupt("return",f.modelArtifactsInfo);case 26:case"end":return t.stop()}}),t)}))),Et.apply(this,arguments)}function Ct(){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,E.Z)((0,N.Z)().mark((function t(){var e,n,r,a,i,o,s;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=kt.getSchemes(),n={},r=(0,S.Z)(e),t.prev=3,r.s();case 5:if((a=r.n()).done){t.next=13;break}return i=a.value,t.next=9,kt.getManager(i).listModels();case 9:for(s in o=t.sent)n[i+xt+s]=o[s];case 11:t.next=5;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),r.e(t.t0);case 18:return t.prev=18,r.f(),t.finish(18);case 21:return t.abrupt("return",n);case 22:case"end":return t.stop()}}),t,null,[[3,15,18,21]])})))).apply(this,arguments)}function It(t){return _t.apply(this,arguments)}function _t(){return(_t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=St(e),r=kt.getManager(n.scheme),t.abrupt("return",r.removeModel(n.path));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function At(t,e){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,E.Z)((0,N.Z)().mark((function t(e,n){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!1,t.abrupt("return",Nt(e,n,false));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Dt(t,e){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,E.Z)((0,N.Z)().mark((function t(e,n){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!0,t.abrupt("return",Nt(e,n,true));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Mt=function(){function t(){(0,x.Z)(this,t),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return(0,k.Z)(t,[{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return fetch(t,e)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}},{key:"decode",value:function(t,e){return new TextDecoder(e).decode(t)}},{key:"setTimeoutCustom",value:function(t,e){var n=this;window&&(0,b.OB)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(t){t.source===window&&t.data.name===n.messageName&&(t.stopPropagation(),(0,n.functionRefs[t.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(t,e)}}]),t}();if((0,b.OB)().get("IS_BROWSER")){(0,b.OB)().setPlatform("browser",new Mt);try{kt.registerManager(yt.URL_SCHEME,new wt)}catch(aa){}try{kt.registerManager(it.URL_SCHEME,new st)}catch(aa){}}var Ft,zt=function(){return n(5410)};var Bt=function(){function t(){(0,x.Z)(this,t),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return(0,k.Z)(t,[{key:"fetch",value:function(t,e){return null!=(0,b.OB)().global.fetch?(0,b.OB)().global.fetch(t,e):(null==Ft&&(Ft=zt()),Ft(t,e))}},{key:"now",value:function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}},{key:"encode",value:function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}},{key:"decode",value:function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}]),t}();(0,b.OB)().get("IS_NODE")&&!(0,b.OB)().get("IS_BROWSER")&&(0,b.OB)().setPlatform("node",new Bt);var Lt=n(7039),Pt=n(9118),Vt=n(672),Wt=n(4600),Ut=n(4376);(0,m.wv)();var jt={buffer:Lt.f,cast:Pt.p,clone:Vt.d,print:Wt.S};(0,Ut.Vp)(jt);function Ht(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var qt=function(){function t(e){if((0,x.Z)(this,t),!(0,b.OB)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return(0,k.Z)(t,[{key:"save",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i,o,s;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!==typeof document){t.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer)){t.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=U(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,o.href=i,t.next=15,Ht((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==e.weightData){t.next=21;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,t.next=21,Ht((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 21:return t.abrupt("return",{modelArtifactsInfo:G(e)});case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();qt.URL_SCHEME="downloads://";var Gt=function(){function t(e){if((0,x.Z)(this,t),null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.jsonFile=e[0],this.weightsFiles=e.slice(1)}return(0,k.Z)(t,[{key:"load",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e=this;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==e.weightsFiles.length){var o=H(a,(function(t){return e.loadWeights(t)}));t(o)}else t({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(e.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(e.jsonFile.name)))},r.onerror=function(t){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(e.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(e.jsonFile)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"loadWeights",value:function(t){var e,n=this,r=[],a=[],i=(0,S.Z)(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;r.push.apply(r,(0,T.Z)(o.weights)),a.push.apply(a,(0,T.Z)(o.paths))}}catch(aa){i.e(aa)}finally{i.f()}var s=this.checkManifestAndWeightFiles(t),u=a.map((function(t){return n.loadWeightsFile(t,s[t])}));return Promise.all(u).then((function(t){return[r,V(t)]}))}},{key:"loadWeightsFile",value:function(t,e){return new Promise((function(n,r){var a=new FileReader;a.onload=function(t){var e=t.target.result;n(e)},a.onerror=function(e){return r("Failed to weights data from file of path '".concat(t,"'."))},a.readAsArrayBuffer(e)}))}},{key:"checkManifestAndWeightFiles",value:function(t){var e,n=this,r=[],a=this.weightsFiles.map((function(t){return W(t.name)})),i={},o=(0,S.Z)(t);try{for(o.s();!(e=o.n()).done;){e.value.paths.forEach((function(t){var e=W(t);if(-1!==r.indexOf(e))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(e,"'"));if(r.push(e),-1===a.indexOf(e))throw new Error("Weight file with basename '".concat(e,"' is not provided."));i[t]=n.weightsFiles[a.indexOf(e)]}))}}catch(aa){o.e(aa)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),t}();function Zt(t){return new Gt(t)}function Kt(t,e,n,r){!function(t){(0,A.hu)(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){(0,A.hu)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t)})),(0,A.hu)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e)})),(0,A.hu)(e>=t,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(t.map((function(i){return i.then((function(i){var o=n+ ++a/t.length*(r-n);return e(o),i})),i})))}function Xt(t,e){return $t.apply(this,arguments)}function $t(){return($t=(0,E.Z)((0,N.Z)().mark((function t(e,n){var r,a,i,o,s,u,c,l,p;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?(0,b.OB)().platform.fetch:n.fetchFunc,a=e.map((function(t){return r(t,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){t.next=11;break}return t.next=8,Promise.all(a);case 8:t.t0=t.sent,t.next=14;break;case 11:return t.next=13,Kt(a,n.onProgress,i,o);case 13:t.t0=t.sent;case 14:if(s=t.t0,u=s.map((function(t){return t.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){t.next=24;break}return t.next=21,Promise.all(u);case 21:t.t1=t.sent,t.next=27;break;case 24:return t.next=26,Kt(u,n.onProgress,c,l);case 26:t.t1=t.sent;case 27:return p=t.t1,t.abrupt("return",p);case 29:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yt(t){return Qt.apply(this,arguments)}function Qt(){return Qt=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i,o=arguments;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=Jt((function(t){return Xt(t,{requestInit:a})})),t.abrupt("return",i(e,n,r));case 6:case"end":return t.stop()}}),t)}))),Qt.apply(this,arguments)}function Jt(t){return function(){var e=(0,E.Z)((0,N.Z)().mark((function e(n){var r,a,i,o,s,u,c,l,p,f,h,d,m=arguments;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m.length>1&&void 0!==m[1]?m[1]:"",a=m.length>2?m[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(t,e){var n=0;t.weights.forEach((function(t){var r="quantization"in t?t.quantization.dtype:t.dtype,c=R[r]*A.NA(t.shape),l=function(){i[e]=!0,null==o[e]&&(o[e]=[]),o[e].push({manifestEntry:t,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(e,n){e===t.name&&(l(),s[n]=!0)})):l(),u.push(t.name),n+=c}))})),s.every((function(t){return t}))){e.next=10;break}throw c=a.filter((function(t,e){return!s[e]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(t,e,n){return e&&t.push(n),t}),[]),p=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;p.push(e)}))})),e.next=15,t(p);case 15:return f=e.sent,h={},d=0,l.forEach((function(t){for(var e=n[t].paths.length,r=0,a=0;a<e;a++)r+=f[d+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<e;c++){var l=new Uint8Array(f[d+c]);s.set(l,u),u+=l.byteLength}o[t].forEach((function(t){var e=M(i.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)h[n]=e[n]})),d+=e})),e.abrupt("return",h);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}X.registerSaveRouter((function(t){return(0,b.OB)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(qt.URL_SCHEME)?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new qt(t)}(t.slice(qt.URL_SCHEME.length)):null}));var te=function(){function t(e,n){if((0,x.Z)(this,t),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?((0,A.hu)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=(0,b.OB)().platform.fetch,(0,A.hu)(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&(0,A.hu)(2===e.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")})),this.path=e,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return(0,k.Z)(t,[{key:"save",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=U(e,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=e.weightData&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),t.next=10,this.fetch(this.path,n);case 10:if(!(i=t.sent).ok){t.next=15;break}return t.abrupt("return",{modelArtifactsInfo:G(e),responses:[i]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"load",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e,n,r,a,i,o=this;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch(this.path,this.requestInit);case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return t.prev=5,t.next=8,e.json();case 8:n=t.sent,t.next=16;break;case 11:throw t.prev=11,t.t0=t.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){t.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return t.abrupt("return",H(n,(function(t){return o.loadWeights(t)})));case 21:case"end":return t.stop()}}),t,this,[[5,11]])})));return function(){return t.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i,o,s,u,c,l,p,f,h,d,m,v,g;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=ee(n),a=(0,C.Z)(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=Z(e),c=[],l=[],p=(0,S.Z)(e);try{for(p.s();!(f=p.n()).done;){h=f.value,d=(0,S.Z)(h.paths);try{for(d.s();!(m=d.n()).done;)v=m.value,null!=this.weightUrlConverter?l.push(this.weightUrlConverter(v)):c.push(s+v+o)}catch(aa){d.e(aa)}finally{d.f()}}}catch(aa){p.e(aa)}finally{p.f()}if(!this.weightUrlConverter){t.next=17;break}return t.t0=c.push,t.t1=c,t.t2=T.Z,t.next=14,Promise.all(l);case 14:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4);case 17:return t.next=19,Xt(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 19:return g=t.sent,t.abrupt("return",[u,V(g)]);case 21:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();function ee(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}function ne(t){return null!=t.match(te.URL_SCHEME_REGEX)}te.URL_SCHEME_REGEX=/^https?:\/\//;var re=function(t,e){if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;return(Array.isArray(t)?t.every((function(t){return ne(t)})):ne(t))?ae(t,e):null};function ae(t,e){return new te(t,e)}function ie(t,e){return ae(t,e)}X.registerSaveRouter(re),X.registerLoadRouter(re);var oe=function(){function t(e){(0,x.Z)(this,t),this.modelArtifacts=e}return(0,k.Z)(t,[{key:"load",value:function(){return this.modelArtifacts}}]),t}(),se=function(){function t(e){(0,x.Z)(this,t),this.saveHandler=e}return(0,k.Z)(t,[{key:"save",value:function(t){return this.saveHandler(t)}}]),t}(),ue=(0,k.Z)((function t(e){(0,x.Z)(this,t),e.load&&(this.load=function(){return Promise.resolve(e.load())}),e.save&&(this.save=function(t){return Promise.resolve(e.save(t))})}));function ce(t,e,n,r){var a=arguments;return new ue(le.apply(void 0,(0,T.Z)(a)))}function le(t,e,n,r){if(1===arguments.length){var a=null!=t.modelTopology||null!=t.weightSpecs;return a?new oe(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new oe({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new oe({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function pe(t){return new se(t)}function fe(t){return new se(t)}var he=n(8354),de=n(7221),me=n(4326),ve=n(8640),ge=n(1240);var ye,be=(0,ve.op)({confusionMatrix_:function(t,e,n){var r=(0,he._1)(t,"labels","confusionMatrix"),a=(0,he._1)(e,"predictions","confusionMatrix");A.hu(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),A.hu(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),A.hu(1===a.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(a.rank)})),A.hu(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(a.shape[0],". ")+"Labels and predictions should have the same number of elements."})),A.hu(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var i=(0,me.l)((0,Pt.p)(r,"int32"),n),o=(0,me.l)((0,Pt.p)(a,"int32"),n),s=(0,ge.p)(i),u=(0,de.O)(s,o);return(0,Pt.p)(u,"int32")}}),we=n(5774),xe=n(2145),ke=n(8864),Se=n(3123);function Ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)i=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));s=!0}var u=(0,ke.pI)(xe.eBW,m.BV.backendName);if(null!=u){var c={pixels:t},l={numChannels:e};return m.BV.runKernel(xe.eBW,c,l)}var p,f,h=a?[t.videoWidth,t.videoHeight]:[t.width,t.height],d=(0,C.Z)(h,2),v=d[0],g=d[1];if(o)p=t.getContext("2d").getImageData(0,0,v,g).data;else if(r||n)p=t.data;else if(i||a||s){if(null==ye)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");ye=new OffscreenCanvas(1,1).getContext("2d")}else ye=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});ye.canvas.width=v,ye.canvas.height=g,ye.drawImage(t,0,0,v,g),p=ye.getImageData(0,0,v,g).data}if(4===e)f=new Int32Array(p);else{var y=v*g;f=new Int32Array(y*e);for(var b=0;b<y;b++)for(var w=0;w<e;++w)f[b*e+w]=p[4*b+w]}var x=[g,v,e];return(0,Se.w)(f,x,"int32")}function Ee(t){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(t instanceof ImageBitmap)&&function(t){return null!=t&&0!==t.width&&0!==t.height}(t)&&!function(t){return null!=t&&t.data instanceof Uint8Array}(t)}function Ce(t){return Te.apply(this,arguments)}function Te(){return Te=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r,a,i=arguments;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=null,!(0,b.OB)().getBool("WRAP_TO_IMAGEBITMAP")||!Ee(e)){t.next=15;break}return t.prev=3,t.next=6,createImageBitmap(e,{premultiplyAlpha:"none"});case 6:a=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),a=null;case 12:r=null!=a&&a.width===e.width&&a.height===e.height?a:e,t.next=16;break;case 15:r=e;case 16:return t.abrupt("return",Ne(r,n));case 17:case"end":return t.stop()}}),t,null,[[3,9]])}))),Te.apply(this,arguments)}function Ie(t,e){return _e.apply(this,arguments)}function _e(){return(_e=(0,E.Z)((0,N.Z)().mark((function t(e,n){var r,a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(0,he._1)(e,"img","toPixels"),e instanceof Ut.es||(a=r,r=(0,Pt.p)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){t.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=(0,C.Z)(i,2),s=o[0],u=o[1],!((c=2===r.rank?1:r.shape[2])>4||2===c)){t.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(c));case 8:if("float32"===r.dtype||"int32"===r.dtype){t.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 10:return t.next=12,r.data();case 12:l=t.sent,p="float32"===r.dtype?255:1,f=new Uint8ClampedArray(u*s*4),h=0;case 16:if(!(h<s*u)){t.next=41;break}d=[0,0,0,255],m=0;case 19:if(!(m<c)){t.next=33;break}if(v=l[h*c+m],"float32"!==r.dtype){t.next=26;break}if(!(v<0||v>1)){t.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(v,"."));case 24:t.next=29;break;case 26:if("int32"!==r.dtype){t.next=29;break}if(!(v<0||v>255)){t.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(v,"."));case 29:1===c?(d[0]=v*p,d[1]=v*p,d[2]=v*p):d[m]=v*p;case 30:m++,t.next=19;break;case 33:f[(g=4*h)+0]=Math.round(d[0]),f[g+1]=Math.round(d[1]),f[g+2]=Math.round(d[2]),f[g+3]=Math.round(d[3]);case 38:++h,t.next=16;break;case 41:return null!=n&&(n.width=u,n.height=s,y=n.getContext("2d"),b=new ImageData(f,u,s),y.putImageData(b,0,0)),r!==e&&r.dispose(),t.abrupt("return",f);case 44:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ae=(0,ve.op)({fromPixels_:Ne});function Re(t,e){var n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===(0,A.NA)(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));for(var a=e.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=t.shape,c=a.slice();c.pop();for(var l=1,p=i;p<n;++p)l*=u[p],c.push(u[p]);var f=[].concat((0,T.Z)((0,A.e3)(t.shape).map((function(t){return t/l}))),[1]).slice(0,i);return[c,o,l,f]}var De=n(8604);function Oe(t,e,n){var r=t.shape.length;A.hu(r===e.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(r,").")})),A.hu(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){A.hu(e[a]+n[a]<=t.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(t.shape[a],")")}))},i=0;i<r;++i)a(i)}function Me(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Fe(t,e,n){for(var r=[],a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function ze(t,e,n,r){for(var a=(0,T.Z)(t),i=a.length;i<r.length;i++)a.push(1);for(var o=0;o<n;o++)0===o?a[e]=1:(a.splice(e,0,1),a.pop());return a}function Be(t,e,n){return n<=t?n:n-(e-1)}function Le(t,e){for(var n=[],r=0;r<t;r++)n.push(e+r);return n}function Pe(t,e,n,r,a,i,o,s,u){var c=t.length,l=new Array(c),p=new Array(c),f=new Array(c);if(e.length&&n>0){var h=e[0],d=n+1;l=Ve(o,h,d,r,t),p=We(s,h,d,a,t),f=ze(i,h,d,t)}else for(var m=0;m<c;m++)l[m]=je(o,r,i,t,m,u),p[m]=He(s,a,i,t,m,u),f[m]=Ue(i,m,u);return{begin:l,end:p,strides:f}}function Ve(t,e,n,r,a){for(var i=(0,T.Z)(a),o=Le(n,e),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{var u=Be(e,n,s),c=r[u];t&1<<u&&(c=0),i[s]=c}return i}function We(t,e,n,r,a){for(var i=(0,T.Z)(a),o=Le(n,e),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{var u=Be(e,n,s),c=r[u];t&1<<u&&(c=Number.MAX_SAFE_INTEGER),i[s]=c}for(var l=0;l<i.length;l++){var p=a[l];i[l]<0&&(i[l]+=p),i[l]=A.uZ(0,i[l],a[l])}return i}function Ue(t,e,n){var r=t[e];return(n&1<<e||null==r)&&(r=1),r}function je(t,e,n,r,a,i){var o=e[a],s=n[a]||1;(t&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=A.uZ(0,o,u-1)}function He(t,e,n,r,a,i){var o=e[a],s=n[a]||1;(t&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=s>0?A.uZ(0,o,u):A.uZ(-1,o,u-1)}function qe(t,e,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function Ge(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Ze(t,e,n){var r,a,i=t.shape.length;return(r="number"===typeof e?[e].concat((0,T.Z)(new Array(i-1).fill(0))):e.length<i?e.concat(new Array(i-e.length).fill(0)):e.slice()).forEach((function(t){A.hu(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat((0,T.Z)(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(e,n){return e>=0?e:(A.hu(-1===e,(function(){return"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,".")})),t.shape[n]-r[n])})),[r,a]}function Ke(t,e,n,r,a,i,o,s,u){var c;if(null==r?(c=new Array(e.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,p={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u},f=0;f<p.dims;f++)l&&0!==(1<<f&s)&&p.numAddAxisAfterEllipsis++,1<<f&o&&(l=!0);l||(p.ellipsisMask|=1<<p.dims,p.dims++);var h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;var n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(var r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask)for(var a=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(-2),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(-1),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(p,h);for(var d=!0,m=!0,v=!0,g=[],y=[],b=0;b<t.length;++b){if(0===h.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var w=!!(h.shrinkAxisMask&1<<b),x=t[b];if(-1!==x){var k=[h.beginMask&1<<b,h.endMask&1<<b],S=[h.strides[b]>0?0:-1,h.strides[b]>0?x:x-1];if(w&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&1===h.strides[b];var N=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(w){var E=h.begin[b]<0?x+h.begin[b]:h.begin[b];if(h.begin[b]=E,h.end[b]=h.begin[b]+1,E<0||E>=x)throw Error("slice index ".concat(h.begin[b]," of dimension ").concat(b," out of bounds."))}else h.begin[b]=Xe(h.begin[b],0,h.strides[b],x,k,S),h.end[b]=Xe(h.end[b],1,h.strides[b],x,k,S);var C=1===h.strides[b]&&0===h.begin[b]&&h.end[b]===x;d=d&&C,m=m&&(0===b&&1===h.strides[b]||C)}else d=d&&1===h.strides[b]&&N,m=m&&(0===b&&1===h.strides[b]||N);var T=void 0,I=!1;if(h.beginValid&&h.endValid?(T=h.end[b]-h.begin[b],I=!0):w?(T=1,I=!0):N&&x>=0&&(T=h.strides[b]<0?-x:x,I=!0),I){var _=void 0;_=0===T||T<0!==h.strides[b]<0?0:Math.trunc(T/h.strides[b])+(T%h.strides[b]!==0?1:0),g.push(_)}else g.push(-1)}else g.push(w?1:-1)}for(var A=0;A<h.finalShapeGatherIndices.length;++A){var R=h.finalShapeGatherIndices[A];R>=0?y.push(g[R]):-2===R&&y.push(1)}var D=y.filter((function(t,e){return-2!==h.finalShapeGatherIndices[e]}));return{finalShapeSparse:D,finalShape:y,isIdentity:d,sliceDim0:m,isSimpleSlice:v,begin:h.begin,end:h.end,strides:h.strides}}function Xe(t,e,n,r,a,i){if(a[e])return n>0?i[e]:i[e+1&1];var o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}var $e=function(){function t(){(0,x.Z)(this,t)}return(0,k.Z)(t,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(t,e){return new t(e)}}]),t}(),Ye=function(){function t(){(0,x.Z)(this,t),this.classNameMap={}}return(0,k.Z)(t,null,[{key:"getMap",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"register",value:function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]}}]),t}();function Qe(t){(0,A.hu)(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),(0,A.hu)("string"===typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),(0,A.hu)(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Ye.register(t)}var Je=n(9064),tn=n(115),en=.1;function nn(t,e,n){return null==n&&(n=rn()),an(t,e,(function(t,e){return cn(t,e,n)}))}function rn(){return 32===m.BV.backend.floatPrecision()?.001:en}function an(t,e,n){var r=!0;if(((0,A.fU)(t)||(0,A.fU)(e))&&(r=!1),(0,A.fU)(t)&&(0,A.fU)(e)&&(r=!0),r){var a=t.constructor.name,i=e.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: ".concat(a,". ")+"Expected: ".concat(i))}if(Array.isArray(t)&&Array.isArray(e)){var o=(0,he.C)(t),s=(0,he.C)(e);if(!(0,A.cO)(o,s))throw new Error("Arrays have different shapes. "+"Actual: [".concat(o,"]. Expected: [").concat(s,"]"))}var u=(0,A.fU)(t)?t:(0,A.xH)(t),c=(0,A.fU)(e)?e:(0,A.xH)(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: ".concat(u.length," vs ")+"expected: ".concat(c.length,".\n")+"Actual:   ".concat(u,".\n")+"Expected: ".concat(c,"."));for(var l=0;l<c.length;++l){var p=u[l],f=c[l];if(!n(p,f))throw new Error("Arrays differ: actual[".concat(l,"] = ").concat(p,", expected[").concat(l,"] = ").concat(f,".\n")+"Actual:   ".concat(u,".\n")+"Expected: ".concat(c,"."))}"undefined"!==typeof expect&&expect().nothing()}function on(t,e){t().then((function(){return e.fail()}),(function(){return e()})),"undefined"!==typeof expect&&expect().nothing()}function sn(t,e){var n="string"===typeof e||"number"===typeof e||"boolean"===typeof e?[e]:e;return(0,A.HD)(t)||(0,A.HD)(t[0])||(0,A.HD)(e)||(0,A.HD)(e[0])?an(t,n,(function(t,e){return t==e})):an(t,e,(function(t,e){return cn(t,e,0)}))}function un(t,e,n){if(null==n&&(n=rn()),!cn(t,e,n))throw new Error("Numbers differ: actual === ".concat(t,", expected === ").concat(e));"undefined"!==typeof expect&&expect().nothing()}function cn(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function ln(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:".concat(t[r]," low: ").concat(e,", high: ").concat(n))}function pn(t,e){var n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(r.length,", but it was ").concat(n.length));for(var a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error("Expected ArrayBuffer value at ".concat(a," to be ")+"".concat(r[a]," but got ").concat(n[a]," instead"))}function fn(t){for(var e=0;e<t.length;e++){var n=t[e];Array.isArray(n)?fn(n):t[e]=(0,tn.encodeString)(n)}return t}function hn(t){var e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise((function(t){e.addEventListener("loadeddata",(function(n){return t(e)})),e.load()}))}function dn(t){return mn.apply(this,arguments)}function mn(){return(mn=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.play();case 2:if(!("requestVideoFrameCallback"in e)){t.next=5;break}return t.next=5,new Promise((function(t){e.requestVideoFrameCallback(t)}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var vn="3.21.0",gn=n(9340),yn=n(2882),bn=n(5875),wn=n(3312),xn=n(5750),kn=n(651),Sn=n(6902),Nn=n(7391),En=n(7293),Cn=n(6450),Tn=n(7067),In=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(){return(0,x.Z)(this,n),e.apply(this,arguments)}return(0,k.Z)(n,[{key:"minimize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(t,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:i[t.name]}}));this.applyGradients(o)}else this.applyGradients(i);return(0,bn.B9)(i),e?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(t,e){return(0,Cn.pn)(t,e)}},{key:"dispose",value:function(){null!=this.iterations_&&(0,bn.B9)(this.iterations_)}},{key:"saveIterations",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==this.iterations_&&(this.iterations_=0),t.abrupt("return",{name:"iter",tensor:(0,Tn.i)(this.iterations_,"int32")});case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e[0].tensor.data();case 2:return this.iterations_=t.sent[0],t.abrupt("return",e.slice(1));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}($e);Object.defineProperty(In,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var _n=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,x.Z)(this,n),(a=e.call(this)).learningRate=t,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=m.BV.backend.epsilon()),a}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=m.BV.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:(0,bn.lu)((function(){return(0,En.P)(a).variable(false)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:(0,bn.lu)((function(){return(0,En.P)(a).variable(false)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;(0,bn.lu)((function(){var t=(0,wn.I)((0,kn.d)(o,e.rho),(0,kn.d)((0,Nn.h)(i),1-e.rho)),n=(0,kn.d)((0,xn.h)((0,Sn._)((0,wn.I)(s,e.epsilon)),(0,Sn._)((0,wn.I)(o,e.epsilon))),i),r=(0,wn.I)((0,kn.d)(s,e.rho),(0,kn.d)((0,Nn.h)(n),1-e.rho));o.assign(t),s.assign(r);var u=(0,wn.I)((0,kn.d)(n,-e.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&((0,bn.B9)(this.accumulatedGrads.map((function(t){return t.variable}))),(0,bn.B9)(this.accumulatedUpdates.map((function(t){return t.variable}))))}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat((0,T.Z)(this.accumulatedGrads),(0,T.Z)(this.accumulatedUpdates)),t.next=3,this.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,n=e.length/2,!1,this.accumulatedGrads=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}})),this.accumulatedUpdates=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}]),n}(In);_n.className="Adadelta",Qe(_n);var An=n(8582),Rn=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return(0,x.Z)(this,n),(r=e.call(this)).learningRate=t,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=m.BV.registeredVariables[n];if(null==e.accumulatedGrads[r]){e.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:(0,bn.lu)((function(){return(0,An.h)(a.shape,e.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedGrads[r].variable;(0,bn.lu)((function(){var t=(0,wn.I)(o,(0,Nn.h)(i));o.assign(t);var n=(0,wn.I)((0,kn.d)((0,xn.h)(i,(0,Sn._)((0,wn.I)(t,m.BV.backend.epsilon()))),-e.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&(0,bn.B9)(this.accumulatedGrads.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,!1,this.accumulatedGrads=e.map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}]),n}(In);Rn.className="Adagrad",Qe(Rn);var Dn=n(4334),On=n(4774),Mn=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,x.Z)(this,n),(i=e.call(this)).learningRate=t,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],(0,bn.lu)((function(){i.accBeta1=(0,Tn.i)(r).variable(),i.accBeta2=(0,Tn.i)(a).variable()})),null==o&&(i.epsilon=m.BV.backend.epsilon()),i}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);(0,bn.lu)((function(){var r=(0,On.l)(1,e.accBeta1),a=(0,On.l)(1,e.accBeta2);n.forEach((function(n,i){var o=m.BV.registeredVariables[n];null==e.accumulatedFirstMoment[i]&&(e.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:(0,bn.lu)((function(){return(0,En.P)(o).variable(false)}))}),null==e.accumulatedSecondMoment[i]&&(e.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:(0,bn.lu)((function(){return(0,En.P)(o).variable(false)}))});var s=Array.isArray(t)?t[i].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[i].variable,c=e.accumulatedSecondMoment[i].variable,l=(0,wn.I)((0,kn.d)(u,e.beta1),(0,kn.d)(s,1-e.beta1)),p=(0,wn.I)((0,kn.d)(c,e.beta2),(0,kn.d)((0,Nn.h)(s),1-e.beta2)),f=(0,xn.h)(l,r),h=(0,xn.h)(p,a);u.assign(l),c.assign(p);var d=(0,wn.I)((0,kn.d)((0,xn.h)(f,(0,wn.I)((0,Sn._)(h),e.epsilon)),-e.learningRate),o);o.assign(d)}})),e.accBeta1.assign((0,kn.d)(e.accBeta1,e.beta1)),e.accBeta2.assign((0,kn.d)(e.accBeta2,e.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,bn.B9)(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&(0,bn.B9)(this.accumulatedSecondMoment.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat((0,T.Z)(this.accumulatedFirstMoment),(0,T.Z)(this.accumulatedSecondMoment)),t.next=3,this.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r=this;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,(0,bn.lu)((function(){r.accBeta1.assign((0,Dn.s)(r.beta1,r.iterations_+1)),r.accBeta2.assign((0,Dn.s)(r.beta2,r.iterations_+1))})),n=e.length/2,!1,this.accumulatedFirstMoment=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}})),this.accumulatedSecondMoment=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}]),n}(In);Mn.className="Adam",Qe(Mn);var Fn=n(7613),zn=n(705),Bn=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return(0,x.Z)(this,n),(i=e.call(this)).learningRate=t,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],(0,bn.lu)((function(){i.iteration=(0,Tn.i)(0).variable(),i.accBeta1=(0,Tn.i)(r).variable()})),null==o&&(i.epsilon=m.BV.backend.epsilon()),i}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);(0,bn.lu)((function(){var r=(0,On.l)(1,e.accBeta1),a=(0,xn.h)(-e.learningRate,(0,wn.I)((0,kn.d)(e.iteration,e.decay),1));n.forEach((function(n,i){var o=m.BV.registeredVariables[n];null==e.accumulatedFirstMoment[i]&&(e.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:(0,En.P)(o).variable(false)}),null==e.accumulatedWeightedInfNorm[i]&&(e.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:(0,En.P)(o).variable(false)});var s=Array.isArray(t)?t[i].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[i].variable,c=e.accumulatedWeightedInfNorm[i].variable,l=(0,wn.I)((0,kn.d)(u,e.beta1),(0,kn.d)(s,1-e.beta1)),p=(0,kn.d)(c,e.beta2),f=(0,Fn.W)(s),h=(0,zn.g)(p,f);u.assign(l),c.assign(h);var d=(0,wn.I)((0,kn.d)((0,xn.h)(a,r),(0,xn.h)(l,(0,wn.I)(h,e.epsilon))),o);o.assign(d)}})),e.iteration.assign((0,wn.I)(e.iteration,1)),e.accBeta1.assign((0,kn.d)(e.accBeta1,e.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,bn.B9)(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&(0,bn.B9)(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}]),n}(In);Bn.className="Adamax",Qe(Bn);var Ln=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t){var r;return(0,x.Z)(this,n),(r=e.call(this)).learningRate=t,r.setLearningRate(t),r}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var i=m.BV.registeredVariables[n];(0,bn.lu)((function(){var t=(0,wn.I)((0,kn.d)(e.c,a),i);i.assign(t)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=(0,bn.Cn)((0,Tn.i)(-t))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0]);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:if(0===(e=t.sent).length){t.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate)}}]),n}(In);Ln.className="SGD",Qe(Ln);var Pn=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,x.Z)(this,n),(a=e.call(this,t)).learningRate=t,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=(0,Tn.i)(a.momentum),a}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=m.BV.registeredVariables[n];if(null==e.accumulations[r]){e.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:(0,bn.lu)((function(){return(0,En.P)(a).variable(false)}))}}var i=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&(0,bn.lu)((function(){var t,n=(0,wn.I)((0,kn.d)(e.m,i),o);t=e.useNesterov?(0,wn.I)((0,kn.d)(e.c,(0,wn.I)(o,(0,kn.d)(n,e.m))),a):(0,wn.I)((0,kn.d)(e.c,n),a),i.assign(n),a.assign(t)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&(0,bn.B9)(this.accumulations.map((function(t){return t.variable})))}},{key:"setMomentum",value:function(t){this.momentum=t}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,!1,this.accumulations=e.map((function(t){return{originalName:t.name,variable:t.tensor.variable(false)}}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}]),n}(Ln);Pn.className="Momentum",Qe(Pn);var Vn=function(t){(0,gn.Z)(n,t);var e=(0,yn.Z)(n);function n(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,x.Z)(this,n),(r=e.call(this)).learningRate=t,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=m.BV.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return(0,k.Z)(n,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=m.BV.registeredVariables[n],i=!1;null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:(0,bn.lu)((function(){return(0,En.P)(a).variable(i)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:(0,bn.lu)((function(){return(0,En.P)(a).variable(i)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:(0,bn.lu)((function(){return(0,En.P)(a).variable(i)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var s=e.accumulatedMeanSquares[r].variable,u=e.accumulatedMoments[r].variable;(0,bn.lu)((function(){var t=(0,wn.I)((0,kn.d)(s,e.decay),(0,kn.d)((0,Nn.h)(o),1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,i=(0,wn.I)((0,kn.d)(n,e.decay),(0,kn.d)(o,1-e.decay)),c=(0,xn.h)((0,kn.d)(o,e.learningRate),(0,Sn._)((0,On.l)(t,(0,wn.I)((0,Nn.h)(i),e.epsilon)))),l=(0,wn.I)((0,kn.d)(u,e.momentum),c);s.assign(t),n.assign(i),u.assign(l);var p=(0,On.l)(a,l);a.assign(p)}else{var f=(0,wn.I)((0,kn.d)(s,e.decay),(0,kn.d)((0,Nn.h)(o),1-e.decay)),h=(0,wn.I)((0,kn.d)(u,e.momentum),(0,xn.h)((0,kn.d)(o,e.learningRate),(0,Sn._)((0,wn.I)(f,e.epsilon))));s.assign(f),u.assign(h);var d=(0,On.l)(a,h);a.assign(d)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&(0,bn.B9)(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&(0,bn.B9)(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&(0,bn.B9)(this.accumulatedMoments.map((function(t){return t.variable})))}},{key:"getWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(){var e;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat((0,T.Z)(this.accumulatedMeanSquares),(0,T.Z)(this.accumulatedMoments)),this.centered&&e.push.apply(e,(0,T.Z)(this.accumulatedMeanGrads)),t.next=4,this.saveIterations();case 4:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setWeights",value:function(){var t=(0,E.Z)((0,N.Z)().mark((function t(e){var n,r;return(0,N.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,n=this.centered?e.length/3:e.length/2,r=!1,this.accumulatedMeanSquares=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(r)}})),this.accumulatedMoments=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(r)}})));case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}]),n}(In);Vn.className="RMSProp",Qe(Vn);var Wn=function(){function t(){(0,x.Z)(this,t)}return(0,k.Z)(t,null,[{key:"sgd",value:function(t){return new Ln(t)}},{key:"momentum",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Pn(t,e,n)}},{key:"rmsprop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Vn(t,e,n,r,a)}},{key:"adam",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Mn(t,e,n,r)}},{key:"adadelta",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new _n(t,e,n)}},{key:"adamax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Bn(t,e,n,r,a)}},{key:"adagrad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Rn(t,e)}}]),t}(),Un=n(3525),jn=n(1674),Hn=n(7627),qn={sgd:Wn.sgd,momentum:Wn.momentum,adadelta:Wn.adadelta,adagrad:Wn.adagrad,rmsprop:Wn.rmsprop,adamax:Wn.adamax,adam:Wn.adam},Gn="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(t){return t()};function Zn(){return new Promise((function(t){return Gn((function(){return t()}))}))}var Kn=n(8473);function Xn(t,e){var n=t[0].length;t.forEach((function(t,e){A.hu(t.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),A.hu(e>=0&&e<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=t[0];t.forEach((function(t,a){for(var i=0;i<n;i++)A.hu(i===e||t[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function $n(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}var Yn,Qn=n(9151),Jn=n(5171);function tr(t,e,n){var r=new Array;if(null==n&&null==e)return r;if(null==e)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(t+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(a+t,"] = ").concat(i," but shape[").concat(a+t,"] = ").concat(s))}else r[o]=i}return r}function er(t){var e,n={FIRST_DIM_SIZE:Yn.FIRST_DIM_SIZE,VALUE_ROWIDS:Yn.VALUE_ROWIDS,ROW_LENGTHS:Yn.ROW_LENGTHS,ROW_SPLITS:Yn.ROW_SPLITS,ROW_LIMITS:Yn.ROW_LIMITS,ROW_STARTS:Yn.ROW_STARTS},r=[],a=(0,S.Z)(t);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(!(i in n))break;r.push(n[i])}}catch(aa){a.e(aa)}finally{a.f()}return r}function nr(t){return 0===t.length?0:t[0]===Yn.FIRST_DIM_SIZE?t.length-1:t.length}function rr(t,e){if(null!=t&&null!=e){var n=t.length,r=e.length;if(n>=r)throw new Error("defaultValue.shape=".concat(t," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=t[a],o=e[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(t,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(a-t.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-t.length,"] = ").concat(o))}}}!function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(Yn||(Yn={}));var ar=30;function ir(t){return t<=ar?t:(0,A.jP)(t,Math.floor(Math.sqrt(t)))}function or(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function sr(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(e.slice(0))).push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);for(var i=e.length,o=0;o<i;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(i+1))}return a}function ur(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(e);for(var a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<t;++s)s>=2*e+1||s%2===1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function cr(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function lr(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function pr(t,e,n){for(var r=t.slice(0,1),a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}var fr=1.7580993408473768,hr=1.0507009873554805,dr=.3275911,mr=.254829592,vr=-.284496736,gr=1.421413741,yr=-1.453152027,br=1.061405429,wr=n(7269);function xr(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function kr(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Sr(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function Nr(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function Er(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Cr(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Tr(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),a=0;a<Math.ceil(t/2);a++){var i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function Ir(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}var _r="->",Ar=/->/g;function Rr(t,e){var n=((t=t.replace(/\s/g,"")).length-t.replace(Ar,"").length)/_r.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(_r,'").'));var r=t.split(_r),a=(0,C.Z)(r,2),i=a[0],o=a[1];(0,A.hu)(-1===i.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var s=i.split(","),u=s.length;if(e!==u)throw new Error("Expected ".concat(u," input tensors, received ").concat(e));if(u>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var c=[],l=function(t){var e=o[t];if(!s.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===c.indexOf(e)&&c.push(e)},p=0;p<o.length;++p)l(p);for(var f=0;f<i.length;++f){var h=i[f];-1===c.indexOf(h)&&","!==h&&c.push(h)}for(var d=new Array(s.length),m=0;m<u;++m){if(new Set(s[m].split("")).size!==s[m].length)throw new Error("Found duplicate axes in input component ".concat(s[m],". ")+"Support for duplicate axes in input is not implemented yet.");d[m]=[];for(var v=0;v<s[m].length;++v)d[m].push(c.indexOf(s[m][v]))}for(var g=c.length,y=[],b=o.length;b<g;++b)y.push(b);return{allDims:c,summedDims:y,idDims:d}}function Dr(t,e){var n=new Array(t);n.fill(-1);for(var r=0;r<e.length;++r)n[e[r]]=r;for(var a=[],i=0;i<t;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(t){return-1!==t})),expandDims:a}}function Or(t,e,n){for(var r=new Array(t),a=function(t){for(var a=n[t].shape,i=function(n){void 0===r[e[t][n]]?r[e[t][n]]=a[n]:(0,A.hu)(r[e[t][n]]===a[n],(function(){return"Expected dimension ".concat(r[e[t][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<e[t].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function Mr(t,e){var n,r=t,a=[];0===t.length&&r.push(-1),n=t.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],s=0;s<r.length;++s){var u,c=zr(e,r[s]),l=(0,S.Z)(c);try{for(l.s();!(u=l.n()).done;){var p=u.value;-1===o.indexOf(p)&&(a[s].push(p),o.push(p))}}catch(aa){l.e(aa)}finally{l.f()}}return{path:r,steps:a}}function Fr(t){return t.every((function(t,e){return t===e}))}function zr(t,e){for(var n=[],r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Br(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof e)(0,A.hu)(t.shape[n]%e===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(t.shape[n]/e);else{var a=e.reduce((function(t,e){return-1===e&&(t+=1),t}),0);(0,A.hu)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=e.indexOf(-1);if(-1!==i){var o=e.reduce((function(t,e){return e>0?t+e:t}));e[i]=t.shape[n]-o}(0,A.hu)(t.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e}return r}function Lr(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(t)}function Pr(t,e){return"indices(".concat(t,", 0) is invalid: ").concat(e," < 0")}function Vr(t,e,n){return"indices(".concat(t,", 0) is invalid: ").concat(e," >= ").concat(n)}function Wr(t,e){return"only one output dimension may be -1, not both ".concat(t," and ").concat(e)}function Ur(t,e){return"size ".concat(t," must be non-negative, not ").concat(e)}function jr(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Hr(t,e){var n=(0,A.NA)(t),r=(0,A.NA)(e);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(t," outputShape= ").concat(e)}function qr(t,e){var n=(0,A.NA)(t),r=(0,A.NA)(e);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(t," outputShape=").concat(e)}function Gr(){return"segment ids must be >= 0"}function Zr(){return"segment ids are not increasing"}function Kr(t,e){return"Segment id ".concat(t," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function Xr(t,e,n){return"Bad: indices[".concat(t,"] == ").concat(e," out of range [0, ").concat(n,")")}function $r(t,e){var n,r=!1;for(t<=ar?(n=t,r=!0):n=(0,A.jP)(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=(0,A.jP)(t,n+1);return n}function Yr(t,e,n){for(var r=[],a=t.length,i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}function Qr(t,e,n,r){var a=e.shape.length,i=t.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(t.shape[o]!==e.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(t.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(e.shape[o],"."));for(var s=t.shape[n],u=[],c=1,l=1,p=1,f=0;f<r;++f)u.push(t.shape[f]),c*=t.shape[f];for(var h=r;h<n;h++)u.push(t.shape[h]),l*=t.shape[h];for(var d=r;d<a;d++)u.push(e.shape[d]);for(var m=n+1;m<i;m++)u.push(t.shape[m]),p*=t.shape[m];return{batchSize:c,sliceSize:p,outerSize:l,dimSize:s,outputShape:u}}function Jr(t){try{return t.map((function(t){return(0,tn.decodeString)(t)}))}catch(aa){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(aa))}}function ta(t){return t.map((function(t){return(0,tn.encodeString)(t)}))}var ea=n(745),na=n(4189),ra=n(4679)},2145:function(t,e,n){"use strict";n.d(e,{$HU:function(){return de},$g6:function(){return J},$w:function(){return K},Acj:function(){return vt},BMI:function(){return Lt},BiW:function(){return pe},Byc:function(){return V},CAk:function(){return Et},D2d:function(){return He},DlI:function(){return ce},Eh3:function(){return R},FKq:function(){return Fe},G3Y:function(){return rn},GBy:function(){return ze},Gcp:function(){return Pe},HEU:function(){return et},HZH:function(){return ve},Hhh:function(){return zt},Hmb:function(){return ye},IKK:function(){return c},IMb:function(){return w},J$2:function(){return St},J_u:function(){return bt},JhU:function(){return g},Kgp:function(){return oe},L8s:function(){return Le},Ly9:function(){return N},M2y:function(){return f},MIZ:function(){return Je},MRv:function(){return Me},MZg:function(){return Rt},NEP:function(){return at},NZg:function(){return Xt},O3z:function(){return Ve},OAf:function(){return Wt},OR:function(){return lt},OU7:function(){return Ut},OV7:function(){return Vt},Omj:function(){return nt},Oyi:function(){return m},PYm:function(){return _t},PhF:function(){return Te},QCc:function(){return v},QRR:function(){return j},Qg5:function(){return yt},QiL:function(){return ae},Qvg:function(){return sn},RFZ:function(){return C},ROF:function(){return y},RQH:function(){return Ae},RuY:function(){return cn},SX0:function(){return tt},SYM:function(){return r},SbG:function(){return xe},SpW:function(){return i},T0n:function(){return H},TQc:function(){return Be},TR1:function(){return P},ToN:function(){return on},Tr8:function(){return Ye},Uyb:function(){return ct},VGw:function(){return a},Vbg:function(){return Kt},VcC:function(){return U},VfG:function(){return At},Vn9:function(){return Y},W0H:function(){return ee},XDQ:function(){return un},XLW:function(){return x},XkS:function(){return $e},Xze:function(){return s},Y0y:function(){return ot},YFo:function(){return it},YoZ:function(){return Bt},ZbH:function(){return Tt},ZjV:function(){return je},Zz9:function(){return _},_JP:function(){return Ke},_V0:function(){return dn},_Yw:function(){return be},_k9:function(){return b},_tC:function(){return qe},a5O:function(){return Oe},aJk:function(){return p},avt:function(){return wt},b9H:function(){return fn},bK0:function(){return Ge},bV0:function(){return Ne},c17:function(){return qt},cWu:function(){return en},cie:function(){return q},cye:function(){return te},dDz:function(){return le},deh:function(){return ut},dpD:function(){return ge},e07:function(){return Se},e6w:function(){return fe},e7N:function(){return Ct},eBW:function(){return pn},eEB:function(){return E},eZ0:function(){return Ft},ekb:function(){return $},gJX:function(){return T},h8e:function(){return ln},hdR:function(){return rt},i5y:function(){return De},iHb:function(){return W},iJz:function(){return gt},iWB:function(){return xt},iZT:function(){return mt},ik2:function(){return B},jMg:function(){return d},jQk:function(){return Ze},jQs:function(){return Zt},jeX:function(){return pt},kU:function(){return It},kpP:function(){return an},kuV:function(){return Yt},luS:function(){return mn},lyA:function(){return ie},mKl:function(){return ke},mTV:function(){return Pt},mc4:function(){return L},mhS:function(){return D},mm_:function(){return o},n9L:function(){return tn},nhH:function(){return We},nr8:function(){return Ce},o0g:function(){return ue},o2y:function(){return z},oFR:function(){return Ie},oHH:function(){return Q},oT6:function(){return u},p2w:function(){return _e},p4S:function(){return X},pe_:function(){return se},q1x:function(){return dt},q2K:function(){return Ht},q8u:function(){return Gt},qCd:function(){return Ot},qIC:function(){return Mt},qWM:function(){return ne},qi_:function(){return ht},qkr:function(){return me},qw7:function(){return h},r7n:function(){return kt},s1s:function(){return Xe},sEM:function(){return Qe},sHE:function(){return ft},sJF:function(){return l},sL$:function(){return G},usg:function(){return hn},uv1:function(){return Jt},vFR:function(){return jt},vtC:function(){return Nt},vwp:function(){return st},w3H:function(){return Ue},w6g:function(){return Dt},wUP:function(){return O},wYB:function(){return Re},wYn:function(){return $t},we_:function(){return re},wm:function(){return M},wx7:function(){return nn},x12:function(){return F},xJR:function(){return he},xQA:function(){return Ee},xnO:function(){return I},y7R:function(){return Z},yQU:function(){return Qt},yj2:function(){return A},zbQ:function(){return we},zvY:function(){return S},zws:function(){return k}});var r="Abs",a="Acos",i="Acosh",o="Add",s="AddN",u="All",c="Any",l="ArgMax",p="ArgMin",f="Asin",h="Asinh",d="Atan",m="Atanh",v="Atan2",g="AvgPool",y="AvgPoolGrad",b="AvgPool3D",w="AvgPool3DGrad",x="BatchMatMul",k="BatchToSpaceND",S="Bincount",N="BroadcastTo",E="BroadcastArgs",C="Cast",T="Ceil",I="ClipByValue",_="Complex",A="ComplexAbs",R="Concat",D="Conv2D",O="Conv2DBackpropFilter",M="Conv2DBackpropInput",F="Conv3D",z="Conv3DBackpropFilterV2",B="Conv3DBackpropInputV2",L="Cos",P="Cosh",V="Cumprod",W="Cumsum",U="CropAndResize",j="DenseBincount",H="DepthToSpace",q="DepthwiseConv2dNative",G="DepthwiseConv2dNativeBackpropFilter",Z="DepthwiseConv2dNativeBackpropInput",K="Diag",X="Dilation2D",$="Dilation2DBackpropInput",Y="Dilation2DBackpropFilter",Q="RealDiv",J="Einsum",tt="Elu",et="EluGrad",nt="Erf",rt="Equal",at="Exp",it="ExpandDims",ot="Expm1",st="FFT",ut="Fill",ct="FlipLeftRight",lt="Floor",pt="FloorDiv",ft="FusedBatchNorm",ht="GatherV2",dt="GatherNd",mt="Greater",vt="GreaterEqual",gt="Identity",yt="IFFT",bt="Imag",wt="IsFinite",xt="IsInf",kt="IsNan",St="LeakyRelu",Nt="Less",Et="LessEqual",Ct="LinSpace",Tt="Log",It="Log1p",_t="LogicalAnd",At="LogicalNot",Rt="LogicalOr",Dt="LogicalXor",Ot="LogSoftmax",Mt="LowerBound",Ft="LRN",zt="LRNGrad",Bt="Max",Lt="Maximum",Pt="MaxPool",Vt="MaxPoolGrad",Wt="MaxPool3D",Ut="MaxPool3DGrad",jt="MaxPoolWithArgmax",Ht="Mean",qt="Min",Gt="Minimum",Zt="MirrorPad",Kt="Mod",Xt="Multinomial",$t="Multiply",Yt="Neg",Qt="NotEqual",Jt="NonMaxSuppressionV3",te="NonMaxSuppressionV4",ee="NonMaxSuppressionV5",ne="OnesLike",re="OneHot",ae="Pack",ie="PadV2",oe="Pool",se="Pow",ue="Prelu",ce="Prod",le="RaggedGather",pe="RaggedTensorToTensor",fe="Range",he="Real",de="Reciprocal",me="Relu",ve="Reshape",ge="ResizeNearestNeighbor",ye="ResizeNearestNeighborGrad",be="ResizeBilinear",we="ResizeBilinearGrad",xe="Relu6",ke="Reverse",Se="Round",Ne="Rsqrt",Ee="ScatterNd",Ce="SearchSorted",Te="Select",Ie="Selu",_e="Slice",Ae="Sin",Re="Sinh",De="Sign",Oe="Sigmoid",Me="Softplus",Fe="Sqrt",ze="Sum",Be="SpaceToBatchND",Le="SplitV",Pe="Softmax",Ve="SparseFillEmptyRows",We="SparseReshape",Ue="SparseSegmentMean",je="SparseSegmentSum",He="SparseToDense",qe="SquaredDifference",Ge="Square",Ze="StridedSlice",Ke="StringNGrams",Xe="StringSplit",$e="StringToHashBucketFast",Ye="Sub",Qe="Tan",Je="Tanh",tn="Tile",en="TopK",nn="Transform",rn="Transpose",an="Unique",on="Unpack",sn="UnsortedSegmentSum",un="UpperBound",cn="ZerosLike",ln="Step",pn="FromPixels",fn="RotateWithOffset",hn="_FusedMatMul",dn="FusedConv2D",mn="FusedDepthwiseConv2D"},8864:function(t,e,n){"use strict";n.d(e,{Li:function(){return h},T3:function(){return v},bt:function(){return m},nE:function(){return d},pI:function(){return c},tr:function(){return p},uk:function(){return l},wC:function(){return f}});var r=n(9439),a=n(5050),i=n(6581),o=n(7269),s=(0,i.R)("kernelRegistry",(function(){return new Map})),u=(0,i.R)("gradRegistry",(function(){return new Map}));function c(t,e){var n=g(t,e);return s.get(n)}function l(t){return u.get(t)}function p(t){for(var e=s.entries(),n=[];;){var a=e.next(),i=a.done,o=a.value;if(i)break;var u=(0,r.Z)(o,2),c=u[0],l=u[1],p=c.split("_");(0,r.Z)(p,1)[0]===t&&n.push(l)}return n}function f(t){var e=t.kernelName,n=t.backendName,r=g(e,n);s.has(r)&&o.Z("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),s.set(r,t)}function h(t){var e=t.kernelName;u.has(e)&&(0,a.OB)().getBool("DEBUG")&&o.Z("Overriding the gradient for '".concat(e,"'")),u.set(e,t)}function d(t,e){var n=g(t,e);if(!s.has(n))throw new Error("The kernel '".concat(t,"' for backend ")+"'".concat(e,"' is not registered"));s.delete(n)}function m(t){if(!u.has(t))throw new Error("The gradient '".concat(t,"' for backend is not registered"));u.delete(t)}function v(t,e){p(t).forEach((function(t){f(Object.assign({},t,{backendName:e}))}))}function g(t,e){return"".concat(e,"_").concat(t)}},7269:function(t,e,n){"use strict";n.d(e,{Z:function(){return a},c:function(){return i}});var r=n(5050);function a(){var t;(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||(t=console).warn.apply(t,arguments)}function i(){var t;(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||(t=console).log.apply(t,arguments)}},7613:function(t,e,n){"use strict";n.d(e,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({abs_:function(t){var e=(0,i._1)(t,"x","abs");if("complex64"===e.dtype){var n={x:e};return r.BV.runKernel(a.yj2,n)}var o={x:e};return r.BV.runKernel(a.SYM,o)}})},3312:function(t,e,n){"use strict";n.d(e,{I:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354);var u=(0,n(8640).op)({add_:function(t,e){var n=(0,s._1)(t,"a","add"),u=(0,s._1)(e,"b","add"),c=(0,o.makeTypesMatch)(n,u),l=(0,r.Z)(c,2),p={a:n=l[0],b:u=l[1]};return a.BV.runKernel(i.mm_,p)}})},8473:function(t,e,n){"use strict";n.d(e,{LJ:function(){return l},Q3:function(){return c},Vh:function(){return i},YB:function(){return a},kz:function(){return o},lB:function(){return u},rv:function(){return s},sY:function(){return p}});var r=n(6147);function a(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function i(t,e,n){for(var r=t.length+e.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(t[i++]):a.push(e[o++]);return a}function o(t,e){for(var n=[],r=t.length,a=0;a<r;a++)-1===e.indexOf(a)&&n.push(t[a]);var i=e.map((function(e){return t[e]}));return[n,i]}function s(t,e){return i(t,e.map((function(t){return 1})),e)}function u(t,e,n){r.hu(a(e,n),(function(){return"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")}))}function c(t,e){if(a(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function l(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function p(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}},5774:function(t,e,n){"use strict";function r(t,e){for(var n=t.length,r=[],a=0;a<n;a++){var i=n-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(t,e){for(var n=[],r=0;r<e.length;r++){var a=t[t.length-r-1],i=e.length-r-1,o=e[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(t,e){for(var n=[],r=Math.max(t.length,e.length),a=0;a<r;a++){var i=t[t.length-a-1];null==i&&(i=1);var o=e[e.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(s)}n.unshift(i)}}return n}n.r(e),n.d(e,{assertAndGetBroadcastShape:function(){return i},getBroadcastDims:function(){return r},getReductionAxes:function(){return a}})},7039:function(t,e,n){"use strict";n.d(e,{f:function(){return i}});var r=n(4376),a=n(6147);function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",a.Mu(t),new r.YD(t,e,n)}},9118:function(t,e,n){"use strict";n.d(e,{p:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var s=(0,n(8640).op)({cast_:function(t,e){var n=(0,i._1)(t,"x","cast");if(!o.LP(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var s={x:n},u={dtype:e};return r.BV.runKernel(a.RFZ,s,u)}})},672:function(t,e,n){"use strict";n.d(e,{d:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({clone_:function(t){var e={x:(0,i._1)(t,"x","clone","string_or_numeric")};return r.BV.runKernel(a.iJz,e)}})},9253:function(t,e,n){"use strict";n.d(e,{P:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var s=(0,n(8640).op)({complex_:function(t,e){var n=(0,i._1)(t,"real","complex"),s=(0,i._1)(e,"imag","complex");o.k5(n.shape,s.shape,"real and imag shapes, ".concat(n.shape," and ").concat(s.shape,", ")+"must match in call to tf.complex().");var u={real:n,imag:s};return r.BV.runKernel(a.Zz9,u)}})},9151:function(t,e,n){"use strict";n.d(e,{I0:function(){return y},Ix:function(){return c},Rf:function(){return o},Xw:function(){return s},aO:function(){return p},jT:function(){return b},jw:function(){return l},m:function(){return x},pl:function(){return u},sl:function(){return w}});var r=n(9439),a=n(3433),i=n(6147);function o(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,s=t[3],u=[].concat((0,a.Z)(e),[s]),l=w(i);return c(t,u,n,o,r,null,null,l)}function s(t,e,n,a,i,o){var s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=f(e),p=(0,r.Z)(l,2),h=p[0],d=p[1];if("channelsLast"===u)s=[h,d,t[3],t[3]];else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));s=[h,d,t[1],t[1]]}return c(t,s,n,a,i,o,!1,u)}function u(t,e,n,a,i,o){var s,u,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",p=h(e),f=(0,r.Z)(p,3),d=f[0],m=f[1],v=f[2];if("NDHWC"===c)u="channelsLast",s=[d,m,v,t[4],t[4]];else{if("NCDHW"!==c)throw new Error("Unknown dataFormat ".concat(c));u="channelsFirst",s=[d,m,v,t[1],t[1]]}return l(t,s,n,a,i,!1,u,o)}function c(t,e,n,a,i,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",c=-1,l=-1,p=-1,h=-1;if("channelsLast"===u){var v=(0,r.Z)(t,4);c=v[0],l=v[1],p=v[2],h=v[3]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var g=(0,r.Z)(t,4);c=g[0],h=g[1],l=g[2],p=g[3]}var y,b=(0,r.Z)(e,4),w=b[0],x=b[1],k=b[3],S=f(n),N=(0,r.Z)(S,2),E=N[0],C=N[1],T=f(a),I=(0,r.Z)(T,2),_=I[0],A=I[1],R=d(w,_),D=d(x,A),O=m(i,l,p,E,C,R,D,o,u),M=O.padInfo,F=O.outHeight,z=O.outWidth,B=s?k*h:k;return"channelsFirst"===u?y=[c,B,F,z]:"channelsLast"===u&&(y=[c,F,z,B]),{batchSize:c,dataFormat:u,inHeight:l,inWidth:p,inChannels:h,outHeight:F,outWidth:z,outChannels:B,padInfo:M,strideHeight:E,strideWidth:C,filterHeight:w,filterWidth:x,effectiveFilterHeight:R,effectiveFilterWidth:D,dilationHeight:_,dilationWidth:A,inShape:t,outShape:y,filterShape:e}}function l(t,e,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=arguments.length>7?arguments[7]:void 0,c=-1,l=-1,p=-1,f=-1,m=-1;if("channelsLast"===s){var g=(0,r.Z)(t,5);c=g[0],l=g[1],p=g[2],f=g[3],m=g[4]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var y=(0,r.Z)(t,5);c=y[0],m=y[1],l=y[2],p=y[3],f=y[4]}var b,w=(0,r.Z)(e,5),x=w[0],k=w[1],S=w[2],N=w[4],E=h(n),C=(0,r.Z)(E,3),T=C[0],I=C[1],_=C[2],A=h(a),R=(0,r.Z)(A,3),D=R[0],O=R[1],M=R[2],F=d(x,D),z=d(k,O),B=d(S,M),L=v(i,l,p,f,T,I,_,F,z,B,u),P=L.padInfo,V=L.outDepth,W=L.outHeight,U=L.outWidth,j=o?N*m:N;return"channelsFirst"===s?b=[c,j,V,W,U]:"channelsLast"===s&&(b=[c,V,W,U,j]),{batchSize:c,dataFormat:s,inDepth:l,inHeight:p,inWidth:f,inChannels:m,outDepth:V,outHeight:W,outWidth:U,outChannels:j,padInfo:P,strideDepth:T,strideHeight:I,strideWidth:_,filterDepth:x,filterHeight:k,filterWidth:S,effectiveFilterDepth:F,effectiveFilterHeight:z,effectiveFilterWidth:B,dilationDepth:D,dilationHeight:O,dilationWidth:M,inShape:t,outShape:b,filterShape:e}}function p(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=d(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function f(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function h(t){return"number"===typeof t?[t,t,t]:t}function d(t,e){return e<=1?t:t+(t-1)*(e-1)}function m(t,e,n,r,a,i,o,s,u){var c,l,f;if("number"===typeof t){c={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,a){null==r&&(r=p(t,e,n));var i=t[0],o=t[1];return[g((i-e+2*r)/n+1,a),g((o-e+2*r)/n+1,a)]}([e,n],i,r,t,s);l=h[0],f=h[1]}else if("same"===t){l=Math.ceil(e/r),f=Math.ceil(n/a);var d=Math.max(0,(l-1)*r+i-e),m=Math.max(0,(f-1)*a+o-n),v=Math.floor(d/2),y=d-v,b=Math.floor(m/2);c={top:v,bottom:y,left:b,right:m-b,type:"SAME"}}else if("valid"===t)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-i+1)/r),f=Math.ceil((n-o+1)/a);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));var w="channelsLast"===u?t[1][0]:t[2][0],x="channelsLast"===u?t[1][1]:t[2][1],k="channelsLast"===u?t[2][0]:t[3][0],S="channelsLast"===u?t[2][1]:t[3][1];c={top:w,bottom:x,left:k,right:S,type:0===w&&0===x&&0===k&&0===S?"VALID":"EXPLICIT"},l=g((e-i+w+x)/r+1,s),f=g((n-o+k+S)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:f}}function v(t,e,n,r,a,i,o,s,u,c,l){var f,h,d,m;if("number"===typeof t){f={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var v=function(t,e,n,r,a,i){null==a&&(a=p(t,e,r));var o=t[0],s=t[1],u=t[2];return[g((o-e+2*a)/r+1,i),g((s-e+2*a)/r+1,i),g((u-e+2*a)/r+1,i),n]}([e,n,r,1],s,1,a,t,l);h=v[0],d=v[1],m=v[2]}else if("same"===t){var y=((h=Math.ceil(e/a))-1)*a+s-e,b=((d=Math.ceil(n/i))-1)*i+u-n,w=((m=Math.ceil(r/o))-1)*o+c-r,x=Math.floor(y/2),k=y-x,S=Math.floor(b/2),N=b-S,E=Math.floor(w/2);f={top:S,bottom:N,left:E,right:w-E,front:x,back:k,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: ".concat(t));f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-s+1)/a),d=Math.ceil((n-u+1)/i),m=Math.ceil((r-c+1)/o)}return{padInfo:f,outDepth:h,outHeight:d,outWidth:m}}function g(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function y(t){var e=f(t),n=(0,r.Z)(e,3),a=n[0],i=n[1],o=n[2];return 1===a&&1===i&&1===o}function b(t,e){return y(t)||y(e)}function w(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}function x(t,e,n){if(null!=n){if("string"===typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"===typeof e)i.hu(i.GN(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}));else{if("object"!==typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((function(e){e.forEach((function(e){i.hu(i.GN(e),(function(){return"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")}))}))}))}}}},5750:function(t,e,n){"use strict";n.d(e,{h:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354),u=n(7145);var c=(0,n(8640).op)({div_:function(t,e){var n=(0,s._1)(t,"a","div"),c=(0,s._1)(e,"b","div"),l=(0,o.makeTypesMatch)(n,c),p=(0,r.Z)(l,2);if(n=p[0],c=p[1],"int32"===n.dtype&&"int32"===c.dtype)return(0,u.q)(n,c);var f={a:n,b:c};return a.BV.runKernel(i.oHH,f,{})}})},2353:function(t,e,n){"use strict";n.d(e,{p:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({elu_:function(t){var e={x:(0,i._1)(t,"x","elu","float32")};return r.BV.runKernel(a.SX0,e)}})},8582:function(t,e,n){"use strict";n.d(e,{h:function(){return i}});var r=n(318),a=n(2145);function i(t,e,n){var i={shape:t,value:e,dtype:n};return r.BV.runKernel(a.deh,{},i)}},7145:function(t,e,n){"use strict";n.d(e,{q:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354);var u=(0,n(8640).op)({floorDiv_:function(t,e){var n=(0,s._1)(t,"a","floorDiv"),u=(0,s._1)(e,"b","floorDiv"),c=(0,o.makeTypesMatch)(n,u),l=(0,r.Z)(c,2),p={a:n=l[0],b:u=l[1]};return a.BV.runKernel(i.jeX,p)}})},5171:function(t,e,n){"use strict";n.d(e,{Fr:function(){return d},QH:function(){return v},pf:function(){return m},uy:function(){return g}});var r=n(5774),a=n(2353),i=n(4419),o=n(651),s=n(6859),u=n(7539),c=n(5900),l=n(5561),p=n(7643),f=n(4031),h=n(227);function d(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return(0,o.d)(t,(0,f.N)(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function m(t,e){var n=e,a=r.getReductionAxes(t.shape,e.shape);return a.length>0&&(n=(0,h.S)(n,a)),(0,l.X)(n,t.shape)}function v(t,e,n,r){if("linear"===e)return t;if("relu"===e)return(0,u.U)(t);if("elu"===e)return(0,a.p)(t);if("relu6"===e)return(0,c.b)(t);if("prelu"===e)return(0,s.A)(t,n);if("leakyrelu"===e)return(0,i.h)(t,r);if("sigmoid"===e)return(0,p.X)(t);throw new Error("Unknown fused activation ".concat(e,"."))}var g=function(t,e){return!(t>0)||"linear"===e}},6996:function(t,e,n){"use strict";n.d(e,{a:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({imag_:function(t){var e={input:(0,i._1)(t,"input","imag")};return r.BV.runKernel(a.J_u,e)}})},4419:function(t,e,n){"use strict";n.d(e,{h:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({leakyRelu_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=(0,i._1)(t,"x","leakyRelu"),o={x:n},s={alpha:e};return r.BV.runKernel(a.J$2,o,s)}})},7627:function(t,e,n){"use strict";var r;n.d(e,{I:function(){return r}}),function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},7221:function(t,e,n){"use strict";n.d(e,{O:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354);var u=(0,n(8640).op)({matMul_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=(0,s._1)(t,"a","matMul"),l=(0,s._1)(e,"b","matMul"),p=(0,o.makeTypesMatch)(c,l),f=(0,r.Z)(p,2),h={a:c=f[0],b:l=f[1]},d={transposeA:n,transposeB:u};return a.BV.runKernel(i.XLW,h,d)}})},705:function(t,e,n){"use strict";n.d(e,{g:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354),u=n(5774),c=n(9118);var l=(0,n(8640).op)({maximum_:function(t,e){var n=(0,s._1)(t,"a","maximum"),l=(0,s._1)(e,"b","maximum"),p=(0,o.makeTypesMatch)(n,l),f=(0,r.Z)(p,2);n=f[0],l=f[1],"bool"===n.dtype&&(n=(0,c.p)(n,"int32"),l=(0,c.p)(l,"int32")),(0,u.assertAndGetBroadcastShape)(n.shape,l.shape);var h={a:n,b:l};return a.BV.runKernel(i.BMI,h)}})},651:function(t,e,n){"use strict";n.d(e,{d:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354);var u=(0,n(8640).op)({mul_:function(t,e){var n=(0,s._1)(t,"a","mul"),u=(0,s._1)(e,"b","mul"),c=(0,o.makeTypesMatch)(n,u),l=(0,r.Z)(c,2),p={a:n=l[0],b:u=l[1]};return a.BV.runKernel(i.wYn,p)}})},4362:function(t,e,n){"use strict";n.d(e,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({neg_:function(t){var e={x:(0,i._1)(t,"x","neg")};return r.BV.runKernel(a.kuV,e)}})},4326:function(t,e,n){"use strict";n.d(e,{l:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({oneHot_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));var u=(0,i._1)(t,"indices","oneHot","int32"),c={indices:u},l={dtype:s,depth:e,onValue:n,offValue:o};return r.BV.runKernel(a.we_,c,l)}})},8640:function(t,e,n){"use strict";n.d(e,{op:function(){return o},z:function(){return i}});var r=n(318),a=n(6147),i="__op";function o(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));var n=e[0],o=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var s=function(){r.BV.startScope(n);try{var t=o.apply(void 0,arguments);return(0,a.tI)(t)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(t),t}catch(e){throw r.BV.endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},1674:function(t,e,n){"use strict";n.d(e,{zvA:function(){return u.z},WnP:function(){return a.W},Khb:function(){return c},__u:function(){return l},IHx:function(){return p.I},QBD:function(){return h},$6P:function(){return d},YjB:function(){return m},NqF:function(){return v},vHJ:function(){return g},ZRM:function(){return y},VfV:function(){return b},z4N:function(){return w},fvJ:function(){return S},C80:function(){return N},wS1:function(){return I},uR5:function(){return _},zEQ:function(){return B},tgs:function(){return P},Dxk:function(){return V},JY5:function(){return W},p3b:function(){return U},E4h:function(){return L},yE8:function(){return j},anm:function(){return lr},XsQ:function(){return H},UFq:function(){return q},f3b:function(){return G.f},pju:function(){return E.p},mDi:function(){return Z},iUl:function(){return X},d9v:function(){return A.d},PYB:function(){return $.P},zoF:function(){return R},gME:function(){return Y},Izb:function(){return Q},MNy:function(){return J},ZaL:function(){return tt},PAt:function(){return nt},Tek:function(){return et},bc:function(){return at},pdZ:function(){return it},$QV:function(){return st},mCk:function(){return ut},f9Y:function(){return ct},mew:function(){return wr},$Gn:function(){return lt},zbp:function(){return pt},ppE:function(){return ft},nTT:function(){return ht},B10:function(){return dt},Ka3:function(){return mt},WmZ:function(){return vt},hiC:function(){return gt.h},NTj:function(){return kt},AKD:function(){return St},rvX:function(){return yr},WYO:function(){return Nt},pyx:function(){return Et.p},GRh:function(){return br},DgJ:function(){return bt},qNN:function(){return Ct},d2q:function(){return Bt},Qqt:function(){return Lt},dt4:function(){return Pt},t$B:function(){return Vt},iyy:function(){return Ut},kp_:function(){return Mn},hlL:function(){return K.h},GWj:function(){return jt},qPi:function(){return Ht.q},imm:function(){return r},Iqj:function(){return qt},dbB:function(){return gr},pjt:function(){return Gt},brS:function(){return Zt},Sxn:function(){return Fn},asL:function(){return Kt.a},BHj:function(){return Ra},V3u:function(){return kr},wx0:function(){return zn},xVT:function(){return Xt},UWc:function(){return $t},i2d:function(){return Yt},hi7:function(){return Qt.h},d9m:function(){return Jt},zN1:function(){return te},$r2:function(){return Da},SX3:function(){return ee},G9k:function(){return ne},cM7:function(){return re},Krr:function(){return ae},e_t:function(){return ue},CmS:function(){return le},l_t:function(){return pe},HvI:function(){return fe},hJK:function(){return he},K5V:function(){return de},egP:function(){return me},MB5:function(){return Oa},eab:function(){return ye},OI3:function(){return D.O},Fp7:function(){return It},_sB:function(){return be},YQQ:function(){return we},Ip$:function(){return xe},gWQ:function(){return ke.g},J69:function(){return Se},ry_:function(){return Te},VV$:function(){return _t},LTh:function(){return Ie},VdP:function(){return _e},wQq:function(){return Ae},Gi7:function(){return Re},p_:function(){return fr},dC7:function(){return O.d},rq4:function(){return De},SJ_:function(){return Oe},W76:function(){return oe.W},KOy:function(){return zt},Quu:function(){return Me},lfX:function(){return Fe.l},iUs:function(){return Ee},JpU:function(){return ze},op:function(){return u.op},N2O:function(){return Be},vku:function(){return Le},pNR:function(){return Pe},koy:function(){return Ve},t1L:function(){return We},lGY:function(){return Ue},d_R:function(){return He},sQ3:function(){return At.s},AL3:function(){return qe.A},S0v:function(){return Ge.S},WVs:function(){return Ze},$gW:function(){return Ke},N89:function(){return Xe},TN_:function(){return $e},wzB:function(){return rn},nGf:function(){return an},ruB:function(){return on},LGj:function(){return sn},w6H:function(){return un},kwC:function(){return cn.k},M25:function(){return ln},UYe:function(){return pn.U},btT:function(){return fn.b},XLQ:function(){return T.X},GYS:function(){return hn},SDf:function(){return dn},diP:function(){return mn},sx7:function(){return vn},mG2:function(){return gn},QEs:function(){return Ln},NMM:function(){return yn},bp0:function(){return bn},iD$:function(){return Rt.i},snQ:function(){return dr},zcT:function(){return ge},U8D:function(){return wn},U_I:function(){return xn},ODp:function(){return En},XD2:function(){return M.X},Xxe:function(){return Cn},tdS:function(){return Aa},O$l:function(){return Tn},R_K:function(){return In},tPi:function(){return F},jZU:function(){return _n},SmN:function(){return An},CnO:function(){return Rn},p0P:function(){return Dn},XAC:function(){return On},Wvh:function(){return se},fBT:function(){return je},rVs:function(){return Ma},ers:function(){return vr},uN7:function(){return _a},Vl2:function(){return Bn},_b3:function(){return Dt._},h62:function(){return Ot.h},$i:function(){return Pn},L9e:function(){return Vn},knu:function(){return Wn},Nbs:function(){return Un.N},NXj:function(){return jn},Z_8:function(){return Fa},luU:function(){return ce.l},Smz:function(){return Mt.S},ORZ:function(){return Hn},AEp:function(){return z},XeE:function(){return qn.X},RRF:function(){return Zn},odF:function(){return Kn},wOQ:function(){return Xn.w},yXz:function(){return $n},Bfx:function(){return Yn},xZs:function(){return Qn},Gg6:function(){return Wt},hg7:function(){return Jn},p4s:function(){return pr.p},Xu6:function(){return tr},Two:function(){return er},pUJ:function(){return nr},HHK:function(){return rr},GaM:function(){return ar},VD$:function(){return ir},arb:function(){return wt},itS:function(){return ur},lls:function(){return Ne},P84:function(){return xt.P}});var r={};n.r(r),n.d(r,{conv2d:function(){return Er},depthwiseConv2d:function(){return Ir},matMul:function(){return _r}});var a=n(7613),i=n(318),o=n(2145),s=n(8354),u=n(8640);var c=(0,u.op)({acos_:function(t){var e={x:(0,s._1)(t,"x","acos")};return i.BV.runKernel(o.VGw,e)}});var l=(0,u.op)({acosh_:function(t){var e={x:(0,s._1)(t,"x","acosh")};return i.BV.runKernel(o.SpW,e)}}),p=n(3312),f=n(6147);var h=(0,u.op)({addN_:function(t){f.hu(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),f.hu(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)}));var e=t.map((function(t,e){return(0,s._1)(t,"tensors".concat(e),"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!f.cO(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return i.BV.runKernel(o.Xze,r)}});var d=(0,u.op)({all_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","all","bool"),a={x:r},u={axis:e,keepDims:n};return i.BV.runKernel(o.oT6,a,u)}});var m=(0,u.op)({any_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","any","bool"),a={x:r},u={axis:e,keepDims:n};return i.BV.runKernel(o.IKK,a,u)}});var v=(0,u.op)({argMax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,s._1)(t,"x","argMax"),r={x:n},a={axis:e};return i.BV.runKernel(o.sJF,r,a)}});var g=(0,u.op)({argMin_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,s._1)(t,"x","argMin"),r={x:n},a={axis:e};return i.BV.runKernel(o.aJk,r,a)}});var y=(0,u.op)({asin_:function(t){var e={x:(0,s._1)(t,"x","asin")};return i.BV.runKernel(o.M2y,e)}});var b=(0,u.op)({asinh_:function(t){var e={x:(0,s._1)(t,"x","asinh")};return i.BV.runKernel(o.qw7,e)}});var w=(0,u.op)({atan_:function(t){var e={x:(0,s._1)(t,"x","atan")};return i.BV.runKernel(o.jMg,e)}}),x=n(9439),k=n(9064);var S=(0,u.op)({atan2_:function(t,e){var n=(0,s._1)(t,"a","atan2"),r=(0,s._1)(e,"b","atan2"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2),c={a:n=u[0],b:r=u[1]};return i.BV.runKernel(o.QCc,c)}});var N=(0,u.op)({atanh_:function(t){var e={x:(0,s._1)(t,"x","atanh")};return i.BV.runKernel(o.Oyi,e)}}),E=n(9118),C=n(9151),T=n(5561);var I=(0,u.op)({avgPool_:function(t,e,n,r,a){var u=(0,s._1)(t,"x","avgPool","float32");f.hu(C.jT(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var c=u,l=!1;3===u.rank&&(l=!0,c=(0,T.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]])),f.hu(4===c.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(c.rank,".")})),C.m("avgPool",r,a);var p={x:c},h={filterSize:e,strides:n,pad:r,dimRoundingMode:a},d=i.BV.runKernel(o.JhU,p,h);return d=(0,E.p)(d,u.dtype),l?(0,T.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var _=(0,u.op)({avgPool3d_:function(t,e,n,r,a){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",c=(0,s._1)(t,"x","avgPool3d","float32"),l=c,p=!1;4===c.rank&&(p=!0,l=(0,T.X)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),f.hu(5===l.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(l.rank,".")})),f.hu("NDHWC"===u,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(u)})),(0,C.m)("avgPool3d",r,a);var h={x:l},d={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:u},m=i.BV.runKernel(o._k9,h,d);return m=(0,E.p)(m,l.dtype),p?(0,T.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),A=n(672);var R=(0,u.op)({concat_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,f.hu)(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=(0,s.sI)(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return(0,A.d)(n[0]);var r=n,a={axis:e};return i.BV.runKernel(o.Eh3,r,a)}}),D=n(7221),O=n(651),M=n(7643);var F=(0,u.op)({slice_:function(t,e,n){var r=(0,s._1)(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},u={begin:e,size:n};return i.BV.runKernel(o.p2w,a,u)}});var z=(0,u.op)({tanh_:function(t){var e={x:(0,s._1)(t,"x","tanh","float32")};return i.BV.runKernel(o.MIZ,e)}});var B=(0,u.op)({basicLSTMCell_:function(t,e,n,r,a,i){var o=(0,s._1)(t,"forgetBias","basicLSTMCell"),u=(0,s._1)(e,"lstmKernel","basicLSTMCell"),c=(0,s._1)(n,"lstmBias","basicLSTMCell"),l=(0,s._1)(r,"data","basicLSTMCell"),f=(0,s._1)(a,"c","basicLSTMCell"),h=(0,s._1)(i,"h","basicLSTMCell"),d=R([l,h],1),m=(0,D.O)(d,u),v=(0,p.I)(m,c),g=v.shape[0],y=v.shape[1]/4,b=[g,y],w=F(v,[0,0],b),x=F(v,[0,y],b),k=F(v,[0,2*y],b),S=F(v,[0,3*y],b),N=(0,p.I)((0,O.d)((0,M.X)(w),z(x)),(0,O.d)(f,(0,M.X)((0,p.I)(o,k))));return[N,(0,O.d)(z(N),(0,M.X)(S))]}});var L=(0,u.op)({batchToSpaceND_:function(t,e,n){var r=(0,s._1)(t,"x","batchToSpaceND"),a=e.reduce((function(t,e){return t*e}));f.hu(r.rank>=1+e.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length)})),f.hu(n.length===e.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)})),f.hu(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(a)}));var u={x:r},c={blockShape:e,crops:n};return i.BV.runKernel(o.zws,u,c)}});var P=(0,u.op)({batchNorm_:function(t,e,n,r,a,u){null==u&&(u=.001);var c,l,p=(0,s._1)(t,"x","batchNorm"),h=(0,s._1)(e,"mean","batchNorm"),d=(0,s._1)(n,"variance","batchNorm");null!=a&&(c=(0,s._1)(a,"scale","batchNorm")),null!=r&&(l=(0,s._1)(r,"offset","batchNorm")),f.hu(h.rank===d.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),f.hu(null==l||h.rank===l.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),f.hu(null==c||h.rank===c.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var m=function(t){return 0===t.rank||1===t.rank?(0,T.X)(t,[1,1,1,t.size]):2===t.rank?(0,T.X)(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?(0,T.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t}(p),v={x:m,scale:c,offset:l,mean:h,variance:d},g={varianceEpsilon:u},y=i.BV.runKernel(o.sHE,v,g);return(0,T.X)(y,p.shape)}});var V=(0,u.op)({batchNorm2d_:function(t,e,n,r,a,i){var o,u,c=(0,s._1)(t,"x","batchNorm"),l=(0,s._1)(e,"mean","batchNorm"),p=(0,s._1)(n,"variance","batchNorm");return null!=a&&(o=(0,s._1)(a,"scale","batchNorm")),null!=r&&(u=(0,s._1)(r,"offset","batchNorm")),f.hu(2===c.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(c.rank,".")})),f.hu(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(l.rank,".")})),f.hu(2===p.rank||1===p.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(p.rank,".")})),null!=o&&f.hu(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&f.hu(2===u.rank||1===u.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")})),P(c,l,p,u,o,i)}});var W=(0,u.op)({batchNorm3d_:function(t,e,n,r,a,i){var o,u,c=(0,s._1)(t,"x","batchNorm"),l=(0,s._1)(e,"mean","batchNorm"),p=(0,s._1)(n,"variance","batchNorm");return null!=a&&(o=(0,s._1)(a,"scale","batchNorm")),null!=r&&(u=(0,s._1)(r,"offset","batchNorm")),f.hu(3===c.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(c.rank,".")})),f.hu(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(l.rank,".")})),f.hu(3===p.rank||1===p.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(p.rank,".")})),null!=o&&f.hu(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&f.hu(3===u.rank||1===u.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")})),P(c,l,p,u,o,i)}});var U=(0,u.op)({batchNorm4d_:function(t,e,n,r,a,i){var o,u,c=(0,s._1)(t,"x","batchNorm"),l=(0,s._1)(e,"mean","batchNorm"),p=(0,s._1)(n,"variance","batchNorm");return null!=a&&(o=(0,s._1)(a,"scale","batchNorm")),null!=r&&(u=(0,s._1)(r,"offset","batchNorm")),f.hu(4===c.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(c.rank,".")})),f.hu(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(l.rank,".")})),f.hu(4===p.rank||1===p.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(p.rank,".")})),null!=o&&f.hu(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&f.hu(4===u.rank||1===u.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")})),P(c,l,p,u,o,i)}});var j=(0,u.op)({bincount_:function(t,e,n){var r=(0,s._1)(t,"x","bincount"),a=(0,s._1)(e,"weights","bincount");f.hu("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),f.hu(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),f.hu(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var u={x:r,weights:a},c={size:n};return i.BV.runKernel(o.zvY,u,c)}});var H=(0,u.op)({broadcastArgs_:function(t,e){var n=(0,s._1)(t,"s0","broadcastArgs","int32"),r=(0,s._1)(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var a={s0:n,s1:r};return i.BV.runKernel(o.eEB,a)}});var q=(0,u.op)({broadcastTo_:function(t,e){var n=(0,s._1)(t,"broadcastTo","x"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(e,"]."));if(e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){for(var a=n.shape.slice();a.length<e.length;)a.unshift(1);n=(0,T.X)(n,a)}for(var u=n.shape,c=Array.from(e),l=e.length-1;l>=0;l--)if(u[l]===e[l])c[l]=1;else if(1!==n.shape[l])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));var p=c.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0}));if(0===p.length)return(0,A.d)(n);var f={x:n},h={reps:c};return i.BV.runKernel(o.n9L,f,h)}}),G=n(7039);var Z=(0,u.op)({ceil_:function(t){var e={x:(0,s._1)(t,"x","ceil","float32")};return i.BV.runKernel(o.gJX,e)}}),K=n(8582);var X=(0,u.op)({clipByValue_:function(t,e,n){var r=(0,s._1)(t,"x","clipByValue");if(f.hu(e<=n,(function(){return"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")})),e===n)return(0,K.h)(r.shape,e,r.dtype);var a={x:r},u={clipValueMin:e,clipValueMax:n};return i.BV.runKernel(o.xnO,a,u)}}),$=n(9253);var Y=(0,u.op)({concat1d_:function(t){return R(t,0)}});var Q=(0,u.op)({concat2d_:function(t,e){return R(t,e)}});var J=(0,u.op)({concat3d_:function(t,e){return R(t,e)}});var tt=(0,u.op)({concat4d_:function(t,e){return R(t,e)}});var et=(0,u.op)({conv2d_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=(0,s._1)(t,"x","conv2d","float32"),p=(0,s._1)(e,"filter","conv2d","float32"),h=l,d=!1;3===l.rank&&(d=!0,h=(0,T.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),f.hu(4===h.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(h.rank,".")})),f.hu(4===p.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")})),C.m("conv2d",r,c);var m="NHWC"===a?h.shape[3]:h.shape[1];f.hu(m===p.shape[2],(function(){return"Error in conv2d: depth of input (".concat(m,") must match ")+"input depth for filter ".concat(p.shape[2],".")})),f.hu(C.jT(n,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(u,"'")}));var v={x:h,filter:p},g={strides:n,pad:r,dataFormat:a,dilations:u,dimRoundingMode:c},y=i.BV.runKernel(o.mhS,v,g);return d?(0,T.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}});var nt=(0,u.op)({conv1d_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,u=(0,s._1)(t,"x","conv1d"),c=(0,s._1)(e,"filter","conv1d"),l=u,p=!1;2===u.rank&&(p=!0,l=(0,T.X)(u,[1,u.shape[0],u.shape[1]])),f.hu(3===l.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,".")})),f.hu(3===c.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(c.rank,".")})),C.m("conv1d",r,o),f.hu(l.shape[2]===c.shape[1],(function(){return"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(c.shape[1],".")})),f.hu(C.jT(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),f.hu("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var h=(0,T.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]]),d=(0,T.X)(l,[l.shape[0],1,l.shape[1],l.shape[2]]),m=[1,n],v=[1,i],g="NHWC",y=et(d,h,m,r,g,v,o);return p?(0,T.X)(y,[y.shape[2],y.shape[3]]):(0,T.X)(y,[y.shape[0],y.shape[2],y.shape[3]])}});var rt=(0,u.op)({conv2DBackpropInput_:function(t,e,n,r,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",u=arguments.length>6?arguments[6]:void 0;f.hu(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var c=t,l=e,p=!1;3===e.rank&&(p=!0,l=(0,T.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]),c=[1,t[0],t[1],t[2]]),f.hu(4===c.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(c.length,".")})),f.hu(4===l.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(l.rank)})),f.hu(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var h="NHWC"===s?c[3]:c[1],d="NHWC"===s?l.shape[3]:l.shape[1];f.hu(h===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(h,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),f.hu(d===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(d,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),C.m("conv2dDerInput",a,u);var m={dy:l,filter:n},v={strides:r,pad:a,dataFormat:s,dimRoundingMode:u,inputShape:c},g=i.BV.runKernel(o.wm,m,v);return p?(0,T.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}});var at=(0,u.op)({conv2dTranspose_:function(t,e,n,r,a,i){var o=(0,s._1)(t,"x","conv2dTranspose"),u=(0,s._1)(e,"filter","conv2dTranspose");return rt(n,o,u,r,a,"NHWC",i)}});var it=(0,u.op)({conv3d_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],c=(0,s._1)(t,"x","conv3d"),l=(0,s._1)(e,"filter","conv3d"),p=c,h=!1;4===c.rank&&(h=!0,p=(0,T.X)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),f.hu(5===p.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(p.rank,".")})),f.hu(5===l.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(l.rank,".")})),f.hu(p.shape[4]===l.shape[3],(function(){return"Error in conv3d: depth of input (".concat(p.shape[4],") must match ")+"input depth for filter ".concat(l.shape[3],".")})),f.hu((0,C.jT)(n,u),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(u,"'")})),f.hu("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")}));var d={x:p,filter:l},m={strides:n,pad:r,dataFormat:a,dilations:u},v=i.BV.runKernel(o.x12,d,m);return h?(0,T.X)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}});var ot=(0,u.op)({conv3DBackpropInput_:function(t,e,n,r,a){f.hu(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var s=t,u=e,c=!1;4===e.rank&&(c=!0,u=(0,T.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);var l=s[4],p=u.shape[4];f.hu(5===s.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(s.length,".")})),f.hu(5===u.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(u.rank)})),f.hu(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),f.hu(l===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),f.hu(p===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(p,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var h={dy:u,filter:n},d={pad:a,strides:r,inputShape:s},m=i.BV.runKernel(o.ik2,h,d);return c?(0,T.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}});var st=(0,u.op)({conv3dTranspose_:function(t,e,n,r,a){var i=(0,s._1)(t,"x","conv3dTranspose"),o=(0,s._1)(e,"filter","conv3dTranspose");return ot(n,i,o,r,a)}});var ut=(0,u.op)({cos_:function(t){var e={x:(0,s._1)(t,"x","cos","float32")};return i.BV.runKernel(o.mc4,e)}});var ct=(0,u.op)({cosh_:function(t){var e={x:(0,s._1)(t,"x","cosh","float32")};return i.BV.runKernel(o.TR1,e)}});var lt=(0,u.op)({cumprod_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,s._1)(t,"x","cumprod"),u={x:a},c={axis:e,exclusive:n,reverse:r};return i.BV.runKernel(o.Byc,u,c)}});var pt=(0,u.op)({cumsum_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,s._1)(t,"x","cumsum"),u={x:a},c={axis:e,exclusive:n,reverse:r};return i.BV.runKernel(o.iHb,u,c)}});var ft=(0,u.op)({denseBincount_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,s._1)(t,"x","denseBincount"),u=(0,s._1)(e,"weights","denseBincount");f.hu("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),f.hu(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),f.hu(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),f.hu(u.size===a.size||0===u.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(u.shape,".")}));var c={x:a,weights:u},l={size:n,binaryOutput:r};return i.BV.runKernel(o.QRR,c,l)}});var ht=(0,u.op)({depthToSpace_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=(0,s._1)(t,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],u="NHWC"===n?r.shape[2]:r.shape[3],c="NHWC"===n?r.shape[3]:r.shape[1];f.hu(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(e)})),f.hu(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(r.shape)})),f.hu(u*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(e," for depthToSpace with input shape\n        ").concat(r.shape)})),f.hu(c%(e*e)===0,(function(){return"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(c," for depthToSpace with input shape ").concat(r.shape)}));var l={x:r},p={blockSize:e,dataFormat:n};return i.BV.runKernel(o.T0n,l,p)}});var dt=(0,u.op)({depthwiseConv2d_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=(0,s._1)(t,"x","depthwiseConv2d","float32"),p=(0,s._1)(e,"filter","depthwiseConv2d","float32"),h=l,d=!1;3===l.rank&&(d=!0,h=(0,T.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),f.hu(4===h.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(h.rank,".")})),f.hu(4===p.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")}));var m="NHWC"===a?h.shape[3]:h.shape[1];f.hu(m===p.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(m,") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],".")})),C.m("depthwiseConv2d",r,c);var v={x:h,filter:p},g={strides:n,pad:r,dataFormat:a,dilations:u,dimRoundingMode:c},y=i.BV.runKernel(o.cie,v,g);return d?(0,T.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}});var mt=(0,u.op)({diag_:function(t){var e={x:(0,s._1)(t,"x","diag")};return i.BV.runKernel(o.$w,e)}});var vt=(0,u.op)({dilation2d_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",c=(0,s._1)(t,"x","dilation2d"),l=(0,s._1)(e,"filter","dilation2d");f.hu(3===c.rank||4===c.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(c.rank,".")})),f.hu(3===l.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(l.rank,".")})),f.hu("NHWC"===u,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(u)}));var p=c,h=!1;3===c.rank&&(p=(0,T.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=!0);var d={x:p,filter:l},m={strides:n,pad:r,dilations:a},v=i.BV.runKernel(o.p4S,d,m);return h?(0,T.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}}),gt=n(5750),yt=n(5774);var bt=(0,u.op)({equal_:function(t,e){var n=(0,s._1)(t,"a","equal","string_or_numeric"),r=(0,s._1)(e,"b","equal","string_or_numeric"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.hdR,c)}});var wt=(0,u.op)({where_:function(t,e,n){var r=(0,s._1)(e,"a","where"),a=(0,s._1)(n,"b","where"),u=(0,s._1)(t,"condition","where","bool"),c=(0,yt.assertAndGetBroadcastShape)((0,yt.assertAndGetBroadcastShape)(u.shape,r.shape),a.shape),l={condition:q(u,c),t:q(r,c),e:q(a,c)};return i.BV.runKernel(o.PhF,l)}}),xt=n(7293);var kt=(0,u.op)({divNoNan_:function(t,e){var n=(0,s._1)(t,"a","div"),r=(0,s._1)(e,"b","div"),a=(0,k.makeTypesMatch)(n,r),i=(0,x.Z)(a,2);n=i[0],r=i[1];var o=(0,gt.h)(n,r),u=(0,xt.P)(o),c=bt(r,u);return wt(c,u,o)}});var St=(0,u.op)({dot_:function(t,e){var n=(0,s._1)(t,"t1","dot"),r=(0,s._1)(e,"t2","dot");f.hu((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(f.hu(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=(0,T.X)(n,[1,-1]),u=(0,T.X)(r,[-1,1]),c=(0,D.O)(o,u);return(0,T.X)(c,[])}if(1===n.rank&&2===r.rank){var l=(0,T.X)(n,[1,-1]),p=(0,T.X)(r,[r.shape[0],r.shape[1]]),h=(0,D.O)(l,p);return(0,T.X)(h,[h.size])}if(2===n.rank&&1===r.rank){var d=(0,T.X)(r,[-1,1]),m=(0,D.O)(n,d);return(0,T.X)(m,[m.size])}var v=(0,T.X)(r,[r.shape[0],r.shape[1]]);return(0,D.O)(n,v)}});var Nt=(0,u.op)({einsum_:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var a=n.map((function(t,e){return(0,s._1)(t,"tensors".concat(e),"einsum")})),u={equation:t};return i.BV.runKernel(o.$g6,a,u)}}),Et=n(2353);var Ct=(0,u.op)({erf_:function(t){var e=(0,s._1)(t,"x","erf");f.hu("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=(0,E.p)(e,"float32"));var n={x:e};return i.BV.runKernel(o.Omj,n)}}),Tt=n(8473);var It=(0,u.op)({max_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","max"),a={x:r},u={reductionIndices:e,keepDims:n};return i.BV.runKernel(o.YoZ,a,u)}});var _t=(0,u.op)({min_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","min"),a={x:r},u={axis:e,keepDims:n};return i.BV.runKernel(o.c17,a,u)}}),At=n(4334),Rt=n(7067),Dt=n(6902),Ot=n(7391),Mt=n(227);function Ft(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return(0,a.W)(t);if(1!==t.rank&&null===n)return Ft((0,T.X)(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return(0,Mt.S)((0,a.W)(t),n);if(e===1/0)return It((0,a.W)(t),n);if(e===-1/0)return _t((0,a.W)(t),n);if("euclidean"===e||2===e)return(0,Dt._)((0,Mt.S)((0,At.s)((0,a.W)(t),(0,Rt.i)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return It((0,Mt.S)((0,a.W)(t),n[0]),n[1]-1);if(e===1/0)return It((0,Mt.S)((0,a.W)(t),n[1]),n[0]);if(e===-1/0)return _t((0,Mt.S)((0,a.W)(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return(0,Dt._)((0,Mt.S)((0,Ot.h)(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}var zt=(0,u.op)({norm_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ft(t=(0,s._1)(t,"x","norm"),e,n),i=a.shape;if(r){var o=(0,f.EC)(n,t.shape);i=Tt.rv(a.shape,o)}return(0,T.X)(a,i)}});var Bt=(0,u.op)({euclideanNorm_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return zt(t,"euclidean",e,n)}});var Lt=(0,u.op)({exp_:function(t){var e={x:(0,s._1)(t,"x","exp")};return i.BV.runKernel(o.NEP,e)}});var Pt=(0,u.op)({expandDims_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,s._1)(t,"x","expandDims","string_or_numeric");f.hu(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:e};return i.BV.runKernel(o.YFo,r,a)}});var Vt=(0,u.op)({expm1_:function(t){var e={x:(0,s._1)(t,"x","expm1")};return i.BV.runKernel(o.Y0y,e)}});var Wt=(0,u.op)({tile_:function(t,e){var n=(0,s._1)(t,"x","tile","string_or_numeric");f.hu(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")}));var r={x:n},a={reps:e};return i.BV.runKernel(o.n9L,r,a)}});var Ut=(0,u.op)({eye_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==e&&(e=t);for(var a=(0,G.f)([t,e],r),i=t<=e?t:e,o=0;o<i;++o)a.set(1,o,o);var s=(0,T.X)(a.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return Wt(Pt(s,0),[n[0],1,1]);if(2===n.length)return Wt(Pt(Pt(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Wt(Pt(Pt(Pt(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var jt=(0,u.op)({floor_:function(t){var e={x:(0,s._1)(t,"x","floor","float32")};return i.BV.runKernel(o.OR,e)}}),Ht=n(7145);var qt=(0,u.op)({gather_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=(0,s._1)(t,"x","gather"),u=(0,s._1)(e,"indices","gather","int32"),c={x:a,indices:u},l={axis:n,batchDims:r};return i.BV.runKernel(o.qi_,c,l)}});var Gt=(0,u.op)({greater_:function(t,e){var n=(0,s._1)(t,"a","greater","string_or_numeric"),r=(0,s._1)(e,"b","greater","string_or_numeric"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.iZT,c)}});var Zt=(0,u.op)({greaterEqual_:function(t,e){var n=(0,s._1)(t,"a","greaterEqual","string_or_numeric"),r=(0,s._1)(e,"b","greaterEqual","string_or_numeric"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.Acj,c)}}),Kt=n(6996);var Xt=(0,u.op)({isFinite_:function(t){var e={x:(0,s._1)(t,"x","isFinite")};return i.BV.runKernel(o.avt,e)}});var $t=(0,u.op)({isInf_:function(t){var e={x:(0,s._1)(t,"x","isInf")};return i.BV.runKernel(o.iWB,e)}});var Yt=(0,u.op)({isNaN_:function(t){var e={x:(0,s._1)(t,"x","isNaN")};return i.BV.runKernel(o.r7n,e)}}),Qt=n(4419);var Jt=(0,u.op)({less_:function(t,e){var n=(0,s._1)(t,"a","less","string_or_numeric"),r=(0,s._1)(e,"b","less","string_or_numeric"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.vtC,c)}});var te=(0,u.op)({lessEqual_:function(t,e){var n=(0,s._1)(t,"a","lessEqual","string_or_numeric"),r=(0,s._1)(e,"b","lessEqual","string_or_numeric"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.CAk,c)}});function ee(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:t,stop:e,num:n};return i.BV.runKernel(o.e7N,{},r)}var ne=(0,u.op)({localResponseNormalization_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,u=(0,s._1)(t,"x","localResponseNormalization");f.hu(4===u.rank||3===u.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(u.rank,".")})),f.hu(f.GN(e),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")}));var c=u,l=!1;3===u.rank&&(l=!0,c=(0,T.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));var p={x:c},h={depthRadius:e,bias:n,alpha:r,beta:a},d=i.BV.runKernel(o.eZ0,p,h);return l?(0,T.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var re=(0,u.op)({log_:function(t){var e={x:(0,s._1)(t,"x","log","float32")};return i.BV.runKernel(o.ZbH,e)}});var ae=(0,u.op)({log1p_:function(t){var e={x:(0,s._1)(t,"x","log1p")};return i.BV.runKernel(o.kU,e)}}),ie=n(6450),oe=n(4362);var se=(0,u.op)({softplus_:function(t){var e={x:(0,s._1)(t,"x","softplus")};return i.BV.runKernel(o.MRv,e)}});var ue=(0,u.op)({logSigmoid_:function(t){var e=(0,s._1)(t,"x","logSigmoid"),n=(0,ie.cb)((function(t){return{value:(0,oe.W)(se((0,oe.W)(t))),gradFunc:function(e){return(0,O.d)(e,(0,M.X)((0,oe.W)(t)))}}}));return n(e)}}),ce=n(4774);var le=(0,u.op)({logSoftmax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=(0,s._1)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));var r=(0,ie.cb)((function(t,n){var r=It(t,e,!0),a=(0,ce.l)(t,r),i=(0,ce.l)((0,E.p)(a,"float32"),re((0,Mt.S)(Lt(a),e,!0)));n([i]);return{value:i,gradFunc:function(t,n){var r=(0,x.Z)(n,1)[0],a=Lt(r);return(0,ce.l)(t,(0,O.d)((0,Mt.S)(t,e,!0),a))}}}));return r(n)}});var pe=(0,u.op)({logSumExp_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","logSumExp"),a=(0,f.EC)(e,r.shape),i=It(r,a,!0),o=(0,ce.l)(r,i),u=Lt(o),c=(0,Mt.S)(u,a),l=re(c),h=(0,p.I)((0,T.X)(i,l.shape),l);if(n){var d=(0,Tt.rv)(h.shape,a);return(0,T.X)(h,d)}return h}});var fe=(0,u.op)({logicalAnd_:function(t,e){var n=(0,s._1)(t,"a","logicalAnd","bool"),r=(0,s._1)(e,"b","logicalAnd","bool");(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var a={a:n,b:r};return i.BV.runKernel(o.PYm,a)}});var he=(0,u.op)({logicalNot_:function(t){var e={x:(0,s._1)(t,"x","logicalNot","bool")};return i.BV.runKernel(o.VfG,e)}});var de=(0,u.op)({logicalOr_:function(t,e){var n=(0,s._1)(t,"a","logicalOr","bool"),r=(0,s._1)(e,"b","logicalOr","bool");(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var a={a:n,b:r};return i.BV.runKernel(o.MZg,a)}});var me=(0,u.op)({logicalXor_:function(t,e){var n=(0,s._1)(t,"a","logicalXor","bool"),r=(0,s._1)(e,"b","logicalXor","bool");return(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape),fe(de(t,e),he(fe(t,e)))}}),ve=2147483648;var ge=(0,u.op)({searchSorted_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",r=(0,s._1)(t,"sortedSequence","searchSorted"),a=(0,s._1)(e,"values","searchSorted"),u=r.shape[r.shape.length-1],c=a.shape[a.shape.length-1],l=(0,T.X)(r,[-1,u]),p=(0,T.X)(a,[-1,c]);if(l.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(l.shape[0]!==p.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,f.NA)(p.shape)>=ve)throw new Error("values tensor size must less than ".concat(ve));if(l.shape[1]>=ve)throw new Error("trailing dim_size must less than ".concat(ve," for int32 output type, was ").concat(l.shape[1]));var h={sortedSequence:l,values:p},d={side:n};return i.BV.runKernel(o.nr8,h,d)}});function ye(t,e){return ge(t,e,"left")}var be=(0,u.op)({maxPool_:function(t,e,n,r,a){var u=(0,s._1)(t,"x","maxPool"),c=u,l=!1;3===u.rank&&(l=!0,c=(0,T.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]])),f.hu(4===c.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(c.rank,".")})),f.hu(C.jT(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),C.m("maxPool",r,a);var p={x:c},h={filterSize:e,strides:n,pad:r,dimRoundingMode:a},d=i.BV.runKernel(o.mTV,p,h);return l?(0,T.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var we=(0,u.op)({maxPool3d_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",c=(0,s._1)(t,"x","maxPool3d"),l=c,p=!1;4===c.rank&&(p=!0,l=(0,T.X)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),f.hu(5===l.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(l.rank,".")})),f.hu("NDHWC"===u,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(u)})),(0,C.m)("maxPool3d",r,a);var h={x:l},d={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:u},m=i.BV.runKernel(o.OAf,h,d);return p?(0,T.X)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}});var xe=(0,u.op)({maxPoolWithArgmax_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=(0,s._1)(t,"x","maxPoolWithArgmax"),c={x:u},l={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},p=i.BV.runKernel(o.vFR,c,l);return{result:p[0],indexes:p[1]}}}),ke=n(705);var Se=(0,u.op)({mean_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","mean"),a={x:r},u={axis:e,keepDims:n};return i.BV.runKernel(o.q2K,a,u)}});function Ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){var n=Ne(t,"float32"),r=Ne(t,"float32");return(0,$.P)(n,r)}var a=(0,f.wT)((0,f.NA)(t),e);return i.BV.makeTensor(a,t,e)}function Ee(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){var n=Ee(t,"float32"),r=Ne(t,"float32");return(0,$.P)(n,r)}var a=(0,f.p8)((0,f.NA)(t),e);return i.BV.makeTensor(a,t,e)}var Ce=n(4376);function Te(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.indexing,a=void 0===r?"xy":r;if("xy"!==a&&"ij"!==a)throw new TypeError("".concat(a," is not a valid third argument to meshgrid"));if(void 0===t)return[];var i=(0,s._1)(t,"x","meshgrid",t instanceof Ce.es?t.dtype:"float32");if(void 0===e)return[i];var o=(0,s._1)(e,"y","meshgrid",e instanceof Ce.es?e.dtype:"float32"),u=(0,f.NA)(i.shape),c=(0,f.NA)(o.shape);return"xy"===a?(i=(0,T.X)(i,[1,-1]),o=(0,T.X)(o,[-1,1]),[(0,D.O)(Ee([c,1],i.dtype),i),(0,D.O)(o,Ee([1,u],o.dtype))]):(i=(0,T.X)(i,[-1,1]),o=(0,T.X)(o,[1,-1]),[(0,D.O)(i,Ee([1,c],i.dtype)),(0,D.O)(Ee([u,1],o.dtype),o)])}var Ie=(0,u.op)({minimum_:function(t,e){var n=(0,s._1)(t,"a","minimum"),r=(0,s._1)(e,"b","minimum"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],"bool"===n.dtype&&(n=(0,E.p)(n,"int32"),r=(0,E.p)(r,"int32")),(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.q8u,c)}});var _e=(0,u.op)({mirrorPad_:function(t,e,n){f.hu("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=(0,s._1)(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");f.hu(e.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(e.length,".")}));for(var a="reflect"===n?1:0,u=function(t){f.hu(2===e[t].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),f.hu(e[t][0]>=0&&e[t][0]<=r.shape[t]-a&&e[t][1]>=0&&e[t][1]<=r.shape[t]-a,(function(){return"Padding in dimension ".concat(t," cannot be greater than or equal ")+"to ".concat(r.shape[t]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},c=0;c<r.rank;c++)u(c);var l={paddings:e,mode:n},p={x:r};return i.BV.runKernel(o.jQs,p,l)}});var Ae=(0,u.op)({mod_:function(t,e){var n=(0,s._1)(t,"a","mod"),r=(0,s._1)(e,"b","mod"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2),c={a:n=u[0],b:r=u[1]};return i.BV.runKernel(o.Vbg,c)}});var Re=(0,u.op)({moments_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=(0,s._1)(t,"x","moments");var r=(0,f.EC)(e,t.shape),a=Se(t,r,n),i=a.shape;n||(i=(0,Tt.rv)(a.shape,r));var o=(0,Ot.h)((0,ce.l)((0,E.p)(t,"float32"),(0,T.X)(a,i))),u=Se(o,r,n);return{mean:a,variance:u}}});var De=(0,u.op)({multiRNNCell_:function(t,e,n,r){for(var a=(0,s._1)(e,"data","multiRNNCell"),i=(0,s.sI)(n,"c","multiRNNCell"),o=(0,s.sI)(r,"h","multiRNNCell"),u=a,c=[],l=0;l<t.length;l++){var p=t[l](u,i[l],o[l]);c.push(p[0]),c.push(p[1]),u=p[1]}for(var f=[],h=[],d=0;d<c.length;d+=2)f.push(c[d]),h.push(c[d+1]);return[f,h]}});var Oe=(0,u.op)({multinomial_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,s._1)(t,"logits","multinomial"),u=a.size,c=a.rank;if(u<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(u,"."));if(c>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(c));n=n||Math.random();var l=1===c?(0,T.X)(a,[1,-1]):a,p={logits:l},f={numSamples:e,seed:n,normalized:r},h=i.BV.runKernel(o.NZg,p,f);return 1===c?(0,T.X)(h,[h.size]):h}});var Me=(0,u.op)({notEqual_:function(t,e){var n=(0,s._1)(t,"a","notEqual","string_or_numeric"),r=(0,s._1)(e,"b","notEqual","string_or_numeric"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o.yQU,c)}}),Fe=n(4326);var ze=(0,u.op)({onesLike_:function(t){var e={x:(0,s._1)(t,"x","onesLike")};return i.BV.runKernel(o.qWM,e)}});var Be=(0,u.op)({outerProduct_:function(t,e){var n=(0,s._1)(t,"v1","outerProduct"),r=(0,s._1)(e,"v2","outerProduct");f.hu(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=(0,T.X)(n,[-1,1]),i=(0,T.X)(r,[1,-1]);return(0,D.O)(a,i)}});var Le=(0,u.op)({pad_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(0,s._1)(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:e,constantValue:n},u={x:r};return i.BV.runKernel(o.lyA,u,a)}});var Pe=(0,u.op)({pad1d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Le(t,[e],n)}});var Ve=(0,u.op)({pad2d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Le(t,e,n)}});var We=(0,u.op)({pad3d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Le(t,e,n)}});var Ue=(0,u.op)({pad4d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,f.hu)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Le(t,e,n)}});var je=(0,u.op)({spaceToBatchND_:function(t,e,n){var r=(0,s._1)(t,"x","spaceToBatchND");f.hu(r.rank>=1+e.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length)})),f.hu(n.length===e.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)})),f.hu(r.shape.reduce((function(t,r,a){return a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]===0:t}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())}));var a={x:r},u={blockShape:e,paddings:n};return i.BV.runKernel(o.TQc,a,u)}});var He=(0,u.op)({pool_:function(t,e,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var u=(0,s._1)(t,"x","maxPool"),c=u,l=!1;3===u.rank&&(l=!0,c=(0,T.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]])),f.hu(C.jT(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var p,h=C.Xw(c.shape,e,i,a,r),d=[h.dilationHeight,h.dilationWidth];p="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),a=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],a[e]]}))}([h.filterHeight,h.filterWidth],d):[[0,0],[0,0]];var m=1===d[0]&&1===d[1],v=function(t,e,n){var r=n.map((function(t){return t[0]})),a=n.map((function(t){return t[1]})),i=t.concat(r,a),o=e.map((function(t,e){return(t-i[e]%t)%t})),s=a.map((function(t,e){return t+o[e]})),u=e.map((function(t,e){return[r[e],s[e]]})),c=e.map((function(t,e){return[0,o[e]]}));return[u,c]}([h.inHeight,h.inWidth],d,p),g=(0,x.Z)(v,2),y=g[0],b=g[1],w=m?r:"valid",k=m?c:je(c,d,y),S=("avg"===n?function(){return I(k,e,i,w,o)}:function(){return be(k,e,i,w,o)})(),N=m?S:L(S,d,b);return l?(0,T.X)(N,[N.shape[1],N.shape[2],N.shape[3]]):N}}),qe=n(6859),Ge=n(4600);var Ze=(0,u.op)({prod_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,s._1)(t,"x","prod");"bool"===r.dtype&&(r=(0,E.p)(r,"int32"));var a={x:r},u={axis:e,keepDims:n};return i.BV.runKernel(o.DlI,a,u)}});var Ke=(0,u.op)({raggedGather_:function(t,e,n,r){var a={paramsNestedSplits:t.map((function(t,e){return(0,s._1)(t,"tensors".concat(e),"raggedGather","int32")})),paramsDenseValues:(0,s._1)(e,"paramsDenseValues","raggedGather"),indices:(0,s._1)(n,"indices","raggedGather","int32")},u={outputRaggedRank:r},c=i.BV.runKernel(o.dDz,a,u);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}});var Xe=(0,u.op)({raggedTensorToTensor_:function(t,e,n,r,a){var u=(0,s._1)(t,"shape","raggedTensorToTensor","int32"),c=(0,s._1)(e,"values","raggedTensorToTensor"),l={shape:u,values:c,defaultValue:(0,s._1)(n,"defaultValue","raggedTensorToTensor",c.dtype),rowPartitionTensors:r.map((function(t,e){return(0,s._1)(t,"tensors".concat(e),"raggedTensorToTensor","int32")}))},p={rowPartitionTypes:a};return i.BV.runKernel(o.BiW,l,p)}});var $e=(0,u.op)({rand_:function(t,e,n){var r=(0,f.NA)(t),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var o=0;o<r;o++)a[o]=e();return i.BV.makeTensor(a,t,n)}}),Ye=n(5671),Qe=n(3144),Je=n(6699),tn=function(){function t(e,n,r,a,i){(0,Ye.Z)(this,t),this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=Je.alea(o.toString())}return(0,Qe.Z)(t,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)}},{key:"convertValue",value:function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}},{key:"isValidTruncated",value:function(t){return t<=this.upper&&t>=this.lower}}]),t}(),en=function(){function t(e,n,r,a){(0,Ye.Z)(this,t),this.alpha=e,this.beta=1/n,this.dtype=r;var i=a||Math.random();this.randu=Je.alea(i.toString()),this.randn=new tn(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return(0,Qe.Z)(t,[{key:"nextValue",value:function(){for(var t,e,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-i+Math.log(i)),(a=this.randu())<e||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(t){return"float32"===this.dtype?t:Math.round(t)}}]),t}(),nn=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if((0,Ye.Z)(this,t),this.canReturnFloat=function(){return null==e.dtype||"float32"===e.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=Je.alea(i)}return(0,Qe.Z)(t,[{key:"convertValue",value:function(t){return this.canReturnFloat()?t:Math.round(t)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),t}();var rn=(0,u.op)({randomGamma_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new en(e,n,r,a),o=(0,G.f)(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var an=(0,u.op)({randomNormal_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new tn(e,n,r,!1,a),o=(0,G.f)(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var on=(0,u.op)({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return an(t,0,1,e,n)}});var sn=(0,u.op)({randomUniform_:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0,i=(0,G.f)(t,r),o=new nn(e,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});function un(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:t,stop:e,step:n,dtype:r};return i.BV.runKernel(o.e6w,{},a)}var cn=n(6972);var ln=(0,u.op)({reciprocal_:function(t){var e={x:(0,s._1)(t,"x","reciprocal")};return i.BV.runKernel(o.$HU,e)}}),pn=n(7539),fn=n(5900);var hn=(0,u.op)({reverse_:function(t,e){var n={x:(0,s._1)(t,"x","reverse")},r={dims:e};return i.BV.runKernel(o.mKl,n,r)}});var dn=(0,u.op)({reverse1d_:function(t){var e=(0,s._1)(t,"x","reverse");return f.hu(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")})),hn(e,0)}});var mn=(0,u.op)({reverse2d_:function(t,e){var n=(0,s._1)(t,"x","reverse");return f.hu(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),hn(n,e)}});var vn=(0,u.op)({reverse3d_:function(t,e){var n=(0,s._1)(t,"x","reverse");return f.hu(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),hn(n,e)}});var gn=(0,u.op)({reverse4d_:function(t,e){var n=(0,s._1)(t,"x","reverse");return f.hu(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),hn(n,e)}});var yn=(0,u.op)({round_:function(t){var e={x:(0,s._1)(t,"x","round")};return i.BV.runKernel(o.e07,e)}});var bn=(0,u.op)({rsqrt_:function(t){var e={x:(0,s._1)(t,"x","rsqrt","float32")};return i.BV.runKernel(o.bV0,e)}});var wn=(0,u.op)({selu_:function(t){var e={x:(0,s._1)(t,"x","selu")};return i.BV.runKernel(o.oFR,e)}});var xn=(0,u.op)({separableConv2d_:function(t,e,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",u=(0,s._1)(t,"x","separableConv2d"),c=(0,s._1)(e,"depthwiseFilter","separableConv2d"),l=(0,s._1)(n,"pointwiseFilter","separableConv2d"),p=u,h=!1;if(3===u.rank&&(h=!0,p=(0,T.X)(u,[1,u.shape[0],u.shape[1],u.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");f.hu(4===p.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")})),f.hu(4===c.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(c.rank,".")})),f.hu(4===l.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(c.rank,".")})),f.hu(1===l.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],".")})),f.hu(1===l.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],".")}));var d=c.shape[2],m=c.shape[3];f.hu(l.shape[2]===d*m,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*m,", ")+"but got ".concat(l.shape[2],".")}));var v=dt(p,c,r,a,o,i),g=1,y=et(v,l,g,"valid",o);return h?(0,T.X)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}}),kn=n(4165),Sn=n(5861);function Nn(){return Nn=(0,Sn.Z)((0,kn.Z)().mark((function t(e,n){var r,a,i,o,u,c,l,p,h,d,m;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(0,s._1)(e,"x","setdiff1d"),a=(0,s._1)(n,"y","setdiff1d"),f.hu(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),f.hu(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),f.hu(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),t.next=7,r.data();case 7:return i=t.sent,t.next=10,a.data();case 10:for(o=t.sent,u=new Set(o),c=0,l=0;l<i.length;l++)u.has(i[l])||c++;for(p=new Ce.YD([c],r.dtype),h=new Ce.YD([c],"int32"),d=0,m=0;d<i.length;d++)u.has(i[d])||(p.values[m]=i[d],h.values[m]=d,m++);return t.abrupt("return",[p.toTensor(),h.toTensor()]);case 18:case"end":return t.stop()}}),t)}))),Nn.apply(this,arguments)}var En=function(t,e){return Nn.apply(this,arguments)};var Cn=(0,u.op)({sign_:function(t){var e={x:(0,s._1)(t,"x","sign")};return i.BV.runKernel(o.i5y,e)}});var Tn=(0,u.op)({sin_:function(t){var e={x:(0,s._1)(t,"x","sin","float32")};return i.BV.runKernel(o.RQH,e)}});var In=(0,u.op)({sinh_:function(t){var e={x:(0,s._1)(t,"x","sinh")};return i.BV.runKernel(o.wYB,e)}});var _n=(0,u.op)({slice1d_:function(t,e,n){var r=(0,s._1)(t,"x","slice1d");return f.hu(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),F(r,[e],[n])}});var An=(0,u.op)({slice2d_:function(t,e,n){var r=(0,s._1)(t,"x","slice2d");return f.hu(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),F(r,e,n)}});var Rn=(0,u.op)({slice3d_:function(t,e,n){var r=(0,s._1)(t,"x","slice3d");return f.hu(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),F(r,e,n)}});var Dn=(0,u.op)({slice4d_:function(t,e,n){var r=(0,s._1)(t,"x","slice4d");return f.hu(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),F(r,e,n)}});var On=(0,u.op)({softmax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=(0,s._1)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));var r={logits:n},a={dim:e};return i.BV.runKernel(o.Gcp,r,a)}});var Mn=(0,u.op)({fft_:function(t){(0,f.hu)("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return i.BV.runKernel(o.vwp,e)}});var Fn=(0,u.op)({ifft_:function(t){(0,f.hu)("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e={input:t};return i.BV.runKernel(o.Qg5,e)}});var zn=(0,u.op)({irfft_:function(t){var e,n=t.shape[t.shape.length-1],r=t.size/n;if(n<=2){var a=(0,T.X)(t,[r,n]);e=Fn(a)}else{var i=[r,2*(n-1)],o=(0,T.X)((0,cn.k)(t),[r,n]),s=(0,T.X)((0,Kt.a)(t),[r,n]),u=hn(F(o,[0,1],[r,n-2]),1),c=(0,O.d)(hn(F(s,[0,1],[r,n-2]),1),(0,Rt.i)(-1)),l=R([o,u],1),p=R([s,c],1),f=(0,T.X)((0,$.P)(l,p),[i[0],i[1]]);e=Fn(f)}if(e=(0,cn.k)(e),3===t.rank&&0!==t.shape[0]){var h=e,d=t.shape[0];e=(0,T.X)(e,[d,e.shape[0]/d,e.shape[1]]),h.dispose()}return e}});var Bn=(0,u.op)({split_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(0,s._1)(t,"x","split"),a={x:r},u={numOrSizeSplits:e,axis:n};return i.BV.runKernel(o.L8s,a,u)}});var Ln=(0,u.op)({rfft_:function(t,e){(0,f.hu)("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(t.dtype)}));var n,r=t.shape[t.shape.length-1],a=t.size/r;if(null!=e&&e<r){var i=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=F(t,i,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=R([t,Ne(s)],t.shape.length-1),r=e}else n=t;var u=(0,xt.P)(n),c=(0,T.X)((0,$.P)(n,u),[a,r]),l=Mn(c),p=Math.floor(r/2)+1,h=(0,cn.k)(l),d=(0,Kt.a)(l),m=Bn(h,[p,r-p],h.shape.length-1),v=Bn(d,[p,r-p],d.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=p,(0,T.X)((0,$.P)(m[0],v[0]),g)}});var Pn=(0,u.op)({squaredDifference_:function(t,e){var n=(0,s._1)(t,"a","squaredDifference"),r=(0,s._1)(e,"b","squaredDifference"),a=(0,k.makeTypesMatch)(n,r),u=(0,x.Z)(a,2);n=u[0],r=u[1],(0,yt.assertAndGetBroadcastShape)(n.shape,r.shape);var c={a:n,b:r};return i.BV.runKernel(o._tC,c,{})}});var Vn=(0,u.op)({squeeze_:function(t,e){var n=(0,s._1)(t,"x","squeeze","string_or_numeric");return(0,T.X)(n,(0,f.bp)(n.shape,e).newShape)}});var Wn=(0,u.op)({stack_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,s.sI)(t,"tensors","stack","string_or_numeric");f.hu(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&f.hu(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:e};return i.BV.runKernel(o.QiL,r,a)}}),Un=n(4031);var jn=(0,u.op)({stridedSlice_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,f=(0,s._1)(t,"x","stridedSlice","string_or_numeric"),h={x:f},d={begin:e,end:n,strides:r,beginMask:a,endMask:u,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:p};return i.BV.runKernel(o.jQk,h,d)}});var Hn=(0,u.op)({tan_:function(t){var e={x:(0,s._1)(t,"x","tan","float32")};return i.BV.runKernel(o.sEM,e)}}),qn=n(2442),Gn=n(7960);function Zn(t,e){(0,f.Cq)(t);var n=(0,s.C)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,Gn.H)(t,null,n,e)}function Kn(t,e,n){if((0,f.Cq)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=(0,s.C)(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,Gn.H)(t,e,r,n)}var Xn=n(3123);function $n(t,e,n){if((0,f.Cq)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=(0,s.C)(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,Gn.H)(t,e,r,n)}function Yn(t,e,n){if((0,f.Cq)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=(0,s.C)(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,Gn.H)(t,e,r,n)}function Qn(t,e,n){if((0,f.Cq)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=(0,s.C)(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,(0,Gn.H)(t,e,r,n)}var Jn=(0,u.op)({topk_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(0,s._1)(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(e));var u={x:r},c={k:e,sorted:n},l=i.BV.runKernel(o.cWu,u,c),p=(0,x.Z)(l,2),f=p[0],h=p[1];return{values:f,indices:h}}});var tr=(0,u.op)({truncatedNormal_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new tn(e,n,r,!0,a),o=(0,G.f)(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var er=(0,u.op)({unique_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,s._1)(t,"x","unique","string_or_numeric");(0,f.hu)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:e},u=i.BV.runKernel(o.kpP,r,a),c=(0,x.Z)(u,2),l=c[0],p=c[1];return{values:l,indices:p}}});var nr=(0,u.op)({unsortedSegmentSum_:function(t,e,n){var r=(0,s._1)(t,"x","unsortedSegmentSum"),a=(0,s._1)(e,"segmentIds","unsortedSegmentSum","int32");(0,f.hu)((0,f.GN)(n),(function(){return"numSegments must be of dtype int"}));var u={x:r,segmentIds:a},c={numSegments:n};return i.BV.runKernel(o.Qvg,u,c)}});var rr=(0,u.op)({unstack_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,s._1)(t,"x","unstack","string_or_numeric");f.hu(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:e};return i.BV.runKernel(o.ToN,r,a)}});function ar(t,e){return ge(t,e,"right")}function ir(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return i.BV.makeVariable(t,e,n,r)}var or=n(4189);function sr(){return(sr=(0,Sn.Z)((0,kn.Z)().mark((function t(e){var n,r,a;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,s._1)(e,"condition","whereAsync","bool"),t.next=3,n.data();case 3:return r=t.sent,a=(0,or.Z)(n.shape,r),e!==n&&n.dispose(),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ur=function(t){return sr.apply(this,arguments)};function cr(){return cr=(0,Sn.Z)((0,kn.Z)().mark((function t(e,n,r){var a,i,o,u,c,l,p,h,d,m,v,g,y;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=(0,s._1)(e,"tensor","boolMask"),i=(0,s._1)(n,"mask","boolMask","bool"),o=null==r?0:r,u=i.rank,c=a.shape,f.hu(u>0,(function(){return"mask cannot be scalar"})),f.k5(c.slice(o,o+u),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,p=o;p<o+u;p++)l*=c[p];return h=c.slice(0,o).concat([l],c.slice(o+u)),d=(0,T.X)(a,h),m=(0,T.X)(i,[-1]),t.next=14,ur(m);case 14:return v=t.sent,g=Vn(v,[1]),y=qt(d,g,o),e!==a&&a.dispose(),n!==i&&i.dispose(),g.dispose(),d.dispose(),m.dispose(),v.dispose(),t.abrupt("return",y);case 24:case"end":return t.stop()}}),t)}))),cr.apply(this,arguments)}var lr=function(t,e,n){return cr.apply(this,arguments)},pr=n(1240);var fr=(0,u.op)({movingAverage_:function(t,e,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=(0,s._1)(t,"v","movingAverage"),o=(0,s._1)(e,"x","movingAverage"),u=(0,s._1)(n,"decay","movingAverage");(0,k.assertTypesMatch)(i,o),f.hu(f.cO(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var c=(0,Rt.i)(1),l=(0,ce.l)(c,u),h=(0,O.d)((0,ce.l)(o,i),l);if(a){f.hu(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var d=(0,s._1)(r,"step","movingAverage");h=(0,gt.h)(h,(0,ce.l)(c,(0,At.s)(u,d)))}return(0,p.I)(i,h)}}),hr=n(8604);var dr=(0,u.op)({scatterND_:function(t,e,n){var r=(0,s._1)(t,"indices","scatterND","int32"),a=(0,s._1)(e,"updates","scatterND");hr.validateInput(a,r,n);var u={indices:r,updates:a},c={shape:n};return i.BV.runKernel(o.xQA,u,c)}});function mr(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));var a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=e.size;if(0!==e.rank&&(1!==e.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(a,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var vr=(0,u.op)({sparseToDense_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=(0,s._1)(t,"sparseIndices","sparseToDense","int32"),u=(0,s._1)(e,"sparseValues","sparseToDense","string_or_numeric"),c=(0,s._1)(r,"defaultValue","sparseToDense",u.dtype);mr(a,u,n,c);var l={sparseIndices:a,sparseValues:u,defaultValue:c},p={outputShape:n};return i.BV.runKernel(o.D2d,l,p)}});var gr=(0,u.op)({gatherND_:function(t,e){var n=(0,s._1)(e,"indices","gatherND","int32"),r={params:(0,s._1)(t,"x","gatherND","string_or_numeric"),indices:n};return i.BV.runKernel(o.q1x,r)}});var yr=(0,u.op)({dropout_:function(t,e,n,r){var a=(0,s._1)(t,"x","dropout");if(f.hu("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),f.hu(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(e,".")})),0===e)return t instanceof Ce.es?a.clone():a;var i=function(t,e){if(null==e)return t.shape.slice();if(f.cO(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(a,n),o=1-e,u=(0,gt.h)(jt((0,p.I)(sn(i,0,1,"float32",r),o)),o);return(0,O.d)(a,u)}});function br(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function wr(t,e,n){for(var r=1-t%2,a=new Float32Array(t),i=0;i<t;++i){var o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return Zn(a,"float32")}function xr(){return xr=(0,Sn.Z)((0,kn.Z)().mark((function t(e,n){var r,a,i,o,u,c,l,p,h,d,m,v,g,y,b,w=arguments;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=w.length>2&&void 0!==w[2]?w[2]:1,a=(0,s._1)(e,"predictions","inTopK"),i=(0,s._1)(n,"targets","inTopK"),(0,f.hu)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),(0,f.hu)(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),(0,f.k5)(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],(0,f.hu)(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),t.next=10,a.data();case 10:return u=t.sent,t.next=13,i.data();case 13:c=t.sent,l=u.length/o,p=o,h=(0,f.WP)("bool",l),d=0;case 17:if(!(d<l)){t.next=35;break}for(m=d*p,v=u.subarray(m,m+p),g=[],y=0;y<v.length;y++)g.push({value:v[y],index:y});g.sort((function(t,e){return e.value-t.value})),h[d]=0,b=0;case 25:if(!(b<r)){t.next=32;break}if(g[b].index!==c[d]){t.next=29;break}return h[d]=1,t.abrupt("break",32);case 29:b++,t.next=25;break;case 32:d++,t.next=17;break;case 35:return e!==a&&a.dispose(),n!==i&&i.dispose(),t.abrupt("return",(0,qn.X)(h,i.shape,"bool"));case 38:case"end":return t.stop()}}),t)}))),xr.apply(this,arguments)}var kr=function(t,e){return xr.apply(this,arguments)};var Sr=(0,u.op)({conv2DBackpropFilter_:function(t,e,n,r,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",u=arguments.length>6?arguments[6]:void 0,c=t;3===t.rank&&(c=(0,T.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var l=e;3===l.rank&&(l=(0,T.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]])),f.hu(4===c.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(c.shape,".")})),f.hu(4===l.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(l.shape,".")})),f.hu(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var p="NHWC"===s?c.shape[3]:c.shape[1],h="NHWC"===s?l.shape[3]:l.shape[1];f.hu(p===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(p,") must ")+"match input depth in filter (".concat(n[2],".")})),f.hu(h===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(h,") must ")+"match output depth for filter (".concat(n[3],").")})),C.m("conv2dDerFilter",a,u);var d={x:c,dy:l},m={strides:r,pad:a,dataFormat:s,dimRoundingMode:u,filterShape:n};return i.BV.runKernel(o.wUP,d,m)}}),Nr=n(5171);var Er=(0,u.op)({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,u=t.dataFormat,c=void 0===u?"NHWC":u,l=t.dilations,h=void 0===l?[1,1]:l,d=t.dimRoundingMode,m=t.bias,v=t.activation,g=void 0===v?"linear":v,y=t.preluActivationWeights,b=t.leakyreluAlpha;if(g=g||"linear",!1===(0,Nr.uy)(i.BV.state.gradientDepth,g)){f.hu("NHWC"===c,(function(){return"Error in fused conv2d: got dataFormat of ".concat(c," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var w=et(e,n,r,a,c,h,d);return null!=m&&(w=(0,p.I)(w,m)),(0,Nr.QH)(w,g,y,b)}var S=(0,s._1)(e,"x","conv2d","float32"),N=(0,s._1)(n,"filter","conv2d","float32"),E=S,I=!1;3===S.rank&&(I=!0,E=(0,T.X)(S,[1,S.shape[0],S.shape[1],S.shape[2]])),f.hu(4===E.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(E.rank,".")})),f.hu(4===N.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(N.rank,".")})),C.m("fused conv2d",a,d);var _="NHWC"===c?E.shape[3]:E.shape[1];f.hu(N.shape[2]===_,(function(){return"Error in conv2d: depth of input (".concat(_,") must match ")+"input depth for filter ".concat(N.shape[2],".")})),f.hu(C.jT(r,h),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(h,"'")}));var A,R,D=C.Ix(E.shape,N.shape,r,h,a,d);if(null!=m){A=(0,s._1)(m,"bias","fused conv2d");var O=(0,k.makeTypesMatch)(A,S),M=(0,x.Z)(O,1);A=M[0],"NHWC"===c?yt.assertAndGetBroadcastShape(D.outShape,A.shape):(f.hu(A.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(A.shape.length,".")})),f.hu(0===A.shape.length||A.shape[0]===D.outChannels||1===A.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(A.shape,") is not ")+"compatible with the number of output channels "+"(".concat(D.outChannels,")")})))}if(null!=y){var F=y.shape;if(f.hu(F.length<=1||3===F.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(F.length,".")})),1===F.length)f.hu(1===F[0]||F[0]===D.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(F,") is not compatible with the number of output ")+"channels (".concat(D.outChannels,").")}));else if(3===F.length)try{yt.assertAndGetBroadcastShape(F,D.outShape)}catch(U){var z="Error in fused conv2d: PReLU activation weights (".concat(F,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(D.outShape,").");throw Error(z)}R=(0,s._1)(y,"prelu weights","fused conv2d")}var B=function(t,e){f.hu("NHWC"===c,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(c," but only NHWC is currently supported.")}));var n=(0,x.Z)(e,4),i=n[0],o=n[1],s=n[2],u=n[3],l=(0,Nr.Fr)(t,s,g);f.hu(C.I0(h),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(h,"'")}));var p=[rt(o.shape,l,i,r,a),Sr(o,l,i.shape,r,a)];if(null!=u){var d=(0,Nr.pf)(u,l);p.push(d)}return p},L={x:E,filter:N,bias:A,preluActivationWeights:R},P={strides:r,pad:a,dataFormat:c,dilations:h,dimRoundingMode:d,activation:g,leakyreluAlpha:b};if(null==m){var V=(0,ie.cb)((function(t,e,n){var r=i.BV.runKernel(o._V0,L,P);return n([e,t,r]),I&&(r=(0,T.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:B}}));return V(E,N)}var W=(0,ie.cb)((function(t,e,n,r){var a=i.BV.runKernel(o._V0,L,P);return r([e,t,a,n]),I&&(a=(0,T.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:B}}));return W(E,N,A)}});var Cr=(0,u.op)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],u=arguments.length>6?arguments[6]:void 0,c=t;3===t.rank&&(c=(0,T.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var l=e;3===l.rank&&(l=(0,T.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var p={x:c,dy:l},f={strides:r,pad:a,dimRoundingMode:u,dilations:s,filterShape:n};return i.BV.runKernel(o.sL$,p,f)}});var Tr=(0,u.op)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],u=arguments.length>6?arguments[6]:void 0,c=e,l=!1;3===e.rank&&(l=!0,c=(0,T.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var p={dy:c,filter:n},f={strides:r,pad:a,dimRoundingMode:u,dilations:s,inputShape:t},h=i.BV.runKernel(o.y7R,p,f);return l?(0,T.X)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});var Ir=(0,u.op)({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,u=t.dataFormat,c=void 0===u?"NHWC":u,l=t.dilations,h=void 0===l?[1,1]:l,d=t.dimRoundingMode,m=t.bias,v=t.activation,g=void 0===v?"linear":v,y=t.preluActivationWeights,b=t.leakyreluAlpha;if(!1===(0,Nr.uy)(i.BV.state.gradientDepth,g)){var w=dt(e,n,r,a,c,h,d);return null!=m&&(w=(0,p.I)(w,m)),(0,Nr.QH)(w,g,y,b)}var S=(0,s._1)(e,"x","depthwiseConv2d","float32"),N=(0,s._1)(n,"filter","depthwiseConv2d","float32"),E=S,I=!1;3===S.rank&&(I=!0,E=(0,T.X)(S,[1,S.shape[0],S.shape[1],S.shape[2]])),f.hu(4===E.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(E.rank,".")})),f.hu(4===N.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(N.rank,".")})),f.hu(E.shape[3]===N.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(E.shape[3],") must match the inChannels dimension in ")+"filter ".concat(N.shape[2],".")})),null==h&&(h=[1,1]),f.hu(C.jT(r,h),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(h,"'")})),C.m("fused depthwiseConv2d",a,d);var _,A,R=C.Ix(E.shape,N.shape,r,h,a,d,!0);if(null!=m){_=(0,s._1)(m,"bias","fused conv2d");var D=(0,k.makeTypesMatch)(_,S),O=(0,x.Z)(D,1);_=O[0],yt.assertAndGetBroadcastShape(R.outShape,_.shape)}null!=y&&(A=(0,s._1)(y,"prelu weights","fused depthwiseConv2d"));var M=function(t,e){f.hu(C.I0(h),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(h,"'")}));var n=(0,x.Z)(e,4),i=n[0],o=n[1],s=n[2],u=n[3],c=(0,Nr.Fr)(t,s,g),l=Tr(o.shape,c,i,r,a,h,d),p=Cr(o,c,i.shape,r,a,h,d);return null!=u?[l,p,(0,Nr.pf)(_,c)]:[l,p]},F={x:E,filter:N,bias:_,preluActivationWeights:A},z={strides:r,pad:a,dataFormat:c,dilations:h,dimRoundingMode:d,activation:g,leakyreluAlpha:b};if(null==m){var B=(0,ie.cb)((function(t,e,n){var r=i.BV.runKernel(o.luS,F,z);return n([e,t,r]),I&&(r=(0,T.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:M}}));return B(E,N)}var L=(0,ie.cb)((function(t,e,n,r){var a=i.BV.runKernel(o.luS,F,z);return r([e,t,a,n]),I&&(a=(0,T.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:M}}));return L(E,N,_)}});var _r=(0,u.op)({fusedMatMul_:function(t){var e=t.a,n=t.b,r=t.transposeA,a=void 0!==r&&r,u=t.transposeB,c=void 0!==u&&u,l=t.bias,h=t.activation,d=void 0===h?"linear":h,m=t.preluActivationWeights,v=t.leakyreluAlpha,g=void 0===v?.2:v;if(!1===(0,Nr.uy)(i.BV.state.gradientDepth,d)){var y=(0,D.O)(e,n,a,c);return null!=l&&(y=(0,p.I)(y,l)),(0,Nr.QH)(y,d,m,g)}var b=(0,s._1)(e,"a","fused matMul"),w=(0,s._1)(n,"b","fused matMul"),S=(0,k.makeTypesMatch)(b,w),N=(0,x.Z)(S,2);b=N[0],w=N[1];var E=a?b.shape[b.rank-2]:b.shape[b.rank-1],C=c?w.shape[w.rank-1]:w.shape[w.rank-2],I=a?b.shape[b.rank-1]:b.shape[b.rank-2],_=c?w.shape[w.rank-2]:w.shape[w.rank-1],A=b.shape.slice(0,-2),R=w.shape.slice(0,-2),O=f.NA(A),M=f.NA(R);f.hu(E===C,(function(){return"Error in fused matMul: inner shapes (".concat(E,") and (")+"".concat(C,") of Tensors with shapes ").concat(b.shape," and ")+"".concat(w.shape," and transposeA=").concat(a)+" and transposeB=".concat(c," must match.")}));var F,z,B=yt.assertAndGetBroadcastShape(b.shape.slice(0,-2),w.shape.slice(0,-2)).concat([I,_]),L=a?(0,T.X)(b,[O,E,I]):(0,T.X)(b,[O,I,E]),P=c?(0,T.X)(w,[M,_,C]):(0,T.X)(w,[M,C,_]);if(null!=l){F=(0,s._1)(l,"bias","fused matMul");var V=(0,k.makeTypesMatch)(F,b);F=(0,x.Z)(V,1)[0],yt.assertAndGetBroadcastShape(B,F.shape)}null!=m&&(z=(0,s._1)(m,"prelu weights","fused matMul"));var W=function(t,e){var n,r,i=(0,x.Z)(e,4),o=i[0],s=i[1],u=i[2],p=i[3],f=(0,Nr.Fr)((0,T.X)(t,u.shape),u,d);return a||c?!a&&c?(n=(0,D.O)(f,s,!1,!1),r=(0,D.O)(f,o,!0,!1)):a&&!c?(n=(0,D.O)(s,f,!1,!0),r=(0,D.O)(o,f,!1,!1)):(n=(0,D.O)(s,f,!0,!0),r=(0,D.O)(f,o,!0,!0)):(n=(0,D.O)(f,s,!1,!0),r=(0,D.O)(o,f,!0,!1)),null!=l?[n,r,(0,Nr.pf)(p,f)]:[n,r]},U={a:L,b:P,bias:F,preluActivationWeights:z},j={transposeA:a,transposeB:c,activation:d,leakyreluAlpha:g};if(null==l){var H=(0,ie.cb)((function(t,e,n){var r=i.BV.runKernel(o.usg,U,j);return n([t,e,r]),{value:(0,T.X)(r,B),gradFunc:W}}));return H(L,P)}var q=(0,ie.cb)((function(t,e,n,r){var a=i.BV.runKernel(o.usg,U,j);return r([t,e,a,n]),{value:(0,T.X)(a,B),gradFunc:W}}));return q(L,P,F)}});var Ar=(0,u.op)({hammingWindow_:function(t){return wr(t,.54,.46)}});var Rr=(0,u.op)({hannWindow_:function(t){return wr(t,.5,.5)}});var Dr=(0,u.op)({frame_:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+e<=t.size;)o.push(F(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=R([F(t,i,e-s),(0,K.h)([s],a)]);o.push(u),i+=n}return 0===o.length?Kn([],[0,e]):(0,T.X)(R(o),[o.length,e])}});var Or=(0,u.op)({stft_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Rr;null==r&&(r=br(e));var i=Dr(t,e,n),o=(0,O.d)(i,a(e));return Ln(o,r)}});var Mr=(0,u.op)({cropAndResize_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=(0,s._1)(t,"image","cropAndResize"),l=(0,s._1)(e,"boxes","cropAndResize","float32"),p=(0,s._1)(n,"boxInd","cropAndResize","int32"),h=l.shape[0];f.hu(4===c.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(c.rank,".")})),f.hu(2===l.rank&&4===l.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(h,",4] ")+"but had shape ".concat(l.shape,".")})),f.hu(1===p.rank&&p.shape[0]===h,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(h,"] ")+"but had shape ".concat(l.shape,".")})),f.hu(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),f.hu(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),f.hu("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var d={image:c,boxes:l,boxInd:p},m={method:a,extrapolationValue:u,cropSize:r},v=i.BV.runKernel(o.VcC,d,m);return v}});var Fr=(0,u.op)({flipLeftRight_:function(t){var e=(0,s._1)(t,"image","flipLeftRight","float32");f.hu(4===e.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")}));var n={image:e};return i.BV.runKernel(o.Uyb,n,{})}});var zr=(0,u.op)({grayscaleToRGB_:function(t){var e=(0,s._1)(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];f.hu(e.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")})),f.hu(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,Wt(e,a)}});var Br=(0,u.op)({rotateWithOffset_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=(0,s._1)(t,"image","rotateWithOffset","float32");f.hu(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var u={image:a},c={radians:e,fillValue:n,center:r},l=i.BV.runKernel(o.b9H,u,c);return l}});function Lr(t,e,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=t.shape[0];return n=Math.min(n,o),f.hu(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),f.hu(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'")})),f.hu(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1])})),f.hu(1===e.rank,(function(){return"scores must be a 1D tensor"})),f.hu(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0])})),f.hu(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var Pr=(0,u.op)({nonMaxSuppression_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,u=(0,s._1)(t,"boxes","nonMaxSuppression","float32"),c=(0,s._1)(e,"scores","nonMaxSuppression","float32"),l=Lr(u,c,n,r,a),p={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:a=l.scoreThreshold};return i.BV.runKernel(o.uv1,{boxes:u,scores:c},p)}}),Vr=n(745);function Wr(){return Wr=(0,Sn.Z)((0,kn.Z)().mark((function t(e,n,r){var a,i,o,u,c,l,p,f,h,d,m=arguments;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:.5,i=m.length>4&&void 0!==m[4]?m[4]:Number.NEGATIVE_INFINITY,o=(0,s._1)(e,"boxes","nonMaxSuppressionAsync"),u=(0,s._1)(n,"scores","nonMaxSuppressionAsync"),c=Lr(o,u,r,a,i),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,t.next=10,Promise.all([o.data(),u.data()]);case 10:return l=t.sent,p=l[0],f=l[1],h=(0,Vr.GP)(p,f,r,a,i),d=h.selectedIndices,o!==e&&o.dispose(),u!==n&&u.dispose(),t.abrupt("return",Zn(d,"int32"));case 17:case"end":return t.stop()}}),t)}))),Wr.apply(this,arguments)}var Ur=function(t,e,n){return Wr.apply(this,arguments)};var jr=(0,u.op)({nonMaxSuppressionWithScore_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=(0,s._1)(t,"boxes","nonMaxSuppression"),l=(0,s._1)(e,"scores","nonMaxSuppression"),p=Lr(c,l,n,r,a,u),f={boxes:c,scores:l},h={maxOutputSize:n=p.maxOutputSize,iouThreshold:r=p.iouThreshold,scoreThreshold:a=p.scoreThreshold,softNmsSigma:u=p.softNmsSigma},d=i.BV.runKernel(o.W0H,f,h);return{selectedIndices:d[0],selectedScores:d[1]}}});function Hr(){return Hr=(0,Sn.Z)((0,kn.Z)().mark((function t(e,n,r){var a,i,o,u,c,l,p,f,h,d,m,v,g=arguments;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=g.length>3&&void 0!==g[3]?g[3]:.5,i=g.length>4&&void 0!==g[4]?g[4]:Number.NEGATIVE_INFINITY,o=g.length>5&&void 0!==g[5]?g[5]:0,u=(0,s._1)(e,"boxes","nonMaxSuppressionAsync"),c=(0,s._1)(n,"scores","nonMaxSuppressionAsync"),l=Lr(u,c,r,a,i,o),r=l.maxOutputSize,a=l.iouThreshold,i=l.scoreThreshold,o=l.softNmsSigma,t.next=12,Promise.all([u.data(),c.data()]);case 12:return p=t.sent,f=p[0],h=p[1],d=(0,Vr.pA)(f,h,r,a,i,o),m=d.selectedIndices,v=d.selectedScores,u!==e&&u.dispose(),c!==n&&c.dispose(),t.abrupt("return",{selectedIndices:Zn(m,"int32"),selectedScores:Zn(v)});case 19:case"end":return t.stop()}}),t)}))),Hr.apply(this,arguments)}var qr=function(t,e,n){return Hr.apply(this,arguments)};var Gr=(0,u.op)({nonMaxSuppressionPadded_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=(0,s._1)(t,"boxes","nonMaxSuppression"),l=(0,s._1)(e,"scores","nonMaxSuppression"),p=Lr(c,l,n,r,a,null),f=p.maxOutputSize,h=p.iouThreshold,d=p.scoreThreshold,m={boxes:c,scores:l},v={maxOutputSize:f,iouThreshold:h,scoreThreshold:d,padToMaxOutputSize:u},g=i.BV.runKernel(o.cye,m,v);return{selectedIndices:g[0],validOutputs:g[1]}}});function Zr(){return Zr=(0,Sn.Z)((0,kn.Z)().mark((function t(e,n,r){var a,i,o,u,c,l,p,f,h,d,m,v,g,y,b,w,k=arguments;return(0,kn.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=k.length>3&&void 0!==k[3]?k[3]:.5,i=k.length>4&&void 0!==k[4]?k[4]:Number.NEGATIVE_INFINITY,o=k.length>5&&void 0!==k[5]&&k[5],u=(0,s._1)(e,"boxes","nonMaxSuppressionAsync"),c=(0,s._1)(n,"scores","nonMaxSuppressionAsync"),l=Lr(u,c,r,a,i,null),p=l.maxOutputSize,f=l.iouThreshold,h=l.scoreThreshold,t.next=11,Promise.all([u.data(),c.data()]);case 11:return d=t.sent,m=(0,x.Z)(d,2),v=m[0],g=m[1],y=(0,Vr.qP)(v,g,p,f,h,o),b=y.selectedIndices,w=y.validOutputs,u!==e&&u.dispose(),c!==n&&c.dispose(),t.abrupt("return",{selectedIndices:Zn(b,"int32"),validOutputs:(0,Rt.i)(w,"int32")});case 19:case"end":return t.stop()}}),t)}))),Zr.apply(this,arguments)}var Kr=function(t,e,n){return Zr.apply(this,arguments)},Xr=n(3878),$r=n(9199),Yr=n(181),Qr=n(5267);function Jr(t){return(0,Xr.Z)(t)||(0,$r.Z)(t)||(0,Yr.Z)(t)||(0,Qr.Z)()}var ta=(0,u.op)({resizeBilinear_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,s._1)(t,"images","resizeBilinear");f.hu(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),f.hu(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")})),f.hu(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var u=a,c=!1;3===a.rank&&(c=!0,u=(0,T.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Jr(e);var l={images:u},p={alignCorners:n,halfPixelCenters:r,size:e},h=i.BV.runKernel(o._Yw,l,p);return c?(0,T.X)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});var ea=(0,u.op)({resizeNearestNeighbor_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,s._1)(t,"images","resizeNearestNeighbor");f.hu(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),f.hu(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")})),f.hu("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),f.hu(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var u=a,c=!1;3===a.rank&&(c=!0,u=(0,T.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Jr(e);var l={images:u},p={alignCorners:n,halfPixelCenters:r,size:e},h=i.BV.runKernel(o.dpD,l,p);return c?(0,T.X)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});function na(t,e){for(var n,r,a,i,o,s,u=Zn([-1]),c=Zn([0]),l=Zn([0]),f=0;f<t.size-1;f++){n=F(t,0,f+1),r=F(t,f+1),o=(0,gt.h)((0,Mt.S)(n),e),s=(0,gt.h)((0,Mt.S)(r),e);var h=(0,Mt.S)((0,O.d)(n,un(0,n.size)));a=(0,gt.h)(h,(0,Mt.S)(n));var d=(0,K.h)(r.shape,n.size),m=(0,p.I)(un(0,r.size),d),v=(0,O.d)(r,m);i=(0,gt.h)((0,Mt.S)(v),(0,Mt.S)(r));var g=(0,ce.l)(a,i),y=(0,ce.l)(a,i),b=(0,O.d)(o,s);l=(0,O.d)((0,O.d)(b,g),y);var w=Gt(l,c);c=wt(w,l,c),u=wt(w,Zn([f]),u)}return u}var ra=(0,u.op)({threshold_:function(t){var e,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,c=(0,s._1)(t,"image","threshold"),l=.2989,h=.587,d=.114,m=c.shape[0]*c.shape[1],v=(0,O.d)(Zn([u]),255);if(f.hu(3===c.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(c.rank,".")})),f.hu(3===c.shape[2]||1===c.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(c.shape[2],".")})),f.hu("int32"===c.dtype||"float32"===c.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(c.dtype,".")})),f.hu("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===c.shape[2]){var g=Bn(c,[1,1,1],-1),y=(0,x.Z)(g,3);e=y[0],n=y[1],r=y[2];var b=(0,O.d)(e,l),w=(0,O.d)(n,h),k=(0,O.d)(r,d);a=(0,p.I)((0,p.I)(b,w),k)}else a=t;if("otsu"===i){var S=j((0,E.p)(yn(a),"int32"),(0,qn.X)([]),256);v=na(S,m)}var N=o?te(a,v):Gt(a,v),C=(0,E.p)((0,O.d)(N,255),"int32");return C}});var aa=(0,u.op)({transform_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5?arguments[5]:void 0,c=(0,s._1)(t,"image","transform","float32"),l=(0,s._1)(e,"transforms","transform","float32");f.hu(4===c.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(c.rank,".")})),f.hu(2===l.rank&&(l.shape[0]===c.shape[0]||1===l.shape[0])&&8===l.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),f.hu(null==u||2===u.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(u,".")}));var p={image:c,transforms:l},h={interpolation:n,fillMode:r,fillValue:a,outputShape:u};return i.BV.runKernel(o.wx7,p,h)}});var ia=(0,u.op)({bandPart_:function(t,e,n){(0,f.hu)(e%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(e,".")})),(0,f.hu)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=(0,s._1)(t,"a","bandPart");(0,f.hu)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=r.shape.slice(-2),o=(0,x.Z)(i,2),u=o[0],c=o[1];if(!(e<=u))throw new Error("bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(u,")."));if(!(n<=c))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(c,")."));e<0&&(e=u),n<0&&(n=c);var l=(0,T.X)(un(0,u,1,"int32"),[-1,1]),p=un(0,c,1,"int32"),h=(0,ce.l)(l,p),d=fe(te(h,(0,Rt.i)(+e,"int32")),Zt(h,(0,Rt.i)(-n,"int32"))),m=Ne([u,c],r.dtype);return(0,T.X)(Wn(rr((0,T.X)(r,[-1,u,c])).map((function(t){return wt(d,t,m)}))),a)}});var oa=(0,u.op)({gramSchmidt_:function(t){var e;Array.isArray(t)?function(){e=!1,(0,f.hu)(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){(0,f.hu)(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")}))},a=1;a<t.length;++a)r(a)}():(e=!0,t=Bn(t,t.shape[0],0).map((function(t){return Vn(t,[0])}))),(0,f.hu)(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")}));for(var n=[],r=t,a=function(t){n.push(i.BV.tidy((function(){var e=r[t];if(t>0)for(var a=0;a<t;++a){var i=(0,O.d)((0,Mt.S)((0,O.d)(n[a],e)),n[a]);e=(0,ce.l)(e,i)}return(0,gt.h)(e,zt(e,"euclidean"))})))},o=0;o<t.length;++o)a(o);return e?Wn(n,0):n}}),sa=n(5875);function ua(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i.BV.tidy((function(){(0,f.hu)(2===t.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")}));for(var n=t.shape[0],r=t.shape[1],a=Ut(n),o=(0,A.d)(t),s=Kn([[1]],[1,1]),u=(0,A.d)(s),c=n>=r?r:n,l=function(t){var e=o,c=u,l=a,p=i.BV.tidy((function(){var e=F(o,[t,t],[n-t,1]),i=zt(e),c=F(o,[t,t],[1,1]),l=wt(Gt(c,0),Kn([[-1]]),Kn([[1]])),p=(0,ce.l)(c,(0,O.d)(l,i)),f=(0,gt.h)(e,p);u=1===f.shape[0]?(0,A.d)(s):R([s,F(f,[1,0],[f.shape[0]-1,f.shape[1]])],0);var h=(0,oe.W)((0,gt.h)((0,D.O)(l,p),i)),d=F(o,[t,0],[n-t,r]),m=(0,O.d)(h,u),v=(0,pr.p)(u);if(0===t)o=(0,ce.l)(d,(0,D.O)(m,(0,D.O)(v,d)));else{var g=(0,ce.l)(d,(0,D.O)(m,(0,D.O)(v,d)));o=R([F(o,[0,0],[t,r]),g],0)}var y=(0,pr.p)(m),b=F(a,[0,t],[n,a.shape[1]-t]);if(0===t)a=(0,ce.l)(b,(0,D.O)((0,D.O)(b,u),y));else{var w=(0,ce.l)(b,(0,D.O)((0,D.O)(b,u),y));a=R([F(a,[0,0],[n,t]),w],1)}return[u,o,a]})),f=(0,x.Z)(p,3);u=f[0],o=f[1],a=f[2],(0,sa.B9)([e,c,l])},p=0;p<c;++p)l(p);return!e&&n>r&&(a=F(a,[0,0],[n,r]),o=F(o,[0,0],[r,r])),[a,o]}))}var ca=(0,u.op)({qr_:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,f.hu)(t.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank)})),2===t.rank)return ua(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=rr((0,T.X)(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];r.forEach((function(t){var n=ua(t,e),r=(0,x.Z)(n,2),o=r[0],s=r[1];a.push(o),i.push(s)}));var o=(0,T.X)(Wn(a,0),t.shape),s=(0,T.X)(Wn(i,0),t.shape);return[o,s]}}),la=n(7627);var pa=(0,u.op)({computeWeightedLoss_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:la.I.SUM_BY_NONZERO_WEIGHTS,r=(0,s._1)(t,"losses","computeWeightedLoss"),a=null;null!=e&&(a=(0,s._1)(e,"weights","computeWeightedLoss"));var i=null==a?r:(0,O.d)(r,a);if(n===la.I.NONE)return i;if(n===la.I.SUM)return(0,Mt.S)(i);if(n===la.I.MEAN){if(null==a)return Se(i);var o=r.size/a.size,u=(0,gt.h)((0,Mt.S)(i),(0,Mt.S)(a));return o>1?(0,gt.h)(u,(0,Rt.i)(o)):u}if(n===la.I.SUM_BY_NONZERO_WEIGHTS){if(null==a)return(0,gt.h)((0,Mt.S)(i),(0,Rt.i)(r.size));var c=(0,O.d)(a,Ee(r.shape)),l=(0,E.p)((0,Mt.S)(Me(c,(0,Rt.i)(0))),"float32");return(0,gt.h)((0,Mt.S)(i),l)}throw Error("Unknown reduction: ".concat(n))}});var fa=(0,u.op)({absoluteDifference_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:la.I.SUM_BY_NONZERO_WEIGHTS,i=(0,s._1)(t,"labels","absoluteDifference"),o=(0,s._1)(e,"predictions","absoluteDifference"),u=null;null!=n&&(u=(0,s._1)(n,"weights","absoluteDifference")),(0,f.k5)(i.shape,o.shape,"Error in absoluteDifference: ");var c=(0,a.W)((0,ce.l)(i,o));return pa(c,u,r)}});var ha=(0,u.op)({cosineDistance_:function(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:la.I.SUM_BY_NONZERO_WEIGHTS,i=(0,s._1)(t,"labels","cosineDistance"),o=(0,s._1)(e,"predictions","cosineDistance"),u=null;null!=r&&(u=(0,s._1)(r,"weights","cosineDistance")),(0,f.k5)(i.shape,o.shape,"Error in cosineDistance: ");var c=(0,Rt.i)(1),l=(0,ce.l)(c,(0,Mt.S)((0,O.d)(i,o),n,!0));return pa(l,u,a)}});var da=(0,u.op)({hingeLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:la.I.SUM_BY_NONZERO_WEIGHTS,a=(0,s._1)(t,"labels","hingeLoss"),i=(0,s._1)(e,"predictions","hingeLoss"),o=null;null!=n&&(o=(0,s._1)(n,"weights","hingeLoss")),(0,f.k5)(a.shape,i.shape,"Error in hingeLoss: ");var u=(0,Rt.i)(1);a=(0,ce.l)((0,O.d)((0,Rt.i)(2),a),u);var c=(0,pn.U)((0,ce.l)(u,(0,O.d)(a,i)));return pa(c,o,r)}});var ma=(0,u.op)({huberLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:la.I.SUM_BY_NONZERO_WEIGHTS,o=(0,s._1)(t,"labels","huberLoss"),u=(0,s._1)(e,"predictions","huberLoss"),c=null;null!=n&&(c=(0,s._1)(n,"weights","huberLoss")),(0,f.k5)(o.shape,u.shape,"Error in huberLoss: ");var l=(0,Rt.i)(r),h=(0,a.W)((0,ce.l)(u,o)),d=Ie(h,l),m=(0,ce.l)(h,d),v=(0,p.I)((0,O.d)((0,Rt.i)(.5),(0,Ot.h)(d)),(0,O.d)(l,m));return pa(v,c,i)}});var va=(0,u.op)({logLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:la.I.SUM_BY_NONZERO_WEIGHTS,i=(0,s._1)(t,"labels","logLoss"),o=(0,s._1)(e,"predictions","logLoss"),u=null;null!=n&&(u=(0,s._1)(n,"weights","logLoss")),(0,f.k5)(i.shape,o.shape,"Error in logLoss: ");var c=(0,Rt.i)(1),l=(0,Rt.i)(r),h=(0,oe.W)((0,O.d)(i,re((0,p.I)(o,l)))),d=(0,O.d)((0,ce.l)(c,i),re((0,p.I)((0,ce.l)(c,o),l))),m=(0,ce.l)(h,d);return pa(m,u,a)}});var ga=(0,u.op)({meanSquaredError_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:la.I.SUM_BY_NONZERO_WEIGHTS,a=(0,s._1)(t,"labels","meanSquaredError"),i=(0,s._1)(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=(0,s._1)(n,"weights","meanSquaredError")),(0,f.k5)(a.shape,i.shape,"Error in meanSquaredError: ");var u=Pn(a,i);return pa(u,o,r)}});function ya(t,e){var n=(0,s._1)(t,"labels","sigmoidCrossEntropyWithLogits"),r=(0,s._1)(e,"logits","sigmoidCrossEntropyWithLogits");(0,f.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=(0,pn.U)(r),o=(0,O.d)(r,n),u=ae(Lt((0,oe.W)((0,a.W)(r))));return(0,p.I)((0,ce.l)(i,o),u)}var ba=(0,u.op)({sigmoidCrossEntropy_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:la.I.SUM_BY_NONZERO_WEIGHTS,i=(0,s._1)(t,"multiClassLabels","sigmoidCrossEntropy"),o=(0,s._1)(e,"logits","sigmoidCrossEntropy"),u=null;if(null!=n&&(u=(0,s._1)(n,"weights","sigmoidCrossEntropy")),(0,f.k5)(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=(0,Rt.i)(r),l=(0,Rt.i)(1),h=(0,Rt.i)(.5);i=(0,p.I)((0,O.d)(i,(0,ce.l)(l,c)),(0,O.d)(h,c))}var d=ya(i,o);return pa(d,u,a)}});function wa(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));var r=(0,ie.cb)((function(t,e,r){var a=pe(e,[n],!0),i=(0,ce.l)((0,E.p)(e,"float32"),a);r([t,i]);var o=(0,oe.W)((0,O.d)(i,t));return{value:(0,Mt.S)(o,[n]),gradFunc:function(t,e){var r=(0,x.Z)(e,2),a=r[0],i=r[1],o=(0,Tt.rv)(t.shape,[n]);return[(0,O.d)((0,T.X)(t,o),(0,ce.l)((0,E.p)(a,"float32"),Lt(i))),(0,O.d)((0,T.X)(t,o),(0,ce.l)(Lt(i),(0,E.p)(a,"float32")))]}}}));return r(t,e)}var xa=(0,u.op)({softmaxCrossEntropy_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:la.I.SUM_BY_NONZERO_WEIGHTS,i=(0,s._1)(t,"onehotLabels","softmaxCrossEntropy"),o=(0,s._1)(e,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=(0,s._1)(n,"weights","softmaxCrossEntropy")),(0,f.k5)(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var c=(0,Rt.i)(r),l=(0,Rt.i)(1),h=(0,Rt.i)(i.shape[1]);i=(0,p.I)((0,O.d)(i,(0,ce.l)(l,c)),(0,gt.h)(c,h))}var d=wa(i,o);return pa(d,u,a)}});var ka=(0,u.op)({sparseFillEmptyRows_:function(t,e,n,r){var a=(0,s._1)(t,"indices","sparseFillEmptyRows","int32"),u=(0,s._1)(e,"values","sparseFillEmptyRows"),c=(0,s._1)(n,"denseShape","sparseFillEmptyRows","int32"),l=(0,s._1)(r,"defaultValue","sparseFillEmptyRows",u.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==u.rank)throw new Error("Values should be Tensor1D but received shape ".concat(u.shape));if(1!==c.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(c.shape));if(0!==l.rank)throw new Error("Default value should be a scalar but received shape ".concat(l.shape));var p={indices:a,values:u,denseShape:c,defaultValue:l},f=i.BV.runKernel(o.O3z,p);return{outputIndices:f[0],outputValues:f[1],emptyRowIndicator:f[2],reverseIndexMap:f[3]}}});var Sa=(0,u.op)({sparseReshape_:function(t,e,n){var r=(0,s._1)(t,"inputIndices","sparseReshape","int32"),a=(0,s._1)(e,"inputShape","sparseReshape","int32"),u=(0,s._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==u.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(u.shape));var c={inputIndices:r,inputShape:a,newShape:u},l=i.BV.runKernel(o.nhH,c);return{outputIndices:l[0],outputShape:l[1]}}});var Na=(0,u.op)({sparseSegmentMean_:function(t,e,n){var r=(0,s._1)(t,"data","sparseSegmentMean"),a=(0,s._1)(e,"indices","sparseSegmentMean","int32"),u=(0,s._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==u.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(u.shape));var c={data:r,indices:a,segmentIds:u};return i.BV.runKernel(o.w3H,c)}});var Ea=(0,u.op)({sparseSegmentSum_:function(t,e,n){var r=(0,s._1)(t,"data","sparseSegmentSum"),a=(0,s._1)(e,"indices","sparseSegmentSum","int32"),u=(0,s._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==u.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(u.shape));var c={data:r,indices:a,segmentIds:u};return i.BV.runKernel(o.ZjV,c)}});var Ca=(0,u.op)({stringNGrams_:function(t,e,n,r,a,u,c,l){var p=(0,s._1)(t,"data","stringNGrams","string");if("string"!==p.dtype)throw new Error("Data must be of datatype string");if(1!==p.shape.length)throw new Error("Data must be a vector, saw: ".concat(p.shape));var f=(0,s._1)(e,"dataSplits","stringNGrams");if("int32"!==f.dtype)throw new Error("Data splits must be of datatype int32");var h={separator:n,nGramWidths:r,leftPad:a,rightPad:u,padWidth:c,preserveShortSequences:l},d={data:p,dataSplits:f},m=i.BV.runKernel(o._JP,d,h);return{nGrams:m[0],nGramsSplits:m[1]}}});var Ta=(0,u.op)({stringSplit_:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(0,s._1)(t,"input","stringSplit","string"),a=(0,s._1)(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var u={skipEmpty:n},c={input:r,delimiter:a},l=i.BV.runKernel(o.s1s,c,u);return{indices:l[0],values:l[1],shape:l[2]}}});var Ia=(0,u.op)({stringToHashBucketFast_:function(t,e){var n=(0,s._1)(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return i.BV.runKernel(o.XkS,a,r)}}),_a={fft:Mn,ifft:Fn,rfft:Ln,irfft:zn},Aa={hammingWindow:Ar,hannWindow:Rr,frame:Dr,stft:Or},Ra={flipLeftRight:Fr,grayscaleToRGB:zr,resizeNearestNeighbor:ea,resizeBilinear:ta,rotateWithOffset:Br,cropAndResize:Mr,nonMaxSuppression:Pr,nonMaxSuppressionAsync:Ur,nonMaxSuppressionWithScore:jr,nonMaxSuppressionWithScoreAsync:qr,nonMaxSuppressionPadded:Gr,nonMaxSuppressionPaddedAsync:Kr,threshold:ra,transform:aa},Da={bandPart:ia,gramSchmidt:oa,qr:ca},Oa={absoluteDifference:fa,computeWeightedLoss:pa,cosineDistance:ha,hingeLoss:da,huberLoss:ma,logLoss:va,meanSquaredError:ga,sigmoidCrossEntropy:ba,softmaxCrossEntropy:xa},Ma={sparseFillEmptyRows:ka,sparseReshape:Sa,sparseSegmentMean:Na,sparseSegmentSum:Ea},Fa={stringNGrams:Ca,stringSplit:Ta,stringToHashBucketFast:Ia}},4334:function(t,e,n){"use strict";n.d(e,{s:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354);var u=(0,n(8640).op)({pow_:function(t,e){var n=(0,s._1)(t,"base","pow"),u=(0,s._1)(e,"exp","pow"),c=(0,o.makeTypesMatch)(n,u),l=(0,r.Z)(c,2),p={a:n=l[0],b:u=l[1]};return a.BV.runKernel(i.pe_,p)}})},6859:function(t,e,n){"use strict";n.d(e,{A:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({prelu_:function(t,e){var n={x:(0,i._1)(t,"x","prelu"),alpha:(0,i._1)(e,"alpha","prelu")};return r.BV.runKernel(a.o0g,n)}})},4600:function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}n.d(e,{S:function(){return r}})},6972:function(t,e,n){"use strict";n.d(e,{k:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({real_:function(t){var e={input:(0,i._1)(t,"input","real")};return r.BV.runKernel(a.xJR,e)}})},7539:function(t,e,n){"use strict";n.d(e,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({relu_:function(t){var e={x:(0,i._1)(t,"x","relu")};return r.BV.runKernel(a.qkr,e)}})},5900:function(t,e,n){"use strict";n.d(e,{b:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({relu6_:function(t){var e={x:(0,i._1)(t,"x","relu6")};return r.BV.runKernel(a.SbG,e)}})},5561:function(t,e,n){"use strict";n.d(e,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reshape_:function(t,e){var n={x:(0,i._1)(t,"x","reshape","string_or_numeric")},o={shape:e};return r.BV.runKernel(a.HZH,n,o)}})},7067:function(t,e,n){"use strict";n.d(e,{i:function(){return i}});var r=n(6147),a=n(7960);function i(t,e){if(((0,r.fU)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&(0,r.fU)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,a.H)(t,[],[],e)}},8604:function(t,e,n){"use strict";n.r(e),n.d(e,{calculateShapes:function(){return s},validateInput:function(){return o},validateUpdateShape:function(){return i}});var r=n(3433),a=n(6147);function i(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(t.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(i+" update.rank != ".concat(a+t.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==t[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(t[s+a],")"))}function o(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}i(n,e,t)}function s(t,e,n){for(var i=e.shape.length,o=i>1?e.shape[i-1]:1,s=n.length,u=1,c=o;c<s;++c)u*=n[c];var l=o<1?1:o;return{sliceRank:o,numUpdates:(0,a.NA)(e.shape)/l,sliceSize:u,strides:[].concat((0,r.Z)((0,a.e3)(n.slice(0,o))),[1]),outputSize:(0,a.NA)(n)}}},7643:function(t,e,n){"use strict";n.d(e,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sigmoid_:function(t){var e={x:(0,i._1)(t,"x","sigmoid","float32")};return r.BV.runKernel(a.a5O,e)}})},6902:function(t,e,n){"use strict";n.d(e,{_:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sqrt_:function(t){var e={x:(0,i._1)(t,"x","sqrt","float32")};return r.BV.runKernel(a.FKq,e)}})},7391:function(t,e,n){"use strict";n.d(e,{h:function(){return i}});var r=n(318),a=n(8354);var i=(0,n(8640).op)({square_:function(t){var e=(0,a._1)(t,"x","square");return r.BV.runKernel("Square",{x:e},{})}})},4031:function(t,e,n){"use strict";n.d(e,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({step_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(t,"x","step"),o={x:n},s={alpha:e};return r.BV.runKernel(a.h8e,o,s)}})},4774:function(t,e,n){"use strict";n.d(e,{l:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),s=n(8354);var u=(0,n(8640).op)({sub_:function(t,e){var n=(0,s._1)(t,"a","sub"),u=(0,s._1)(e,"b","sub"),c=(0,o.makeTypesMatch)(n,u),l=(0,r.Z)(c,2),p={a:n=l[0],b:u=l[1]};return a.BV.runKernel(i.Tr8,p)}})},227:function(t,e,n){"use strict";n.d(e,{S:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(9118);var s=(0,n(8640).op)({sum_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(0,i._1)(t,"x","sum");"bool"===s.dtype&&(s=(0,o.p)(s,"int32"));var u={x:s},c={axis:e,keepDims:n};return r.BV.runKernel(a.GBy,u,c)}})},2442:function(t,e,n){"use strict";n.d(e,{X:function(){return i}});var r=n(8354),a=n(7960);function i(t,e,n){var i=(0,r.C)(t,n);return(0,a.H)(t,e,i,n)}},3123:function(t,e,n){"use strict";n.d(e,{w:function(){return o}});var r=n(8354),a=n(6147),i=n(7960);function o(t,e,n){if((0,a.Cq)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var o=(0,r.C)(t,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,i.H)(t,e,o,n)}},7960:function(t,e,n){"use strict";n.d(e,{H:function(){return o}});var r=n(318),a=n(6147),i=n(115);function o(t,e,n,o){if(null==o&&(o=(0,a.D2)(t)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!(0,a.fU)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){(0,a.Mu)(e);var s=(0,a.NA)(e),u=(0,a.NA)(n);(0,a.hu)(s===u,(function(){return"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(s," values but has ").concat(u)}));for(var c=0;c<n.length;++c){var l=n[c],p=c!==n.length-1||l!==(0,a.NA)(e.slice(c));(0,a.hu)(n[c]===e[c]||!p,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")}))}}return(0,a.fU)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==o?(0,i.toTypedArray)(t,o):(0,a.xH)(t,[],!0),r.BV.makeTensor(t,e,o)}},1240:function(t,e,n){"use strict";n.d(e,{p:function(){return h}});var r=n(318),a=n(5875),i=n(2145),o=n(8354),s=n(6147),u=n(9253),c=n(6996),l=n(4362),p=n(8640),f=n(6972);var h=(0,p.op)({transpose_:function(t,e,n){var p=(0,o._1)(t,"x","transpose");if(null==e&&(e=p.shape.map((function(t,e){return e})).reverse()),s.hu(p.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(p.rank," ")+"must match length of perm ".concat(e,".")})),e.forEach((function(t){s.hu(t>=0&&t<p.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(p.rank-1)+" but got ".concat(e)}))})),p.rank<=1)return p.clone();var h={x:p},d={perm:e};return"complex64"===p.dtype?(0,a.lu)((function(){var t=(0,f.k)(p),e=(0,c.a)(p);return t=r.BV.runKernel(i.G3Y,{x:t},d),e=r.BV.runKernel(i.G3Y,{x:e},d),n&&(e=(0,l.W)(e)),(0,u.P)(t,e)})):r.BV.runKernel(i.G3Y,h,d)}})},7293:function(t,e,n){"use strict";n.d(e,{P:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({zerosLike_:function(t){var e={x:(0,i._1)(t,"x","zerosLike")};return r.BV.runKernel(a.RuY,e)}})},4376:function(t,e,n){"use strict";n.d(e,{es:function(){return N},YD:function(){return y},_w:function(){return E},FZ:function(){return S},Vp:function(){return k},Vi:function(){return x}});var r=n(9340),a=n(2882),i=n(4165),o=n(5861),s=n(5671),u=n(3144),c=n(6581),l=n(3433),p=n(6147);function f(t,e,n,r){var a=(0,p.e3)(e),i=function(t,e,n,r){var a=(0,p.NA)(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,u="complex64"===n?v(t):t;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,f=0;f<i;f++)o[f]=Math.max(o[f],h(u[l+f],0,n).length);return o}(t,e,n,a),o=e.length,s=m(t,e,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function h(t,e,n){var r;return r=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(7))," + ")+"".concat(parseFloat(t[1].toFixed(7)),"j"):(0,p.HD)(t)?"'".concat(t,"'"):"bool"===n?d(t):parseFloat(t.toFixed(7)).toString(),(0,p.oj)(r,e)}function d(t){return 0===t?"false":"true"}function m(t,e,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=e[0],u=e.length;if(0===u){if("complex64"===n){var c=v(t);return[h(c[0],0,n)]}return"bool"===n?[d(t[0])]:[t[0].toString()]}if(1===u){if(s>20){var p=3*o,f=Array.from(t.slice(0,p)),g=Array.from(t.slice((s-3)*o,s*o));return"complex64"===n&&(f=v(f),g=v(g)),["["+f.map((function(t,e){return h(t,a[e],n)})).join(", ")+", ..., "+g.map((function(t,e){return h(t,a[s-3+e],n)})).join(", ")+"]"]}var y="complex64"===n?v(t):Array.from(t);return["["+y.map((function(t,e){return h(t,a[e],n)})).join(", ")+"]"]}var b=e.slice(1),w=r.slice(1),x=r[0]*o,k=[];if(s>20){for(var S=0;S<3;S++){var N=S*x,E=N+x;k.push.apply(k,(0,l.Z)(m(t.slice(N,E),b,n,w,a,!1)))}k.push("...");for(var C=s-3;C<s;C++){var T=C*x,I=T+x;k.push.apply(k,(0,l.Z)(m(t.slice(T,I),b,n,w,a,C===s-1)))}}else for(var _=0;_<s;_++){var A=_*x,R=A+x;k.push.apply(k,(0,l.Z)(m(t.slice(A,R),b,n,w,a,_===s-1)))}var D=2===u?",":"";k[0]="["+k[0]+D;for(var O=1;O<k.length-1;O++)k[O]=" "+k[O]+D;for(var M=",\n",F=2;F<u;F++)M+="\n";return k[k.length-1]=" "+k[k.length-1]+"]"+(i?"":M),k}function v(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var g=n(115),y=function(){function t(e,n,r){var a=this;if((0,s.Z)(this,t),this.dtype=n,this.shape=e.slice(),this.size=p.NA(e),null!=r){var i=r.length;p.hu(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||p.rQ(n,this.size),this.strides=(0,p.e3)(e)}return(0,u.Z)(t,[{key:"set",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),p.hu(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(e.rank,")")}));var i=this.locToIndex(r);this.values[i]=t}},{key:"get",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);for(var r=0,a=0,i=e;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=e[e.length-1],c=0;c<e.length-1;++c)u+=this.strides[c]*e[c];return this.values[u]}},{key:"locToIndex",value:function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}},{key:"indexToLoc",value:function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return b().makeTensor(this.values,this.shape,this.dtype)}}]),t}(),b=null,w=null;function x(t){b=t}function k(t){w=t}function S(t){t}var N=function(){function t(e,n,r,a){(0,s.Z)(this,t),this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=p.NA(e),this.strides=(0,p.e3)(e),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return(0,u.Z)(t,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.data();case 2:return e=t.sent,t.abrupt("return",w.buffer(this.shape,this.dtype,e));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return w.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.data();case 2:return e=t.sent,t.abrupt("return",(0,p.GX)(this.shape,e,"complex64"===this.dtype));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"arraySync",value:function(){return(0,p.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(){var e,n;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.throwIfDisposed(),e=b().read(this.dataId),"string"!==this.dtype){t.next=13;break}return t.next=5,e;case 5:return n=t.sent,t.prev=6,t.abrupt("return",n.map((function(t){return g.decodeString(t)})));case 10:throw t.prev=10,t.t0=t.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[6,10]])})));return function(){return t.apply(this,arguments)}}()},{key:"dataToGPU",value:function(t){return this.throwIfDisposed(),b().readToGPU(this.dataId,t)}},{key:"dataSync",value:function(){this.throwIfDisposed();var t=b().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return g.decodeString(t)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}},{key:"bytes",value:function(){var t=(0,o.Z)((0,i.Z)().mark((function t(){var e;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.throwIfDisposed(),t.next=3,b().read(this.dataId);case 3:if(e=t.sent,"string"!==this.dtype){t.next=8;break}return t.abrupt("return",e);case 8:return t.abrupt("return",new Uint8Array(e.buffer));case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(b().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return w.print(this,t)}},{key:"clone",value:function(){return this.throwIfDisposed(),w.clone(this)}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.dataSync();return f(e,this.shape,this.dtype,t)}},{key:"cast",value:function(t){return this.throwIfDisposed(),w.cast(this,t)}},{key:"variable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),b().makeVariable(this,t,e,n)}}]),t}();Object.defineProperty(N,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}}),(0,c.R)("Tensor",(function(){return N}));var E=function(t){(0,r.Z)(n,t);var e=(0,a.Z)(n);function n(t,r,a,i){var o;return(0,s.Z)(this,n),(o=e.call(this,t.shape,t.dtype,t.dataId,i)).trainable=r,o.name=a,o}return(0,u.Z)(n,[{key:"assign",value:function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!p.cO(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));b().disposeTensor(this),this.dataId=t.dataId,b().incRef(this,null)}},{key:"dispose",value:function(){b().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(N);Object.defineProperty(E,Symbol.hasInstance,{value:function(t){return t instanceof N&&null!=t.assign&&t.assign instanceof Function}})},9064:function(t,e,n){"use strict";n.r(e),n.d(e,{assertTypesMatch:function(){return s},getTensorsInContainer:function(){return c},isTensorInList:function(){return u},makeTypesMatch:function(){return o}});var r=n(4376),a=n(3525),i=n(6147);function o(t,e){if(t.dtype===e.dtype)return[t,e];var n=(0,a.x8)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function s(t,e){(0,i.hu)(t.dtype===e.dtype,(function(){return"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")}))}function u(t,e){return e.some((function(e){return e.id===t.id}))}function c(t){var e=[];return l(t,e,new Set),e}function l(t,e,n){if(null!=t)if(t instanceof r.es)e.push(t);else if(a=t,Array.isArray(a)||"object"===typeof a){var a,i=t;for(var o in i){var s=i[o];n.has(s)||(n.add(s),l(s,e,n))}}}},8354:function(t,e,n){"use strict";n.d(e,{C:function(){return u},_1:function(){return p},sI:function(){return f}});var r=n(318),a=n(5050),i=n(4376),o=n(6147),s=n(115);function u(t,e){var n=t;if((0,o.fU)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||(0,o.fU)(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&(0,a.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&c(t,r,[]),r}function c(t,e,n){if(n=n||[],Array.isArray(t)||(0,o.fU)(t)){(0,o.hu)(e.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")})),(0,o.hu)(t.length===e[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")}));for(var r=e.slice(1),a=0;a<t.length;++a)c(t[a],r,n.concat(a))}else(0,o.hu)(0===e.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")}))}function l(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function p(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof i.es)return l(a,t.dtype,e,n),t;var c=(0,o.D2)(t);if("string"!==c&&["bool","int32","float32"].indexOf(a)>=0&&(c=a),l(a,c,e,n),null==t||!(0,o.fU)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){var p=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(p,"'"))}var f=u(t,c);(0,o.fU)(t)||Array.isArray(t)||(t=[t]);var h=!0,d="string"!==c?(0,s.toTypedArray)(t,c):(0,o.xH)(t,[],h);return r.BV.makeTensor(d,f,c)}function f(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=t;return a.map((function(t,a){return p(t,"".concat(e,"[").concat(a,"]"),n,r)}))}},3525:function(t,e,n){"use strict";var r,a,i,o,s;n.d(e,{x8:function(){return c},yw:function(){return r},z4:function(){return l}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(a||(a={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(i||(i={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(s||(s={}));var u={float32:o,int32:a,bool:i,complex64:s};function c(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return u[t][e]}function l(t){return c(t,"int32")}},115:function(t,e,n){"use strict";n.r(e),n.d(e,{arraysEqual:function(){return a.cO},assert:function(){return a.hu},assertNonNegativeIntegerDimensions:function(){return a.Mu},assertNonNull:function(){return a.Cq},assertShapesMatch:function(){return a.k5},bytesFromStringArray:function(){return a.Ub},bytesPerElement:function(){return a.bT},checkConversionForErrors:function(){return a.D5},clamp:function(){return a.uZ},computeStrides:function(){return a.e3},createScalarValue:function(){return k},createShuffledIndices:function(){return a.U$},decodeString:function(){return T},distSquared:function(){return a.E7},encodeString:function(){return C},fetch:function(){return E},fingerPrint64:function(){return x},flatten:function(){return a.xH},getArrayFromDType:function(){return a.rQ},getTypedArrayFromDType:function(){return a.WP},hasEncodingLoss:function(){return a.QB},hexToLong:function(){return s},indexToLoc:function(){return a.NE},inferDtype:function(){return a.D2},inferFromImplicitShape:function(){return a.JZ},isBoolean:function(){return a.jn},isFunction:function(){return a.mf},isInt:function(){return a.GN},isNumber:function(){return a.hj},isPromise:function(){return a.tI},isScalarShape:function(){return a.N9},isString:function(){return a.HD},isTypedArray:function(){return a.fU},isValidDtype:function(){return a.LP},locToIndex:function(){return a.qy},makeOnesTypedArray:function(){return a.p8},makeZerosNestedTypedArray:function(){return a.l6},makeZerosTypedArray:function(){return a.wT},nearestDivisor:function(){return a.jP},nearestLargerEven:function(){return a.nY},now:function(){return N},parseAxisParam:function(){return a.EC},randUniform:function(){return a.bj},repeatedTry:function(){return a.WD},rightPad:function(){return a.oj},shuffle:function(){return a.TV},shuffleCombo:function(){return a.d7},sizeFromShape:function(){return a.NA},sizeToSquarishShape:function(){return a.YP},squeezeShape:function(){return a.bp},sum:function(){return a.Sm},swap:function(){return a.LF},tanh:function(){return a.AE},toNestedArray:function(){return a.GX},toTypedArray:function(){return S}});var r=n(5050),a=n(6147),i=n(8987),o=n.n(i)()||i;function s(t){return o.fromString(t,!0,16)}var u=s("c3a5c85c97cb3127"),c=s("b492b66fbe98f273"),l=s("9ae16a3b2f90404f");function p(t){return t.xor(t.shru(47))}function f(t,e,n){var r=t.slice(e,e+n);return o.fromBytes(Array.from(r),!0,!0)}function h(t,e){return f(t,e,8)}function d(t,e){return f(t,e,4)}function m(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function v(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s("9ddfea08eb382d69"),r=t.xor(e).mul(n);r=r.xor(r.shru(47));var a=e.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function g(t,e,n,r){return function(t,e,n,r,a,i){a=a.add(t),i=m(i.add(a).add(r),21);var o=a;return a=(a=a.add(e)).add(n),i=i.add(m(a,44)),[a.add(r),i.add(o)]}(h(t,e),h(t,e+8),h(t,e+16),h(t,e+24),n,r)}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e>=8){var n=l.add(2*e),r=h(t,0).add(l),a=h(t,e-8),i=m(a,37).mul(n).add(r),o=m(r,25).add(a).mul(n);return v(i,o,n)}if(e>=4){var s=l.add(2*e),c=d(t,0);return v(c.shl(3).add(e),d(t,e-4),s)}if(e>0){var f=t[0],g=t[e>>1],y=t[e-1],b=f+(g<<8),w=e+(y<<2);return p(l.mul(b).xor(u.mul(w))).mul(l)}return l}function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n=l.add(2*e),r=h(t,0).mul(c),a=h(t,8),i=h(t,e-8).mul(n),o=h(t,e-16).mul(l);return v(m(r.add(a),43).add(m(i,30)).add(o),r.add(m(a.add(l),18)).add(i),n)}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n=l.add(2*e),r=h(t,0).mul(l),a=h(t,8),i=h(t,e-8).mul(n),o=h(t,e-16).mul(l),s=m(r.add(a),43).add(m(i,30)).add(o),u=v(s,r.add(m(a.add(l),18)).add(i),n),c=h(t,16).mul(n),p=h(t,24),f=s.add(h(t,e-32)).mul(n),d=u.add(h(t,e-24)).mul(n);return v(m(c.add(p),43).add(m(f,30)).add(d),c.add(m(p.add(r),18)).add(f),n)}function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length,n=o.fromNumber(81,!0);if(e<=32)return e<=16?y(t,e):b(t,e);if(e<=64)return w(t,e);var r=n,a=n.mul(c).add(113),i=p(a.mul(l).add(113)).mul(l),s=[o.UZERO,o.UZERO],f=[o.UZERO,o.UZERO];r=r.mul(l).add(h(t,0));var d=0,x=64*(e-1>>6),k=x+(e-1&63)-63;do{r=m(r.add(a).add(s[0]).add(h(t,d+8)),37).mul(c),a=m(a.add(s[1]).add(h(t,d+48)),42).mul(c),r=r.xor(f[1]),a=a.add(s[0]).add(h(t,d+40)),i=m(i.add(f[0]),33).mul(c),s=g(t,d,s[1].mul(c),r.add(f[0])),f=g(t,d+32,i.add(f[1]),a.add(h(t,d+16)));var S=[r,i];i=S[0],r=S[1],d+=64}while(d!==x);var N=c.add(i.and(255).shl(1));d=k,f[0]=f[0].add(e-1&63),s[0]=s[0].add(f[0]),f[0]=f[0].add(s[0]),r=m(r.add(a).add(s[0]).add(h(t,d+8)),37).mul(N),a=m(a.add(s[1]).add(h(t,d+48)),42).mul(N),r=r.xor(f[1].mul(9)),a=a.add(s[0].mul(9).add(h(t,d+40))),i=m(i.add(f[0]),33).mul(N),s=g(t,d,s[1].mul(N),r.add(f[0])),f=g(t,d+32,i.add(f[1]),a.add(h(t,d+16)));var E=[r,i];return i=E[0],r=E[1],v(v(s[0],f[0],N).add(p(a).mul(u)).add(i),v(s[1],f[1],N).add(r),N)}function k(t,e){return"string"===e?C(t):S([t],e)}function S(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=a.xH(t)),(0,r.OB)().getBool("DEBUG")&&a.D5(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var n=new Uint8Array(t.length),i=0;i<n.length;++i)0!==Math.round(t[i])&&(n[i]=1);return n}throw new Error("Unknown data type ".concat(e))}function N(){return(0,r.OB)().platform.now()}function E(t,e){return(0,r.OB)().platform.fetch(t,e)}function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",(0,r.OB)().platform.encode(t,e)}function T(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",(0,r.OB)().platform.decode(t,e)}},6147:function(t,e,n){"use strict";function r(t){for(var e=t.length,n=0;e>0;)n=Math.random()*e|0,s(t,--e,n)}function a(t,e){if(t.length!==e.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(t.length)+"Second array length was ".concat(e.length));for(var n=t.length,r=0;n>0;)r=Math.random()*n|0,s(t,--n,r),s(e,n,r)}function i(t,e,n){return Math.max(t,Math.min(e,n))}function o(t){return t%2===0?t:t+1}function s(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function u(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function c(t,e){var n=Math.random();return e*n+(1-n)*t}function l(t,e){for(var n=0,r=0;r<t.length;r++){var a=Number(t[r])-Number(e[r]);n+=a*a}return n}function p(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";p(g(t,e),(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}function h(t){p(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),Array.isArray(t)||D(t)&&!n)for(var r=0;r<t.length;++r)d(t[r],e,n);else e.push(t);return e}function m(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function v(t){return 0===t.length}function g(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function y(t){return t%1===0}function b(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function w(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function x(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return r(e),e}function k(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:setTimeout;return new Promise((function(a,i){var o=0;!function s(){if(t())a();else{o++;var u=e(o);null!=n&&o>=n?i():r(s,u)}}()}))}function N(t,e){for(var n=1,r=-1,a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found ".concat(t[a]," at dim ").concat(a));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));var i=t.slice();return i[r]=e/n,i}function E(t,e){var n=e.length;return p((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)})),p(t.every((function(t){return y(t)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(t)})),t.map((function(t){return t<0?n+t:t}))}function C(t,e){for(var n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||a?null:E(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function T(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type ".concat(t));n=new Uint8Array(e)}return n}function I(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function _(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}function A(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function R(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function D(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function O(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function M(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function F(t){return"string"===typeof t||t instanceof String}function z(t){return"boolean"===typeof t}function B(t){return"number"===typeof t}function L(t){return Array.isArray(t)?L(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":B(t)?"float32":F(t)?"string":z(t)?"bool":"float32"}function P(t){return!!(t&&t.constructor&&t.call&&t.apply)}function V(t,e){for(var n=e;n<t;++n)if(t%n===0)return n;return t}function W(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function U(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===e.length)for(var i=e[0]*(r?2:1),o=0;o<i;o++)a[o]=n[t+o];else for(var s=e[0],u=e.slice(1),c=u.reduce((function(t,e){return t*e}))*(r?2:1),l=0;l<s;l++)a[l]=U(t+l*c,u,n,r);return a}function j(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return e[0];var r=t.reduce((function(t,e){return t*e}))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return U(0,t,e,n)}function H(t,e){for(var n=q(t,e),r=0;r<n.length;r++)n[r]=1;return n}function q(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function G(t,e){var n=t.reduce((function(t,e){return t*e}),1);if(null==e||"float32"===e)return j(t,new Float32Array(n));if("int32"===e)return j(t,new Int32Array(n));if("bool"===e)return j(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))}function Z(t){t.forEach((function(e){p(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")}))}))}function K(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function X(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function $(t){return t&&t.then&&"function"===typeof t.then}n.d(e,{AE:function(){return b},Cq:function(){return h},D2:function(){return L},D5:function(){return _},E7:function(){return l},EC:function(){return E},GN:function(){return y},GX:function(){return j},HD:function(){return F},JZ:function(){return N},LF:function(){return s},LP:function(){return A},Mu:function(){return Z},N9:function(){return v},NA:function(){return m},NE:function(){return X},QB:function(){return R},Sm:function(){return u},TV:function(){return r},U$:function(){return x},Ub:function(){return M},WD:function(){return S},WP:function(){return T},YP:function(){return w},bT:function(){return O},bj:function(){return c},bp:function(){return C},cO:function(){return g},d7:function(){return a},e3:function(){return W},fU:function(){return D},hj:function(){return B},hu:function(){return p},jP:function(){return V},jn:function(){return z},k5:function(){return f},l6:function(){return G},mf:function(){return P},nY:function(){return o},oj:function(){return k},p8:function(){return H},qy:function(){return K},rQ:function(){return I},tI:function(){return $},uZ:function(){return i},wT:function(){return q},xH:function(){return d}})},7803:function(t,e,n){"use strict";n.r(e),n.d(e,{AdadeltaOptimizer:function(){return yf},AdagradOptimizer:function(){return bf},AdamOptimizer:function(){return wf},AdamaxOptimizer:function(){return xf},Callback:function(){return Ty},CallbackList:function(){return Kd},CustomCallback:function(){return Yd},DataStorage:function(){return ia},ENV:function(){return l},EarlyStopping:function(){return Ay},Environment:function(){return u},GraphModel:function(){return Mb},History:function(){return $d},InputSpec:function(){return Fd},KernelBackend:function(){return oa},LayerVariable:function(){return Dd},LayersModel:function(){return uv},MomentumOptimizer:function(){return Sf},Optimizer:function(){return gf},RMSPropOptimizer:function(){return Nf},RNN:function(){return Jg},Rank:function(){return mt},Reduction:function(){return Sl},SGDOptimizer:function(){return kf},Sequential:function(){return lv},SymbolicTensor:function(){return zd},Tensor:function(){return dt},TensorBuffer:function(){return lt},Variable:function(){return xt},abs:function(){return ks},acos:function(){return Ss},acosh:function(){return Ns},add:function(){return ku},addN:function(){return Su},addStrict:function(){return Nu},all:function(){return Wc},any:function(){return Uc},argMax:function(){return jc},argMin:function(){return Hc},asin:function(){return Es},asinh:function(){return Cs},atan:function(){return Ts},atan2:function(){return Eu},atanh:function(){return Is},avgPool:function(){return Rc},avgPool3d:function(){return Mc},backend:function(){return rn},backend_util:function(){return Ca},basicLSTMCell:function(){return sl},batchNorm:function(){return fu},batchNorm2d:function(){return hu},batchNorm3d:function(){return du},batchNorm4d:function(){return mu},batchNormalization:function(){return pu},batchNormalization2d:function(){return uu},batchNormalization3d:function(){return cu},batchNormalization4d:function(){return lu},batchToSpaceND:function(){return ur},booleanMaskAsync:function(){return ic},browser:function(){return of},buffer:function(){return or},callbacks:function(){return Oy},cast:function(){return cr},ceil:function(){return _s},clipByValue:function(){return As},clone:function(){return lr},complex:function(){return kn},concat:function(){return Un},concat1d:function(){return jn},concat2d:function(){return Hn},concat3d:function(){return qn},concat4d:function(){return Gn},constraints:function(){return vh},conv1d:function(){return cc},conv2d:function(){return lc},conv2dTranspose:function(){return yc},conv3d:function(){return pc},conv3dTranspose:function(){return bc},cos:function(){return Rs},cosh:function(){return Ds},cumsum:function(){return pr},customGrad:function(){return ea},data:function(){return r},deprecationWarn:function(){return We},depthToSpace:function(){return fr},depthwiseConv2d:function(){return dc},deregisterOp:function(){return Vy},diag:function(){return wl},disableDeprecationWarnings:function(){return Ve},dispose:function(){return Ze},disposeVariables:function(){return Ue},div:function(){return Cu},divStrict:function(){return Tu},dot:function(){return xc},dropout:function(){return xl},elu:function(){return Qc},enableDebugMode:function(){return Pe},enableProdMode:function(){return Le},engine:function(){return je},env:function(){return c},equal:function(){return ju},equalStrict:function(){return Hu},erf:function(){return Os},exp:function(){return Ms},expandDims:function(){return hr},expm1:function(){return Fs},eye:function(){return dr},fft:function(){return hl},fill:function(){return Bn},findBackend:function(){return tn},findBackendFactory:function(){return en},floor:function(){return zs},floorDiv:function(){return Iu},frame:function(){return Cl},fused:function(){return rp},gather:function(){return rc},gatherND:function(){return bl},getBackend:function(){return Qe},getKernel:function(){return f},getKernelsForBackend:function(){return h},grad:function(){return $r},grads:function(){return Yr},greater:function(){return qu},greaterEqual:function(){return Gu},greaterEqualStrict:function(){return Zu},greaterStrict:function(){return Ku},hammingWindow:function(){return El},hannWindow:function(){return Nl},ifft:function(){return dl},imag:function(){return Nn},image:function(){return Xl},inTopKAsync:function(){return _l},initializers:function(){return xd},input:function(){return dv},io:function(){return ef},irfft:function(){return vl},isFinite:function(){return Ks},isInf:function(){return Zs},isNaN:function(){return Gs},keep:function(){return Ke},layers:function(){return Sy},leakyRelu:function(){return Jc},less:function(){return Xu},lessEqual:function(){return $u},lessEqualStrict:function(){return Yu},lessStrict:function(){return Qu},linalg:function(){return jl},linspace:function(){return Ln},loadGraphModel:function(){return Fb},loadLayersModel:function(){return hv},localResponseNormalization:function(){return il},log:function(){return Bs},log1p:function(){return Ls},logSigmoid:function(){return Ps},logSoftmax:function(){return aa},logSumExp:function(){return qc},logicalAnd:function(){return vu},logicalNot:function(){return gu},logicalOr:function(){return yu},logicalXor:function(){return bu},losses:function(){return Pl},matMul:function(){return wc},math:function(){return rf},max:function(){return Gc},maxPool:function(){return Ac},maxPool3d:function(){return Oc},maximum:function(){return _u},maximumStrict:function(){return Au},mean:function(){return Zc},memory:function(){return He},metrics:function(){return Ny},min:function(){return Kc},minimum:function(){return Ru},minimumStrict:function(){return Du},mod:function(){return Ou},modStrict:function(){return Mu},model:function(){return pv},models:function(){return Ey},moments:function(){return Xc},movingAverage:function(){return cl},mul:function(){return Fu},mulStrict:function(){return zu},multiRNNCell:function(){return ul},multinomial:function(){return mr},neg:function(){return Vs},nextFrame:function(){return If},norm:function(){return ol},notEqual:function(){return Ju},notEqualStrict:function(){return tc},oneHot:function(){return vr},ones:function(){return Fn},onesLike:function(){return Vn},op:function(){return xn},outerProduct:function(){return kc},pad:function(){return gr},pad1d:function(){return yr},pad2d:function(){return br},pad3d:function(){return wr},pad4d:function(){return xr},pool:function(){return Dc},pow:function(){return Bu},powStrict:function(){return Lu},prelu:function(){return tl},print:function(){return sr},prod:function(){return Yc},profile:function(){return qe},rand:function(){return kr},randomGamma:function(){return Nr},randomNormal:function(){return Sr},randomUniform:function(){return Er},range:function(){return Pn},ready:function(){return Ye},real:function(){return Sn},reciprocal:function(){return Ws},registerBackend:function(){return nn},registerCallbackConstructor:function(){return mv},registerKernel:function(){return d},registerOp:function(){return Ly},regularizers:function(){return Cy},relu:function(){return el},relu6:function(){return nl},removeBackend:function(){return Je},reshape:function(){return Cr},reverse:function(){return Sc},reverse1d:function(){return Nc},reverse2d:function(){return Ec},reverse3d:function(){return Cc},reverse4d:function(){return Tc},rfft:function(){return ml},round:function(){return Us},rsqrt:function(){return js},scalar:function(){return Tn},scatterND:function(){return fl},selu:function(){return rl},separableConv2d:function(){return gc},sequential:function(){return fv},serialization:function(){return lf},setBackend:function(){return $e},setPlatform:function(){return an},setdiff1dAsync:function(){return Or},sigmoid:function(){return Hs},sign:function(){return qs},signal:function(){return Il},sin:function(){return Xs},sinh:function(){return $s},slice:function(){return Fc},slice1d:function(){return zc},slice2d:function(){return Bc},slice3d:function(){return Lc},slice4d:function(){return Pc},slice_util:function(){return Xr},softmax:function(){return ra},softplus:function(){return Ys},spaceToBatchND:function(){return Tr},sparseToDense:function(){return yl},spectral:function(){return gl},split:function(){return Zn},sqrt:function(){return Qs},square:function(){return xs},squaredDifference:function(){return Pu},squaredDifferenceStrict:function(){return Vu},squeeze:function(){return Ir},stack:function(){return _r},step:function(){return Js},stft:function(){return Tl},stridedSlice:function(){return ll},sub:function(){return Wu},subStrict:function(){return Uu},sum:function(){return $c},tan:function(){return tu},tanh:function(){return eu},tensor:function(){return En},tensor1d:function(){return In},tensor2d:function(){return _n},tensor3d:function(){return An},tensor4d:function(){return Rn},tensor5d:function(){return Dn},tensor6d:function(){return On},tensor_util:function(){return _t},test_util:function(){return df},tidy:function(){return Ge},tile:function(){return Ar},time:function(){return Xe},topk:function(){return pl},train:function(){return Cf},transpose:function(){return al},truncatedNormal:function(){return Rr},unregisterKernel:function(){return m},unsortedSegmentSum:function(){return ac},unstack:function(){return Dr},util:function(){return at},valueAndGrad:function(){return Qr},valueAndGrads:function(){return Jr},variable:function(){return Mn},variableGrads:function(){return ta},version:function(){return cx},version_converter:function(){return zb},version_core:function(){return mf},version_layers:function(){return Om},webgl:function(){return vf},where:function(){return wu},whereAsync:function(){return xu},zeros:function(){return zn},zerosLike:function(){return Wn}});var r={};n.r(r),n.d(r,{CSVDataset:function(){return Ww},Dataset:function(){return Iw},FileDataSource:function(){return ex},TextLineDataset:function(){return Mw},URLDataSource:function(){return nx},array:function(){return Aw},csv:function(){return rx},func:function(){return ax},generator:function(){return ix},microphone:function(){return sx},version_data:function(){return ux},webcam:function(){return ox},zip:function(){return Rw}});var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var u=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n,r=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(n,e[0],e[1]),e.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0],a=n[1];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,a)}))}},t}();function c(){return l}var l=null,p=new Map;function f(t,e){var n=v(t,e);return p.get(n)}function h(t){for(var e=p.entries(),n=[];;){var r=e.next(),a=r.done,i=r.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===t&&n.push(s)}return n}function d(t){var e=t.kernelName,n=t.backendName,r=v(e,n);if(p.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");p.set(r,t)}function m(t,e){var n=v(t,e);if(!p.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is not registered");p.delete(n)}function v(t,e){return e+"_"+t}function g(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function y(t,e,n){return Math.max(t,Math.min(e,n))}function b(t){return t%2==0?t:t+1}function w(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function x(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function k(t,e,n){void 0===n&&(n=""),x(C(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function S(t){x(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function N(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||V(t)&&!n)for(var r=0;r<t.length;++r)N(t[r],e,n);else e.push(t);return e}function E(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function C(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function T(t){return t%1==0}function I(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function _(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function A(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function R(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,a){var i=0;!function o(){if(t())r();else{var s=e(++i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function D(t,e){for(var n=1,r=-1,a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found "+t[a]+" at dim "+a);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var i=t.slice();return i[r]=e/n,i}function O(t,e){var n=e.length;return x((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),x(t.every((function(t){return T(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function M(t,e){for(var n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||a?null:O(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function F(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function z(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function B(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function L(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function P(t,e){return"complex64"!==e&&("float32"!==e||"complex64"===t)&&("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)}function V(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function W(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function U(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function j(t){return"string"==typeof t||t instanceof String}function H(t){return"boolean"==typeof t}function q(t){return"number"==typeof t}function G(t){return Array.isArray(t)?G(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":q(t)?"float32":j(t)?"string":H(t)?"bool":"float32"}function Z(t){return!!(t&&t.constructor&&t.call&&t.apply)}function K(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function X(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function $(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=N(t)),n&&B(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),a=0;a<r.length;++a)0!==Math.round(t[a])&&(r[a]=1);return r}throw new Error("Unknown data type "+e)}function Y(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[e+o];else{i=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(o=0;o<i;o++)a[o]=t(e+o*u,s,r)}return a}(0,t,e)}function Q(t,e){for(var n=J(t,e),r=0;r<n.length;r++)n[r]=1;return n}function J(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function tt(){return c().platform.now()}function et(t){t.forEach((function(e){x(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function nt(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",c().platform.encode(t,e)}function rt(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",c().platform.decode(t,e)}var at=Object.freeze({shuffle:g,clamp:y,nearestLargerEven:b,sum:w,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var a=Number(t[r])-Number(e[r]);n+=a*a}return n},assert:x,assertShapesMatch:k,assertNonNull:S,flatten:N,sizeFromShape:E,isScalarShape:function(t){return 0===t.length},arraysEqual:C,isInt:T,tanh:I,sizeToSquarishShape:_,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return g(e),e},rightPad:A,repeatedTry:R,inferFromImplicitShape:D,parseAxisParam:O,squeezeShape:M,getTypedArrayFromDType:F,getArrayFromDType:z,checkConversionForErrors:B,isValidDtype:L,hasEncodingLoss:P,isTypedArray:V,bytesPerElement:W,bytesFromStringArray:U,isString:j,isBoolean:H,isNumber:q,inferDtype:G,isFunction:Z,nearestDivisor:K,computeStrides:X,toTypedArray:$,toNestedArray:Y,makeOnesTypedArray:Q,makeZerosTypedArray:J,now:tt,assertNonNegativeIntegerDimensions:et,fetch:function(t,e){return c().platform.fetch(t,e)},encodeString:nt,decodeString:rt}),it=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new ot)}return t.prototype.profileKernel=function(t,e,n){var r,a=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var a=t[r];if(isNaN(a)||!isFinite(a))return console.warn("Found "+a+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(t,n,r,i.kernelMs,e,o)}))}))})),r},t}(),ot=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,a,i){var o=A(r+"ms",9),s=A(t,25),u=e.rank,c=e.size,l=A(e.shape.toString(),14),p="";for(var f in a){var h=a[f].shape,d=h.length;p+=f+": "+d+"D "+(d>0?h:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+p+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function st(t,e,n){return A(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":j(t)?"'"+t+"'":"bool"===n?ut(t):parseFloat(t.toFixed(7)).toString(),e)}function ut(t){return 0===t?"false":"true"}function ct(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var lt=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=E(t),null!=n){var a=n.length;x(a===this.size,(function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||z(e,this.size),this.strides=X(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),x(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var a=this.locToIndex(n);this.values[a]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,a=t;r<a.length;r++){var i=a[r];if(i<0||i>=this.shape[n]){var o="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return pt().makeTensor(this.values,this.shape,this.dtype)},t}(),pt=null,ft=null,ht=null,dt=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=E(t),this.strides=X(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),x(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,a){return this.throwIfDisposed(),this.reshape([t,e,n,r,a])},t.prototype.asType=function(t){return this.throwIfDisposed(),ft.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,ft.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return ft.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Y(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return Y(this.shape,this.dataSync())},t.prototype.data=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=pt().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return rt(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=pt().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return rt(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,pt().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(pt().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),ft.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),ft.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),ft.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),ft.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),ft.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),ft.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),ft.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var a=X(e),i=function(t,e,n,r){var a=E(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,u="complex64"===n?ct(t):t;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,p=0;p<i;p++)o[p]=Math.max(o[p],st(u[l+p],0,n).length);return o}(t,e,n,a),o=e.length,s=function t(e,n,r,a,i,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[st(ct(e)[0],0,r)]:"bool"===r?[ut(e[0])]:[e[0].toString()];if(1===c){if(u>20){var l=3*s,p=Array.from(e.slice(0,l)),f=Array.from(e.slice(u-3*s,u));return"complex64"===r&&(p=ct(p),f=ct(f)),["["+p.map((function(t,e){return st(t,i[e],r)})).join(", ")+", ..., "+f.map((function(t,e){return st(t,i[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?ct(e):Array.from(e)).map((function(t,e){return st(t,i[e],r)})).join(", ")+"]"]}var h=n.slice(1),d=a.slice(1),m=a[0]*s,v=[];if(u>20){for(var g=0;g<3;g++){var y=(b=g*m)+m;v.push.apply(v,t(e.slice(b,y),h,r,d,i,!1))}for(v.push("..."),g=u-3;g<u;g++)y=(b=g*m)+m,v.push.apply(v,t(e.slice(b,y),h,r,d,i,g===u-1))}else for(g=0;g<u;g++){var b;y=(b=g*m)+m,v.push.apply(v,t(e.slice(b,y),h,r,d,i,g===u-1))}var w=2===c?",":"";for(v[0]="["+v[0]+w,g=1;g<v.length-1;g++)v[g]=" "+v[g]+w;var x=",\n";for(g=2;g<c;g++)x+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(o?"":x),v}(t,e,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),ft.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),ft.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),ft.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),ft.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),ft.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),ft.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),ft.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),ft.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),ft.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),ft.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),ft.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),ft.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,a){return void 0===n&&(n=.001),ht("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,a,r,n)},t.prototype.batchNorm=function(t,e,n,r,a){return void 0===a&&(a=.001),this.throwIfDisposed(),ft.batchNorm(this,t,e,n,r,a)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ft.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),ft.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),ft.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),ft.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),ft.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),ft.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),ft.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),ft.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),ft.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),ft.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),ft.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),ft.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),ft.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),ft.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),ft.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),ft.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),ft.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ft.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),ft.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ft.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),ft.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),ft.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),ft.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ft.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),ft.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),ft.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ft.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),ft.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),ft.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),ft.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),ft.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),ft.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ft.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),ft.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ft.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ft.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ft.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ft.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),ft.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),ft.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),ft.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),ft.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),ft.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),ft.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),ft.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),ft.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),ft.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),ft.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),ft.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),ft.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),ft.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),ft.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),ft.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),ft.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),ft.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),ft.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),ft.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),ft.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ft.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),ft.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),ft.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),ft.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),ft.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),ft.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),ft.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),ft.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),ft.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),ft.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),ft.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),ft.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),ft.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),ft.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),ft.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),ft.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),ft.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),ft.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),ft.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),ft.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),ft.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),ft.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),ft.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),ft.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),ft.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),ft.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),ft.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),ft.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),ft.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),ft.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),ft.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,a,i){return void 0===r&&(r="NWC"),void 0===a&&(a=1),this.throwIfDisposed(),ft.conv1d(this,t,e,n,r,a,i)},t.prototype.conv2d=function(t,e,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),ft.conv2d(this,t,e,n,r,a,i)},t.prototype.conv2dTranspose=function(t,e,n,r,a){return this.throwIfDisposed(),ft.conv2dTranspose(this,t,e,n,r,a)},t.prototype.depthwiseConv2D=function(t,e,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),ft.depthwiseConv2d(this,t,e,n,r,a,i)},t.prototype.separableConv2d=function(t,e,n,r,a,i){return void 0===a&&(a=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),ft.separableConv2d(this,t,e,n,r,a,i)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),ft.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),ft.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),ft.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,a){return this.throwIfDisposed(),ft.pool(this,t,e,n,r,a)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),pt().makeVariable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ft.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ft.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ft.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),ft.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,a,i,o,s){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),ft.stridedSlice(this,t,e,n,r,a,i,o,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ft.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),ft.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),ft.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),ft.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),ft.spectral.irfft(this)},t}();Object.defineProperty(dt,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var mt,vt,gt,yt,bt,wt,xt=function(t){function e(e,n,r,a){var i=t.call(this,e.shape,e.dtype,e.dataId,a)||this;return i.trainable=n,i.name=r,i}return i(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!C(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");pt().disposeTensor(this),this.dataId=t.dataId,pt().incRef(this,null)},e.prototype.dispose=function(){pt().disposeVariable(this),this.isDisposedInternal=!0},e}(dt);Object.defineProperty(xt,Symbol.hasInstance,{value:function(t){return t instanceof dt&&null!=t.assign&&t.assign instanceof Function}}),(wt=mt||(mt={})).R0="R0",wt.R1="R1",wt.R2="R2",wt.R3="R3",wt.R4="R4",wt.R5="R5",wt.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(vt||(vt={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(gt||(gt={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(yt||(yt={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(bt||(bt={}));var kt={float32:yt,int32:vt,bool:gt,complex64:bt};function St(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return kt[t][e]}function Nt(t){return St(t,"int32")}function Et(t,e){if(t.dtype===e.dtype)return[t,e];var n=St(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Ct(t,e){x(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function Tt(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof dt)n.push(e);else if(a=e,Array.isArray(a)||"object"==typeof a){var a,i=e;for(var o in i){var s=i[o];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}var It,_t=Object.freeze({makeTypesMatch:Et,assertTypesMatch:Ct,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:Tt}),At=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),Rt=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new At}return t.prototype.ready=function(){return o(this,void 0,void 0,(function(){var t,e,n;return s(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return s(this,(function(a){switch(a.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=a.sent(),[3,3];case 2:r=n,a.label=3;case 3:if(!r)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new it(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;h(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;h(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<e.pendingBackendInitId)&&(e.registry[t]=n,e.pendingBackendInit=null,!0)})).catch((function(n){return!(a<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,a=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){return t.toFloat()}}}),[]),e},t.prototype.runKernel=function(t,e,n,r,a){return this.runKernelFunc(null,e,null,t,n,r,a)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(t){a+="complex64"===t.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+t+"'")},t.prototype.runKernelFunc=function(t,e,n,r,a,i,o){var s,u=this;void 0===i&&(i=[]),void 0===o&&(o=[]);var c,l=[],p=this.isTapeOn(),h=null!=this.state.activeScope?this.state.activeScope.name:"",d=function(t){p&&(l=t.map((function(t){return u.keep(u.clone(t))})))},m=this.state.numBytes,v=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,y=f(r,this.backendName);return c=null!=y?function(){var t=u.backend.numDataIds();g=y.kernelFunc({inputs:e,attrs:a,backend:u.backend});var n=Array.isArray(g)?g:[g];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(h,t,n);var r=n.map((function(t){var e=t.dataId,n=t.shape,r=t.dtype;return u.makeTensorFromDataId(e,n,r)})),s=r.filter((function(t,e){return o[e]}));return d(i.slice().concat(s)),r}:function(){var e=u.backend.numDataIds();g=u.tidy((function(){return t(u.backend,d)}));var n=Array.isArray(g)?g:[g];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(h,e,n),n},this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(h,e,(function(){return c()})):c()})),p&&this.addTapeNode(h,e,s,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:h,bytesAdded:this.state.numBytes-m,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-v,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(g)?s:s[0]},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=t;"string"===n&&j(t[0])&&(a=t.map((function(t){return nt(t)})));var i=r.write(a,e,n),o=new dt(e,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=U(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var a=new dt(e,n=n||"float32",t,this.nextTensorId());return this.incRef(a,r),a},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var a=new xt(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},t.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*W(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof xt||this.track(t)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,a){var i=this,o={id:this.state.nextTapeNodeId++,name:t,inputs:e,outputs:n,saved:a};null!=r&&(o.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],a=J(r.size,r.dtype);return i.makeTensor(a,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],a)}),this.state.activeTape.push(o)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=Tt(t),r=new Set(n.map((function(t){return t.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var a=this;if(void 0===r&&(r=!1),x(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",t)}));x(i instanceof dt,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},a={},i=0;i<e.length;i++)r[e[i].id]=!0;for(i=0;i<t.length;i++){var o=(d=t[i]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){d.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,a[d.id]=!0;break}if(c)break}}var p={};p[n.id]=!0;var f={};for(i=t.length-1;i>=0;i--)for(o=(d=t[i]).inputs,l=0;l<d.outputs.length;l++)if(p[d.outputs[l].id]){for(var s in o)p[o[s].id]=!0,f[d.id]=!0;break}var h=[];for(i=0;i<t.length;i++){var d;if(a[(d=t[i]).id]&&f[d.id]){var m={};for(var s in d.inputs){var v=d.inputs[s];r[v.id]&&(m[s]=v)}var g=Object.assign({},d);g.inputs=m,g.outputs=d.outputs,h.push(g)}}return h}(this.state.activeTape,e,i);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[i.id]=null==n?(r=Q(E(t=i.shape),"float32"),Dt.makeTensor(r,t,"float32")):n,function(t,e,n){for(var r=function(r){var a=e[r],i=[];if(a.outputs.forEach((function(e){var n=t[e.id];null!=n?i.push(n):i.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+a.name+".");var o=a.gradient(i),s=function(e){if(!(e in o))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+a.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=a.inputs[e];if(!C(r.shape,i.shape))throw new Error("Error in gradient for op "+a.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==t[i.id])t[i.id]=r;else{var s=t[i.id];t[i.id]=s.add(r),s.dispose()}};for(var u in a.inputs)s(u)},a=e.length-1;a>=0;a--)r(a)}(s,o,(function(t){return a.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(t){for(var e in t.saved)t.saved[e].dispose()})),a.state.activeTape=null),{value:i,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return x(Z(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];x(r.every((function(t){return t instanceof dt})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(t,e){i[e]=t})),e.runKernelFunc((function(e,a){return x((n=t.apply(void 0,r.concat([a]))).value instanceof dt,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),x(Z(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(t,e){var a=n.gradFunc(t,e),i=Array.isArray(a)?a:[a];x(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),x(i.every((function(t){return t instanceof dt})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return i.forEach((function(t,e){o[e]=function(){return t}})),o}))}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return e=tt(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=tt()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new At,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),Dt=function(){var t=function(){if(null==It){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof n.g)t=n.g;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}It=t}return It}();if(null==t._tfengine){var e=new u(t);t._tfengine=new Rt(e)}return function(t){l=t}(t._tfengine.ENV),pt=function(){return t._tfengine},t._tfengine}();function Ot(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Mt=c();Mt.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Mt.registerFlag("IS_BROWSER",(function(){return Ot()})),Mt.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Mt.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Mt.registerFlag("PROD",(function(){return!1})),Mt.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Mt.getBool("DEBUG")})),Mt.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Mt.registerFlag("IS_TEST",(function(){return!1}));var Ft,zt,Bt,Lt={},Pt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Vt(t,e){Lt[t]=e}function Wt(t){t in Lt||(Lt[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=Ut(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete Lt[t]}),!1),1===t?e.getContext("webgl",Pt)||e.getContext("experimental-webgl",Pt):e.getContext("webgl2",Pt)}(t));var e=Lt[t];return e.isContextLost()?(delete Lt[t],Wt(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Lt[t])}function Ut(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function jt(t,e){return[e,t]}function Ht(t){var e=E(t);return _(Math.ceil(e/4))}function qt(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Gt(t,e){var n,r,a,i,o,s,u,l,p,f=t;return 2===c().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,i=f.RGBA32F,o=f.RED,s=4,u=1,l=f.HALF_FLOAT,p=f.FLOAT):(n=t.RGBA,r=t.RGBA,a=t.RGBA,i=f.RGBA,o=t.RGBA,s=4,u=4,l=null!=e?e.HALF_FLOAT_OES:null,p=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:p}}function Zt(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Xt(t,e))}(t),r}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(Ft||(Ft={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(zt||(zt={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Bt||(Bt={}));function Kt(t){return!!(c().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function Xt(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function $t(t,e,n){return be(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function Yt(t,e,n){var r=be(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Zt(t,e,(function(){return t.shaderSource(r,n)})),Zt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Qt(t,e,n){var r=be(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Zt(t,e,(function(){return t.shaderSource(r,n)})),Zt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=ee.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],a=t.split("\n"),i=a.length.toString().length+2,o=a.map((function(t,e){return A((e+1).toString(),i)+t})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),p=o.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+A(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(p.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Jt,te,ee=/ERROR: [0-9]+:([0-9]+):/g;function ne(t,e){return be(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function re(t,e,n){if(Zt(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function ae(t,e,n){if(Zt(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function ie(t,e,n){var r=be(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Zt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),Zt(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function oe(t,e,n){var r=be(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Zt(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),Zt(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function se(t,e){return be(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function ue(t,e){var n=c().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function ce(t,e){return be(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function le(t,e,n,r,a,i,o,s){var u=t.getAttribLocation(n,r);return-1!==u&&(Zt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,a)})),Zt(t,e,(function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,o,s)})),Zt(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function pe(t,e,n,r){we(t,r),Zt(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function fe(t,e,n,r){return be(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function he(t,e,n){return t.getUniformLocation(e,n)}function de(t,e,n,r,a,i){Zt(t,e,(function(){return pe(t,e,r,i)})),Zt(t,e,(function(){return t.uniform1i(a,i)}))}function me(t,e,n,r){Zt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Zt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function ve(t,e,n){Zt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Zt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function ge(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+ye(t,e))}function ye(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function be(t,e,n,r){var a=Zt(t,e,(function(){return n()}));if(null==a)throw new Error(r);return a}function we(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function xe(t,e){return void 0===e&&(e=2),E(t.slice(0,t.length-e))}function ke(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Se(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[xe(t)].concat(ke(t))),e}function Ne(t,e){var n;void 0===e&&(e=!1);var r=c().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?b(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var a=M(t);t=a.newShape}var i=E(t);if(t.length<=1&&i<=r)return[1,i];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var o=xe(t),s=2,u=2;return t.length&&(s=(n=ke(t))[0],u=n[1]),_(i=o*(s/2)*(u/2)).map((function(t){return 2*t}))}return _(i)}function Ee(t){return t%2==0}function Ce(t,e){if(C(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Ee(n)&&Ee(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Ee(t[0])&&Ee(e[0])}function Te(t){if(null==Jt){var e=Wt(t);Jt=e.getParameter(e.MAX_TEXTURE_SIZE)}return Jt}function Ie(t){if(null==te){var e=Wt(t);te=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,te)}function _e(t){if(0===t)return 0;var e=Wt(t);return Ae(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:Ae(e,"EXT_disjoint_timer_query")?1:0}function Ae(t,e){return null!=t.getExtension(e)}function Re(t){try{if(null!=Wt(t))return!0}catch(t){return!1}return!1}function De(t){if(0===t)return!1;var e=Wt(t);if(1===t){if(!Ae(e,"OES_texture_float"))return!1}else if(!Ae(e,"EXT_color_buffer_float"))return!1;return Me(e)}function Oe(t){if(0===t)return!1;var e=Wt(t);if(1!==t){if(Ae(e,"EXT_color_buffer_float"))return Me(e);if(Ae(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=Gt(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(a),i}(e,n)}return!1}return!!Ae(e,"OES_texture_float")&&!!Ae(e,"WEBGL_color_buffer_float")&&Me(e)}function Me(t){var e=Gt(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),a}function Fe(t){return 2===t&&null!=Wt(t).fenceSync}var ze=Object.freeze({callAndCheck:Zt,canBeRepresented:Kt,getWebGLErrorMessage:Xt,getExtensionOrThrow:$t,createVertexShader:Yt,createFragmentShader:Qt,createProgram:ne,linkProgram:re,validateProgram:ae,createStaticVertexBuffer:ie,createStaticIndexBuffer:oe,getNumChannels:function(){return 2===c().getNumber("WEBGL_VERSION")?1:4},createTexture:se,validateTextureSize:ue,createFramebuffer:ce,bindVertexBufferToProgramAttribute:le,bindTextureUnit:pe,unbindTextureUnit:function(t,e,n){we(t,n),Zt(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:fe,getProgramUniformLocation:he,bindTextureToProgramUniformSampler:de,bindCanvasToFramebuffer:function(t,e){Zt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Zt(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),Zt(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:me,unbindColorTextureFromFramebuffer:ve,validateFramebuffer:ge,getFramebufferErrorMessage:ye,getBatchDim:xe,getRowsCols:ke,getShapeAs3D:Se,getTextureShapeFromLogicalShape:Ne,isReshapeFree:Ce,getWebGLMaxTextureSize:Te,resetMaxTextureSize:function(){Jt=null},resetMaxTexturesInShader:function(){te=null},getMaxTexturesInShader:Ie,getWebGLDisjointQueryTimerVersion:_e,hasExtension:Ae,isWebGLVersionEnabled:Re,isCapableOfRenderingToFloatTexture:De,isDownloadFloatTextureEnabled:Oe,isWebGLFenceEnabled:Fe}),Be=c();function Le(){c().set("PROD",!0)}function Pe(){c().set("DEBUG",!0)}function Ve(){c().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function We(t){c().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ue(){Dt.disposeVariables()}function je(){return Dt}function He(){return Dt.memory()}function qe(t){return Dt.profile(t)}function Ge(t,e){return Dt.tidy(t,e)}function Ze(t){Tt(t).forEach((function(t){return t.dispose()}))}function Ke(t){return Dt.keep(t)}function Xe(t){return Dt.time(t)}function $e(t){return Dt.setBackend(t)}function Ye(){return Dt.ready()}function Qe(){return Dt.backendName}function Je(t){Dt.removeBackend(t)}function tn(t){return Dt.findBackend(t)}function en(t){return Dt.findBackendFactory(t)}function nn(t,e,n){return void 0===n&&(n=1),Dt.registerBackend(t,e,n)}function rn(){return Dt.backend}function an(t,e){c().setPlatform(t,e)}function on(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c().getBool("IS_TEST")||console.warn.apply(console,t)}function sn(t,e){var n=t;if(V(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||V(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&c().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||V(e)){x(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),x(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var a=n.slice(1),i=0;i<e.length;++i)t(e[i],a,r.concat(i))}else x(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function un(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function cn(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof dt)return un(r,t.dtype,e,n),t;var a=G(t);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),un(r,a,e,n),null==t||!V(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var i=null==t?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=sn(t,a);V(t)||Array.isArray(t)||(t=[t]);var s="string"!==a?$(t,a,c().getBool("DEBUG")):N(t,[],!0);return Dt.makeTensor(s,o,a)}function ln(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return cn(t,e+"["+r+"]",n)}),r)}function pn(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function fn(t,e,n){for(var r=t.length+e.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(t[i++]):a.push(e[o++]);return a}function hn(t,e){for(var n=[],r=t.length,a=0;a<r;a++)-1===e.indexOf(a)&&n.push(t[a]);return[n,e.map((function(e){return t[e]}))]}function dn(t,e){return fn(t,e.map((function(t){return 1})),e)}function mn(t,e,n){x(pn(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function vn(t,e){if(pn(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function gn(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function yn(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function bn(t,e){var n=t[0].length;t.forEach((function(t,e){x(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),x(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,a){for(var i=0;i<n;i++)x(i===e||t[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."}))}))}function wn(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function xn(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Dt.startScope(n);try{var a=r.apply(void 0,t);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Dt.endScope(a),a}catch(t){throw Dt.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}Be.registerFlag("HAS_WEBGL",(function(){return Be.getNumber("WEBGL_VERSION")>0})),Be.registerFlag("WEBGL_VERSION",(function(){return Re(2)?2:Re(1)?1:0})),Be.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Be.get("WEBGL_VERSION")})),Be.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Be.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Be.registerFlag("WEBGL_PACK",(function(){return Be.getBool("HAS_WEBGL")})),Be.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_PACK_CLIP",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Be.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_PACK_REDUCE",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_CONV_IM2COL",(function(){return Be.getBool("WEBGL_PACK")})),Be.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Te(Be.getNumber("WEBGL_VERSION"))})),Be.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Ie(Be.getNumber("WEBGL_VERSION"))})),Be.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=Be.getNumber("WEBGL_VERSION");return 0===t?0:_e(t)})),Be.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Be.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),Be.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return De(Be.getNumber("WEBGL_VERSION"))})),Be.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Be.getBool("WEBGL_FORCE_F16_TEXTURES")&&Be.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Be.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Oe(Be.getNumber("WEBGL_VERSION"))})),Be.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Fe(Be.getNumber("WEBGL_VERSION"))})),Be.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Be.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),ht=We;var kn=xn({complex_:function(t,e){var n=cn(t,"real","complex"),r=cn(e,"imag","complex");return k(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Dt.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),Sn=xn({real_:function(t){var e=cn(t,"input","real");return Dt.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),Nn=xn({imag_:function(t){var e=cn(t,"input","imag");return Dt.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function En(t,e,n){return Cn(t,e,sn(t,n),n)}function Cn(t,e,n,r){if(null==r&&(r=G(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!V(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){et(e);var a=E(e),i=E(n);x(a===i,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+a+" values but has "+i}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==E(e.slice(o));x(n[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return V(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?$(t,r,c().getBool("DEBUG")):N(t,[],!0),Dt.makeTensor(t,e,r)}function Tn(t,e){if((V(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&V(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Cn(t,[],[],e)}function In(t,e){S(t);var n=sn(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Cn(t,null,n,e)}function _n(t,e,n){if(S(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=sn(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Cn(t,e,r,n)}function An(t,e,n){if(S(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=sn(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Cn(t,e,r,n)}function Rn(t,e,n){if(S(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=sn(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Cn(t,e,r,n)}function Dn(t,e,n){if(S(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=sn(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Cn(t,e,r,n)}function On(t,e,n){if(S(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=sn(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Cn(t,e=e||r,r,n)}function Mn(t,e,n,r){return void 0===e&&(e=!0),Dt.makeVariable(t,e,n,r)}function Fn(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=Fn(t,"float32"),r=zn(t,"float32");return kn(n,r)}var a=Q(E(t),e);return Dt.makeTensor(a,t,e)}function zn(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=zn(t,"float32"),r=zn(t,"float32");return kn(n,r)}var a=J(E(t),e);return Dt.makeTensor(a,t,e)}function Bn(t,e,n){return Dt.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function Ln(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return Dt.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function Pn(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return zn([0],r);var a=J(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return In(a,r)}var Vn=xn({onesLike_:function(t){var e=cn(t,"x","onesLike");if("complex64"===e.dtype){var n=Vn(Sn(e)),r=Wn(Nn(e));return kn(n,r)}return Dt.runKernelFunc((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Wn(t)}}}))}}),Wn=xn({zerosLike_:function(t){var e=cn(t,"x","zerosLike");return Dt.runKernelFunc((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Wn(t)}}}))}}),Un=xn({concat_:function(t,e){void 0===e&&(e=0),x(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=ln(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=O(e,n[0].shape)[0];var r=wn(n.map((function(t){return t.shape})),e);if(0===E(r))return En([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var a=n.map((function(t){return t.shape}));bn(a,e);var i=n;return Dt.runKernelFunc((function(t){return t.concat(n,e)}),i,(function(t){var n=a.map((function(t){return t[e]}));return Zn(t,n,e).map((function(t){return function(){return t}}))}))}}),jn=xn({concat1d_:function(t){return Un(t,0)}}),Hn=xn({concat2d_:function(t,e){return Un(t,e)}}),qn=xn({concat3d_:function(t,e){return Un(t,e)}}),Gn=xn({concat4d_:function(t,e){return Un(t,e)}}),Zn=xn({split_:function(t,e,n){void 0===n&&(n=0);var r,a=cn(t,"x","split");return n=O(n,a.shape)[0],"number"==typeof e?(x(a.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(a.shape[n]/e)):(x(a.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Dt.runKernelFunc((function(t){return t.split(a,r,n)}),{$x:a},(function(t){return{$x:function(){return Un(t,n)}}}))}});function Kn(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var Xn=Kn((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var n=new r(t),i=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)})),$n=Kn((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)})),Yn=Kn((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)})),Qn=Kn((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],n=(t^=t>>>7)^t<<24,n^=(t=r[a+1&7])^t>>>10,n^=(t=r[a+3&7])^t>>>3,n^=(t=r[a+4&7])^t<<7,t=r[a+7&7],n^=(t^=t<<13)^t<<9,r[a]=n,e.i=a+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.x&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)})),Jn=Kn((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},function(t,e){var n,r,a,i,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,i=-32;i<u;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.X&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)})),tr=Kn((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)})),er=Kn((function(t){!function(e,r){var a,i=this,o=256,s="random",u=r.pow(o,6),c=r.pow(2,52),l=2*c,p=255;function f(t,n,p){var f=[],g=m(function t(e,n){var r,a=[],i=typeof e;if(n&&"object"==i)for(r in e)try{a.push(t(e[r],n-1))}catch(t){}return a.length?a:"string"==i?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,v(e)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(o):(t=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(t)),v(t)}catch(t){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,v(e)]}}():t,3),f),y=new h(f),b=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*o,e*=o,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,m(v(y.S),e),(n.pass||p||function(t,e,n,a){return a&&(a.S&&d(a,y),t.state=function(){return d(y,{})}),n?(r[s]=t,e):t})(b,g,"global"in n?n.global:this==r,n.state)}function h(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=p&i+t[a%n]+(e=s[a])],s[i]=e;(r.g=function(t){for(var e,n=0,a=r.i,i=r.j,s=r.S;t--;)e=s[a=p&a+1],n=n*o+s[p&(s[a]=s[i=p&i+e])+(s[i]=e)];return r.i=a,r.j=i,n})(o)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,r=t+"",a=0;a<r.length;)e[p&a]=p&(n^=19*e[p&a])+r.charCodeAt(a++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(r["seed"+s]=f,m(r.random(),e),t.exports){t.exports=f;try{a=n(7806)}catch(t){}}}([],Math)}));er.alea=Xn,er.xor128=$n,er.xorwow=Yn,er.xorshift7=Qn,er.xor4096=Jn,er.tychei=tr;var nr=er.alea,rr=function(){function t(t,e,n,r,a){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=nr(i.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),ar=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var a=r||Math.random();this.randu=nr(a.toString()),this.randn=new rr(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-i+Math.log(i)),(a=this.randu())<e||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),ir=function(){function t(t,e,n,r){var a=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==a.dtype||"float32"===a.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=nr(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function or(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",et(t),new lt(t,e,n)}function sr(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}var ur=xn({batchToSpaceND_:function(t,e,n){var r=cn(t,"x","batchToSpaceND"),a=e.reduce((function(t,e){return t*e}));return x(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),x(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),x(r.shape[0]%a==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+a})),Dt.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),cr=xn({cast_:function(t,e){var n=cn(t,"x","cast");if(!L(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:e};return Dt.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),"Cast",r)}}),lr=xn({clone_:function(t){var e=cn(t,"x","clone",null);return Dt.runKernelFunc((function(){return Dt.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),pr=xn({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=cn(t,"x","cumsum"),i=vn([e|=0],a.rank),o=a;null!=i&&(o=a.transpose(i));var s=yn(1,a.rank)[0],u=Dt.runKernelFunc((function(t){return t.cumsum(o,s,n,r)}),{permutedX:o},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),fr=xn({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=cn(t,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return x(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),x(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),x(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+o+" for depthToSpace with input shape "+r.shape})),Dt.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),hr=xn({expandDims_:function(t,e){void 0===e&&(e=0);var n=cn(t,"x","expandDims",null);x(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(x(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),Cr(n,r)}}),dr=xn({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var a=or([t,e],r),i=t<=e?t:e,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return Ar(hr(s,0),[n[0],1,1]);if(2===n.length)return Ar(hr(hr(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Ar(hr(hr(hr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),mr=xn({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var a=cn(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?a.as2D(1,-1):a,u=Dt.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===o?u.as1D():u}}),vr=xn({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var a=cn(t,"indices","oneHot","int32"),i=a.shape.concat([e]);return a=a.flatten(),Dt.runKernelFunc((function(t){return t.oneHot(a,e,n,r)}),{$indices:a},(function(t){return{$indices:function(){return zn(a.shape,"float32")}}})).reshape(i)}}),gr=xn({pad_:function(t,e,n){void 0===n&&(n=0);var r=cn(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a=e.map((function(t){return t[0]}));return Dt.runKernelFunc((function(t){return t.pad(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.slice(a,r.shape)}}}))}}),yr=xn({pad1d_:function(t,e,n){return void 0===n&&(n=0),x(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),gr(t,[e],n)}}),br=xn({pad2d_:function(t,e,n){return void 0===n&&(n=0),x(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),gr(t,e,n)}}),wr=xn({pad3d_:function(t,e,n){return void 0===n&&(n=0),x(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),gr(t,e,n)}}),xr=xn({pad4d_:function(t,e,n){return void 0===n&&(n=0),x(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),gr(t,e,n)}}),kr=xn({rand_:function(t,e,n){var r=E(t),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=e();return Dt.makeTensor(a,t,n)}}),Sr=xn({randomNormal_:function(t,e,n,r,a){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new rr(e,n,r,!1,a),o=or(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Nr=xn({randomGamma_:function(t,e,n,r,a){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new ar(e,n,r,a),o=or(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Er=xn({randomUniform_:function(t,e,n,r,a){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=or(t,r),o=new ir(e,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),Cr=xn({reshape_:function(t,e){var n=cn(t,"x","reshape",null);e=D(e,n.size),x(n.size===E(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Dt.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),"Reshape",r)}}),Tr=xn({spaceToBatchND_:function(t,e,n){var r=cn(t,"x","spaceToBatchND");return x(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),x(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),x(r.shape.reduce((function(t,r,a){return a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),Dt.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),Ir=xn({squeeze_:function(t,e){var n=cn(t,"x","squeeze");return Cr(n,M(n.shape,e).newShape)}}),_r=xn({stack_:function(t,e){void 0===e&&(e=0);var n=ln(t,"tensors","stack");if(x(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].rank,a=n[0].shape,i=n[0].dtype;x(e<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){k(a,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){x(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return Un(o,e)}}),Ar=xn({tile_:function(t,e){var n=cn(t,"x","tile",null);return x(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),Dt.runKernelFunc((function(t,r){var a=t.tile(n,e);return r([n]),a}),{$x:n},(function(t,n){var r=n[0];return{$x:function(){var n=Wn(r);if(1===r.rank)for(var a=0;a<e[0];++a)n=n.add(t.slice([a*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(a=0;a<e[0];++a)for(var i=0;i<e[1];++i)n=n.add(t.slice([a*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(a=0;a<e[0];++a)for(i=0;i<e[1];++i)for(var o=0;o<e[2];++o)n=n.add(t.slice([a*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(a=0;a<e[0];++a)for(i=0;i<e[1];++i)for(o=0;o<e[2];++o)for(var s=0;s<e[3];++s)n=n.add(t.slice([a*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),Rr=xn({truncatedNormal_:function(t,e,n,r,a){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new rr(e,n,r,!0,a),o=or(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Dr=xn({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=cn(t,"x","unstack");return x(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),Dt.runKernelFunc((function(t){return t.unstack(n,e)}),{$x:n},(function(t){return{$x:function(){return _r(t,e)}}}))}}),Or=function(t,e){return o(this,void 0,void 0,(function(){var n,r,a,i,o,u,c,l,p,f;return s(this,(function(s){switch(s.label){case 0:return n=cn(t,"x","setdiff1d"),r=cn(e,"y","setdiff1d"),x(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),x(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),x(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return a=s.sent(),[4,r.data()];case 2:for(i=s.sent(),o=new Set(i),u=0,p=0;p<a.length;p++)o.has(a[p])||u++;for(c=new lt([u],n.dtype),l=new lt([u],"int32"),p=0,f=0;p<a.length;p++)o.has(a[p])||(c.values[f]=a[p],l.values[f]=p,f++);return[2,[c.toTensor(),l.toTensor()]]}}))}))};function Mr(t,e,n,r){void 0===r&&(r=!0);var a=[];if(r)(a=a.concat(e.slice(0))).push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);for(var i=e.length,o=0;o<i;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(i+1))}return a}function Fr(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{var i=[],o=[];for(a=1;a<t;++a)a>=2*e+1||a%2==1?o.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function zr(t,e,n,r){void 0===r&&(r=!0);var a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function Br(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Lr(t,e,n){for(var r=t.slice(0,1),a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}function Pr(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=t.shape,s=n.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=o[i],s.push(o[i]);var c=X(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,a,u,c]}function Vr(t){return t<=30?t:K(t,Math.floor(Math.sqrt(t)))}function Wr(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,a=n.length,i=1,o=r;o<a;++o)i*=n[o];var s=r<1?1:r;return{sliceRank:r,numUpdates:e.size/s,sliceSize:i,strides:X(n.slice(0,r)).concat([1]),outputSize:E(n)}}function Ur(t,e,n){x(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),x(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){x(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},a=0;a<t.rank;++a)r(a)}function jr(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Hr(t,e,n){for(var r=[],a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function qr(t,e,n,r,a){var i=e[a],o=n[a]||1;(t&1<<a||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),y(0,i,s-1)}function Gr(t,e,n,r,a){var i=e[a],o=n[a]||1;(t&1<<a||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),o>0?y(0,i,s):y(-1,i,s-1)}function Zr(t,e,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function Kr(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}var Xr=Object.freeze({assertParamsValid:Ur,maskToAxes:jr,computeOutShape:Hr,startForAxis:qr,stopForAxis:Gr,isSliceContinous:Zr,computeFlatOffset:Kr});function $r(t){return x(Z(t),(function(){return"The f passed in grad(f) must be a function"})),function(e,n){var r=cn(e,"x","tf.grad",null),a=null!=n?cn(n,"dy","tf.grad"):null;return Dt.tidy((function(){var e=Dt.gradients((function(){return t(r)}),[r],a),n=e.value,i=e.grads;return null!=a&&k(n.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),na(i),i[0]}))}}function Yr(t){return x(Z(t),(function(){return"The f passed in grads(f) must be a function"})),function(e,n){x(Array.isArray(e),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var r=ln(e,"args","tf.grads",null),a=null!=n?cn(n,"dy","tf.grads"):null;return Dt.tidy((function(){var e=Dt.gradients((function(){return t.apply(void 0,r)}),r,a),n=e.value,i=e.grads;return null!=a&&k(n.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),na(i),i}))}}function Qr(t){return x(Z(t),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(e,n){x(e instanceof dt,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),x(null==n||n instanceof dt,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=Dt.gradients((function(){return t(e)}),[e],n),a=r.grads,i=r.value;return na(a),{grad:a[0],value:i}}}function Jr(t){return x(Z(t),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(e,n){x(Array.isArray(e)&&e.every((function(t){return t instanceof dt})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),x(null==n||n instanceof dt,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var r=Dt.gradients((function(){return t.apply(void 0,e)}),e,n);return null!=n&&k(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),na(r.grads),r}}function ta(t,e){x(Z(t),(function(){return"The f passed in variableGrads(f) must be a function"})),x(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof xt})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Dt.registeredVariables)e.push(Dt.registeredVariables[r]);var a=n?e.filter((function(t){return!t.trainable})):null,i=e.length;x((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var o=Dt.gradients(t,e,null,!0),s=o.value,u=o.grads;x(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),x(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=a&&a.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}function ea(t){return Dt.customGrad(t)}function na(t){if(t.filter((function(t){return null==t})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var ra=xn({softmax_:function(t,e){void 0===e&&(e=-1);var n=cn(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return ea((function(t,n){var r=t.logSumExp([e],!0),a=t.toFloat().sub(r).exp();return n([a]),{value:a,gradFunc:function(t,n){var r=n[0],a=t.mul(r);return a.sub(a.sum([e],!0).mul(r))}}}))(n)}}),aa=xn({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=cn(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return ea((function(t,n){var r=t.max(e,!0),a=t.sub(r),i=a.toFloat().sub(a.exp().sum(e,!0).log());return n([i]),{value:i,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),ia=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),oa=function(){function t(){}return t.prototype.time=function(t){return sa()},t.prototype.read=function(t){return sa()},t.prototype.readSync=function(t){return sa()},t.prototype.numDataIds=function(){return sa()},t.prototype.disposeData=function(t){return sa()},t.prototype.fromPixels=function(t,e){return sa()},t.prototype.write=function(t,e,n){return sa()},t.prototype.move=function(t,e,n,r){return sa()},t.prototype.memory=function(){return sa()},t.prototype.floatPrecision=function(){return sa()},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){return sa()},t.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,sa()},t.prototype.slice=function(t,e,n){return sa()},t.prototype.stridedSlice=function(t,e,n,r){return sa()},t.prototype.unstack=function(t,e){return sa()},t.prototype.reverse=function(t,e){return sa()},t.prototype.concat=function(t,e){return sa()},t.prototype.neg=function(t){return sa()},t.prototype.add=function(t,e){return sa()},t.prototype.addN=function(t){return sa()},t.prototype.subtract=function(t,e){return sa()},t.prototype.multiply=function(t,e){return sa()},t.prototype.realDivide=function(t,e){return sa()},t.prototype.floorDiv=function(t,e){return sa()},t.prototype.sum=function(t,e){return sa()},t.prototype.prod=function(t,e){return sa()},t.prototype.unsortedSegmentSum=function(t,e,n){return sa()},t.prototype.argMin=function(t,e){return sa()},t.prototype.argMax=function(t,e){return sa()},t.prototype.equal=function(t,e){return sa()},t.prototype.notEqual=function(t,e){return sa()},t.prototype.less=function(t,e){return sa()},t.prototype.lessEqual=function(t,e){return sa()},t.prototype.greater=function(t,e){return sa()},t.prototype.greaterEqual=function(t,e){return sa()},t.prototype.logicalNot=function(t){return sa()},t.prototype.logicalAnd=function(t,e){return sa()},t.prototype.logicalOr=function(t,e){return sa()},t.prototype.where=function(t){return sa()},t.prototype.select=function(t,e,n){return sa()},t.prototype.topk=function(t,e,n){return sa()},t.prototype.min=function(t,e){return sa()},t.prototype.minimum=function(t,e){return sa()},t.prototype.mod=function(t,e){return sa()},t.prototype.max=function(t,e){return sa()},t.prototype.maximum=function(t,e){return sa()},t.prototype.all=function(t,e){return sa()},t.prototype.any=function(t,e){return sa()},t.prototype.squaredDifference=function(t,e){return sa()},t.prototype.ceil=function(t){return sa()},t.prototype.floor=function(t){return sa()},t.prototype.round=function(t){return sa()},t.prototype.sign=function(t){return sa()},t.prototype.isNaN=function(t){return sa()},t.prototype.isInf=function(t){return sa()},t.prototype.isFinite=function(t){return sa()},t.prototype.pow=function(t,e){return sa()},t.prototype.exp=function(t){return sa()},t.prototype.expm1=function(t){return sa()},t.prototype.log=function(t){return sa()},t.prototype.log1p=function(t){return sa()},t.prototype.sqrt=function(t){return sa()},t.prototype.rsqrt=function(t){return sa()},t.prototype.square=function(t){return sa()},t.prototype.reciprocal=function(t){return sa()},t.prototype.relu=function(t){return sa()},t.prototype.relu6=function(t){return sa()},t.prototype.prelu=function(t,e){return sa()},t.prototype.elu=function(t){return sa()},t.prototype.eluDer=function(t,e){return sa()},t.prototype.selu=function(t){return sa()},t.prototype.int=function(t){return sa()},t.prototype.clip=function(t,e,n){return sa()},t.prototype.abs=function(t){return sa()},t.prototype.complexAbs=function(t){return sa()},t.prototype.sigmoid=function(t){return sa()},t.prototype.softplus=function(t){return sa()},t.prototype.sin=function(t){return sa()},t.prototype.cos=function(t){return sa()},t.prototype.tan=function(t){return sa()},t.prototype.asin=function(t){return sa()},t.prototype.acos=function(t){return sa()},t.prototype.atan=function(t){return sa()},t.prototype.atan2=function(t,e){return sa()},t.prototype.sinh=function(t){return sa()},t.prototype.cosh=function(t){return sa()},t.prototype.tanh=function(t){return sa()},t.prototype.asinh=function(t){return sa()},t.prototype.acosh=function(t){return sa()},t.prototype.atanh=function(t){return sa()},t.prototype.erf=function(t){return sa()},t.prototype.step=function(t,e){return sa()},t.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,sa()},t.prototype.conv2d=function(t,e,n){return sa()},t.prototype.conv2dDerInput=function(t,e,n){return sa()},t.prototype.conv2dDerFilter=function(t,e,n){return sa()},t.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,sa()},t.prototype.depthwiseConv2D=function(t,e,n){return sa()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){return sa()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){return sa()},t.prototype.conv3d=function(t,e,n){return sa()},t.prototype.conv3dDerInput=function(t,e,n){return sa()},t.prototype.conv3dDerFilter=function(t,e,n){return sa()},t.prototype.maxPool=function(t,e){return sa()},t.prototype.maxPoolBackprop=function(t,e,n,r){return sa()},t.prototype.avgPool=function(t,e){return sa()},t.prototype.avgPoolBackprop=function(t,e,n){return sa()},t.prototype.avgPool3d=function(t,e){return sa()},t.prototype.avgPool3dBackprop=function(t,e,n){return sa()},t.prototype.maxPool3d=function(t,e){return sa()},t.prototype.maxPool3dBackprop=function(t,e,n,r){return sa()},t.prototype.reshape=function(t,e){return sa()},t.prototype.cast=function(t,e){return sa()},t.prototype.tile=function(t,e){return sa()},t.prototype.pad=function(t,e,n){return sa()},t.prototype.transpose=function(t,e){return sa()},t.prototype.gather=function(t,e,n){return sa()},t.prototype.gatherND=function(t,e){return sa()},t.prototype.scatterND=function(t,e,n){return sa()},t.prototype.batchToSpaceND=function(t,e,n){return sa()},t.prototype.spaceToBatchND=function(t,e,n){return sa()},t.prototype.resizeBilinear=function(t,e,n,r){return sa()},t.prototype.resizeBilinearBackprop=function(t,e,n){return sa()},t.prototype.resizeNearestNeighbor=function(t,e,n,r){return sa()},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){return sa()},t.prototype.batchNormalization=function(t,e,n,r,a,i){return sa()},t.prototype.localResponseNormalization4D=function(t,e,n,r,a){return sa()},t.prototype.LRNGrad=function(t,e,n,r,a,i,o){return sa()},t.prototype.multinomial=function(t,e,n,r){return sa()},t.prototype.oneHot=function(t,e,n,r){return sa()},t.prototype.cumsum=function(t,e,n,r){return sa()},t.prototype.nonMaxSuppression=function(t,e,n,r,a){return sa()},t.prototype.fft=function(t){return sa()},t.prototype.ifft=function(t){return sa()},t.prototype.complex=function(t,e){return sa()},t.prototype.real=function(t){return sa()},t.prototype.imag=function(t){return sa()},t.prototype.cropAndResize=function(t,e,n,r,a,i){return sa()},t.prototype.depthToSpace=function(t,e,n){return sa()},t.prototype.split=function(t,e,n){return sa()},t.prototype.sparseToDense=function(t,e,n,r){return sa()},t.prototype.diag=function(t){return sa()},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){return sa()},t.prototype.zerosLike=function(t){return sa()},t.prototype.linspace=function(t,e,n){return sa()},t.prototype.dispose=function(){return sa()},t}();function sa(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function ua(t,e){for(var n=t.length,r=[],a=0;a<n;a++){var i=n-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function ca(t,e){for(var n=[],r=0;r<e.length;r++){var a=t[t.length-r-1],i=e.length-r-1,o=e[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function la(t,e){for(var n=[],r=Math.max(t.length,e.length),a=0;a<r;a++){var i=t[t.length-a-1];null==i&&(i=1);var o=e[e.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(i)}}return n}function pa(t,e,n,r,a,i,o){void 0===o&&(o="channelsLast");var s,u=va(e),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,l,t[1],t[1]]}return ha(t,s,n,r,a,i,!1,o)}function fa(t,e,n,r,a,i,o){void 0===o&&(o="NDHWC");var s,u,c=ga(e),l=c[0],p=c[1],f=c[2];if("NDHWC"===o)u="channelsLast",s=[l,p,f,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[l,p,f,t[1],t[1]]}return da(t,s,n,r,a,!1,u,i)}function ha(t,e,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],p=u[2],f=u[3];if("channelsLast"===s)c=t[0],l=t[1],p=t[2],f=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],p=t[3]}var h,d=e[0],m=e[1],v=e[3],g=va(n),y=g[0],b=g[1],w=va(r),k=w[0],S=w[1],N=ya(d,k),E=ya(m,S),C=function(t,e,n,r,a,i,o,s){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var p=function(t,e,n,r,a){null==r&&(r=ma(t,e,n));var i=t[1],o=ba((t[0]-e+2*r)/n+1,a);x(T(o),(function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"}));var s=ba((i-e+2*r)/n+1,a);return x(T(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[o,s]}([e,n],i,r,t,s);c=p[0],l=p[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/a);var f=Math.max(0,(c-1)*r+i-e),h=Math.max(0,(l-1)*a+o-n),d=Math.floor(f/2),m=f-d,v=Math.floor(h/2);u={top:d,bottom:m,left:v,right:h-v,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),l=Math.ceil((n-o+1)/a)}return{padInfo:u,outHeight:c,outWidth:l}}(a,l,p,y,b,N,E,i),I=C.padInfo,_=C.outHeight,A=C.outWidth,R=o?v*f:v;return"channelsFirst"===s?h=[c,R,_,A]:"channelsLast"===s&&(h=[c,_,A,R]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:p,inChannels:f,outHeight:_,outWidth:A,outChannels:R,padInfo:I,strideHeight:y,strideWidth:b,filterHeight:d,filterWidth:m,effectiveFilterHeight:N,effectiveFilterWidth:E,dilationHeight:k,dilationWidth:S,inShape:t,outShape:h,filterShape:e}}function da(t,e,n,r,a,i,o,s){void 0===i&&(i=!1),void 0===o&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],p=u[2],f=u[3],h=u[4];if("channelsLast"===o)c=t[0],l=t[1],p=t[2],f=t[3],h=t[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=t[0],h=t[1],l=t[2],p=t[3],f=t[4]}var d,m=e[0],v=e[1],g=e[2],y=e[4],b=ga(n),w=b[0],k=b[1],S=b[2],N=ga(r),E=N[0],C=N[1],I=N[2],_=ya(m,E),A=ya(v,C),R=ya(g,I),D=function(t,e,n,r,a,i,o,s,u,c,l){var p,f,h,d;if("number"==typeof t){p={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,a,i){null==a&&(a=ma(t,e,r));var o=t[1],s=t[2],u=ba((t[0]-e+2*a)/r+1,i);x(T(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=ba((o-e+2*a)/r+1,i);x(T(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=ba((s-e+2*a)/r+1,i);return x(T(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([e,n,r,1],s,0,a,t,l);f=m[0],h=m[1],d=m[2]}else if("same"===t){var v=((f=Math.ceil(e/a))-1)*a+s-e,g=((h=Math.ceil(n/i))-1)*i+u-n,y=((d=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(v/2),w=v-b,k=Math.floor(g/2),S=g-k,N=Math.floor(y/2);p={top:k,bottom:S,left:N,right:y-N,front:b,back:w,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);p={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((e-s+1)/a),h=Math.ceil((n-u+1)/i),d=Math.ceil((r-c+1)/o)}return{padInfo:p,outDepth:f,outHeight:h,outWidth:d}}(a,l,p,f,w,k,S,_,A,R,s),O=D.padInfo,M=D.outDepth,F=D.outHeight,z=D.outWidth,B=i?y*h:y;return"channelsFirst"===o?d=[c,B,M,F,z]:"channelsLast"===o&&(d=[c,M,F,z,B]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:p,inWidth:f,inChannels:h,outDepth:M,outHeight:F,outWidth:z,outChannels:B,padInfo:O,strideDepth:w,strideHeight:k,strideWidth:S,filterDepth:m,filterHeight:v,filterWidth:g,effectiveFilterDepth:_,effectiveFilterHeight:A,effectiveFilterWidth:R,dilationDepth:E,dilationHeight:C,dilationWidth:I,inShape:t,outShape:d,filterShape:e}}function ma(t,e,n,r){void 0===r&&(r=1);var a=ya(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function va(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function ga(t){return"number"==typeof t?[t,t,t]:t}function ya(t,e){return e<=1?t:t+(t-1)*(e-1)}function ba(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function wa(t){var e=va(t),n=e[0],r=e[1],a=e[2];return 1===n&&1===r&&1===a}function xa(t,e){return wa(t)||wa(e)}function ka(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function Sa(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=zn(t.shape),a=t.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!P(t.dtype,e))return Dt.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){var o=n.real(t);return i=o.cast(e),o.dispose(),i}if("int32"===e)return n.int(t);if("bool"===e){var s=Tn(0,t.dtype);return i=n.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Na(t,e){return Dt.makeTensorFromDataId(t.dataId,e,t.dtype)}function Ea(t,e,n){var r=(e-t)/(n-1),a=J(n,"float32");a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return In(a,"float32")}var Ca=Object.freeze({castTensor:Sa,reshapeTensor:Na,linspaceImpl:Ea,upcastType:St,axesAreInnerMostDims:pn,combineLocations:fn,computeOutAndReduceShapes:hn,expandShapeToKeepDim:dn,assertAxesAreInnerMostDims:mn,getAxesPermutation:vn,getUndoAxesPermutation:gn,getInnerMostAxes:yn,getBroadcastDims:ua,getReductionAxes:ca,assertAndGetBroadcastShape:la,assertParamsConsistent:bn,computeOutShape:wn,computePool2DInfo:pa,computePool3DInfo:fa,computeConv2DInfo:ha,computeConv3DInfo:da,computeDefaultPad:ma,tupleValuesAreOne:wa,eitherStridesOrDilationsAreOne:xa,convertConv2DDataFormat:ka});function Ta(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Ia(t,e){return{real:t[2*e],imag:t[2*e+1]}}function _a(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Aa(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function Ra(t,e,n,r,a){for(var i=Array.from(e).map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>a})).sort((function(t,e){return e.score-t.score})),o=[],s=0;s<i.length;s++){var u=i[s],c=u.score,l=u.boxIndex;if(c<a)break;for(var p=!1,f=o.length-1;f>=0;--f)if(Da(t,l,o[f])>=r){p=!0;break}if(!p&&(o.push(l),o.length>=n))break}return In(o,"int32")}function Da(t,e,n){var r=t.subarray(4*e,4*e+4),a=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),p=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),h=(s-i)*(u-o),d=(p-c)*(f-l);if(h<=0||d<=0)return 0;var m=Math.max(i,c),v=Math.max(o,l),g=Math.min(s,p),y=Math.min(u,f),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(h+d-b)}function Oa(t,e,n){var r=new Array(t.rank).fill(0),a=t.shape.slice();return e.map((function(e){a[n]=e;var i=t.slice(r,a);return r[n]+=e,i}))}function Ma(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var a=or(n,t.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),o=new Array(t.rank),s=0;s<o.length;s++)o[s]=i[s]%t.shape[s];var u=t.locToIndex(o);a.values[r]=t.values[u]}return a.toTensor()}function Fa(t,e,n,r,a){for(var i=e[e.length-1],o=[t.length/i,i],s=o[0],u=o[1],c=F(n,s*r),l=F("int32",s*r),p=0;p<s;p++){for(var f=p*u,h=t.subarray(f,f+u),d=[],m=0;m<h.length;m++)d.push({value:h[m],index:m});d.sort((function(t,e){return e.value-t.value}));var v=p*r,g=c.subarray(v,v+r),y=l.subarray(v,v+r);for(m=0;m<r;m++)g[m]=d[m].value,y[m]=d[m].index}var b=e.slice();return b[b.length-1]=r,[En(c,b,n),En(l,b,"int32")]}function za(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var a=or(t,"int32"),i=or([n.length,t.length],"int32");for(r=0;r<n.length;r++){var o=a.indexToLoc(n[r]),s=r*t.length;i.values.set(o,s)}return i.toTensor()}var Ba=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},La=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Pa=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s="max"===e?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Va(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function Wa(t,e){return 1===e?[t]:Va(t,e)}function Ua(){var t,e,n,r,a,i,o,s,u,l;return 2===c().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function ja(t,e,n){void 0===n&&(n="index");var r=X(e);return r.map((function(e,a){return"int "+t[a]+" = "+n+" / "+e+"; "+(a===r.length-1?"int "+t[a+1]+" = "+n+" - "+t[a]+" * "+e:"index -= "+t[a]+" * "+e)+";"})).join("")}function Ha(t){var e=X(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var qa="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Ga(t,e,n,r){var a=[];t.forEach((function(t){var e=E(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?a.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(a.push("uniform sampler2D "+t.name+";"),a.push("uniform int offset"+t.name+";"))}));var i,o,s=a.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";r+=n?Ka(t):Za(t);var a=t.shapeInfo.logicalShape,i=e.logicalShape;return a.length<=i.length&&(r+=n?function(t,e){var n,r=t.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,u=ua(t.shapeInfo.logicalShape,e.logicalShape),c=ei(s),l=s-o,p=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+p[t+l]+" = 0;"})).join("\n");var f;f=s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+p[e+l]})).join(", ");var h="return outputValue;",d=1===E(t.shapeInfo.logicalShape),m=1===E(e.logicalShape);if(1!==o||d||m){if(d&&!m)h=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var v=o-2,g=o-1;u.indexOf(v)>-1&&u.indexOf(g)>-1?h="return vec4(outputValue.x);":u.indexOf(v)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+f+");\n      "+h+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===u&&null==t.shapeInfo.flatOffset&&C(o,i))return"\n      float "+a+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=ei(u),p=ua(t.shapeInfo.logicalShape,e.logicalShape),f=u-s,h=["x","y","z","w","u","v"];c=0===s?"":u<2&&p.length>=1?"coords = 0;":p.map((function(t){return"coords."+h[t+f]+" = 0;"})).join("\n");var d;return d=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+h[e+f]})).join(", "),"\n    float "+a+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+d+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=Ua(),p=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),f=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+t.defineSpecialNaN+"\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+Xa+"\n    "+$a+"\n    "+Ya+"\n  "}(l);return e.isPacked?(i=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(C(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+a[0]+", "+a[1]+"));\n      int index = resTexRC.x * "+a[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),a=r*Math.ceil(t[t.length-2]/2),i=a,o="",s="b, r, c",u=2;u<t.length-1;u++)o="\n      int b"+u+" = index / "+(i*=t[t.length-u-1])+";\n      index -= b"+u+" * "+i+";\n    "+o,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,a,i,o}(e.logicalShape,c),o=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(i=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return C(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=ja(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=ja(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=ja(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=ja(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),o=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(f+=Qa),[f,p,o,s,i,u,n].join("\n")}function Za(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape,a=r[0],i=r[1];if(1===a&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+o[0]+", "+o[1]+", "+Ja(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(t);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+ti(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=Ja(e);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+a+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+i+", index + "+o+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape;if(null!=a&&C(e,a)){var i=a[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var o=M(e),s=o.newShape,u=o.keptDims,c=s;if(c.length<e.length)return"\n      "+Za(ni(t,c))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+ri(["row","col"],u)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+e[1]+", 1)));\n        "+ti(t)+"\n      }\n    ";var l=a[0],p=a[1],f=Ja(n);return 1===p?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+e[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===l?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+e[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+p+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+e[1]+" + col + "+f+";\n    vec2 uv = uvFromFlat("+l+", "+p+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[1]*e[2],i=e[2],o=M(e),s=o.newShape,u=o.keptDims,c=s;if(c.length<e.length)return"\n        "+Za(ni(t,c))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+ri(["row","col","depth"],u)+");\n        }\n      ";if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+i+", 1)));\n        "+ti(t)+"\n      }\n    ";var l=t.shapeInfo.texShape,p=l[0],f=l[1],h=t.shapeInfo.flatOffset;return f===a&&null==h?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+f+".0, "+p+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":f===i&&null==h?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+e[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+f+".0, "+p+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+i+" + depth + "+Ja(n)+";\n        vec2 uv = uvFromFlat("+p+", "+f+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(t);case 4:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[3],i=e[2]*a,o=e[1]*i,s=M(e),u=s.newShape,c=s.keptDims;if(u.length<e.length)return"\n      "+Za(ni(t,u))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+ri(["row","col","depth","depth2"],c)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+i+", "+a+", 1)));\n        "+ti(t)+"\n      }\n    ";var l=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],h=p[1];return h===o&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+h+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":h===a&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+e[1]*e[2]+", "+e[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+h+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+i+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+f+", "+h+", index + "+Ja(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);case 5:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],i=e[3]*a,o=e[2]*i,s=e[1]*o,u=M(e),c=u.newShape,l=u.keptDims;if(c.length<e.length)return"\n      "+Za(ni(t,c))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+ri(["row","col","depth","depth2","depth3"],l)+");\n      }\n    ";if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+i+", "+a+")) +\n          depth3;\n        "+ti(t)+"\n      }\n    ";var p=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],d=f[1];return d===s&&null==p?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+d+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":d===a&&null==p?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+e[1]*e[2]*e[3]+",\n               "+e[2]*e[3]+", "+e[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+d+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+i+" +\n          depth2 * "+a+" + depth3 + "+Ja(n)+";\n      vec2 uv = uvFromFlat("+h+", "+d+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);case 6:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=M(e),i=a.newShape,o=a.keptDims;if(i.length<e.length)return"\n      "+Za(ni(t,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+ri(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    ";var s=e[5],u=e[4]*s,c=e[3]*u,l=e[2]*c,p=e[1]*l;if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+p+", "+l+", "+c+", "+u+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+ti(t)+"\n      }\n    ";var f=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],m=h[1];return m===p&&null==f?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+l+", "+c+", "+u+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":m===s&&null==f?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+e[1]*e[2]*e[3]*e[4]+",\n               "+e[2]*e[3]*e[4]+",\n               "+e[3]*e[4]+",\n               "+e[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+p+" + col * "+l+" + depth * "+c+" +\n          depth2 * "+u+" + depth3 * "+s+" + depth4 + "+Ja(n)+";\n      vec2 uv = uvFromFlat("+d+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function Ka(t){var e;switch(t.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(e=t.name).charAt(0).toUpperCase()+e.slice(1))+"() {\n      return "+Ua().texture2D+"("+e+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Ua();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+a[0]+", "+a[1]+", index);\n      return "+i.texture2D+"("+e+", uv);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=a[0],o=a[1],s=Ua();if(null!=a&&C(e,a))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===e[0])return"\n        "+Ka(ni(t,e.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+ri(["b","row","col"],[1,2])+");\n        }\n      ";var o=i[0],s=i[1],u=Math.ceil(e[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+o+", "+s+", "+u*Math.ceil(e[1]/2)+", "+u+", b, row, col);\n      return "+Ua().texture2D+"("+n+", uv);\n    }\n  "}(t);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),p="int b, int row, int col",f="b * "+l+" + (row / 2) * "+c+" + (col / 2)",h=2;h<n-1;h++)p="int b"+h+", "+p,f="b"+h+" * "+(l*=e[n-h-1])+" + "+f;return"\n    vec4 "+a+"("+p+") {\n      int index = "+f+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+Ua().texture2D+"("+r+", uv);\n    }\n  "}(t)}}var Xa="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",$a="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ya="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Qa="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Ja(t){return"offset"+t}function ti(t){var e=t.name,n=E(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function ei(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function ni(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function ri(t,e){return e.map((function(e){return t[e]})).join(", ")}var ai=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,x(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var a=t[t.length-1],i=Math.ceil(a/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=ei(c),p=Wa("coords",c);if(1===i){var f=ei(s=c+1);o="\n        "+f+" sourceLocR = "+f+"("+p.join()+", 0);\n        ++"+p[c-1]+";\n        "+f+" sourceLocG = "+f+"("+p.join()+", 0);\n        ++"+p[c-2]+";\n        "+f+" sourceLocA = "+f+"("+p.join()+", 0);\n        --"+p[c-1]+";\n        "+f+" sourceLocB = "+f+"("+p.join()+", 0);\n        --"+p[c-2]+";"}else s=c,o="\n        "+l+" sourceLocR = coords;\n        ++"+p[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+p[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+p[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+p[c-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),d="."+h[s-1],m=h.map((function(t){return"int "+t})),v=Wa("sourceLocR",s-1).concat("inIdx.r"),g=Wa("sourceLocG",s-1).concat("inIdx.g"),y=Wa("sourceLocB",s-1).concat("inIdx.b"),b=Wa("sourceLocA",s-1).concat("inIdx.a"),w="max"===n?"greaterThan":"lessThan",k=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",S="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",N=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+h.join()+"),\n                                          vec2("+h.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+h.join()+"),\n                               vec2("+h.slice(-2).join()+"));\n      }\n      "+N+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+p[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+p[c-2]+" < "+(u[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+S+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+k+"\n          vec4 candidate = "+S+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+w+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},ii=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,p=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+p+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},oi=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=l-1-t.padInfo.front,d=p-1-t.padInfo.top,m=f-1-t.padInfo.left,v=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3("+h+", "+d+", "+m+");\n      const float avgMultiplier = float("+v+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+a+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+p+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+f+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},si=function(t,e,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],la(t,e),la(t,n);var o="0.0";null!=r&&(la(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=a&&(la(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},ui=function(t,e,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],la(t,e),la(t,n);var o="vec4(0.0)";null!=r&&(la(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=a&&(la(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},ci=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=la(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},li="return a + b;",pi="return a - b;",fi="return a * b;",hi="return (a < 0.) ? b * a : a;",di=function(t,e,n){this.variableNames=["A","B"],this.outputShape=la(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},mi="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",vi=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=la(e,n);var a=this.outputShape.length,i="";if(r)if(0===a||1===E(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+ei(a)+" coords = getOutputCoords();\n        ",1===a)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=Wa("coords",a);i+="\n            bool nextRowOutOfBounds =\n              ("+o[a-2]+" + 1) >= "+this.outputShape[a-2]+";\n            bool nextColOutOfBounds =\n              ("+o[a-1]+" + 1) >= "+this.outputShape[a-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},gi=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),yi=function(){function t(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),bi=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},wi=function(t){this.outputShape=[],this.outputShape=wn(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var a=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var i=e.length,o=e[e.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},xi=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=wn(t,e);var n=this.outputShape,r=n.length,a=ei(r),i=Wa("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=o[e],l=o.slice(-2),p=o.join(),f="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+p+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var h=s[u-1];f+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+ki(o,c,h)+"),\n            vec2("+ki(l,c,h)+"));\n        }"}var d=s.length,m=s[s.length-1];f+="\n        return getChannel(\n          getT"+d+"("+ki(o,c,m)+"),\n          vec2("+ki(l,c,m)+"));",this.userCode="\n      float getValue("+o.map((function(t){return"int "+t}))+") {\n        "+f+"\n      }\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function ki(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+" - "+n:t})).join()}var Si=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ni=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ei=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+e+" - "+a+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ci=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+a+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ti=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ii=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},_i=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,p=t.filterWidth,f=4*Math.floor(t.inChannels/4),h=t.inChannels%4,d="channelsLast"===t.dataFormat,m=d?1:2,v=d?2:3,g=d?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+v+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+p+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+d+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===h)+") {\n\n              if ("+d+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+f+") *\n                    getW(wR, wC, "+f+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+f+", xR, xC) *\n                    getW(wR, wC, "+f+", d2);\n              }\n\n            } else if ("+(2===h)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2)\n              );\n\n              if ("+d+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===h)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2),\n                getW(wR, wC, "+f+" + 2, d2)\n              );\n\n              if ("+d+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1),\n                  getX(batch, xR, xC, "+f+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC),\n                  getX(batch, "+f+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+w+"\n        "+b+"\n        setOutput(result);\n      }\n    "},Ai=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,p=t.filterHeight,f=t.filterWidth,h=4*Math.floor(t.inChannels/4),d=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+p+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===d)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+h+") *\n                  getW(wF, wR, wC, "+h+", d2);\n              } else if ("+(2===d)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===d)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1),\n                  getX(batch, xF, xR, xC, "+h+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2),\n                  getW(wF, wR, wC, "+h+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ri=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.inHeight,i=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,p=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,d=t.outChannels/t.inChannels,m="",v="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",v="result = activation(result);");var g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+d+";\n        int q = d2 - d1 * "+d+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+f+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+a+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+p+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+v+"\n        setOutput(result);\n      }\n    "},Di=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var a=t.inHeight,i=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,p=t.dilationWidth,f=t.filterHeight,h=t.filterWidth,d=h,m="int xR; int xC; int xCOffset;",v=0;v<f;v++)for(var g=0;g<h;g++)m+="\n          vec4 xTexelR"+v+"C"+2*g+" = vec4(0.);\n          vec4 wR"+v+"C"+g+" = vec4(0.);\n          vec4 xR"+v+"C"+g+" = vec4(0.);";for(v=0;v<f;v++)for(var y=0;y<d;y++){if(m+="\n          xR = xRCorner + "+v*l+";\n          xC = xCCorner + "+(g=2*y)*p+";\n        ",1===c){if(g<h&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+v+"C"+g+" = vec4(previous.zw, xTexelR"+v+"C"+g+".xy);\n                } else {\n                  xR"+v+"C"+g+" = vec4(0, 0, xTexelR"+v+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+a+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = xTexelR"+v+"C"+g+";\n              ",g+1<h)){var w=s%2==0?b(p):p;p%2==0&&s%2==1||p%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+w+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",p>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+a+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+v+"C"+g+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+v+"C"+(g+1)+" = vec4(\n                    xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+w+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+v+"C"+(g+1)+" = xTexelR"+v+"C"+(g+2)+";\n                "}}else g<h&&(m+="\n              if(xR >= 0 && xR < "+a+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+v+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = vec4(\n                  xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".zw);\n              ",g+1<h&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+v+"C"+(g+1)+" = vec4(xTexelR"+v+"C"+(g+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = vec4(\n                  xTexelR"+v+"C"+g+".xy, xTexelR"+v+"C"+(g+2)+".xy);\n              ",g+1<h&&(m+="\n                  xR"+v+"C"+(g+1)+" = vec4(\n                    xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".zw);\n                ")),m+="}");g<h&&(m+="\n            vec4 wTexelR"+v+"C"+g+" = getW("+v+", "+g+", d1, q);\n            wR"+v+"C"+g+" = vec4(wTexelR"+v+"C"+g+".xz, wTexelR"+v+"C"+g+".xz);\n          ",g+1<h&&(m+="\n              vec4 wTexelR"+v+"C"+(g+1)+" = getW("+v+", "+(g+1)+", d1, q);\n              wR"+v+"C"+(g+1)+" =\n                vec4(wTexelR"+v+"C"+(g+1)+".xz, wTexelR"+v+"C"+(g+1)+".xz);"))}for(v=0;v<f;v++)for(g=0;g<h;g++)m+="dotProd += xR"+v+"C"+g+" * wR"+v+"C"+g+";";var x="",k="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",k="result = activation(result);");var S=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+S+"\n        "+k+"\n        setOutput(result);\n      }\n    "},Oi=function(t,e,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],o=t[1],s=t[2],u=t[3],c=e[0],l=n[0],p=n[1];this.outputShape=[c,l,p,u];var f="bilinear"===r?1:0,h=[o-1+".0",s-1+".0"],d=h[0],m=h[1],v=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+d+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+d],g=v[0],y=v[1],b=v[2],w=p>1?[""+(s-1)/(p-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],x=w[0],k=w[1],S=w[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+x+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+k+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+d+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n        float in_x = "+S+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+f+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Mi=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,a=t[t.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+a+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+ei(r)+" coords = getOutputCoords();\n        int end = "+Fi(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+a+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+Fi(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Fi(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var zi=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ft.DENSE;var e=Ht(t),n=Ua();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ja(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},Bi=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ft.DENSE;var e=Ht(t),n=Ua();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+ja(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},Li=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),Pi=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Vi=function(t){this.variableNames=["A"],this.outTexUsage=zt.DOWNLOAD;var e=Ua();this.outputShape=t,this.userCode="\n      "+qa+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},Wi=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zt.DOWNLOAD;var e=Ua();this.outputShape=t,this.userCode="\n      "+qa+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},Ui=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Ua(),a=e[0],i=e[1];this.outputShape=t;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+Ha(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},ji=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ua(),a=e[0],i=e[1];this.outputShape=t;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Ha(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},Hi=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+a+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},qi=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),Gi=function(t){this.variableNames=["A"];var e=Ua(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Zi=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Ua(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},Ki=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var a=ei(this.rank),i=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<t.length;i++)i===e?a.push("int(getIndices("+r[i]+"))"):a.push(""+r[i]);return a.join()}(t,n);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Xi=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=ei(e.length),a=ei(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+a+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function $i(t,e){var n=Ua();return Yt(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Yi(t,e){return ie(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Qi(t,e){return oe(t,e,new Uint16Array([0,1,2,2,1,3]))}function Ji(t,e,n,r,a,i,o){ue(n,r);var s=se(t,e),u=t.TEXTURE_2D;return Zt(t,e,(function(){return t.bindTexture(u,s)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Zt(t,e,(function(){return t.texImage2D(u,0,a,n,r,0,i,o,null)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function to(t,e,n,r,a){var i=jt(n,r);return Ji(t,e,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,t.FLOAT)}function eo(t,e,n,r,a){var i=jt(n,r);return Ji(t,e,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function no(t,e,n,r,a){var i=jt(n,r);return Ji(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function ro(t,e,n,r,a){var i=qt(n,r);return Ji(t,e,i[0],i[1],a.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function ao(t,e,n,r,a){var i=qt(n,r);return Ji(t,e,i[0],i[1],a.internalFormatPackedHalfFloat,t.RGBA,a.textureTypeHalfFloat)}function io(t,e,n,r){return Zt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),le(t,e,n,"clipSpacePos",r,3,20,0)&&le(t,e,n,"uv",r,2,20,12)}function oo(t,e,n,r,a,i,o){var s,u,c;Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*a*4),u=t.FLOAT,c=o.internalFormatPackedFloat),s.set(i),Zt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,a,0,t.RGBA,u,s)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function so(t,e,n,r){Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Zt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):Zt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function uo(t,e,n,r,a){var i=t.createBuffer();Zt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)}));var o=16*n*r;return Zt(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),Zt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),Zt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),i}function co(t,e,n){var r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function lo(t,e,n,r,a){var i=jt(n,r),o=i[0],s=i[1],u=new Uint8Array(n*r*4);return Zt(t,e,(function(){return t.readPixels(0,0,o,s,a.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function po(t,e,n,r,a,i,o,s){var u=t,c=new Float32Array(function(t,e){var n=qt(t,e);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function fo(t,e,n,r){var a=new Float32Array(n*r*4);return Zt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,a)})),a}var ho=Object.freeze({createVertexShader:$i,createVertexBuffer:Yi,createIndexBuffer:Qi,createFloat32MatrixTexture:to,createFloat16MatrixTexture:eo,createUnsignedBytesMatrixTexture:no,createPackedMatrixTexture:ro,createFloat16PackedMatrixTexture:ao,bindVertexProgramAttributeStreams:io,uploadDenseMatrixToTexture:oo,uploadPixelDataToTexture:so,createBufferFromOutputTexture:uo,downloadFloat32MatrixFromBuffer:co,downloadByteEncodedFloatMatrixFromOutputTexture:lo,downloadPackedMatrixFromBuffer:po,downloadMatrixFromPackedOutputTexture:fo}),mo=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=c().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,Vt(e,t)):this.gl=Wt(e),1===c().getNumber("WEBGL_VERSION"))this.textureFloatExtension=$t(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=$t(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(Ae(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!Ae(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Yi(this.gl,this.debug),this.indexBuffer=Qi(this.gl,this.debug),this.framebuffer=ce(this.gl,this.debug),this.textureConfig=Gt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return c().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Zt(e,this.debug,(function(){return e.finish()})),Zt(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Zt(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Zt(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Zt(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Zt(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),to(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),eo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),no(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),so(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),oo(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ao(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ro(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(ve(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Zt(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return lo(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,a,i){return po(this.gl,t,0,0,0,a,i,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return co(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=uo(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(c().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=a.clientWaitSync(i,0,0);return t===a.ALREADY_SIGNALED||t===a.CONDITION_SATISFIED},e=i}else c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return fo(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=Qt(e,this.debug,t),r=$i(e,this.debug),a=ne(e,this.debug);return Zt(e,this.debug,(function(){return e.attachShader(a,r)})),Zt(e,this.debug,(function(){return e.attachShader(a,n)})),re(e,this.debug,a),this.debug&&ae(e,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=io(e,this.debug,this.program,this.vertexBuffer)),a},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&Zt(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&ae(this.gl,this.debug,this.program),Zt(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?fe(this.gl,this.debug,t,e):he(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Zt(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),de(this.gl,this.debug,this.program,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=qt(e,n),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(t,a,i)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&ae(this.gl,this.debug,this.program),ge(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Zt(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Zt(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=$t(this.gl,this.debug,2===c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a},t.prototype.endQuery=function(){if(2!==c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){switch(n.label){case 0:return[4,R((function(){return e.disposed||e.isQueryAvailable(t,c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||R((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),me(this.gl,this.debug,t,this.framebuffer),this.debug&&ge(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(me(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ge(this.gl)):ve(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;me(r,this.debug,t,this.framebuffer),this.debug&&ge(r),this.outputTexture=t,Zt(r,this.debug,(function(){return r.viewport(0,0,e,n)})),Zt(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var a=this;this.throwIfDisposed(),Zt(this.gl,this.debug,(function(){return a.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function vo(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,a=e[n],i=a.shape;if(!C(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!t.isUniform||!a.isUniform){var o=t.texShape,s=a.isUniform?null:a.texData.texShape;if(!C(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var go=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,a=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,p=n.dataFormat,f=s.left,h=s.top,d=a*r,m=Ua(),v="channelsLast"===p,g=v?0:1,y=v?1:2,b="",w=0;w<=1;w++)for(var x=0;x<=1;x++)b+="\n          blockIndex = rc.y + "+x+";\n          pos = rc.x + "+w+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+o+" - "+h+";\n            d0 = offsetY + "+l+" * (pos / "+d+");\n\n            if(d0 < "+e[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+f+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+d+".) / "+a+".));\n\n              if(d1 < "+e[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+a+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*w+x)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*w+x)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+m.output+" = result;\n      }\n    "},yo=function(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[];var i,o=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},bo=function(t,e,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+a+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+a+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},wo=function(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},xo=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,o=a-1-t.padInfo.top,s=i-1-t.padInfo.left,u=a*i-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+e+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ko=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,p=u-1-t.padInfo.top,f=c-1-t.padInfo.left,h=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+p+", "+f+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+a+") {\n          float dyD = float(dyDCorner + wD) / "+e+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+h+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},So=function(t,e,n,r,a,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",p=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",d="";i&&(h=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",d="result = activation(result);");var m=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+p[0]+" * "+f[0]+");\n          result += ("+p[1]+" * "+f[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},No=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),Eo=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Co=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Wa("rc",e),r=ei(e),a=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",a=t-2;a<t;a++)r+=n[a]+" >= "+e[a],a<t-1&&(r+="||");return r}(e,t,n),i=function(t,e,n,r){if(1===t)return"";var a=r.slice(-2);return"\n    int r = "+a[0]+";\n    int c = "+a[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i=(0===r?"r":"rp1")+", "+(0===a?"c":"cp1"),o=2;o<t;o++)i=e[e.length-1-o]+","+i;n.push(i)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+a+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},To=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,a=ei(r),i=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Io=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,a=ei(r),i=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Wa("rc",r),u=Wa("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",p=[a+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",d=0,m=1===r?2:4;d<m;d++)h+="\n        "+p[d]+"\n        if ("+f+") {\n          result["+d+"] = float("+n+");\n        } else {\n          "+a+" source = rc - start;\n          result["+d+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";h+=1===r?"} ":"}}",this.userCode="\n      const "+a+" start = "+a+"("+i+");\n      const "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+h+"\n        setOutput(result);\n      }\n    "},_o=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var f="avg"===e,h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+a+", "+i+");\n        const ivec2 pads = ivec2("+l+", "+p+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+o+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var d=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(d="avgValue / count");var m=4*Math.floor(r/4),v=r%4,g="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+l+", "+p+");\n      const float initializationValue = "+h+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+h+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+o+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+d+");\n      }\n    "}},Ao=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===e,g="0.0";if(v||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+a+", "+i+", "+o+");\n        const ivec3 pads = ivec3("+h+", "+d+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+p+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+p+" * "+f+" +\n                      wR * "+f+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");var b=4*Math.floor(r/4),w=r%4,x="\n      if ("+v+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+h+", "+d+", "+m+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+p+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+x+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+x+"\n            } else if ("+(2===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+x+"\n            } else if ("+(3===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+x+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},Ro=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,a=t.inSize,i=Math.ceil(a/n);this.outputShape=[r,i];var o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,p="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",f="vec4";"all"===e?(o="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===e&&(o="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+h+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+p+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+p+"\n        } else if ("+(2===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+p+"\n        } else if ("+(3===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+p+"\n        }\n        setOutput("+u+");\n      }\n    "},Do=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        "+a+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+ja(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Ha(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Oo=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,a=r[1],i=r[2],o=t.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],p=c[0]/l[0],f=c[1]/l[1],h=1/p,d=1/f,m=2*Math.ceil(h)+2,v=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+p+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(a-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Mo=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Fo=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},zo=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,a=r[1],i=r[2],o=t.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],p=c[0]/l[0],f=c[1]/l[1],h=1/p,d=1/f,m=2*Math.ceil(h)+2,v=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+p+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Bo=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Lo=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),a=ei(n);this.userCode="\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},Po=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=Wa("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=ei(n);function s(n){var r=t.map((function(r,a){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(a,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+a+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+a+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+a+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},Vo=function(t,e,n,r,a,i,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=ei(a.length),u=ei(i.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",p="";1===r?p="i":2===r&&(p="i, coords[1]");var f="getUpdates("+p+")",h=e>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+a+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+h+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+f+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Wo=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,a=t.inSize,i=t.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      ");var p="";a%n>0&&(p="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+p+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},Uo=function(t,e,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&o.push(""+i[u]);r=o.join(),a=s.join()}var c=ei(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},jo=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=ei(this.rank),r="uniform int start["+this.rank+"];",a=function(t){if(1===t)return"sourceLoc";if(t<=6)return Ho.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+Ho[e]+" = start["+e+"] + coords."+Ho[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+a+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),Ho=["x","y","z","w","u","v"],qo=function(){function t(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=ei(this.rank),n=Wa("coords",this.rank),r=Wa("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+a+")",o="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),Go=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=ei(n.length),i=ei(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+t+");\n      "+a+" strides = "+a+"("+e+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},Zo=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,a=Ko(e,n),i=Xo(t,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===Bt.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===Bt.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===Bt.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===Bt.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===Bt.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var a=Xo(e,Ko(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function Ko(t,e){if(t===zt.UPLOAD)return Bt.PACKED_2X2_FLOAT32;if(t===zt.RENDER||null==t)return function(t){return c().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Bt.PACKED_2X2_FLOAT32:Bt.UNPACKED_FLOAT32:t?Bt.PACKED_2X2_FLOAT16:Bt.UNPACKED_FLOAT16}(e);if(t===zt.DOWNLOAD||t===zt.PIXELS)return Bt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function Xo(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var $o=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var a=ei(this.rank),i=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<t.length;a++)r.push("imod("+n[a]+", "+t[a]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},Yo=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var a=ei(this.rank),i=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}(e);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},Qo=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=ei(this.rank),i=Va("rc",this.rank),o=new Array(this.rank);for(r=0;r<e.length;r++)o[e[r]]=i[r];var s="vec2("+o.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+a+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},Jo=1.7580993408473768,ts=1.0507009873554805,es=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},ns="if (isnan(x)) return x;",rs="return abs(x);",as=ns+"\n  return (x < 0.0) ? 0.0 : x;\n",is=ns+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",os="return (x >= 0.0) ? x : (exp(x) - 1.0);",ss="return -x;",us="return ceil(x);",cs="return floor(x);",ls="return exp(x);",ps="return exp(x) - 1.0;",fs="return x;",hs="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ds="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ms="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",vs=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},gs=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=Wa("rc",e),r=ei(e),a=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),i=n.slice(-2),o=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+a+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},ys={};function bs(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?hs:as;if("elu"===t)return e?ms:os;if("relu6"===t)return e?ds:is;if("prelu"===t)return e?mi:hi;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var ws=function(t){function e(e){var n,r=t.call(this)||this;if(r.gpgpu=e,r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!c().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var a=Wt(c().getNumber("WEBGL_VERSION"));r.binaryCache=((n=c().getNumber("WEBGL_VERSION"))in ys||(ys[n]={}),ys[n]),r.gpgpu=new mo(a),r.canvas=a.canvas,r.gpgpuCreatedLocally=!0}else r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new Zo(r.gpgpu),r.numMBBeforeWarning=null==c().global.screen?1024:c().global.screen.height*c().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new ia(r,Dt),r}return i(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n="undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement,r=t.data instanceof Uint8Array,a="undefined"!=typeof ImageData&&t instanceof ImageData,i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,s=i?[t.videoWidth,t.videoHeight]:[t.width,t.height],u=s[0],l=s[1],p=[l,u],f=[l,u,e];if(!(n||r||a||i||o))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);(o||i)&&(null==this.fromPixels2DContext&&(this.fromPixels2DContext=Ut(c().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=u,this.fromPixels2DContext.canvas.height=l,this.fromPixels2DContext.drawImage(t,0,0,u,l),t=this.fromPixels2DContext.canvas);var h,d,m=this.makeTensorInfo(p,"int32");return this.texData.get(m.dataId).usage=zt.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(m.dataId),t),c().getBool("WEBGL_PACK")?(h=new Zi(f),d=this.compileAndRun(h,[m])):(h=new Gi(f),d=this.compileAndRun(h,[m])),this.disposeData(m.dataId),d},e.prototype.write=function(t,e,n){if(c().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:zt.UPLOAD}),r},e.prototype.move=function(t,e,n,r){if(c().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:zt.UPLOAD})},e.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,a=e.complexTensors,i=e.slice,o=e.shape,s=e.isPacked;if(null!=i){var u;u=s?new vs(o,fs):new es(o,fs);var c=this.runWebGLProgram(u,[{dataId:t,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var p,f,h=null!=this.activeTimers;return h&&(p=tt()),f="complex64"===r?Ta(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=tt()-p),this.convertAndCacheOnCPU(t,f)},e.prototype.read=function(t){return o(this,void 0,void 0,(function(){var e,n,r,a,i,o,u,l,p,f,h,d,m,v,g,y,b,w,x,k,S,N;return s(this,(function(s){switch(s.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,a=n.shape,i=n.slice,o=n.dtype,u=n.complexTensors,l=n.isPacked,null!=i)return void 0,p=l?new vs(a,fs):new es(a,fs),f=this.runWebGLProgram(p,[{dataId:t,shape:a,dtype:o}],o),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!c().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===c().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return d=null,"complex64"!==o&&c().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(t),v=this.texData.get(m.dataId),d=(N=this.gpgpu).createBufferFromTexture.apply(N,[v.texture].concat(Ht(a)))),this.pendingRead.set(t,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:s.sent(),s.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([u.real.data(),u.imag.data()])];case 3:return y=s.sent(),b=y[0],w=y[1],g=Ta(b,w),[3,5];case 4:null==d?g=this.getValuesFromTexture(t):(x=E(a),g=this.gpgpu.downloadFloat32MatrixFromBuffer(d,x)),s.label=5;case 5:return null!=m&&this.disposeData(m.dataId),k=this.convertAndCacheOnCPU(t,g),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(t){return t(k)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,k]}}))}))},e.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!Kt(n)){if(c().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},e.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),r=n.shape,a=n.dtype,i=n.isPacked,o=E(r);if(c().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(t),u=this.texData.get(s.dataId),l=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[u.texture].concat(Ht(r))).subarray(0,o);return this.disposeData(s.dataId),l}var p=c().getBool("WEBGL_PACK")&&!0===i,f=p?Se(r):r,h=p?new Wi(f):new Vi(f),d=this.runWebGLProgram(h,[{shape:f,dtype:a,dataId:t}],"float32"),m=this.texData.get(d.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,o);return this.disposeData(d.dataId),v},e.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e,n,r,a,i,o,u;return s(this,(function(s){switch(s.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),a=N(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),i=N(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(a)];case 1:return o=s.sent(),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:w(o),getExtraProfileInfo:function(){return o.map((function(t,e){return{name:i[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:tt(),endMs:null}},e.prototype.endTimer=function(t){return c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=tt(),t)},e.prototype.getQueryTime=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return c().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,a=e.texShape,i=e.usage,o=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return c().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Dt.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,e){var n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Dt.keep(t.clone()),imag:Dt.keep(e.clone())},n},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===E(n))return En([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,a=Zr(t.shape,e,n);if(r||!a){var i=c().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qo(n):new jo(n),o=i.getCustomSetupFunc(e);return this.compileAndRun(i,[t],null,o)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},e.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),a=this.makeOutput(n,t.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=t.dtype;var o=Kr(e,t.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),a},e.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var a=Hr(e,n,r);if(a.some((function(t){return 0===t})))return En([],a);var i=new Go(e,r,a);return this.compileAndRun(i,[t])},e.prototype.reverse=function(t,e){var n=c().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Po(t.shape,e):new Lo(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return Sn(t)})),r=t.map((function(t){return Nn(t)}));return kn(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>c().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(t.length/2),i=this.concat(t.slice(0,a),e),o=this.concat(t.slice(a),e);return this.concat([i,o],e)}if(c().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new xi(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var u=wn(t.map((function(t){return t.shape})),e),l=t.map((function(t){return t.as2D(-1,E(t.shape.slice(e)))})),p=new wi(l.map((function(t){return t.shape})));return this.compileAndRun(p,l).reshape(u)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ss,t.dtype);var e=new es(t.shape,ss);return this.compileAndRun(e,[t])},e.prototype.batchMatMul=function(t,e,n,r){var a=n?t.shape[2]:t.shape[1],i=r?e.shape[1]:e.shape[2],o=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===a||1===i)&&o>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===i?t:t.as3D(s,o,1),c=1===i?2:1,l=1===i?e.as3D(s,1,o):e;return this.multiply(u,l).sum(c,!0)}var p=St(t.dtype,e.dtype),f=new So(t.shape,[s,a,i],n,r);return this.compileAndRun(f,[t,e],p)},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,a=t.transposeB,i=t.bias,o=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=a?n.shape[1]:n.shape[2],l=e.shape[0],p=St(e.dtype,n.dtype),f=null!=i,h=null!=s,d=o?bs(o,!0):null,m=new So(e.shape,[l,u,c],r,a,f,d,h),v=[e,n];return i&&v.push(i),s&&v.push(s),this.compileAndRun(m,v,p)},e.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),a=new ci("return areal * breal - aimag * bimag;",t.shape,e.shape),i=new ci("return areal * bimag + aimag * breal;",t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],s=this.compileAndRun(a,o),u=this.compileAndRun(i,o),l=this.complex(s,u);return s.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,fi,t.dtype);var p=new di(fi,t.shape,e.shape);return this.compileAndRun(p,[t,e],t.dtype)},e.prototype.batchNormalization=function(t,e,n,r,a,i){var o=[t,e,n],s=null;null!=i&&(s=i.shape,o.push(i));var u=null;if(null!=a&&(u=a.shape,o.push(a)),c().getBool("WEBGL_PACK_NORMALIZATION")){var l=new ui(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(l,o)}var p=new si(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(p,o)},e.prototype.localResponseNormalization4D=function(t,e,n,r,a){var i=c().getBool("WEBGL_PACK_NORMALIZATION")?new wo(t.shape,e,n,r,a):new yo(t.shape,e,n,r,a);return this.compileAndRun(i,[t])},e.prototype.LRNGrad=function(t,e,n,r,a,i,o){var s=new bo(e.shape,r,a,i,o);return this.compileAndRun(s,[e,n,t])},e.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return rt(t)}));return Ma(or(t.shape,t.dtype,n),e)}var r=new $o(t.shape,e);return this.compileAndRun(r,[t])},e.prototype.pad=function(t,e,n){var r=c().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Io(t.shape,e,n):new To(t.shape,e,n);return this.compileAndRun(r,[t])},e.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=c().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Qo(t.shape,e):new Yo(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new Ki(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},e.prototype.batchToSpaceND=function(t,e,n){x(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),a=Mr(t.shape,e,r),i=Fr(a.length,e.length),o=zr(t.shape,e,r),s=Br(n,e.length),u=Lr(o,n,e.length);return t.reshape(a).transpose(i).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){x(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),a=[[0,0]];a.push.apply(a,n);for(var i=1+e.length;i<t.shape.length;++i)a.push([0,0]);var o=t.pad(a),s=Mr(o.shape,e,r,!1),u=Fr(s.length,e.length,!1),c=zr(o.shape,e,r,!1);return o.reshape(s).transpose(u).reshape(c)},e.prototype.reduce=function(t,e,n){var r=t.shape[0],a=t.shape[1],i=Vr(a),o=new Ro({windowSize:i,inSize:a,batchSize:r},e),s=this.compileAndRun(o,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)},e.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],a=t.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=Vr(a),o=new Pa({windowSize:i,inSize:a,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(t,e,u)},e.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,a=Vr(r[r.length-1]),i=new ai(r,a,e,null==n),o=null==n?[t]:[t,n],s=this.compileAndRun(i,o,"int32");return s.rank===t.rank?this.argReducePacked(t,e,s):s},e.prototype.sum=function(t,e){mn("sum",e,t.rank);var n=hn(t.shape,e),r=n[0],a=E(n[1]),i=t.as2D(-1,a),o=Nt(t.dtype);return this.reduce(i,"sum",o).reshape(r)},e.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=hn(t.shape,e),r=n[0],a=E(n[1]),i=t.as2D(-1,a),o=Nt(t.dtype);return this.reduce(i,"prod",o).reshape(r)},e.prototype.unsortedSegmentSum=function(t,e,n){var r=0,a=vn([r],t.rank),i=t;null!=a&&(i=t.transpose(a),r=yn(1,t.rank)[0]);var o=function(t,e,n){for(var r=[],a=t.length,i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}(i.shape,r,n),s=E([i.shape[r]]),u=i.as2D(-1,s),c=Nt(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(o);return null!=a&&(l=l.transpose(gn(a))),l},e.prototype.segOpCompute=function(t,e,n,r,a){var i=t.shape[0],o=t.shape[1],s=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=K(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=K(t,n+1);return n}(o,a),u=new Wo({windowSize:s,inSize:o,batchSize:i,numSegments:a},e),c=this.compileAndRun(u,[t,n],r);return c.shape[1]===a?c:(n=Pn(0,a).tile([o/s]),this.segOpCompute(c,e,n,r,a))},e.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(mn("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!c().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var a=hn(t.shape,r),i=a[0],o=E(a[1]),s=t.as2D(-1,o);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(t,n)},e.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},e.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},e.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var a=new Mi(t.shape,n,r);return this.compileAndRun(a,[t])},e.prototype.equal=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new di("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.notEqual=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new di("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new di("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.lessEqual=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new di("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new di("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greaterEqual=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new di("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalNot=function(t){var e=new es(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},e.prototype.logicalAnd=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new di("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalOr=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new di("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.select=function(t,e,n){var r=new Uo(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],St(e.dtype,n.dtype))},e.prototype.where=function(t){on("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return za(t.shape,e)},e.prototype.topk=function(t,e,n){return Fa(t.dataSync(),t.shape,t.dtype,e)},e.prototype.min=function(t,e){mn("min",e,t.rank);var n=hn(t.shape,e),r=n[0],a=E(n[1]),i=t.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(r)},e.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new di("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.mod=function(t,e){var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new di("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);mn("max",e,t.rank);var n=hn(t.shape,e),r=n[0],a=E(n[1]),i=t.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(r)},e.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new di("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.all=function(t,e){mn("all",e,t.rank);var n=hn(t.shape,e),r=n[0],a=E(n[1]),i=t.as2D(-1,a);return this.reduce(i,"all",i.dtype).reshape(r)},e.prototype.any=function(t,e){mn("any",e,t.rank);var n=hn(t.shape,e),r=n[0],a=E(n[1]),i=t.as2D(-1,a);return this.reduce(i,"any",i.dtype).reshape(r)},e.prototype.squaredDifference=function(t,e){var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("return (a - b) * (a - b);",t.shape,e.shape):new di("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.realDivide=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new di("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return this.compileAndRun(n,[t,e],"float32")},e.prototype.floorDiv=function(t,e){if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new di("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")},e.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,li);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=St(t.dtype,e.dtype);if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,li,n);var r=new di(li,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.packedUnaryOp=function(t,e,n){var r=new vs(t.shape,e);return this.compileAndRun(r,[t],n)},e.prototype.packedBinaryOp=function(t,e,n,r,a){void 0===a&&(a=!1);var i=new vi(n,t.shape,e.shape,a);return this.compileAndRun(i,[t,e],r)},e.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,a=this.texData.get(t.dataId),i=this.texData.get(e.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map((function(a){var i=a[0],o=a[1],s=r.makeComplexComponentTensorInfo(t,i),u=r.makeComplexComponentTensorInfo(e,o),c=new di(n,t.shape,e.shape);return r.compileAndRun(c,[s,u],St(i.dtype,o.dtype))})),s=o[0],u=o[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},e.prototype.makeComplexComponentTensorInfo=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},e.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>c().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var a=t.map((function(t){return t.dtype})).reduce((function(t,e){return St(t,e)})),i=t.map((function(t){return t.shape})),o=c().getBool("WEBGL_PACK")?new La(t[0].shape,i):new Ba(t[0].shape,i);return this.compileAndRun(o,t,a)},e.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,pi);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=St(t.dtype,e.dtype);if(c().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,pi,t.dtype);var r=new di(pi,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.pow=function(t,e){var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new di("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=St(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,us,t.dtype);var e=new es(t.shape,us);return this.compileAndRun(e,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,cs,t.dtype);var e=new es(t.shape,cs);return this.compileAndRun(e,[t])},e.prototype.sign=function(t){var e=new es(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},e.prototype.isNaN=function(t){var e=new es(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isInf=function(t){var e=new es(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isFinite=function(t){var e=new es(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.round=function(t){var e=new es(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ls,t.dtype);var e=new es(t.shape,ls);return this.compileAndRun(e,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ps,t.dtype);var e=new es(t.shape,ps);return this.compileAndRun(e,[t])},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new es(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},e.prototype.log1p=function(t){var e=new es(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},e.prototype.sqrt=function(t){var e=new es(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new es(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},e.prototype.reciprocal=function(t){var e=new es(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},e.prototype.relu=function(t){var e;return e=c().getBool("WEBGL_PACK")?new vs(t.shape,hs):new es(t.shape,as),this.compileAndRun(e,[t])},e.prototype.relu6=function(t){var e;return e=c().getBool("WEBGL_PACK")?new vs(t.shape,ds):new es(t.shape,is),this.compileAndRun(e,[t])},e.prototype.prelu=function(t,e){var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi(mi,t.shape,e.shape):new di(hi,t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.elu=function(t){if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ms,t.dtype);var e=new es(t.shape,os);return this.compileAndRun(e,[t])},e.prototype.eluDer=function(t,e){var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new di("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.selu=function(t){var e=new es(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},e.prototype.int=function(t){var e=new es(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")},e.prototype.clip=function(t,e,n){var r,a=(r=c().getBool("WEBGL_PACK_CLIP")?new yi(t.shape):new gi(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,a)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(c().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,rs,t.dtype);var e=new es(t.shape,rs);return this.compileAndRun(e,[t])},e.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new bi(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(t){var e=new es(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},e.prototype.softplus=function(t){var e=new es(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},e.prototype.sin=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},e.prototype.cos=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},e.prototype.tan=function(t){var e=new es(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},e.prototype.asin=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])},e.prototype.acos=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])},e.prototype.atan=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},e.prototype.atan2=function(t,e){var n=c().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new vi("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new di("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.sinh=function(t){var e=new es(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.cosh=function(t){var e=new es(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.tanh=function(t){var e=new es(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},e.prototype.asinh=function(t){var e=new es(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},e.prototype.acosh=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},e.prototype.atanh=function(t){var e=new es(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},e.prototype.erf=function(t){var e=new es(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(e,[t])},e.prototype.step=function(t,e){var n=new es(t.shape,function(t){return void 0===t&&(t=0),ns+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},e.prototype.conv2dByMatMul=function(t,e,n,r,a,i){var o=t.shape,s=this.texData.get(t.dataId),u=n.inChannels,l=o[0]*o[1]*o[2],p=n.outChannels,f="channelsLast"===n.dataFormat,h=(1===l||1===p)&&u>1e3,d=o[2]%2!=0&&!!s.isPacked;if(h||!c().getBool("WEBGL_LAZILY_UNPACK")||!c().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!d){var m=f?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],v=this.reshape(t,[1,m,n.inChannels]),g=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:g,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var y=f?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),b={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},w=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,x(Ce(s.shape,b.shape),(function(){return"packed reshape "+s.shape+" to "+b.shape+" isn't free"}));var k=this.reshape(e,[1,n.inChannels,n.outChannels]),S=this.fusedBatchMatMul({a:b,b:k,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),N=this.texData.get(S.dataId);return x(N.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=w,N.shape=n.outShape,Dt.makeTensorFromDataId(S.dataId,n.outShape,S.dtype)},e.prototype.conv2dWithIm2Row=function(t,e,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,p="channelsLast"===n.dataFormat,f=o*s*u,h=l*c,d=[f,h],m=t.squeeze([0]),v=e.reshape([1,f,-1]),g=new go(d,m.shape,n),y=this.compileAndRun(g,[m]).reshape([1,d[0],d[1]]),b=null!=r,w=null!=i,x=a?bs(a,!0):null,k=new So(y.shape,[1,h,n.outChannels],!0,!1,b,x,w),S=[y,v];r&&S.push(r),w&&S.push(i);var N=this.compileAndRun(k,S);return p?N.reshape([1,l,c,n.outChannels]):N.reshape([1,n.outChannels,l,c])},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,a=t.bias,i=t.activation,o=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,a,i,o);if(c().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,a,i,o);var s=null!=a,u=null!=o,l=i?bs(i,!1):null,p=new _i(r,s,l,u),f=[e,n];return a&&f.push(a),o&&f.push(o),this.compileAndRun(p,f)},e.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(c().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new _i(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerInput=function(t,e,n){var r=new Ni(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerFilter=function(t,e,n){var r=new Si(n);return this.compileAndRun(r,[t,e])},e.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,a=t.convInfo,i=t.bias,o=t.activation,s=t.preluActivationWeights,u=c().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,l=o?bs(o,u):null,p=[n,r],f=null!=i,h=null!=s;return f&&p.push(i),h&&p.push(s),u?(e=new Di(a,f,l,h),this.compileAndRun(e,p)):(e=new Ri(a,f,l,h),this.compileAndRun(e,p))},e.prototype.depthwiseConv2D=function(t,e,n){var r;return c().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Di(n),this.compileAndRun(r,[t,e])):(r=new Ri(n),this.compileAndRun(r,[t,e]))},e.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new Ii(n);return this.compileAndRun(r,[t,e])},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new Ti(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3d=function(t,e,n){var r=new Ai(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerInput=function(t,e,n){var r=new Ci(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerFilter=function(t,e,n){var r=new Ei(n);return this.compileAndRun(r,[t,e])},e.prototype.maxPool=function(t,e){var n=new _o(e,"max",!1);return this.compileAndRun(n,[t])},e.prototype.avgPool=function(t,e){var n=new _o(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPoolBackprop=function(t,e,n,r){var a=new _o(r,"max",!0),i=this.compileAndRun(a,[e]),o=new xo(r),s=this.compileAndRun(o,[t,i],e.dtype);return i.dispose(),s},e.prototype.avgPoolBackprop=function(t,e,n){var r=new ii(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.cast=function(t,e){return Sa(t,e,this)},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),a=0,i=0;i<t.rank;i++)i!==e&&(r[a++]=t.shape[i]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[e]=i,u[i]=this.slice(t,o,s).reshape(r);return u},e.prototype.avgPool3d=function(t,e){var n=new Ao(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,e,n){var r=new oi(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.maxPool3d=function(t,e){var n=new Ao(e,"max",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,e,n,r){var a=new Ao(r,"max",!0),i=this.compileAndRun(a,[e]),o=new ko(r),s=this.compileAndRun(o,[t,i],e.dtype);return i.dispose(),s},e.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!Ce(t.shape,e)&&(null===n.texture||!Ce(n.shape,e))){var r=this.packedReshape(t,e);return Dt.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Na(t,e)},e.prototype.resizeBilinear=function(t,e,n,r){var a=c().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Fo(t.shape,e,n,r):new Mo(t.shape,e,n,r);return this.compileAndRun(a,[t])},e.prototype.resizeBilinearBackprop=function(t,e,n){var r=new Oo(t,e,n);return this.compileAndRun(r,[t])},e.prototype.resizeNearestNeighbor=function(t,e,n,r){var a=new Bo(t.shape,e,n,r);return this.compileAndRun(a,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new zo(t,e,n);return this.compileAndRun(r,[t])},e.prototype.multinomial=function(t,e,n,r){var a=e?t:ra(t),i=a.shape[0],o=a.shape[1],s=new No(i,o,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[a],"int32",u)},e.prototype.oneHot=function(t,e,n,r){var a=new Eo(t.size,e,n,r);return this.compileAndRun(a,[t])},e.prototype.diag=function(t){var e=new Pi(t.size);return this.compileAndRun(e,[t])},e.prototype.nonMaxSuppression=function(t,e,n,r,a){return on("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Ra(t.dataSync(),e.dataSync(),n,r,a)},e.prototype.cropAndResize=function(t,e,n,r,a,i){var o=new Oi(t.shape,e.shape,r,a,i);return this.compileAndRun(o,[t,e,n])},e.prototype.depthToSpace=function(t,e,n){x(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],a="NHWC"===n?t.shape[1]:t.shape[2],i="NHWC"===n?t.shape[2]:t.shape[3],o="NHWC"===n?t.shape[3]:t.shape[1],s=a*e,u=i*e,c=o/(e*e),l=new Li("NHWC"===n?[r,s,u,c]:[r,c,s,u],e,n);return this.compileAndRun(l,[t])},e.prototype.split=function(t,e,n){return Oa(t,e,n)},e.prototype.scatterND=function(t,e,n){var r=Wr(0,t,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=t.reshape([i,a]),p=e.reshape([i,o]);if(0===u)return Na(En([]),n);var f=Tn(0),h=new Vo(i,a,l.rank,p.rank,s,c);return this.compileAndRun(h,[p,l,f]).reshape(n)},e.prototype.sparseToDense=function(t,e,n,r){var a=Wr(0,t,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,u=a.outputSize,c=new Vo(o,i,t.rank,e.rank,s,[u,1],!1);return this.compileAndRun(c,[e,t,r]).reshape(n)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new Hi("return real * expR - imag * expI;",t.shape,e),a=new Hi("return real * expI + imag * expR;",t.shape,e),i=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),u=this.complex(o,s).as2D(t.shape[0],t.shape[1]);return o.dispose(),s.dispose(),u},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],a=Pr(t,e),i=a[0],o=a[1],s=a[2],u=a[3],c=e.reshape([o,r]),l=t.reshape([t.size/s,s]),p=new Xi(r,u,[o,s]);return this.compileAndRun(p,[l,c]).reshape(i)},e.prototype.fill=function(t,e,n){if("string"===(n=n||G(e))){var r=z(n,E(t));return r.fill(e),Dt.makeTensor(r,t,n,this)}var a=new qi(t,e),i=a.getCustomSetupFunc(e);return this.compileAndRun(a,[],n,i)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},e.prototype.linspace=function(t,e,n){return Ea(t,e,n)},e.prototype.makeTensorInfo=function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}},e.prototype.makeOutput=function(t,e){var n=this.makeTensorInfo(t,e).dataId;return Dt.makeTensorFromDataId(n,t,e,this)},e.prototype.unpackTensor=function(t){var e=new gs(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},e.prototype.packTensor=function(t){var e=new Co(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,e){var n=[xe(t.shape)].concat(ke(t.shape)),r={dtype:t.dtype,shape:n,dataId:t.dataId},a=[xe(e)].concat(ke(e)),i=new Do(a,n),o=this.runWebGLProgram(i,[r],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}},e.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,a=n.shape,i=n.dtype,o=Se(a);return e=r?new Bi(o):new zi(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(e,[{shape:o,dtype:i,dataId:t}],i,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,e,n,r,a){var i=this;void 0===a&&(a=!1);var o=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(o.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===Ft.DENSE){var u=Ht(t.outputShape);s.texShape=u.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===E(o.shape))return s.values=F(o.dtype,0),o;var l=[],p=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&E(e.shape)<=c().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?i.unpackTensor(e):i.packTensor(e),l.push(e),n=i.texData.get(e.dataId);else if(n.isPacked&&!Ce(n.shape,e.shape)){var r=e,a=e.shape;e.shape=n.shape,e=i.packedReshape(e,a),l.push(e),n=i.texData.get(e.dataId),r.shape=a}return i.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var f,h={shape:o.shape,texData:s,isUniform:!1},d=function(t,e,n){var r="";e.concat(n).forEach((function(t){var e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;r+=t.shape+"_"+n+"_"+e}));var a=t.userCode;return t.constructor.name+"_"+r+"_"+a}(t,p,h),m=this.getAndSaveBinary(d,(function(){return function(t,e,n,r){var a=e.userCode,i=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=i.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=Ga(i,s,a,e.packedInputs),l=t.createProgram(u),p=null,f=t.getUniformLocation(l,"NAN",!1);1===c().getNumber("WEBGL_VERSION")&&(p=t.getUniformLocation(l,"INFINITY",!1));for(var h={},d=0;d<e.variableNames.length;d++){var m=e.variableNames[d];h[m]=t.getUniformLocation(l,m,!1),h["offset"+m]=t.getUniformLocation(l,"offset"+m,!1)}return{program:e,source:u,webGLProgram:l,uniformLocations:h,inShapeInfos:o,outShapeInfo:s,infLoc:p,nanLoc:f}}(i.gpgpu,t,p,h)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),function(t,e,n,r,a){vo(e.inShapeInfos,n),vo([e.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i,o[0],o[1]):t.setOutputMatrixTexture(i,o[0],o[1]),t.setProgram(e.webGLProgram),1===c().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var a=e.program.variableNames[r],i=e.uniformLocations[a],o=e.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(E(n.shape)<2)t.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,m,p,h,r),l.forEach((function(t){return i.disposeData(t.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!c().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){var g=this.unpackTensor(o);return this.disposeData(o.dataId),g}return o},e.prototype.compileAndRun=function(t,e,n,r,a){void 0===a&&(a=!1),n=n||e[0].dtype;var i=this.runWebGLProgram(t,e,n,r,a);return Dt.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},e.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ge((function(){if(!c().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=c().getBool("DEBUG");c().set("DEBUG",!1);var n=t.abs(Tn(1e-8)).dataSync()[0];if(c().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,a=n.dtype,i=n.values,o=n.texture,s=n.usage,u=n.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=tt());var p=n.texShape;if(null==p&&(p=Ne(r,u),n.texShape=p),null!=i){var f=Se(r),h=void 0,d=p[1],m=p[0],v=i instanceof Uint8Array;u?(d=(e=qt(p[0],p[1]))[0],m=e[1],h=new ji(f,[m,d],v)):h=new Ui(f,[m,d],v);var g=this.makeTensorInfo([m,d],a);this.texData.get(g.dataId).usage=v?zt.PIXELS:zt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,m,i);var y=this.runWebGLProgram(h,[g],a,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=tt()-c)}else{var w=this.acquireTexture(p,s,a,u);n.texture=w}}},e.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},e.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},e.prototype.computeBytes=function(t,e){return t[0]*t[1]*W(e)},e}(oa);Ot()&&Dt.registerBackend("webgl",(function(){return new ws}),2);var xs=xn({square_:function(t){var e=cn(t,"x","square"),n=[e];return Dt.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}),"Square",{},n,[])}}),ks=xn({abs_:function(t){var e=cn(t,"x","abs");return"complex64"===e.dtype?Dt.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Dt.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),"Abs")}}),Ss=xn({acos_:function(t){var e=cn(t,"x","acos");return Dt.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Tn(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),Ns=xn({acosh_:function(t){var e=cn(t,"x","acosh");return Dt.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Es=xn({asin_:function(t){var e=cn(t,"x","asin");return Dt.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Tn(1).sub(n.toFloat().square()).sqrt())}}}))}}),Cs=xn({asinh_:function(t){var e=cn(t,"x","asinh");return Dt.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Tn(1).add(n.toFloat().square()).sqrt())}}}))}}),Ts=xn({atan_:function(t){var e=cn(t,"x","atan");return Dt.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),Is=xn({atanh_:function(t){var e=cn(t,"x","atanh");return Dt.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(Tn(1).sub(n.toFloat().square()))}}}))}}),_s=xn({ceil_:function(t){var e=cn(t,"x","ceil");return Dt.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),As=xn({clipByValue_:function(t,e,n){var r=cn(t,"x","clipByValue");return x(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),Dt.runKernelFunc((function(t,a){var i=t.clip(r,e,n);return a([r]),i}),{$x:r},(function(t,r){var a=r[0];return{$x:function(){return t.where(a.greaterEqual(e).logicalAnd(a.lessEqual(n)),Wn(t))}}}))}}),Rs=xn({cos_:function(t){var e=cn(t,"x","cos");return Dt.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}}))}}),Ds=xn({cosh_:function(t){var e=cn(t,"x","cosh");return Dt.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),Os=xn({erf_:function(t){var e=cn(t,"x","erf");return x("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),Dt.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Ms=xn({exp_:function(t){var e=cn(t,"x","exp");return Dt.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{$x:e},(function(t,e){return{$x:function(){return t.mulStrict(e[0])}}}))}}),Fs=xn({expm1_:function(t){var e=cn(t,"x","expm1");return Dt.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),zs=xn({floor_:function(t){var e=cn(t,"x","floor");return Dt.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),Bs=xn({log_:function(t){var e=cn(t,"x","log");return Dt.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}}))}}),Ls=xn({log1p_:function(t){var e=cn(t,"x","log1p");return Dt.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),Ps=xn({logSigmoid_:function(t){var e=cn(t,"x","logSigmoid");return Dt.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),Vs=xn({neg_:function(t){var e=cn(t,"x","neg");return Dt.runKernelFunc((function(t){return t.neg(e)}),{$x:e},(function(t){return{$x:function(){return t.neg()}}}))}}),Ws=xn({reciprocal_:function(t){var e=cn(t,"x","reciprocal");return Dt.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),Us=xn({round_:function(t){var e=cn(t,"x","round");return Dt.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),js=xn({rsqrt_:function(t){var e=cn(t,"x","rsqrt");return Dt.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}))}}),Hs=xn({sigmoid_:function(t){var e=cn(t,"x","sigmoid");return Dt.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.mul(Tn(1).sub(n)))}}}),"Sigmoid")}}),qs=xn({sign_:function(t){var e=cn(t,"x","sign");return Dt.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),Gs=xn({isNaN_:function(t){var e=cn(t,"x","isNaN");return Dt.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),Zs=xn({isInf_:function(t){var e=cn(t,"x","isInf");return Dt.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),Ks=xn({isFinite_:function(t){var e=cn(t,"x","isFinite");return Dt.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Wn(t)}}}))}}),Xs=xn({sin_:function(t){var e=cn(t,"x","sin");return Dt.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}}))}}),$s=xn({sinh_:function(t){var e=cn(t,"x","sinh");return Dt.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),Ys=xn({softplus_:function(t){var e=cn(t,"x","softplus");return Dt.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),Qs=xn({sqrt_:function(t){var e=cn(t,"x","sqrt");return Dt.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),Js=xn({step_:function(t,e){void 0===e&&(e=0);var n=cn(t,"x","step");return Dt.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Wn(t)}}}))}}),tu=xn({tan_:function(t){var e=cn(t,"x","tan");return Dt.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),eu=xn({tanh_:function(t){var e=cn(t,"x","tanh");return Dt.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Tn(1).sub(n.square()).mulStrict(t)}}}))}});function nu(t,e,n,r,a,i){var o,s,u=cn(t,"x","batchNorm"),c=cn(e,"mean","batchNorm"),l=cn(n,"variance","batchNorm");return null!=a&&(o=cn(a,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),x(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),x(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),x(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=o&&x(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&x(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),iu(u,c,l,s,o,i)}function ru(t,e,n,r,a,i){var o,s,u=cn(t,"x","batchNorm"),c=cn(e,"mean","batchNorm"),l=cn(n,"variance","batchNorm");return null!=a&&(o=cn(a,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),x(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),x(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),x(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=o&&x(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&x(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),iu(u,c,l,s,o,i)}function au(t,e,n,r,a,i){var o,s,u=cn(t,"x","batchNorm"),c=cn(e,"mean","batchNorm"),l=cn(n,"variance","batchNorm");return null!=a&&(o=cn(a,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),x(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),x(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),x(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=o&&x(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&x(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),iu(u,c,l,s,o,i)}function iu(t,e,n,r,a,i){null==i&&(i=.001);var o,s,u,c=cn(t,"x","batchNorm"),l=cn(e,"mean","batchNorm"),p=cn(n,"variance","batchNorm");null!=a&&(o=cn(a,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),x(l.rank===p.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),x(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),x(null==o||l.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,l,p,o];return Dt.runKernelFunc((function(t,e){var n=t.batchNormalization(u,ou(l),ou(p),i,ou(o),ou(s));return e([c,l,p,o]),n}),{x:c,mean:l,variance:p,scale:o,offset:s},(function(t,e){var n=e,r=n[0],a=n[1],o=n[2],s=n[3],c=null==s?Tn(1):s,l=ca(a.shape,u.shape),p=[];if(1===a.rank){for(var f=0;f<u.shape.length-1;++f)p.push(u.shape[f]);p.push(1)}var h=r.sub(a),d=t.mul(c),m=js(o.add(Tn(i))),v=m.mul(m).mul(m).mul(Tn(-.5));return{x:function(){return 1===a.rank?t.mul(Ar(m.as4D(1,1,1,a.shape[0]),p)).mul(c).reshape(r.shape):t.mul(m).mul(c).reshape(r.shape)},mean:function(){var t=m.mul(Tn(-1)).mul(d);return 1===a.rank&&(t=t.sum(l)),t.reshape(a.shape)},variance:function(){var t=v.mul(h).mul(d);return 1===a.rank&&(t=t.sum(l)),t.reshape(a.shape)},scale:function(){var e=h.mul(m),n=t.mul(e);return 1===a.rank&&(n=n.sum(l)),n.reshape(a.shape)},offset:function(){var e=t;return 1===a.rank&&(e=e.sum(l)),e.reshape(a.shape)}}}),"BatchNormalization",{varianceEpsilon:i},f).reshape(c.shape)}function ou(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function su(){We("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var uu=xn({batchNormalization2d_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),su(),nu(t,e,n,i,a,r)}}),cu=xn({batchNormalization3d_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),su(),ru(t,e,n,i,a,r)}}),lu=xn({batchNormalization4d_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),su(),au(t,e,n,i,a,r)}}),pu=xn({batchNormalization_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),su(),iu(t,e,n,i,a,r)}}),fu=xn({batchNorm_:iu}),hu=xn({batchNorm2d_:nu}),du=xn({batchNorm3d_:ru}),mu=xn({batchNorm4d_:au}),vu=xn({logicalAnd_:function(t,e){var n=cn(t,"a","logicalAnd","bool"),r=cn(e,"b","logicalAnd","bool");return la(n.shape,r.shape),Dt.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{$a:n,$b:r})}}),gu=xn({logicalNot_:function(t){var e=cn(t,"x","logicalNot","bool");return Dt.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),yu=xn({logicalOr_:function(t,e){var n=cn(t,"a","logicalOr","bool"),r=cn(e,"b","logicalOr","bool");return la(n.shape,r.shape),Dt.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),bu=xn({logicalXor_:function(t,e){var n=cn(t,"a","logicalXor","bool"),r=cn(e,"b","logicalXor","bool");return la(n.shape,r.shape),yu(t,e).logicalAnd(vu(t,e).logicalNot())}}),wu=xn({where_:function(t,e,n){var r=cn(e,"a","where"),a=cn(n,"b","where"),i=cn(t,"condition","where","bool");return k(r.shape,a.shape,"Error in where: "),1===i.rank?x(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):k(i.shape,a.shape,"Error in where: "),Dt.runKernelFunc((function(t,e){var n=t.select(i,r,a);return e([i]),n}),{$condition:i,$a:r,$b:a},(function(t,e){var n=e[0];return{$condition:function(){return Wn(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),xu=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return s(this,(function(a){switch(a.label){case 0:return[4,(e=cn(t,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=za(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},ku=xn({add_:function(t,e){var n,r=cn(t,"a","add"),a=cn(e,"b","add");n=Et(r,a),r=n[0],a=n[1];var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t){return t.add(r,a)}),{a:r,b:a},(function(t){return{a:function(){var e=t,n=ca(r.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=ca(a.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(a.shape)}}}),"Add")}}),Su=xn({addN_:function(t){x(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),x(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return cn(t,"tensors"+e,"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!C(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Dt.runKernelFunc((function(t){return t.addN(e)}),r,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}))}}),Nu=xn({addStrict_:function(t,e){var n=cn(t,"a","addStrict"),r=cn(e,"b","addStrict");return k(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Eu=xn({atan2_:function(t,e){var n,r=cn(t,"a","atan2"),a=cn(e,"b","atan2");n=Et(r,a),r=n[0],a=n[1];var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t,e){var n=t.atan2(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=ku(n.square(),r.square()),a=t.mul(r.div(e)),o=ca(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$b:function(){var e=ku(n.square(),r.square()),a=Vs(t.mul(n.div(e))),o=ca(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}))}}),Cu=xn({div_:function(t,e){var n,r=cn(t,"a","div"),a=cn(e,"b","div");if(n=Et(r,a),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype)return Iu(r,a);var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t,e){var n=t.realDivide(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),a=ca(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),a=ca(r.shape,i);a.length>0&&(e=e.sum(a).reshape(r.shape));var o=r.square();return e.div(o.toFloat()).neg()}}}),"Div")}}),Tu=xn({divStrict_:function(t,e){var n=cn(t,"a","div"),r=cn(e,"b","div");return k(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Iu=xn({floorDiv_:function(t,e){var n,r=cn(t,"a","floorDiv"),a=cn(e,"b","floorDiv");n=Et(r,a),r=n[0],a=n[1];var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t,e){var n=t.floorDiv(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),a=ca(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),a=ca(r.shape,i);a.length>0&&(e=e.sum(a).reshape(r.shape));var o=r.square();return e.div(o.toFloat()).neg()}}}))}}),_u=xn({maximum_:function(t,e){var n,r=cn(t,"a","maximum"),a=cn(e,"b","maximum");return n=Et(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),la(r.shape,a.shape),Dt.runKernelFunc((function(t,e){var n=t.maximum(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}}))}}),Au=xn({maximumStrict_:function(t,e){var n=cn(t,"a","maximumStrict"),r=cn(e,"b","maximumStrict");return k(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Ru=xn({minimum_:function(t,e){var n,r=cn(t,"a","minimum"),a=cn(e,"b","minimum");return n=Et(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),la(r.shape,a.shape),Dt.runKernelFunc((function(t,e){var n=t.minimum(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}}))}}),Du=xn({minimumStrict_:function(t,e){var n=cn(t,"a","minimumStrict"),r=cn(e,"b","minimumStrict");return k(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Ou=xn({mod_:function(t,e){var n,r=cn(t,"a","mod"),a=cn(e,"b","mod");n=Et(r,a),r=n[0],a=n[1];var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t,e){var n=t.mod(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=ca(n.shape,i);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),a=ca(r.shape,i);return a.length>0?e.sum(a).reshape(r.shape):e}}}))}}),Mu=xn({modStrict_:function(t,e){var n=cn(t,"a","modStrict"),r=cn(e,"b","modStrict");return k(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Fu=xn({mul_:function(t,e){var n,r=cn(t,"a","mul"),a=cn(e,"b","mul");n=Et(r,a),r=n[0],a=n[1];var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t,e){var n=t.multiply(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.mul(r.toFloat()),a=ca(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),a=ca(r.shape,i);return a.length>0?e.sum(a).reshape(r.shape):e}}}),"Mul")}}),zu=xn({mulStrict_:function(t,e){var n=cn(t,"a","mul"),r=cn(e,"b","mul");return k(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Bu=xn({pow_:function(t,e){var n=cn(t,"base","pow"),r=cn(e,"exp","pow"),a=la(n.shape,r.shape);return t=n.cast(St(n.dtype,r.dtype)),e=r.cast(St(n.dtype,r.dtype)),Dt.runKernelFunc((function(t,e){var a=t.pow(n,r);return e([n,r,a]),a}),{$base:n,$exp:r},(function(t,e){var n=e[0],r=e[1],i=e[2];return{$base:function(){var e=r.toFloat(),i=t.mul(e.mul(n.pow(e.sub(Tn(1))))),o=ca(n.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(n.shape)},$exp:function(){var e=n.greater(0),o=n.log().where(e,Wn(n)),s=t.mul(i.mul(o)),u=ca(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}))}}),Lu=xn({powStrict_:function(t,e){return k(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Pu=xn({squaredDifference_:function(t,e){var n,r=cn(t,"a","squaredDifference"),a=cn(e,"b","squaredDifference");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t,e){var n=t.squaredDifference(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1],a=Tn(2);return{$a:function(){return t.mul(n.sub(r).mul(a))},$b:function(){return t.mul(r.sub(n).mul(a))}}}))}}),Vu=xn({squaredDifferenceStrict_:function(t,e){var n=cn(t,"a","squaredDifferenceStrict"),r=cn(e,"b","squaredDifferenceStrict");return k(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Wu=xn({sub_:function(t,e){var n,r=cn(t,"a","sub"),a=cn(e,"b","sub");n=Et(r,a),r=n[0],a=n[1];var i=la(r.shape,a.shape);return Dt.runKernelFunc((function(t){return t.subtract(r,a)}),{a:r,b:a},(function(t){return{a:function(){var e=t,n=ca(r.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=ca(a.shape,i);return n.length>0&&(e=e.sum(n)),e.neg().reshape(a.shape)}}}),"Sub")}}),Uu=xn({subStrict_:function(t,e){var n=cn(t,"a","subStrict"),r=cn(e,"b","subStrict");return k(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),ju=xn({equal_:function(t,e){var n,r=cn(t,"a","equal"),a=cn(e,"b","equal");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t){return t.equal(r,a)}),{$a:r,$b:a})}}),Hu=xn({equalStrict_:function(t,e){var n=cn(t,"a","equalStrict"),r=cn(e,"b","equalStrict");return k(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),qu=xn({greater_:function(t,e){var n,r=cn(t,"a","greater"),a=cn(e,"b","greater");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t){return t.greater(r,a)}),{$a:r,$b:a})}}),Gu=xn({greaterEqual_:function(t,e){var n,r=cn(t,"a","greaterEqual"),a=cn(e,"b","greaterEqual");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t,e){var n=t.greaterEqual(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return Wn(n)},$b:function(){return Wn(r)}}}))}}),Zu=xn({greaterEqualStrict_:function(t,e){var n=cn(t,"a","greaterEqualStrict"),r=cn(e,"b","greaterEqualStrict");return k(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Ku=xn({greaterStrict_:function(t,e){var n=cn(t,"a","greaterStrict"),r=cn(e,"b","greaterStrict");return k(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Xu=xn({less_:function(t,e){var n,r=cn(t,"a","less"),a=cn(e,"b","less");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t){return t.less(r,a)}),{$a:r,$b:a})}}),$u=xn({lessEqual_:function(t,e){var n,r=cn(t,"a","lessEqual"),a=cn(e,"b","lessEqual");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t){return t.lessEqual(r,a)}),{$a:r,$b:a})}}),Yu=xn({lessEqualStrict_:function(t,e){var n=cn(t,"a","lessEqualStrict"),r=cn(e,"b","lessEqualStrict");return k(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Qu=xn({lessStrict_:function(t,e){var n=cn(t,"a","lessStrict"),r=cn(e,"b","lessStrict");return k(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Ju=xn({notEqual_:function(t,e){var n,r=cn(t,"a","notEqual"),a=cn(e,"b","notEqual");return n=Et(r,a),r=n[0],a=n[1],la(r.shape,a.shape),Dt.runKernelFunc((function(t){return t.notEqual(r,a)}),{$a:r,$b:a})}}),tc=xn({notEqualStrict_:function(t,e){var n=cn(t,"a","notEqualStrict"),r=cn(e,"b","notEqualStrict");return k(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function ec(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function nc(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var rc=xn({gather_:function(t,e,n){void 0===n&&(n=0);var r=cn(t,"x","gather"),a=cn(e,"indices","gather","int32");n=O(n,r.shape)[0];var i=function(t,e,n){for(var r=t.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(t.shape[s]),i*=t.shape[s];for(s=0;s<e.rank;s++)a.push(e.shape[s]);for(s=n+1;s<t.rank;s++)a.push(t.shape[s]),o*=t.shape[s];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}(r,a,n);return Dt.runKernelFunc((function(t,e){var i=t.gather(r,a.flatten(),n);return e([a]),i}),{$x:r},(function(t,e){var a=e[0];return{$x:function(){var e=r.shape,i=a.size,o=e.slice(0,n),s=o.length,u=e.slice(n,e.length).slice(1),c=u.length,l=ec(0,s),p=ec(s+1,s+1+c),f=nc([o,[i],u]),h=t.reshape(f),d=a.reshape([i]),m=nc([[s],l,p]),v=h.transpose(m),g=ac(v,d,r.shape[n]),y=gn(m);return g.transpose(y)}}})).reshape(i.outputShape)}}),ac=xn({unsortedSegmentSum_:function(t,e,n){var r=cn(t,"x","unsortedSegmentSum"),a=cn(e,"segmentIds","unsortedSegmentSum","int32");return x(T(n),(function(){return"numSegments must be of dtype int"})),Dt.runKernelFunc((function(t,e){var i=t.unsortedSegmentSum(r,a,n);return e([a]),i}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=_u(e,Wn(e)),r=rc(t,n),a=Gu(e,Tn(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=hr(a,o+1);a=vu(a,Fn(r.shape,"bool"));var s=Wn(r);return wu(a,r,s)}(t,n)}}}))}}),ic=function(t,e,n){return o(this,void 0,void 0,(function(){var r,a,i,o,u,c,l,p,f,h,d,m,v;return s(this,(function(s){switch(s.label){case 0:for(r=cn(t,"tensor","boolMask"),a=cn(e,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,u=r.shape,x(o>0,(function(){return"mask cannot be scalar"})),k(u.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=i;l<i+o;l++)c*=u[l];return p=u.slice(0,i).concat([c],u.slice(i+o)),f=r.reshape(p),h=a.reshape([-1]),[4,xu(h)];case 1:return d=s.sent(),m=d.squeeze([1]),v=rc(f,m,i),t!==r&&r.dispose(),e!==a&&a.dispose(),m.dispose(),f.dispose(),h.dispose(),d.dispose(),[2,v]}}))}))};function oc(t,e,n,r,a,i,o){void 0===i&&(i="NHWC"),x(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),x(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),x(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),x(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===i?s[3]:s[1],p="NHWC"===i?u.shape[3]:u.shape[1];x(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),x(p===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+p+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&x(T(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var f=ka(i),h=ha(s,n.shape,r,1,a,o,!1,f),d=Dt.runKernelFunc((function(t,e){var r=t.conv2dDerInput(u,n,h);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return lc(t,n,r,a,i,1,o)},filter:function(){return fc(t,s,n.shape,r,a,i,o)}}}));return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function sc(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t),n=e[0],r=e[1],a=e[2];return 1===n&&1===r&&1===a}function uc(t,e,n,r,a){x(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var i=t,o=e,s=!1;4===e.rank&&(s=!0,o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],c=o.shape[4];x(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),x(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),x(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),x(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),x(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=da(i,n.shape,r,1,a),p=Dt.runKernelFunc((function(t){return t.conv3dDerInput(o,n,l)}),{dy5D:o});return s?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}var cc=xn({conv1d_:function(t,e,n,r,a,i,o){void 0===a&&(a="NWC"),void 0===i&&(i=1);var s=cn(t,"x","conv1d"),u=cn(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),x(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),x(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=o&&x(T(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),x(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),x(xa(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),x("NWC"===a,(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var p=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),h=lc(f,p,[1,n],r,"NHWC",[1,i],o);return l?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),lc=xn({conv2d_:function(t,e,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=cn(t,"x","conv2d"),u=cn(e,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),x(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),x(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=o&&x(T(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var p="NHWC"===a?c.shape[3]:c.shape[1];x(p===u.shape[2],(function(){return"Error in conv2d: depth of input ("+p+") must match input depth for filter "+u.shape[2]+"."})),x(xa(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var f=ka(a),h=ha(c.shape,u.shape,n,i,r,o,!1,f),d=Dt.runKernelFunc((function(t,e){var n=t.conv2d(c,u,h);return e([u,c]),n}),{x:c,$filter:u},(function(t,e){var o=e,s=o[0],u=o[1];return x(wa(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return hc(u.shape,t,s,n,r,a)},$filter:function(){return fc(u,t,s.shape,n,r,a)}}}));return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),pc=xn({conv3d_:function(t,e,n,r,a,i){void 0===a&&(a="NDHWC"),void 0===i&&(i=[1,1,1]);var o=cn(t,"x","conv3d"),s=cn(e,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),x(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),x(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),x(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),x(function(t,e){return sc(t)||sc(e)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),x("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var l=da(u.shape,s.shape,n,i,r),p=Dt.runKernelFunc((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){x(sc(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var a=e[0],o=e[1];return{x:function(){return uc(a.shape,t,o,n,r)},$filter:function(){return function(t,e,n,r,a){var i=t;4===t.rank&&(i=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var o=e;4===o.rank&&(o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),x(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),x(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),x(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),x(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),x(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=da(i.shape,n,r,1,a);return Dt.runKernelFunc((function(t){return t.conv3dDerFilter(i,o,s)}),{x5D:i,dy5D:o})}(a,t,o.shape,n,r)}}}));return c?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),fc=xn({conv2dDerFilter_:function(t,e,n,r,a,i,o){void 0===i&&(i="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),x(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),x(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),x(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];x(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),x(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=o&&x(T(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var p=ka(i),f=ha(s.shape,n,r,1,a,o,!1,p);return Dt.runKernelFunc((function(t){return t.conv2dDerFilter(s,u,f)}),{x4D:s,dy4D:u})}}),hc=xn({conv2dDerInput_:oc}),dc=xn({depthwiseConv2d_:function(t,e,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=cn(t,"x","depthwiseConv2d"),u=cn(e,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),x(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),x(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),x(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),x(xa(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=o&&x(T(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var p=ha(c.shape,u.shape,n,i,r,o,!0),f=Dt.runKernelFunc((function(t,e){var n=t.depthwiseConv2D(c,u,p);return e([c,u]),n}),{x:c,$filter:u},(function(t,e){x(wa(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=e[0],r=e[1];return{x:function(){return mc(n.shape,t,r,p)},$filter:function(){return vc(n,t,r.shape,p)}}}));return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),mc=xn({depthwiseConv2dDerInput_:function(t,e,n,r){var a=e,i=!1;3===e.rank&&(i=!0,a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=Dt.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(a,n,r)}),{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),vc=xn({depthwiseConv2dDerFilter_:function(t,e,n,r){var a=t;3===t.rank&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return 3===i.rank&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Dt.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(a,i,r)}),{x4D:a,dy4D:i})}}),gc=xn({separableConv2d_:function(t,e,n,r,a,i,o){void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC");var s=cn(t,"x","separableConv2d"),u=cn(e,"depthwiseFilter","separableConv2d"),c=cn(n,"pointwiseFilter","separableConv2d"),l=s,p=!1;if(3===s.rank&&(p=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");x(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),x(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),x(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),x(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),x(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var f=u.shape[2],h=u.shape[3];x(c.shape[2]===f*h,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+c.shape[2]+"."}));var d=dc(l,u,r,a,o,i),m=lc(d,c,1,"valid",o);return p?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),yc=xn({conv2dTranspose_:function(t,e,n,r,a,i){return oc(n,cn(t,"x","conv2dTranspose"),cn(e,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),bc=xn({conv3dTranspose_:function(t,e,n,r,a){return uc(n,cn(t,"x","conv3dTranspose"),cn(e,"filter","conv3dTranspose"),r,a)}}),wc=xn({matMul_:function(t,e,n,r){var a;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=cn(t,"a","matMul"),o=cn(e,"b","matMul");a=Et(i,o),i=a[0],o=a[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?o.shape[o.rank-2]:o.shape[o.rank-1],p=i.shape.slice(0,-2),f=o.shape.slice(0,-2),h=E(p),d=E(f);x(i.rank>=2&&o.rank>=2&&i.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."})),x(C(p,f),(function(){return"Error in matMul: outer dimensions ("+p+") and ("+f+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."})),x(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=i.shape.slice(0,-2).concat([c,l]),v=n?i.as3D(h,s,c):i.as3D(h,c,s),g=r?o.as3D(d,l,u):o.as3D(d,u,l),y={transposeA:n,transposeB:r};return Dt.runKernelFunc((function(t,e){var a=t.batchMatMul(v,g,n,r);return e([v,g]),a}),{a:v,b:g},(function(t,e){var a=e,i=a[0],o=a[1];return n||r?!n&&r?{a:function(){return t.matMul(o,!1,!1)},b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{a:function(){return o.matMul(t,!1,!0)},b:function(){return i.matMul(t,!1,!1)}}:{a:function(){return o.matMul(t,!0,!0)},b:function(){return t.matMul(i,!0,!0)}}:{a:function(){return t.matMul(o,!1,!0)},b:function(){return i.matMul(t,!0,!1)}}}),"BatchMatMul",y).reshape(m)}}),xc=xn({dot_:function(t,e){var n=cn(t,"t1","dot"),r=cn(e,"t2","dot");x(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return x(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),kc=xn({outerProduct_:function(t,e){var n=cn(t,"v1","outerProduct"),r=cn(e,"v2","outerProduct");return x(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Sc=xn({reverse_:function(t,e){var n=cn(t,"x","reverse");if(0===n.rank)return n.clone();var r=O(e,n.shape);return Dt.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),Nc=xn({reverse1d_:function(t){var e=cn(t,"x","reverse");return x(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Sc(e,0)}}),Ec=xn({reverse2d_:function(t,e){var n=cn(t,"x","reverse");return x(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),Sc(n,e)}}),Cc=xn({reverse3d_:function(t,e){var n=cn(t,"x","reverse");return x(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),Sc(n,e)}}),Tc=xn({reverse4d_:function(t,e){var n=cn(t,"x","reverse");return x(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),Sc(n,e)}});function Ic(t,e,n,r,a,i){var o=cn(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),x(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),x(xa(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&x(T(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=pa(s.shape,e,n,r,a,i),l=Dt.runKernelFunc((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,i){var o=i[0],s=i[1];return{x:function(){return function(t,e,n,r,a,i,o,s){var u=cn(t,"dy","maxPoolBackprop"),c=cn(e,"input","maxPoolBackprop"),l=cn(n,"output","maxPoolBackprop");x(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),x(xa(a,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),x(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),x(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var p=pa(c.shape,r,a,i,o,s);return Dt.runKernelFunc((function(t){return t.maxPoolBackprop(u,c,l,p)}),{$dy:u,$input:c})}(t,o,s,e,n,r,a)}}}));return u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}function _c(t,e,n,r,a,i){var o=cn(t,"x","avgPool","float32");null==r&&(r=[1,1]),x(xa(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),x(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&x(T(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=pa(s.shape,e,n,r,a,i),l=Dt.runKernelFunc((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,a,i){var o=cn(t,"dy","avgPoolBackprop"),s=cn(e,"input","avgPoolBackprop");x(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==a&&(a=[1,1]),x(xa(r,a),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"}));var u=s,c=o,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),x(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),x(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var p=pa(u.shape,n,r,a,i),f=Dt.runKernelFunc((function(t){return t.avgPoolBackprop(c,u,p)}),{dy4D:c,input4D:u});return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}(t,s,e,n,r,a)}}}));return l=l.cast(o.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Ac=xn({maxPool_:function(t,e,n,r,a){return Ic(t,e,n,1,r,a)}}),Rc=xn({avgPool_:function(t,e,n,r,a){return _c(t,e,n,1,r,a)}}),Dc=xn({pool_:function(t,e,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=cn(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),x(xa(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}));var c,l=pa(s.shape,e,i,a,r),p=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),a=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],a[e]]}))}([l.filterHeight,l.filterWidth],p):[[0,0],[0,0]];var f=1===p[0]&&1===p[1],h=function(t,e,n){var r=n.map((function(t){return t[0]})),a=n.map((function(t){return t[1]})),i=t.concat(r,a),o=e.map((function(t,e){return(t-i[e]%t)%t})),s=a.map((function(t,e){return t+o[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,o[e]]}))]}([l.inHeight,l.inWidth],p,c),d=h[0],m=h[1],v=f?r:"valid",g=f?s:Tr(s,p,d),y=("avg"===n?function(){return _c(g,e,i,1,v)}:function(){return Ic(g,e,i,1,v)})(),b=f?y:ur(y,p,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Oc=xn({maxPool3d_:function(t,e,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=cn(t,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),x(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),x("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),x(xa(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&x(T(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=fa(u.shape,e,n,o,r,a,i),p=Dt.runKernelFunc((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,i){var s=i[0],u=i[1];return{x:function(){return function(t,e,n,r,a,i,o,s){var u=cn(t,"dy","maxPool3dBackprop"),c=cn(e,"input","maxPool3dBackprop"),l=cn(n,"output","maxPool3dBackprop"),p=u,f=c,h=l,d=!1;4===c.rank&&(d=!0,p=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),f=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),h=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),x(5===p.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+p.rank+"."})),x(5===f.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+f.rank+"."})),x(5===h.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+h.rank+"."})),null==i&&(i=[1,1,1]),x(xa(a,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),null!=s&&x(T(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var m=fa(f.shape,r,a,i,o,s),v=Dt.runKernelFunc((function(t){return t.maxPool3dBackprop(p,f,h,m)}),{dy5D:p,input5D:f});return d?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}(t,s,u,e,n,o,r,a)}}}));return c?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),Mc=xn({avgPool3d_:function(t,e,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=cn(t,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),x(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),x("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),x(xa(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&x(T(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=fa(u.shape,e,n,o,r,a,i),p=Dt.runKernelFunc((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,a,i,o){var s=cn(t,"dy","avgPool3dBackprop"),u=cn(e,"input","avgPool3dBackprop"),c=s,l=u,p=!1;4===u.rank&&(p=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),x(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),x(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==a&&(a=[1,1,1]),x(xa(r,a),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"})),null!=o&&x(T(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var f=fa(l.shape,n,r,a,i,o),h=Dt.runKernelFunc((function(t){return t.avgPool3dBackprop(c,l,f)}),{dy5D:c,input5D:l});return p?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}(t,u,e,n,o,r,a)}}}));return p=p.cast(u.dtype),c?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),Fc=xn({slice_:function(t,e,n){var r,a,i=cn(t,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach((function(t){x(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(x(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),i.shape[e]-r[e])})),Ur(i,r,a);var o=i.shape,s={begin:r,size:a};return Dt.runKernelFunc((function(t){return t.slice(i,r,a)}),{x:i},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return t.pad(e)}}}),"Slice",s)}}),zc=xn({slice1d_:function(t,e,n){var r=cn(t,"x","slice1d");return x(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Fc(r,[e],[n])}}),Bc=xn({slice2d_:function(t,e,n){var r=cn(t,"x","slice2d");return x(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Fc(r,e,n)}}),Lc=xn({slice3d_:function(t,e,n){var r=cn(t,"x","slice3d");return x(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Fc(r,e,n)}}),Pc=xn({slice4d_:function(t,e,n){var r=cn(t,"x","slice4d");return x(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Fc(r,e,n)}});function Vc(t,e,n,r,a){return e.rank<n.rank&&(e=e.reshape(dn(e.shape,r))),t.rank<n.rank&&(t=t.reshape(dn(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==a?r:r.transpose(a)}}}var Wc=xn({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","all","bool"),a=O(e,r.shape),i=a,o=vn(i,r.rank);null!=o&&(r=r.transpose(o),i=yn(i.length,r.rank));var s=Dt.runKernelFunc((function(t){return t.all(r,i)}),{$x:r});if(n){var u=dn(s.shape,a);return s.reshape(u)}return s}}),Uc=xn({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","any","bool"),a=O(e,r.shape),i=a,o=vn(i,r.rank);null!=o&&(r=r.transpose(o),i=yn(i.length,r.rank));var s=Dt.runKernelFunc((function(t){return t.any(r,i)}),{$x:r});if(n){var u=dn(s.shape,a);return s.reshape(u)}return s}}),jc=xn({argMax_:function(t,e){void 0===e&&(e=0);var n=cn(t,"x","argMax");null==e&&(e=0);var r=O(e,n.shape),a=vn(r,n.rank);return null!=a&&(n=n.transpose(a),r=yn(r.length,n.rank)),Dt.runKernelFunc((function(t,e){var a=t.argMax(n,r[0]);return e([n]),a}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Wn(n)}}}))}}),Hc=xn({argMin_:function(t,e){void 0===e&&(e=0);var n=cn(t,"x","argMin");null==e&&(e=0);var r=O(e,n.shape),a=vn(r,n.rank);return null!=a&&(n=n.transpose(a),r=yn(r.length,n.rank)),Dt.runKernelFunc((function(t,e){var a=t.argMin(n,r[0]);return e([n]),a}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Wn(n)}}}))}}),qc=xn({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","logSumExp"),a=O(e,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var u=dn(s.shape,a);return s.reshape(u)}return s}}),Gc=xn({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","max"),a=r,i=O(e,r.shape),o=i,s=vn(o,r.rank);null!=s&&(r=r.transpose(s),o=yn(o.length,r.rank));var u=Dt.runKernelFunc((function(t,e){var n=t.max(r,o);return e([a,n]),n}),{$x:r},(function(t,e){return Vc(t,e[1],e[0],i,s)}));if(n){var c=dn(u.shape,i);u=u.reshape(c)}return u}}),Zc=xn({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","mean"),a=O(e,r.shape),i=E(hn(r.shape,a)[1]);return ea((function(t){var r=Tn(i);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return a.forEach((function(t){n[t]=1})),e.reshape(n).mul(Fn(t.shape,"float32")).div(i)}}}))(r)}}),Kc=xn({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","min"),a=r,i=O(e,r.shape),o=i,s=vn(o,r.rank);null!=s&&(r=r.transpose(s),o=yn(o.length,r.rank));var u=Dt.runKernelFunc((function(t,e){var n=t.min(r,o);return e([a,n]),n}),{$x:r},(function(t,e){return Vc(t,e[1],e[0],i,s)}));if(n){var c=dn(u.shape,i);u=u.reshape(c)}return u}}),Xc=xn({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=O(e,(t=cn(t,"x","moments")).shape),a=t.mean(r,n),i=a.shape;n||(i=dn(a.shape,r));var o=t.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),$c=xn({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=O(e,r.shape);return ea((function(t){var e=vn(a,t.rank),r=a,i=t;null!=e&&(i=t.transpose(e),r=yn(r.length,t.rank));var o=Dt.runKernelFunc((function(t){return t.sum(i,r)}),{permutedX:i});if(n){var s=dn(o.shape,a);o=o.reshape(s)}return{value:o,gradFunc:function(e){var n=t.shape.slice();return a.forEach((function(t){n[t]=1})),e.reshape(n).mul(Fn(t.shape,"float32"))}}}))(r)}}),Yc=xn({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=cn(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=O(e,r.shape),i=vn(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=yn(o.length,r.rank));var u=Dt.runKernelFunc((function(t){return t.prod(s,o)}),{permutedX:s});if(n){var c=dn(u.shape,a);u=u.reshape(c)}return u}}),Qc=xn({elu_:function(t){var e=cn(t,"x","elu");return Dt.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Dt.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),Jc=xn({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=cn(t,"x","leakyRelu");return _u(Tn(e).mul(n),n)}}),tl=xn({prelu_:function(t,e){var n=cn(t,"x","prelu"),r=cn(e,"alpha","prelu");return Dt.runKernelFunc((function(t,e){var a=t.prelu(n,r);return e([n,r]),a}),{x:n,alpha:r},(function(t,e){var n=e[0],r=e[1],a=n.greater(0);return{x:function(){return wu(a,t,t.mul(r))},alpha:function(){var e=wu(a,Wn(t),t.mul(n)),i=ca(r.shape,t.shape);return i.length>0&&(e=e.sum(i)),e.reshape(r.shape)}}}),"Prelu")}}),el=xn({relu_:function(t){var e=cn(t,"x","relu");return"bool"===e.dtype?e.toInt():Dt.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}}))}}),nl=xn({relu6_:function(t){var e=cn(t,"x","relu6");return"bool"===e.dtype?e.toInt():Dt.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{$x:function(){return t.mulStrict(r.toFloat())}}}))}}),rl=xn({selu_:function(t){var e=cn(t,"x","selu");return Dt.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(Tn(0)),r=Tn(Jo),a=Tn(ts),i=t.mul(a),o=t.mul(r).mul(n.toFloat().exp());return wu(e,i,o)}}}))}}),al=xn({transpose_:function(t,e){var n=cn(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),x(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){x(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():Dt.runKernelFunc((function(t){return t.transpose(n,e)}),{$x:n},(function(t){var n=gn(e);return{$x:function(){return t.transpose(n)}}}))}}),il=xn({localResponseNormalization_:function(t,e,n,r,a){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=.5);var i=cn(t,"x","localResponseNormalization");x(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),x(T(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var o=i,s=!1;3===i.rank&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=Dt.runKernelFunc((function(t,i){var s=t.localResponseNormalization4D(o,e,n,r,a);return i([o,s]),s}),{x4D:o},(function(t,i){var o=i[0],s=i[1];return{x4D:function(){return Dt.runKernelFunc((function(i){return i.LRNGrad(t,o,s,e,n,r,a)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),ol=xn({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var a=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(Tn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=cn(t,"x","norm"),e,n),i=a.shape;if(r){var o=O(n,t.shape);i=dn(a.shape,o)}return a.reshape(i)}}),sl=xn({basicLSTMCell_:function(t,e,n,r,a,i){var o=cn(t,"forgetBias","basicLSTMCell"),s=cn(e,"lstmKernel","basicLSTMCell"),u=cn(n,"lstmBias","basicLSTMCell"),c=cn(r,"data","basicLSTMCell"),l=cn(a,"c","basicLSTMCell"),p=cn(i,"h","basicLSTMCell"),f=c.concat(p,1).matMul(s).add(u),h=f.shape[0],d=f.shape[1]/4,m=[h,d],v=f.slice([0,0],m),g=f.slice([0,d],m),y=f.slice([0,2*d],m),b=f.slice([0,3*d],m),w=v.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(o.add(y).sigmoid())),x=w.tanh().mulStrict(b.sigmoid());return[w,x]}}),ul=xn({multiRNNCell_:function(t,e,n,r){for(var a=cn(e,"data","multiRNNCell"),i=ln(n,"c","multiRNNCell"),o=ln(r,"h","multiRNNCell"),s=a,u=[],c=0;c<t.length;c++){var l=t[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var p=[],f=[];for(c=0;c<u.length;c+=2)p.push(u[c]),f.push(u[c+1]);return[p,f]}}),cl=xn({movingAverage_:function(t,e,n,r,a){void 0===a&&(a=!0);var i=cn(t,"v","movingAverage"),o=cn(e,"x","movingAverage"),s=cn(n,"decay","movingAverage");Ct(i,o),x(C(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=Tn(1),c=u.sub(s),l=o.sub(i).mul(c);if(a){x(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var p=cn(r,"step","movingAverage");l=l.div(u.sub(Bu(s,p)))}return i.add(l)}}),ll=xn({stridedSlice_:function(t,e,n,r,a,i,o,s,u){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=cn(t,"x","stridedSlice"),l=jr(s),p=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,p.splice(t,0,1)})),c=c.reshape(p);for(var f=0;f<c.rank;f++)e[f]=qr(a,e,r,c.shape,f),n[f]=Gr(i,n,r,c.shape,f),r[f]=r[f]||1;var h=jr(u);h.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var d=Hr(e,n,r),m=d.filter((function(t,e){return-1===h.indexOf(e)}));return r.every((function(t){return 1===t}))?Fc(c,e,d).reshape(m):Dt.runKernelFunc((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(m)}}),pl=xn({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=cn(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+e);var i=Dt.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),fl=xn({scatterND_:function(t,e,n){var r=cn(t,"indices","scatterND","int32"),a=cn(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(i+" update.rank < "+a+". ");if(t.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(i+" update.rank != "+(a+t.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+e.shape[o]+").");for(o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+" updates.shape["+(o+a)+"] ("+n.shape[o+a]+") != shape["+(o+a)+"] ("+t[o+a]+")")}(n,e,t)}(a,r,n),Dt.runKernelFunc((function(t){return t.scatterND(r,a,n)}),{$indices:r,$updates:a})}}),hl=xn({fft_:function(t){x("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Dt.runKernelFunc((function(t){return t.fft(r)}),{input:t}).reshape(t.shape)}}),dl=xn({ifft_:function(t){x("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Dt.runKernelFunc((function(t){return t.ifft(r)}),{input:t}).reshape(t.shape)}}),ml=xn({rfft_:function(t,e){x("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],a=t.size/r;if(null!=e&&e<r){var i=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=t.slice(i,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(zn(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=kn(n,u).as2D(a,r),l=hl(c),p=Math.floor(r/2)+1,f=Sn(l),h=Nn(l),d=f.split([p,r-p],f.shape.length-1),m=h.split([p,r-p],h.shape.length-1),v=n.shape.slice();return v[n.shape.length-1]=p,kn(d[0],m[0]).reshape(v)}}),vl=xn({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),a=dl(r);return Sn(a)}var i=[n,2*(e-1)],o=Sn(t).as2D(n,e),s=Nn(t).as2D(n,e),u=o.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(Tn(-1)),l=o.concat(u,1),p=s.concat(c,1);return r=kn(l,p).as2D(i[0],i[1]),a=dl(r),Sn(a)}}),gl=Object.freeze({fft:hl,ifft:dl,rfft:ml,irfft:vl}),yl=xn({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var a=cn(t,"sparseIndices","sparseToDense","int32"),i=cn(e,"sparseValues","sparseToDense"),o=cn(r,"defaultValue","sparseToDense",i.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var o=e.size;if(0!==e.rank&&(1!==e.rank||o!==a))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+a+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),Dt.runKernelFunc((function(t){return t.sparseToDense(a,i,n,o)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),bl=xn({gatherND_:function(t,e){var n=cn(e,"indices","gatherND","int32"),r=cn(t,"x","gatherND");return Dt.runKernelFunc((function(t){return t.gatherND(r,n)}),{$x:r,$indices:n})}}),wl=xn({diag_:function(t){var e=cn(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return Dt.runKernelFunc((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),xl=xn({dropout_:function(t,e,n,r){var a=cn(t,"x","dropout");if(x("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),x(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof dt?a.clone():a;var i=function(t,e){if(null==e)return t.shape.slice();if(C(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(a,n),o=1-e,s=Er(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function kl(t,e,n){for(var r=1-t%2,a=new Float32Array(t),i=0;i<t;++i){var o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return In(a,"float32")}var Sl,Nl=xn({hannWindow_:function(t){return kl(t,.5,.5)}}),El=xn({hammingWindow_:function(t){return kl(t,.54,.46)}}),Cl=xn({frame_:function(t,e,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);for(var i=0,o=[];i+e<=t.size;)o.push(Fc(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=Un([Fc(t,i,e-s),Bn([s],a)]);o.push(u),i+=n}return 0===o.length?_n([],[0,e]):Un(o).as2D(o.length,e)}}),Tl=xn({stft_:function(t,e,n,r,a){var i;void 0===a&&(a=Nl),null==r&&(i=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=Cl(t,e,n),s=Fu(o,a(e)),u=[],c=0;c<o.shape[0];c++)u.push(ml(s.slice([c,0],[1,e]),r));return Un(u)}}),Il=Object.freeze({hannWindow:Nl,hammingWindow:El,frame:Cl,stft:Tl}),_l=function(t,e,n){return void 0===n&&(n=1),o(this,void 0,void 0,(function(){var r,a,i,o,u,c,l,p,f,h,d,m,v,g;return s(this,(function(s){switch(s.label){case 0:return r=cn(t,"predictions","inTopK"),a=cn(e,"targets","inTopK"),x(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),x(r.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank})),k(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],x(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return o=s.sent(),[4,a.data()];case 2:for(u=s.sent(),c=[o.length/i,i],p=c[1],f=F("bool",l=c[0]),h=0;h<l;h++){for(d=h*p,m=o.subarray(d,d+p),v=[],g=0;g<m.length;g++)v.push({value:m[g],index:g});for(v.sort((function(t,e){return e.value-t.value})),f[h]=0,g=0;g<n;g++)if(v[g].index===u[h]){f[h]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),[2,En(f,a.shape,"bool")]}}))}))};!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Sl||(Sl={}));var Al=xn({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=Sl.SUM_BY_NONZERO_WEIGHTS);var a=cn(t,"labels","absoluteDifference"),i=cn(e,"predictions","absoluteDifference"),o=null;null!=n&&(o=cn(n,"weights","absoluteDifference")),k(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return Rl(s,o,r)}}),Rl=xn({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=Sl.SUM_BY_NONZERO_WEIGHTS);var r=cn(t,"losses","computeWeightedLoss"),a=null;null!=e&&(a=cn(e,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===Sl.NONE)return i;if(n===Sl.SUM)return i.sum();if(n===Sl.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(Tn(o)):s}if(n===Sl.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(Tn(r.size));var u=a.mul(Fn(r.shape)).notEqual(Tn(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Dl=xn({cosineDistance_:function(t,e,n,r,a){void 0===a&&(a=Sl.SUM_BY_NONZERO_WEIGHTS);var i=cn(t,"labels","cosineDistance"),o=cn(e,"predictions","cosineDistance"),s=null;null!=r&&(s=cn(r,"weights","cosineDistance")),k(i.shape,o.shape,"Error in cosineDistance: ");var u=Tn(1).sub(i.mul(o).sum(n,!0));return Rl(u,s,a)}}),Ol=xn({hingeLoss_:function(t,e,n,r){void 0===r&&(r=Sl.SUM_BY_NONZERO_WEIGHTS);var a=cn(t,"labels","hingeLoss"),i=cn(e,"predictions","hingeLoss"),o=null;null!=n&&(o=cn(n,"weights","hingeLoss")),k(a.shape,i.shape,"Error in hingeLoss: ");var s=Tn(1);a=Tn(2).mul(a).sub(s);var u=s.sub(a.mul(i)).relu();return Rl(u,o,r)}}),Ml=xn({huberLoss_:function(t,e,n,r,a){void 0===r&&(r=1),void 0===a&&(a=Sl.SUM_BY_NONZERO_WEIGHTS);var i=cn(t,"labels","huberLoss"),o=cn(e,"predictions","huberLoss"),s=null;null!=n&&(s=cn(n,"weights","huberLoss")),k(i.shape,o.shape,"Error in huberLoss: ");var u=Tn(r),c=o.sub(i).abs(),l=Ru(c,u),p=c.sub(l),f=Tn(.5).mul(l.square()).add(u.mul(p));return Rl(f,s,a)}}),Fl=xn({logLoss_:function(t,e,n,r,a){void 0===r&&(r=1e-7),void 0===a&&(a=Sl.SUM_BY_NONZERO_WEIGHTS);var i=cn(t,"labels","logLoss"),o=cn(e,"predictions","logLoss"),s=null;null!=n&&(s=cn(n,"weights","logLoss")),k(i.shape,o.shape,"Error in logLoss: ");var u=Tn(1),c=Tn(r),l=i.mul(o.add(c).log()).neg().sub(u.sub(i).mul(u.sub(o).add(c).log()));return Rl(l,s,a)}}),zl=xn({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=Sl.SUM_BY_NONZERO_WEIGHTS);var a=cn(t,"labels","meanSquaredError"),i=cn(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=cn(n,"weights","meanSquaredError")),k(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return Rl(s,o,r)}}),Bl=xn({sigmoidCrossEntropy_:function(t,e,n,r,a){void 0===r&&(r=0),void 0===a&&(a=Sl.SUM_BY_NONZERO_WEIGHTS);var i=cn(t,"multiClassLabels","sigmoidCrossEntropy"),o=cn(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=cn(n,"weights","sigmoidCrossEntropy")),k(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Tn(r),c=Tn(1),l=Tn(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var p=function(t,e){var n=cn(t,"labels","sigmoidCrossEntropyWithLogits"),r=cn(e,"logits","sigmoidCrossEntropyWithLogits");k(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return Rl(p,s,a)}}),Ll=xn({softmaxCrossEntropy_:function(t,e,n,r,a){void 0===r&&(r=0),void 0===a&&(a=Sl.SUM_BY_NONZERO_WEIGHTS);var i=cn(t,"onehotLabels","softmaxCrossEntropy"),o=cn(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=cn(n,"weights","softmaxCrossEntropy")),k(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Tn(r),c=Tn(1),l=Tn(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var p=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return ea((function(t,e,r){var a=e.logSumExp([n],!0),i=e.toFloat().sub(a);return r([t,i]),{value:i.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],a=e[1],i=dn(t.shape,[n]);return[t.reshape(i).mul(r.toFloat().sub(a.exp())),t.reshape(i).mul(a.exp().sub(r.toFloat()))]}}}))(t,e)}(i,o);return Rl(p,s,a)}}),Pl=Object.freeze({get Reduction(){return Sl},absoluteDifference:Al,computeWeightedLoss:Rl,cosineDistance:Dl,hingeLoss:Ol,huberLoss:Ml,logLoss:Fl,meanSquaredError:zl,sigmoidCrossEntropy:Bl,softmaxCrossEntropy:Ll});function Vl(t,e){return void 0===e&&(e=!1),Dt.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],a=dr(n),i=t.clone(),o=_n([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(t){var e,u=i,c=s,l=a;e=Dt.tidy((function(){var e=i.slice([t,t],[n-t,1]),u=e.norm(),c=i.slice([t,t],[1,1]),l=_n([[-1]]).where(c.greater(0),_n([[1]])),p=c.sub(l.mul(u)),f=e.div(p);s=1===f.shape[0]?o.clone():o.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var h=l.matMul(p).div(u).neg(),d=i.slice([t,0],[n-t,r]),m=h.mul(s);if(0===t)i=d.sub(m.matMul(s.transpose().matMul(d)));else{var v=d.sub(m.matMul(s.transpose().matMul(d)));i=i.slice([0,0],[t,r]).concat(v,0)}var g=a.slice([0,t],[n,a.shape[1]-t]);if(0===t)a=g.sub(g.matMul(s).matMul(m.transpose()));else{var y=g.sub(g.matMul(s).matMul(m.transpose()));a=a.slice([0,0],[n,t]).concat(y,1)}return[s,i,a]})),s=e[0],i=e[1],a=e[2],Ze([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]}))}var Wl=xn({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,x(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){x(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},a=1;a<t.length;++a)r(a)}else e=!0,t=Zn(t,t.shape[0],0).map((function(t){return Ir(t,[0])}));x(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var i=[],o=t,s=function(t){i.push(Dt.tidy((function(){var e=o[t];if(t>0)for(var n=0;n<t;++n){var r=$c(i[n].mulStrict(e)).mul(i[n]);e=e.sub(r)}return e.div(ol(e,"euclidean"))})))};for(a=0;a<t.length;++a)s(a);return e?_r(i,0):i}}),Ul=xn({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return Vl(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Dr(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];return r.forEach((function(t){var n=Vl(t,e),r=n[0],o=n[1];a.push(r),i.push(o)})),[_r(a,0).reshape(t.shape),_r(i,0).reshape(t.shape)]}}),jl=Object.freeze({gramSchmidt:Wl,qr:Ul});function Hl(t,e,n,r,a){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY);var i=t.shape[0];return n=Math.min(n,i),x(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),x(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),x(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),x(1===e.rank,(function(){return"scores must be a 1D tensor"})),x(e.shape[0]===i,(function(){return"scores has incompatible shape with boxes. Expected "+i+", but was "+e.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a}}var ql=xn({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=cn(t,"images","resizeBilinear");x(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),x(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],u=Dt.runKernelFunc((function(t,e){return e([a]),t.resizeBilinear(a,o,s,n)}),{batchImages:a},(function(t,e){return{batchImages:function(){return Dt.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Gl=xn({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=cn(t,"images","resizeNearestNeighbor");x(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),x(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),x("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],u=Dt.runKernelFunc((function(t,e){return e([a]),t.resizeNearestNeighbor(a,o,s,n)}),{batchImages:a},(function(t,e){return{batchImages:function(){return Dt.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Zl=xn({nonMaxSuppression_:function(t,e,n,r,a){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY);var i=cn(t,"boxes","nonMaxSuppression"),o=cn(e,"scores","nonMaxSuppression"),s=Hl(i,o,n,r,a);return n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold,Dt.runKernelFunc((function(t){return t.nonMaxSuppression(i,o,n,r,a)}),{$boxes:i})}}),Kl=xn({cropAndResize_:function(t,e,n,r,a,i){var o=cn(t,"image","cropAndResize","float32"),s=cn(e,"boxes","cropAndResize","float32"),u=cn(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return x(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),x(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),x(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),x(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),x(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),x("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was "+a})),Dt.runKernelFunc((function(t,e){return t.cropAndResize(o,s,u,r,a,i)}),{$image:o,$boxes:s})}}),Xl=Object.freeze({resizeBilinear:ql,resizeNearestNeighbor:Gl,nonMaxSuppression:Zl,nonMaxSuppressionAsync:function(t,e,n,r,a){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),o(this,void 0,void 0,(function(){var i,o,u,c,l,p,f;return s(this,(function(s){switch(s.label){case 0:return i=cn(t,"boxes","nonMaxSuppressionAsync"),o=cn(e,"scores","nonMaxSuppressionAsync"),u=Hl(i,o,n,r,a),n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return c=s.sent(),l=c[0],p=c[1],f=Ra(l,p,n,r,a),i!==t&&i.dispose(),o!==e&&o.dispose(),[2,f]}}))}))},cropAndResize:Kl}),$l=function(t,e){return!(t>0)&&("linear"===e||"relu"===e)},Yl=function(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Ql=function(t,e){var n=e,r=ca(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},Jl=function(t,e,n){if("linear"===e)return t;if("relu"===e)return el(t);if("elu"===e)return Qc(t);if("relu6"===e)return nl(t);if("prelu"===e)return tl(t,n);throw new Error("Unknown fused activation "+e+".")},tp=xn({matMul_:function(t){var e,n=t.a,r=t.b,a=t.transposeA,i=void 0!==a&&a,o=t.transposeB,s=void 0!==o&&o,u=t.bias,c=t.activation,l=void 0===c?"linear":c,p=t.preluActivationWeights;if(!1===$l(Dt.state.gradientDepth,l)){var f=wc(n,r,i,s);return null!=u&&(f=ku(f,u)),Jl(f,l,p)}var h=cn(n,"a","fused matMul"),d=cn(r,"b","fused matMul");e=Et(h,d),h=e[0],d=e[1];var m=i?h.shape[h.rank-2]:h.shape[h.rank-1],v=s?d.shape[d.rank-1]:d.shape[d.rank-2],g=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?d.shape[d.rank-2]:d.shape[d.rank-1],b=h.shape.slice(0,-2),w=d.shape.slice(0,-2),k=E(b),S=E(w);x(h.rank>=2&&d.rank>=2&&h.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+d.rank+"."})),x(C(b,w),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+h.shape+" and "+d.shape+" must match."})),x(m===v,(function(){return"Error in fused matMul: inner shapes ("+m+") and ("+v+") of Tensors with shapes "+h.shape+" and "+d.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var N,T,I=h.shape.slice(0,-2).concat([g,y]),_=i?h.as3D(k,m,g):h.as3D(k,g,m),A=s?d.as3D(S,y,v):d.as3D(S,v,y);null!=u&&la(I,(N=Et(N=cn(u,"bias","fused matMul"),h)[0]).shape),null!=p&&(T=cn(p,"prelu weights","fused matMul"));var R={$a:_,$b:A};return null!=u&&(R.$bias=N),null!=p&&(R.$preluActivationWeights=T),Dt.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:_,b:A,transposeA:i,transposeB:s,bias:N,activation:l,preluActivationWeights:T});return e([_,A,n]),n}),R,(function(t,e){var n=e[0],r=e[1],a=e[2],o=Yl(t,a,l),c={};return null!=u&&(c={$bias:function(){return Ql(N,o)}}),i||s?!i&&s?Object.assign({$a:function(){return o.matMul(r,!1,!1)},$b:function(){return o.matMul(n,!0,!1)}},c):i&&!s?Object.assign({$a:function(){return r.matMul(o,!1,!0)},$b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({$a:function(){return r.matMul(o,!0,!0)},$b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({$a:function(){return o.matMul(r,!1,!0)},$b:function(){return n.matMul(o,!0,!1)}},c)})).reshape(I)}}),ep=xn({conv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,p=t.activation,f=void 0===p?"linear":p,h=t.preluActivationWeights;if(f=f||"linear",!1===$l(Dt.state.gradientDepth,f)){var d=lc(e,n,r,a,o,u,c);return null!=l&&(d=ku(d,l)),Jl(d,f,h)}var m=cn(e,"x","conv2d"),v=cn(n,"filter","conv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),x(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),x(4===v.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+v.rank+"."})),null!=c&&x(T(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."})),x(g.shape[3]===v.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+v.shape[2]+"."})),x(xa(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),x("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var b,w,k=ha(g.shape,v.shape,r,u,a,c);null!=l&&(b=Et(b=cn(l,"bias","fused conv2d"),m)[0],la(k.outShape,b.shape)),null!=h&&(w=cn(h,"prelu weights","fused conv2d"));var S={x:g,$filter:v};null!=l&&(S.$bias=b),null!=h&&(S.$preluActivationWeights=w);var N=Dt.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:g,filter:v,convInfo:k,bias:b,activation:f,preluActivationWeights:w});return e([v,g,n]),n}),S,(function(t,e){var n=e,i=n[0],o=n[1],s=n[2],c=Yl(t,s,f);x(wa(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var p={};return null!=l&&(p={$bias:function(){return Ql(b,c)}}),Object.assign({x:function(){return hc(o.shape,c,i,r,a)},$filter:function(){return fc(o,c,i.shape,r,a)}},p)}));return y?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),np=xn({depthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,p=t.activation,f=void 0===p?"linear":p,h=t.preluActivationWeights;if(!1===$l(Dt.state.gradientDepth,f)){var d=dc(e,n,r,a,o,u,c);return null!=l&&(d=ku(d,l)),Jl(d,f,h)}var m=cn(e,"x","depthwiseConv2d"),v=cn(n,"filter","depthwiseConv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),x(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),x(4===v.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+v.rank+"."})),x(g.shape[3]===v.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+v.shape[2]+"."})),null==u&&(u=[1,1]),x(xa(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&x(T(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."}));var b,w,k=ha(g.shape,v.shape,r,u,a,c,!0);null!=l&&(b=Et(b=cn(l,"bias","fused conv2d"),m)[0],la(k.outShape,b.shape)),null!=h&&(w=cn(h,"prelu weights","fused depthwiseConv2d"));var S={x:g,$filter:v};null!=l&&(S.$bias=b),null!=h&&(S.$preluActivationWeights=w);var N=Dt.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:g,filter:v,convInfo:k,bias:b,activation:f,preluActivationWeights:w});return e([g,v,n]),n}),S,(function(t,e){x(wa(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=e[0],r=e[1],a=e[2],i=Yl(t,a,f),o={};return null!=l&&(o={$bias:function(){return Ql(b,i)}}),Object.assign({x:function(){return mc(n.shape,i,r,k)},$filter:function(){return vc(n,i,r.shape,k)}},o)}));return y?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),rp=Object.freeze({matMul:tp,conv2d:ep,depthwiseConv2d:np}),ap=Object.freeze({image:Xl,linalg:jl,losses:Pl,spectral:gl,fused:rp,signal:Il,square:xs,conv1d:cc,conv2d:lc,conv3d:pc,depthwiseConv2d:dc,separableConv2d:gc,conv2dTranspose:yc,conv3dTranspose:bc,op:xn,batchNormalization2d:uu,batchNormalization3d:cu,batchNormalization4d:lu,batchNormalization:pu,batchNorm:fu,batchNorm2d:hu,batchNorm3d:du,batchNorm4d:mu,booleanMaskAsync:ic,complex:kn,real:Sn,imag:Nn,concat:Un,concat1d:jn,concat2d:Hn,concat3d:qn,concat4d:Gn,split:Zn,matMul:wc,dot:xc,outerProduct:kc,reverse:Sc,reverse1d:Nc,reverse2d:Ec,reverse3d:Cc,reverse4d:Tc,maxPool:Ac,avgPool:Rc,pool:Dc,maxPool3d:Oc,avgPool3d:Mc,slice:Fc,slice1d:zc,slice2d:Bc,slice3d:Lc,slice4d:Pc,abs:ks,acos:Ss,acosh:Ns,asin:Es,asinh:Cs,atan:Ts,atanh:Is,ceil:_s,clipByValue:As,cos:Rs,cosh:Ds,erf:Os,exp:Ms,expm1:Fs,floor:zs,log:Bs,log1p:Ls,logSigmoid:Ps,neg:Vs,reciprocal:Ws,round:Us,rsqrt:js,sigmoid:Hs,sign:qs,isNaN:Gs,isInf:Zs,isFinite:Ks,sin:Xs,sinh:$s,softplus:Ys,sqrt:Qs,step:Js,tan:tu,tanh:eu,all:Wc,any:Uc,argMax:jc,argMin:Hc,logSumExp:qc,max:Gc,mean:Zc,min:Kc,moments:Xc,sum:$c,prod:Yc,equal:ju,equalStrict:Hu,greater:qu,greaterEqual:Gu,greaterEqualStrict:Zu,greaterStrict:Ku,less:Xu,lessEqual:$u,lessEqualStrict:Yu,lessStrict:Qu,notEqual:Ju,notEqualStrict:tc,add:ku,addN:Su,addStrict:Nu,atan2:Eu,div:Cu,divStrict:Tu,floorDiv:Iu,maximum:_u,maximumStrict:Au,minimum:Ru,minimumStrict:Du,mod:Ou,modStrict:Mu,mul:Fu,mulStrict:zu,pow:Bu,powStrict:Lu,squaredDifference:Pu,squaredDifferenceStrict:Vu,sub:Wu,subStrict:Uu,elu:Qc,leakyRelu:Jc,prelu:tl,relu:el,relu6:nl,selu:rl,logicalAnd:vu,logicalNot:gu,logicalOr:yu,logicalXor:bu,where:wu,whereAsync:xu,buffer:or,print:sr,batchToSpaceND:ur,cast:cr,clone:lr,cumsum:pr,depthToSpace:fr,expandDims:hr,eye:dr,multinomial:mr,oneHot:vr,pad:gr,pad1d:yr,pad2d:br,pad3d:wr,pad4d:xr,rand:kr,randomNormal:Sr,randomGamma:Nr,randomUniform:Er,reshape:Cr,spaceToBatchND:Tr,squeeze:Ir,stack:_r,tile:Ar,truncatedNormal:Rr,unstack:Dr,setdiff1dAsync:Or,fill:Bn,linspace:Ln,ones:Fn,range:Pn,scalar:Tn,tensor:En,tensor1d:In,tensor2d:_n,tensor3d:An,tensor4d:Rn,tensor5d:Dn,tensor6d:On,variable:Mn,zeros:zn,onesLike:Vn,zerosLike:Wn,transpose:al,softmax:ra,logSoftmax:aa,localResponseNormalization:il,norm:ol,gather:rc,unsortedSegmentSum:ac,basicLSTMCell:sl,multiRNNCell:ul,movingAverage:cl,stridedSlice:ll,topk:pl,scatterND:fl,fft:hl,ifft:dl,rfft:ml,irfft:vl,sparseToDense:yl,gatherND:bl,diag:wl,dropout:xl,hannWindow:Nl,hammingWindow:El,frame:Cl,stft:Tl,inTopKAsync:_l});function ip(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&x("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))}function op(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var sp=function(t){function e(){var e=t.call(this)||this;if(e.blockSize=48,e.firstUse=!0,c().get("IS_BROWSER")){var n="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(300,150):"undefined"!=typeof document?document.createElement("canvas"):null;null!==n&&(e.fromPixels2DContext=n.getContext("2d"))}return e.data=new ia(e,Dt),e}return i(e,t),e.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,c().get("IS_NODE")&&on("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n"));var r={};return this.data.set(r,{values:t,dtype:n}),r},e.prototype.move=function(t,e,n,r){this.data.set(t,{values:e,dtype:r})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r,a=t.data instanceof Uint8Array,i="undefined"!=typeof ImageData&&t instanceof ImageData,o="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,u=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=u[0],p=u[1];if(c().get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,l,p).data;else if(i||a)n=t.data;else{if(!s&&!o)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=l,this.fromPixels2DContext.canvas.height=p,this.fromPixels2DContext.drawImage(t,0,0,l,p),n=this.fromPixels2DContext.getImageData(0,0,l,p).data}if(4===e)r=new Int32Array(n);else{var f=l*p;r=new Int32Array(f*e);for(var h=0;h<f;h++)for(var d=0;d<e;++d)r[h*e+d]=n[4*h+d]}return An(r,[p,l,e],"int32")},e.prototype.read=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.data.get(t),n=e.dtype,r=e.complexTensors;return"complex64"===n?Ta(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return rt(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return or(t.shape,t.dtype,n)},e.prototype.makeOutput=function(t,e,n){var r=this.write(t,e,n);return Dt.makeTensorFromDataId(r,e,n,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return e=tt(),t(),[2,{kernelMs:tt()-e}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,e){var n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Dt.keep(t.clone()),imag:Dt.keep(e.clone())},n},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(ip(t,"slice"),Zr(t.shape,e,n)){var r=Kr(e,t.strides),a=E(n);return En(this.readSync(t.dataId).subarray(r,r+a),n,t.dtype)}for(var i=or(n,t.dtype),o=this.bufferSync(t),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(t,n){return t+e[n]}));i.values[s]=o.get.apply(o,u)}return i.toTensor()},e.prototype.stridedSlice=function(t,e,n,r){ip(t,"stridedSlice");var a=Hr(e,n,r);if(a.some((function(t){return 0===t})))return En([],a);for(var i=or(a,t.dtype),o=this.bufferSync(t),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];i.set.apply(i,[o.get.apply(o,c)].concat(u))}return i.toTensor()},e.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=or([t.size,t.size],t.dtype),r=n.values,a=0;a<e.length;a++)r[a*t.size+a]=e[a];return n.toTensor()},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),a=0,i=0;i<t.rank;i++)i!==e&&(r[a++]=t.shape[i]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[e]=i,u[i]=this.slice(t,o,s).reshape(r);return u},e.prototype.reverse=function(t,e){ip(t,"reverse");for(var n=or(t.shape,t.dtype),r=this.bufferSync(t),a=function(a){var i=n.indexToLoc(a),o=i.slice();e.forEach((function(e){return o[e]=t.shape[e]-1-o[e]})),n.set.apply(n,[r.get.apply(r,o)].concat(i))},i=0;i<n.size;i++)a(i);return n.toTensor()},e.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return Sn(t)})),a=t.map((function(t){return Nn(t)}));return kn(this.concat(r,e),this.concat(a,e))}var i=t.map((function(t){var n=E(t.shape.slice(e));return t.as2D(-1,n)})),o=wn(i.map((function(t){return t.shape})),1),s=or(o,t[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;i.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,a=0;a<t.shape[0];++a)for(var i=a*o[1]+c,u=0;u<t.shape[1];++u)s[i+u]=e[r++];c+=t.shape[1]}))}var l=wn(t.map((function(t){return t.shape})),e);return En(s,l,t[0].dtype)},e.prototype.neg=function(t){return ip(t,"neg"),this.multiply(Tn(-1),t)},e.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,St(t.dtype,e.dtype),(function(t,e){return t+e}))},e.prototype.addN=function(t){var e=this;ip(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=or(t[0].shape,t[0].dtype),a=r.values,i=0;i<t.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()},e.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,St(t.dtype,e.dtype),(function(t,e){return t-e}))},e.prototype.pow=function(t,e){return ip([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},e.prototype.batchMatMul=function(t,e,n,r){ip([t,e],"matMul");for(var a=n?t.shape[1]:t.shape[2],i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],p=l[0],f=l[1],h=l[2],d=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=d[0],v=d[1],g=d[2],y=i*o,b=or([s,i,o],t.dtype),w=b.values,x=this.blockSize,k=0;k<s;k++)for(var S=0;S<i;S+=x)for(var N=0;N<o;N+=x)for(var E=0;E<a;E+=x)for(var C=Math.min(S+x,i),T=Math.min(N+x,o),I=Math.min(E+x,a),_=S;_<C;_++)for(var A=N;A<T;A++){for(var R=0,D=E;D<I;D++)R+=u[k*p+_*f+D*h]*c[D*m+A*v+k*g];w[k*y+(_*o+A)]+=R}return b.toTensor()},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,a=t.transposeB,i=t.bias,o=t.activation,s=t.preluActivationWeights,u=this.batchMatMul(e,n,r,a);return i&&(u=this.add(u,i)),o&&(u=op(this,u,o,s)),u},e.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,St(t.dtype,e.dtype),(function(t,e){return t*e}))},e.prototype.realDivide=function(t,e){return ip([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},e.prototype.floorDiv=function(t,e){return ip([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},e.prototype.sum=function(t,e){ip(t,"sum"),mn("sum",e,t.rank);for(var n=hn(t.shape,e),r=n[0],a=n[1],i=zn(r,St(t.dtype,"int32")),o=E(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,p=0,f=0;f<o;++f)p+=u[l+f];s[c]=p}return i},e.prototype.prod=function(t,e){ip(t,"sum");for(var n=hn(t.shape,e),r=n[0],a=n[1],i=zn(r,St(t.dtype,"int32")),o=E(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,p=1,f=0;f<o;++f)p*=u[l+f];s[c]=p}return i},e.prototype.unsortedSegmentSum=function(t,e,n){ip(t,"unsortedSegmentSum");for(var r=[],a=t.rank-e.rank,i=0;i<a;++i)e=e.expandDims(i+1);for(i=0;i<n;++i){var o=Tn(i,"int32"),s=ju(o,e).asType("float32").mul(t).sum(0);r.push(s)}return _r(r)},e.prototype.argMin=function(t,e){ip(t,"argMin");var n=[e];mn("argMin",n,t.rank);for(var r=hn(t.shape,n),a=r[0],i=r[1],o=zn(a,"int32"),s=E(i),u=this.readSync(o.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var p=l*s,f=c[p],h=0,d=0;d<s;++d){var m=c[p+d];m<f&&(f=m,h=d)}u[l]=h}return o},e.prototype.argMax=function(t,e){ip(t,"argMax");var n=[e];mn("argMax",n,t.rank);for(var r=hn(t.shape,n),a=r[0],i=r[1],o=zn(a,"int32"),s=E(i),u=this.readSync(o.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var p=l*s,f=c[p],h=0,d=0;d<s;++d){var m=c[p+d];m>f&&(f=m,h=d)}u[l]=h}return o},e.prototype.cumsum=function(t,e,n,r){if(ip(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var a=St(t.dtype,"int32"),i=zn(t.shape,a),o=this.readSync(i.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var p=0;p<u;p++){var f=c(l,p);if(0===p)o[f]=n?0:s[f];else{var h=c(l,p-1);o[f]=n?s[h]+o[h]:s[f]+o[h]}}return i},e.prototype.equal=function(t,e){return ip([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},e.prototype.notEqual=function(t,e){return ip([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},e.prototype.less=function(t,e){return ip([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},e.prototype.lessEqual=function(t,e){return ip([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},e.prototype.greater=function(t,e){return ip([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},e.prototype.greaterEqual=function(t,e){return ip([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},e.prototype.logicalNot=function(t){ip(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")},e.prototype.logicalAnd=function(t,e){return ip([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},e.prototype.logicalOr=function(t,e){return ip([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},e.prototype.select=function(t,e,n){ip([t,e,n],"select");for(var r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=this.readSync(n.dataId),o=zn(e.shape,St(e.dtype,n.dtype)),s=this.readSync(o.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:E(e.shape.slice(1)),l=0;l<r.length;l++)for(var p=0;p<c;p++)1===r[l]?s[u++]=a[l]:s[u++]=i[l];return o},e.prototype.where=function(t){ip([t],"where");var e=this.readSync(t.dataId);return za(t.shape,e)},e.prototype.topk=function(t,e,n){return ip(t,"topk"),Fa(this.readSync(t.dataId),t.shape,t.dtype,e)},e.prototype.min=function(t,e){ip(t,"min"),mn("min",e,t.rank);for(var n=hn(t.shape,e),r=n[0],a=n[1],i=zn(r,t.dtype),o=E(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,p=u[l],f=0;f<o;++f){var h=u[l+f];h<p&&(p=h)}s[c]=p}return i},e.prototype.minimum=function(t,e){return ip([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},e.prototype.mod=function(t,e){return ip([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},e.prototype.max=function(t,e){ip(t,"max"),mn("max",e,t.rank);for(var n=hn(t.shape,e),r=n[0],a=n[1],i=zn(r,t.dtype),o=E(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,p=u[l],f=0;f<o;++f){var h=u[l+f];h>p&&(p=h)}s[c]=p}return i},e.prototype.maximum=function(t,e){return ip([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},e.prototype.all=function(t,e){ip(t,"all"),mn("all",e,t.rank);for(var n=hn(t.shape,e),r=n[0],a=n[1],i=zn(r,t.dtype),o=E(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,p=u[l],f=0;f<o;++f){var h=u[l+f];p=p&&h}s[c]=p}return i},e.prototype.any=function(t,e){ip(t,"any"),mn("any",e,t.rank);for(var n=hn(t.shape,e),r=n[0],a=n[1],i=zn(r,t.dtype),o=E(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,p=u[l],f=0;f<o;++f){var h=u[l+f];p=p||h}s[c]=p}return i},e.prototype.squaredDifference=function(t,e){return ip([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},e.prototype.ceil=function(t){ip(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.floor=function(t){ip(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.sign=function(t){ip(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)e[r]<0?n[r]=-1:e[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,t.shape,"float32")},e.prototype.isNaN=function(t){ip(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isInf=function(t){ip(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isFinite=function(t){ip(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.round=function(t){ip(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=Math.floor(e[r]);e[r]-a<.5?n[r]=Math.floor(e[r]):e[r]-a>.5?n[r]=Math.ceil(e[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,t.shape,"float32")},e.prototype.exp=function(t){ip(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.expm1=function(t){ip(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.log=function(t){ip(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=Math.log(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.log1p=function(t){ip(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=Math.log1p(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.sqrt=function(t){ip(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.rsqrt=function(t){ip(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.reciprocal=function(t){ip(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){ip(t,"relu");for(var e=zn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return e},e.prototype.relu6=function(t){ip(t,"relu");for(var e=zn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return e},e.prototype.prelu=function(t,e){return ip([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},e.prototype.elu=function(t){ip(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var a=n[r];e[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(e,t.shape,"float32")},e.prototype.eluDer=function(t,e){ip([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,e.shape,"float32")},e.prototype.selu=function(t){ip(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var a=n[r];e[r]=a>=0?1.0507009873554805*a:1.7580993408473768*(Math.exp(a)-1)}return this.makeOutput(e,t.shape,"float32")},e.prototype.clip=function(t,e,n){ip(t,"clip");for(var r=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<e?e:o}return this.makeOutput(r,t.shape,"float32")},e.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r){var a=n[2*r],i=n[2*r+1];e[r]=Math.hypot(a,i)}return this.makeOutput(e,t.shape,"float32")},e.prototype.int=function(t){ip(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")},e.prototype.sigmoid=function(t){ip(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")},e.prototype.softplus=function(t){ip(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),a=0;a<r.length;++a){var i,o=r[a]>-e,s=r[a]<e,u=Math.exp(r[a]);i=s?u:o?r[a]:Math.log(1+u),n[a]=i}return this.makeOutput(n,t.shape,"float32")},e.prototype.sin=function(t){ip(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cos=function(t){ip(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tan=function(t){ip(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asin=function(t){ip(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acos=function(t){ip(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan=function(t){ip(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan2=function(t,e){return ip([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},e.prototype.sinh=function(t){ip(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cosh=function(t){ip(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tanh=function(t){ip(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=I(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asinh=function(t){ip(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acosh=function(t){ip(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atanh=function(t){ip(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.erf=function(t){ip(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var a=Math.sign(n[r]),i=Math.abs(n[r]),o=1/(1+.3275911*i);e[r]=a*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i))}return this.makeOutput(e,t.shape,"float32")},e.prototype.step=function(t,e){void 0===e&&(e=0),ip(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:e}return this.makeOutput(n,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,a=t.bias,i=t.activation,o=t.preluActivationWeights,s=this.conv2d(e,n,r);return a&&(s=this.add(s,a)),i&&(s=op(this,s,i,o)),s},e.prototype.conv2d=function(t,e,n){ip([t,e],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=or(n.outShape,t.dtype),p=t.strides[0],f=c?t.strides[1]:t.strides[2],h=c?t.strides[2]:1,d=c?1:t.strides[1],m=l.strides[0],v=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(t.dataId),w=this.readSync(e.dataId),x=l.values,k=0;k<n.batchSize;++k)for(var S=k*p,N=k*m,E=0;E<n.outHeight;++E)for(var C=N+E*v,T=E*n.strideHeight-u,I=0;I<r;I++){var _=T+I*i;if(!(_<0||_>=n.inHeight))for(var A=I*e.strides[0],R=S+_*f,D=0;D<n.outWidth;++D)for(var O=C+D*g,M=D*n.strideWidth-s,F=0;F<a;F++){var z=M+F*o;if(!(z<0||z>=n.inWidth))for(var B=R+z*h,L=A+F*e.strides[1],P=0;P<n.inChannels;++P){for(var V=b[B+P*d],W=0;W<n.outChannels;++W)x[O+W*y]+=V*w[L+W];L+=n.outChannels}}}return l.toTensor()},e.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,p=n.padInfo.top,f=or(n.outShape,t.dtype),h=this.readSync(t.dataId),d=this.readSync(e.dataId),m=f.values,v=0;v<n.batchSize;++v)for(var g=v*t.strides[0],y=v*f.strides[0],b=0;b<n.outDepth;++b)for(var w=y+b*f.strides[1],x=b*n.strideDepth-c,k=0;k<r;k++){var S=x+k*o;if(!(S<0||S>=n.inDepth))for(var N=k*e.strides[0],E=g+S*t.strides[1],C=0;C<n.outHeight;++C)for(var T=w+C*f.strides[2],I=C*n.strideHeight-p,_=0;_<a;_++){var A=I+_*s;if(!(A<0||A>=n.inHeight))for(var R=N+_*e.strides[1],D=E+A*t.strides[2],O=0;O<n.outWidth;++O)for(var M=T+O*n.outChannels,F=O*n.strideWidth-l,z=0;z<i;z++){var B=F+z*u;if(!(B<0||B>=n.inWidth))for(var L=R+z*e.strides[2],P=D+B*n.inChannels,V=L,W=0;W<n.inChannels;++W){for(var U=h[P+W],j=0;j<n.outChannels;++j)m[M+j]+=U*d[V+j];V+=n.outChannels}}}}return f.toTensor()},e.prototype.conv2dDerInput=function(t,e,n){ip([t,e],"conv2dDerInput");for(var r=or(n.inShape,"float32"),a=r.values,i=this.readSync(t.dataId),o=this.readSync(e.dataId),s=e.strides,u=s[0],c=s[1],l=s[2],p=n.batchSize,f=n.filterHeight,h=n.filterWidth,d=n.inChannels,m=n.inHeight,v=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,w=n.strideHeight,x=n.strideWidth,k=n.dataFormat,S=f-1-n.padInfo.top,N=h-1-n.padInfo.left,E="channelsLast"===k,C=r.strides[0],T=E?r.strides[1]:r.strides[2],I=E?r.strides[2]:1,_=E?1:r.strides[1],A=t.strides[0],R=E?t.strides[1]:t.strides[2],D=E?t.strides[2]:1,O=E?1:t.strides[1],M=0;M<p;++M)for(var F=0;F<d;++F)for(var z=0;z<m;++z)for(var B=z-S,L=Math.max(0,Math.ceil(B/w)),P=Math.min(y,(f+B)/w),V=0;V<v;++V){for(var W=V-N,U=Math.max(0,Math.ceil(W/x)),j=Math.min(b,(h+W)/x),H=0,q=L;q<P;++q)for(var G=q*w-B,Z=U;Z<j;++Z)for(var K=A*M+R*q+D*Z,X=u*(f-1-G)+c*(h-1-(Z*x-W))+l*F,$=0;$<g;++$)H+=i[K+O*$]*o[X+$];a[C*M+T*z+I*V+_*F]=H}return r.toTensor()},e.prototype.conv3dDerInput=function(t,e,n){for(var r=or(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(t.dataId),p=t.strides,f=p[0],h=p[1],d=p[2],m=p[3],v=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],w=g[2],x=g[3],k=n.batchSize,S=n.filterDepth,N=n.filterHeight,E=n.filterWidth,C=n.inChannels,T=n.inDepth,I=n.inHeight,_=n.inWidth,A=n.outChannels,R=n.outDepth,D=n.outHeight,O=n.outWidth,M=n.strideDepth,F=n.strideHeight,z=n.strideWidth,B=S-1-n.padInfo.front,L=N-1-n.padInfo.top,P=E-1-n.padInfo.left,V=0;V<k;++V)for(var W=0;W<C;++W)for(var U=0;U<T;++U)for(var j=U-B,H=Math.max(0,Math.ceil(j/M)),q=Math.min(R,(S+j)/M),G=0;G<I;++G)for(var Z=G-L,K=Math.max(0,Math.ceil(Z/F)),X=Math.min(D,(N+Z)/F),$=0;$<_;++$){for(var Y=$-P,Q=Math.max(0,Math.ceil(Y/z)),J=Math.min(O,(E+Y)/z),tt=0,et=H;et<q;++et)for(var nt=et*M-j,rt=K;rt<X;++rt)for(var at=rt*F-Z,it=Q;it<J;++it)for(var ot=f*V+h*et+d*rt+m*it,st=y*(S-1-nt)+b*(N-1-at)+w*(E-1-(it*z-Y))+x*W,ut=0;ut<A;++ut)tt+=l[ot+ut]*v[st+ut];a[o*V+s*U+u*G+c*$+W]=tt}return r.toTensor()},e.prototype.conv2dDerFilter=function(t,e,n){ip([t,e],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=or(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,p=this.bufferSync(t),f=this.bufferSync(e),h=0;h<i;++h)for(var d=Math.max(0,Math.ceil((l-h)/r)),m=Math.min(n.outHeight,(n.inHeight+l-h)/r),v=0;v<o;++v)for(var g=Math.max(0,Math.ceil((c-v)/a)),y=Math.min(n.outWidth,(n.inWidth+c-v)/a),b=0;b<n.inChannels;++b)for(var w=0;w<n.outChannels;++w){for(var x=0,k=0;k<n.batchSize;++k)for(var S=d;S<m;++S)for(var N=h+S*r-l,E=g;E<y;++E){var C=v+E*a-c;x+=s?p.get(k,N,C,b)*f.get(k,S,E,w):p.get(k,b,N,C)*f.get(k,w,S,E)}u.set(x,h,v,b,w)}return u.toTensor()},e.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=or(n.filterShape,"float32"),l=c.values,p=c.strides,f=p[0],h=p[1],d=p[2],m=p[3],v=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],w=g[2],x=g[3],k=this.readSync(t.dataId),S=t.strides,N=S[0],E=S[1],C=S[2],T=S[3],I=n.padInfo.front,_=n.padInfo.left,A=n.padInfo.top,R=0;R<o;++R)for(var D=Math.max(0,Math.ceil((I-R)/r)),O=Math.min(n.outDepth,(n.inDepth+I-R)/r),M=R*f,F=0;F<s;++F)for(var z=Math.max(0,Math.ceil((A-F)/a)),B=Math.min(n.outHeight,(n.inHeight+A-F)/a),L=F*h+M,P=0;P<u;++P)for(var V=Math.max(0,Math.ceil((_-P)/i)),W=Math.min(n.outWidth,(n.inWidth+_-P)/i),U=P*d+L,j=0;j<n.inChannels;++j)for(var H=j*m+U,q=0;q<n.outChannels;++q){for(var G=0,Z=0;Z<n.batchSize;++Z)for(var K=Z*N,X=Z*y,$=D;$<O;++$)for(var Y=(R+$*r-I)*E+K,Q=$*b+X,J=z;J<B;++J)for(var tt=(F+J*a-A)*C+Y,et=J*w+Q,nt=V;nt<W;++nt){var rt=nt*x+et;G+=k[(P+nt*i-_)*T+tt+j]*v[rt+q]}l[H+q]=G}return c.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var e=t.input,n=t.filter,r=t.convInfo,a=t.bias,i=t.activation,o=t.preluActivationWeights,s=this.depthwiseConv2D(e,n,r);return a&&(s=this.add(s,a)),i&&(s=op(this,s,i,o)),s},e.prototype.depthwiseConv2D=function(t,e,n){ip([t,e],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=or(n.outShape,t.dtype),p=this.readSync(t.dataId),f=this.readSync(e.dataId),h=l.values,d=0;d<n.batchSize;++d)for(var m=d*t.strides[0],v=d*l.strides[0],g=0;g<n.outHeight;++g)for(var y=v+g*l.strides[1],b=g*n.strideHeight-s,w=0;w<r;++w){var x=b+w*i;if(!(x<0||x>=n.inHeight))for(var k=w*e.strides[0],S=m+x*t.strides[1],N=0;N<n.outWidth;++N)for(var E=y+N*l.strides[2],C=N*n.strideWidth-u,T=0;T<a;++T){var I=C+T*o;if(!(I<0||I>=n.inWidth))for(var _=k+T*e.strides[1],A=S+I*n.inChannels,R=E,D=_,O=0;O<n.inChannels;++O){for(var M=p[A+O],F=0;F<c;++F)h[R+F]+=M*f[D+F];R+=c,D+=c}}}return l.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,e,n){ip([t,e],"depthwiseConv2DDerInput");for(var r=or(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=this.readSync(t.dataId),l=t.strides,p=l[0],f=l[1],h=l[2],d=this.readSync(e.dataId),m=e.strides,v=m[0],g=m[1],y=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,k=n.inChannels,S=n.inHeight,N=n.inWidth,E=n.outChannels,C=n.outHeight,T=n.outWidth,I=n.strideHeight,_=n.strideWidth,A=w-1-n.padInfo.top,R=x-1-n.padInfo.left,D=E/k,O=0;O<b;++O)for(var M=0;M<k;++M)for(var F=0;F<S;++F)for(var z=F-A,B=Math.max(0,Math.ceil(z/I)),L=Math.min(C,(w+z)/I),P=0;P<N;++P){for(var V=P-R,W=Math.max(0,Math.ceil(V/_)),U=Math.min(T,(x+V)/_),j=0,H=B;H<L;++H)for(var q=H*I-z,G=W;G<U;++G)for(var Z=p*O+f*H+h*G,K=v*(w-1-q)+g*(x-1-(G*_-V))+y*M,X=0;X<D;++X)j+=c[Z+(M*D+X)]*d[K+X];a[o*O+s*F+u*P+M]=j}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){ip([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=or(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,p=this.bufferSync(t),f=this.bufferSync(e),h=0;h<i;++h)for(var d=Math.max(0,Math.ceil((c-h)/r)),m=Math.min(n.outHeight,(n.inHeight+c-h)/r),v=0;v<o;++v)for(var g=Math.max(0,Math.ceil((u-v)/a)),y=Math.min(n.outWidth,(n.inWidth+u-v)/a),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/l),x=b%l,k=0,S=0;S<n.batchSize;++S)for(var N=d;N<m;++N)for(var E=h+N*r-c,C=g;C<y;++C){var T=v+C*a-u;k+=p.get(S,E,T,w)*f.get(S,N,C,b)}s.set(k,h,v,w,x)}return s.toTensor()},e.prototype.tile=function(t,e){return ip(t,"tile"),Ma(this.bufferSync(t),e)},e.prototype.pad=function(t,e,n){ip(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),a=e.map((function(t){return t[0]})),i=this.bufferSync(t),o=or(r,t.dtype);0!==n&&o.values.fill(n);for(var s=0;s<t.size;s++){var u=i.indexToLoc(s),c=u.map((function(t,e){return t+a[e]}));o.set.apply(o,[i.get.apply(i,u)].concat(c))}return o.toTensor()},e.prototype.transpose=function(t,e){ip(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var a=this.readSync(t.dataId),i=or(n,t.dtype),o=this.bufferSync(t);for(r=0;r<t.size;++r){for(var s=o.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[e[c]];var l=i.locToIndex(u);i.values[l]=a[r]}return i.toTensor()},e.prototype.gather=function(t,e,n){ip([t,e],"gather");var r=t.shape.slice(),a=this.readSync(e.dataId);r[n]=a.length;for(var i=or(r,t.dtype),o=this.bufferSync(t),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=a[u[n]];var l=o.locToIndex(c);i.values[s]=o.values[l]}return i.toTensor()},e.prototype.batchToSpaceND=function(t,e,n){ip([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),a=Mr(t.shape,e,r),i=Fr(a.length,e.length),o=zr(t.shape,e,r),s=Br(n,e.length),u=Lr(o,n,e.length);return t.reshape(a).transpose(i).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){ip([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),a=[[0,0]];a.push.apply(a,n);for(var i=1+e.length;i<t.shape.length;++i)a.push([0,0]);var o=t.pad(a),s=Mr(o.shape,e,r,!1),u=Fr(s.length,e.length,!1),c=zr(o.shape,e,r,!1);return o.reshape(s).transpose(u).reshape(c)},e.prototype.pool=function(t,e,n){ip(t,"pool");for(var r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,p="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,f=this.readSync(t.dataId),h=or(e.outShape,t.dtype),d=h.values,m=e.outShape[1]*e.outShape[2]*e.outShape[3],v=e.outShape[2]*e.outShape[3],g=e.outShape[3],y=0;y<e.batchSize;++y)for(var b=y*m,w=y*t.strides[0],x=0;x<e.inChannels;++x)for(var k=0;k<e.outHeight;++k)for(var S=k*r-c,N=Math.max(0,S),E=Math.min(e.inHeight,s+S),C=b+k*v,T=0;T<e.outWidth;++T){for(var I=T*a-l,_=Math.max(0,I),A=Math.min(e.inWidth,u+I),R=p,D=0,O=0,M=N;M<E;M+=i){for(var F=w+M*t.strides[1],z=_;z<A;z+=o){var B=f[F+z*t.strides[2]+x];"max"===n&&B>R?R=B:"avg"===n&&(D+=B,O++)}if(isNaN(R))break}d[C+T*g+x]="avg"===n?D/O:R}return h.toTensor()},e.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},e.prototype.maxPoolPositions=function(t,e){for(var n=or(e.outShape,"int32"),r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,p=this.bufferSync(t),f=0;f<e.batchSize;++f)for(var h=0;h<e.inChannels;++h)for(var d=0;d<e.outHeight;++d){for(var m=d*r-c,v=m;v<0;)v+=i;for(var g=Math.min(e.inHeight,s+m),y=0;y<e.outWidth;++y){for(var b=y*a-l,w=b;w<0;)w+=o;for(var x=Math.min(e.inWidth,u+b),k=Number.NEGATIVE_INFINITY,S=-1,N=v;N<g;N+=i)for(var E=N-m,C=w;C<x;C+=o){var T=C-b,I=p.get(f,N,C,h);I>k&&(k=I,S=E*u+T)}n.set(S,f,d,y,h)}}return n.toTensor()},e.prototype.maxPoolBackprop=function(t,e,n,r){ip([e,n],"maxPoolBackprop");for(var a=this.maxPoolPositions(e,r),i=r.strideHeight,o=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,p=l-1-r.padInfo.left,f=c-1-r.padInfo.top,h=or(e.shape,"float32"),d=this.bufferSync(a),m=this.bufferSync(t),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var w=y-f,x=b-p,k=0,S=0;S<c;S+=s){var N=(w+S)/i;if(!(N<0||N>=r.outHeight||Math.floor(N)!==N))for(var E=0;E<l;E+=u){var C=(x+E)/o;if(!(C<0||C>=r.outWidth||Math.floor(C)!==C)){var T=c*l-1-d.get(v,N,C,g)===S*l+E?1:0;0!==T&&(k+=m.get(v,N,C,g)*T)}}}h.set(k,v,y,b,g)}return h.toTensor()},e.prototype.avgPoolBackprop=function(t,e,n){ip([t,e],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,p=l-1-n.padInfo.left,f=c-1-n.padInfo.top,h=or(e.shape,"float32"),d=1/(i*o),m=this.bufferSync(t),v=0;v<n.batchSize;++v)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var w=y-f,x=b-p,k=0,S=0;S<c;S+=s){var N=(w+S)/r;if(!(N<0||N>=n.outHeight||Math.floor(N)!==N))for(var E=0;E<l;E+=u){var C=(x+E)/a;C<0||C>=n.outWidth||Math.floor(C)!==C||(k+=m.get(v,N,C,g))}}h.set(k*d,v,y,b,g)}return h.toTensor()},e.prototype.pool3d=function(t,e,n){ip(t,"pool3d");for(var r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,h=e.padInfo.top,d=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(t.dataId),g=or(e.outShape,t.dtype),y=g.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[3]*e.outShape[4],k=e.outShape[4],S=0;S<e.batchSize;++S)for(var N=S*b,E=S*t.strides[0],C=0;C<e.inChannels;++C)for(var T=0;T<e.outDepth;++T){for(var I=T*r-f,_=I;_<0;)_+=o;for(var A=Math.min(e.inDepth,c+I),R=N+T*w,D=0;D<e.outHeight;++D){for(var O=D*a-h,M=O;M<0;)M+=s;for(var F=Math.min(e.inHeight,l+O),z=R+D*x,B=0;B<e.outWidth;++B){for(var L=B*i-d,P=L;P<0;)P+=u;for(var V=Math.min(e.inWidth,p+L),W=z+B*k,U=m,j=0,H=0,q=_;q<A;q+=o){for(var G=E+q*t.strides[1],Z=M;Z<F;Z+=s){for(var K=G+Z*t.strides[2],X=P;X<V;X+=u){var $=v[K+X*t.strides[3]+C];if("max"===n&&$>U?U=$:"avg"===n&&(j+=$,H++),isNaN(U))break}if(isNaN(U))break}if(isNaN(U))break}y[W+C]="avg"===n?j/H:U}}}return g.toTensor()},e.prototype.avgPool3d=function(t,e){return ip(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,e,n){ip([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,p=n.dilationWidth,f=n.effectiveFilterDepth,h=n.effectiveFilterHeight,d=n.effectiveFilterWidth,m=f-1-n.padInfo.front,v=d-1-n.padInfo.left,g=h-1-n.padInfo.top,y=or(e.shape,"float32"),b=1/(o*s*u),w=this.bufferSync(t),x=0;x<n.batchSize;++x)for(var k=0;k<n.inChannels;++k)for(var S=0;S<n.inDepth;++S)for(var N=0;N<n.inHeight;++N)for(var E=0;E<n.inWidth;++E){for(var C=S-m,T=N-g,I=E-v,_=0,A=0;A<f;A+=c){var R=(C+A)/r;if(!(R<0||R>=n.outDepth||Math.floor(R)!==R))for(var D=0;D<h;D+=l){var O=(T+D)/a;if(!(O<0||O>=n.outHeight||Math.floor(O)!==O))for(var M=0;M<d;M+=p){var F=(I+M)/i;F<0||F>=n.outWidth||Math.floor(F)!==F||(_+=w.get(x,R,O,F,k))}}}y.set(_*b,x,S,N,E,k)}return y.toTensor()},e.prototype.maxPool3d=function(t,e){return ip(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,e){for(var n=or(e.outShape,"int32"),r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,h=e.padInfo.top,d=e.padInfo.left,m=this.bufferSync(t),v=0;v<e.batchSize;++v)for(var g=0;g<e.inChannels;++g)for(var y=0;y<e.outDepth;++y){for(var b=y*r-f,w=b;w<0;)w+=o;for(var x=Math.min(e.inDepth,c+b),k=0;k<e.outHeight;++k){for(var S=k*a-h,N=S;N<0;)N+=s;for(var E=Math.min(e.inHeight,l+S),C=0;C<e.outWidth;++C){for(var T=C*i-d,I=T;I<0;)I+=u;for(var _=Math.min(e.inWidth,p+T),A=Number.NEGATIVE_INFINITY,R=-1,D=w;D<x;D+=o)for(var O=D-b,M=N;M<E;M+=s)for(var F=M-S,z=I;z<_;z+=u){var B=z-T,L=m.get(v,D,M,z,g);L>=A&&(A=L,R=O*l*p+F*l+B)}n.set(R,v,y,k,C,g)}}}return n.toTensor()},e.prototype.maxPool3dBackprop=function(t,e,n,r){ip([e,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(e,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,p=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,d=p-1-r.padInfo.front,m=h-1-r.padInfo.left,v=f-1-r.padInfo.top,g=or(e.shape,"float32"),y=this.bufferSync(a),b=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var x=0;x<r.inChannels;++x)for(var k=0;k<r.inDepth;++k)for(var S=0;S<r.inHeight;++S)for(var N=0;N<r.inWidth;++N){for(var E=k-d,C=S-v,T=N-m,I=0,_=0;_<p;_+=u){var A=(E+_)/i;if(!(A<0||A>=r.outDepth||Math.floor(A)!==A))for(var R=0;R<f;R+=c){var D=(C+R)/o;if(!(D<0||D>=r.outHeight||Math.floor(D)!==D))for(var O=0;O<h;O+=l){var M=(T+O)/s;if(!(M<0||M>=r.outWidth||Math.floor(M)!==M)){var F=p*f*h-1-y.get(w,A,D,M,x)===_*f*h+R*h+O?1:0;0!==F&&(I+=b.get(w,A,D,M,x)*F)}}}}g.set(I,w,k,S,N,x)}return g.toTensor()},e.prototype.cast=function(t,e){return Sa(t,e,this)},e.prototype.reshape=function(t,e){return Na(t,e)},e.prototype.avgPool=function(t,e){return ip(t,"avgPool"),this.pool(t,e,"avg").toFloat()},e.prototype.resizeBilinear=function(t,e,n,r){ip(t,"resizeBilinear");for(var a=t.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(t.dataId),l=new Float32Array(E([i,e,n,u])),p=[r&&e>1?o-1:o,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=0,d=p[0]/f[0],m=p[1]/f[1],v=0;v<i;v++)for(var g=0;g<e;g++)for(var y=d*g,b=Math.floor(y),w=y-b,x=Math.min(o-1,Math.ceil(y)),k=v*t.strides[0]+b*t.strides[1],S=v*t.strides[0]+x*t.strides[1],N=0;N<n;N++)for(var C=m*N,T=Math.floor(C),I=C-T,_=Math.min(s-1,Math.ceil(C)),A=k+T*t.strides[2],R=S+T*t.strides[2],D=k+ +_*t.strides[2],O=S+_*t.strides[2],M=0;M<u;M++){var F=c[A+M],z=c[R+M],B=F+(c[D+M]-F)*I,L=B+(z+(c[O+M]-z)*I-B)*w;l[h++]=L}return En(l,[i,e,n,u])},e.prototype.resizeBilinearBackprop=function(t,e,n){ip([t,e],"resizeBilinearBackprop");for(var r=e.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],p=new Float32Array(a*i*o*s),f=[n&&c>1?i-1:i,n&&l>1?o-1:o],h=[n&&c>1?c-1:c,n&&l>1?l-1:l],d=f[0]/h[0],m=f[1]/h[1],v=this.readSync(t.dataId),g=0,y=0;y<a;y++)for(var b=y*e.strides[0],w=0;w<c;w++)for(var x=w*d,k=Math.floor(x),S=Math.min(Math.ceil(x),i-1),N=b+k*e.strides[1],E=b+S*e.strides[1],C=x-k,T=1-C,I=0;I<l;I++)for(var _=I*m,A=Math.floor(_),R=Math.min(Math.ceil(_),o-1),D=_-A,O=1-D,M=N+A*e.strides[2],F=N+R*e.strides[2],z=E+A*e.strides[2],B=E+R*e.strides[2],L=T*O,P=T*D,V=C*O,W=C*D,U=0;U<s;U++){var j=v[g++];p[M+U]+=j*L,p[F+U]+=j*P,p[z+U]+=j*V,p[B+U]+=j*W}return Rn(p,[a,o,i,s],e.dtype)},e.prototype.resizeNearestNeighbor=function(t,e,n,r){ip(t,"resizeNearestNeighbor");for(var a=t.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(t.dataId),l=new Float32Array(i*e*n*u),p=[r&&e>1?o-1:o,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=p[0]/f[0],d=p[1]/f[1],m=0,v=0;v<i;v++)for(var g=v*t.strides[0],y=0;y<e;y++)for(var b=h*y,w=g+Math.min(o-1,r?Math.round(b):Math.floor(b))*t.strides[1],x=0;x<n;x++)for(var k=d*x,S=w+Math.min(s-1,r?Math.round(k):Math.floor(k))*t.strides[2],N=0;N<u;N++){var E=c[S+N];l[m++]=E}return En(l,[i,e,n,u],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){ip([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],p=new Float32Array(a*i*o*s),f=this.readSync(t.dataId),h=[n&&c>1?i-1:i,n&&l>1?o-1:o],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=h[0]/d[0],v=h[1]/d[1],g=1/m,y=1/v,b=2*Math.ceil(g)+2,w=2*Math.ceil(y)+2,x=0;x<a;x++)for(var k=x*e.strides[0],S=0;S<i;S++)for(var N=k+S*e.strides[1],E=Math.floor(S*g),C=Math.floor(E-b/2),T=0;T<o;T++)for(var I=N+T*e.strides[2],_=Math.floor(T*y),A=Math.floor(_-w/2),R=0;R<s;R++){for(var D=0,O=0;O<b;O++){var M=O+C;if(!(M<0||M>=c)){var F=k+M*t.strides[1],z=M*m;if(S===Math.min(i-1,n?Math.round(z):Math.floor(z)))for(var B=0;B<w;B++){var L=B+A;if(!(L<0||L>=l)){var P=F+L*t.strides[2],V=L*v;T===Math.min(o-1,n?Math.round(V):Math.floor(V))&&(D+=f[P+R])}}}}p[I+R]=D}return Rn(p,e.shape,e.dtype)},e.prototype.batchNormalization=function(t,e,n,r,a,i){ip([t,e,n,a,i],"batchNorm");for(var o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),p=new Float32Array(o.length),f=l.length,h=c.length,d=u.length,m=s.length,v=0,g=0,y=0,b=0,w=0;w<o.length;++w)p[w]=l[v++]+(o[w]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),v>=f&&(v=0),g>=m&&(g=0),y>=h&&(y=0),b>=d&&(b=0);return Rn(p,t.shape)},e.prototype.localResponseNormalization4D=function(t,e,n,r,a){ip(t,"localResponseNormalization4D");var i=t.shape[3],o=i-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%i,r=t-n+Math.max(0,n-e),a=t-n+Math.min(n+e,o),u=0;r<=a;r++){var c=s[r];u+=c*c}return u}for(var p=0;p<u;p++){var f=l(p),h=s[p]*Math.pow(n+r*f,-a);c[p]=h}return Rn(c,t.shape)},e.prototype.LRNGrad=function(t,e,n,r,a,i,o){ip(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),p=new Float32Array(t.size),f=t.size,h=0;h<f;h++){for(var d=h%s,m=h-d+Math.max(0,d-r),v=h-d+Math.min(s,d+r+1),g=0,y=m;y<v;y++)g+=Math.pow(c[y],2);for(g=i*g+a,y=m;y<v;y++){var b=-2*i*o*c[y]*l[h]/g;h===y&&(b+=Math.pow(g,-o)),b*=u[h],p[y]+=b}}return Rn(p,t.shape)},e.prototype.multinomial=function(t,e,n,r){ip(t,"multinomial");for(var a=e?t:ra(t),i=a.shape[0],o=a.shape[1],s=zn([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(a.dataId),l=0;l<i;++l){var p=l*o,f=new Float32Array(o-1);f[0]=c[p];for(var h=1;h<f.length;++h)f[h]=f[h-1]+c[p+h];for(var d=nr(r.toString()),m=l*n,v=0;v<n;++v){var g=d();u[m+v]=f.length;for(var y=0;y<f.length;y++)if(g<f[y]){u[m+v]=y;break}}}return s},e.prototype.oneHot=function(t,e,n,r){ip(t,"oneHot");var a=new Float32Array(t.size*e);a.fill(r);for(var i=this.readSync(t.dataId),o=0;o<t.size;++o)i[o]>=0&&i[o]<e&&(a[o*e+i[o]]=n);return _n(a,[t.size,e],"int32")},e.prototype.nonMaxSuppression=function(t,e,n,r,a){return ip(t,"nonMaxSuppression"),Ra(this.readSync(t.dataId),this.readSync(e.dataId),n,r,a)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],a=or(t.shape,"float32"),i=or(t.shape,"float32"),o=Sn(t).as2D(n,r),s=Nn(t).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),p=kn(c,l),f=this.readSync(this.fftImpl(p,e).dataId),h=0;h<r;h++){var d=Ia(f,h);a.values[u*r+h]=d.real,i.values[u*r+h]=d.imag}return kn(a.toTensor(),i.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(a=kn(Sn(a).div(Tn(r)),Nn(a).div(Tn(r)))),a}var i=this.readSync(t.dataId),o=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(i,r,e));return kn(o.real,o.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return 0==(t&t-1)},e.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),a=e/2,i=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}(r),o=kn(i.real,i.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}(r),u=kn(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),u=this.fftRadix2(u,a,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),a=0;a<Math.ceil(t/2);a++){var i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(e,n),l=kn(c.real,c.imag).mul(u),p=o.add(l),f=o.sub(l),h=Sn(p).concat(Sn(f)),d=Nn(p).concat(Nn(f));return kn(h,d).as1D()},e.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),a=0;a<e;a++){for(var i=0,o=0,s=0;s<e;s++){var u=Aa(a*s,e,n),c=Ia(t,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=e,o/=e),_a(r,i,o,a)}return r},e.prototype.depthToSpace=function(t,e,n){x("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),x(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],a=t.shape[1],i=t.shape[2],o=t.shape[3],s=a*e,u=i*e,c=o/(e*e),l=this.readSync(t.dataId),p=new Float32Array(r*s*u*c),f=0,h=0;h<r;++h)for(var d=0;d<s;++d)for(var m=Math.floor(d/e),v=d%e,g=0;g<u;++g)for(var y=Math.floor(g/e),b=(v*e+g%e)*c,w=0;w<c;++w){var k=w+b+o*(y+i*(m+a*h));p[f++]=l[k]}return Rn(p,[r,s,u,c])},e.prototype.broadcastedBinaryOp=function(t,e,n,r){var a=la(t.shape,e.shape),i=or(a,n),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=ua(t.shape,a),c=ua(e.shape,a),l=i.values;if(u.length+c.length===0)for(var p=0;p<l.length;++p)l[p]=r(o[p%o.length],s[p%s.length]);else{var f=this.bufferSync(t),h=this.bufferSync(e),d=function(n){var a=i.indexToLoc(n),p=a.slice(-t.rank);u.forEach((function(t){return p[t]=0}));var d=f.locToIndex(p),m=a.slice(-e.rank);c.forEach((function(t){return m[t]=0}));var v=h.locToIndex(m);l[n]=r(o[d],s[v])};for(p=0;p<l.length;++p)d(p)}return i.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=la(t.shape,e.shape),a=or(r,"float32"),i=or(r,"float32"),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=ua(t.shape,r),c=ua(e.shape,r),l=a.values,p=i.values;if(u.length+c.length===0)for(var f=0;f<l.length;f++){var h=f%o.length,d=f%s.length,m=n(o[2*h],o[2*h+1],s[2*d],s[2*d+1]);l[f]=m.real,p[f]=m.imag}else{var v=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var i=a.indexToLoc(r),f=i.slice(-t.rank);u.forEach((function(t){return f[t]=0}));var h=v.locToIndex(f),d=i.slice(-e.rank);c.forEach((function(t){return d[t]=0}));var m=g.locToIndex(d),y=n(o[2*h],o[2*h+1],s[2*m],s[2*m+1]);l[r]=y.real,p[r]=y.imag};for(f=0;f<l.length;f++)y(f)}return this.complex(a.toTensor(),i.toTensor())},e.prototype.split=function(t,e,n){return Oa(t,e,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,e,n,r,a,i){for(var o=t.shape,s=o[0],u=o[1],c=o[2],l=o[3],p=e.shape[0],f=r[0],h=r[1],d=or([p,f,h,l],t.dtype),m=this.readSync(e.dataId),v=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,b=d.strides,w=0;w<p;w++){var x=4*w,k=m[x],S=m[x+1],N=m[x+2],E=m[x+3],C=v[w];if(!(C>=s))for(var T=f>1?(N-k)*(u-1)/(f-1):0,I=h>1?(E-S)*(c-1)/(h-1):0,_=0;_<f;_++){var A=f>1?k*(u-1)+_*T:.5*(k+N)*(u-1);if(A<0||A>u-1)for(var R=0;R<h;R++)for(var D=0;D<l;D++){var O=D+R*b[2]+_*b[1]+w*b[0];d.values[O]=i}else if("bilinear"===a){var M=Math.floor(A),F=Math.ceil(A),z=A-M;for(R=0;R<h;R++)if((q=h>1?S*(c-1)+R*I:.5*(S+E)*(c-1))<0||q>c-1)for(D=0;D<l;D++)O=D+R*b[2]+_*b[1]+w*b[0],d.values[O]=i;else{var B=Math.floor(q),L=Math.ceil(q),P=q-B;for(D=0;D<l;D++){var V=g[O=D+B*y[2]+M*y[1]+C*y[0]],W=g[O=D+L*y[2]+M*y[1]+C*y[0]],U=g[O=D+B*y[2]+F*y[1]+C*y[0]],j=V+(W-V)*P,H=U+(g[O=D+L*y[2]+F*y[1]+C*y[0]]-U)*P;O=D+R*b[2]+_*b[1]+w*b[0],d.values[O]=j+(H-j)*z}}}else for(R=0;R<h;++R){var q;if((q=h>1?S*(c-1)+R*I:.5*(S+E)*(c-1))<0||q>c-1)for(D=0;D<l;D++)O=D+R*b[2]+_*b[1]+w*b[0],d.values[O]=i;else{var G=Math.round(q),Z=Math.round(A);for(D=0;D<l;D++){var K=D+G*y[2]+Z*y[1]+C*y[0],X=D+R*b[2]+_*b[1]+w*b[0];d.values[X]=g[K]}}}}}return d.toTensor()},e.prototype.sparseToDense=function(t,e,n,r){var a=Wr(0,t,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,u=a.strides,c=a.outputSize;return this.scatter(t,e,n,c,s,o,i,u,r,!1)},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],a=Pr(t,e),i=a[0],o=a[1],s=a[2],u=a[3];if(0===o)return En([],i,t.dtype);for(var c=new lt([o,s],t.dtype),l=this.readSync(e.dataId),p=this.readSync(t.dataId),f=0;f<o;f++){for(var h=[],d=0,m=0;m<r;m++){var v=l[f*r+m];d+=v*u[m],h.push(v)}if(d<0||d>=t.size/s)throw new Error("Invalid indices: "+h+" does not index into "+t.shape);for(var g=0;g<s;g++)c.values[f*s+g]=p[d*s+g]}return c.toTensor().reshape(i)},e.prototype.scatterND=function(t,e,n){var r=Wr(0,t,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=Tn(0);return this.scatter(t,e,n,u,o,i,a,s,c,!0)},e.prototype.fill=function(t,e,n){var r=z(n=n||G(e),E(t));return r.fill(e),Dt.makeTensor(r,t,n,this)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var e=z(t.dtype,E(t.shape));return this.makeOutput(e,t.shape,t.dtype)},e.prototype.linspace=function(t,e,n){return Ea(t,e,n)},e.prototype.scatter=function(t,e,n,r,a,i,o,s,u,c){var l=[r/a,a],p=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===r)return En([],n,e.dtype);var h=new lt(l,e.dtype);h.values.fill(this.readSync(u.dataId)[0]);for(var d=0;d<i;d++){for(var m=[],v=0,g=0;g<o;g++){var y=p[d*o+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/a)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<a;b++)c?h.values[v*a+b]+=f[d*a+b]:h.values[v*a+b]=0===e.rank?f[0]:f[d*a+b]}return h.toTensor().reshape(n)},e}(oa);Dt.registerBackend("cpu",(function(){return new sp}),1),d({kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=n;ip(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}),d({kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=n,i=new es(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}});var up=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();c().get("IS_BROWSER")&&c().setPlatform("browser",new up);var cp,lp=function(){function t(){this.util=n(9319),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=c().global.fetch?c().global.fetch(t,e):(null==cp&&(cp=n(9086)),cp(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();c().get("IS_NODE")&&c().setPlatform("node",new lp);var pp={float32:4,int32:4,uint16:2,uint8:1,bool:1};function fp(t,e){for(var n={},r=0,a=function(e){var a=e.name,i=e.dtype,o=e.shape,s=E(o),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=pp[c.dtype],p=t.slice(r,r+s*l),f="uint8"===c.dtype?new Uint8Array(p):new Uint16Array(p);if("float32"===i)u=Float32Array.from(f,(function(t){return t*c.scale+c.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=Int32Array.from(f,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if("string"===i){var h=E(e.shape);u=[];for(var d=0;d<h;d++){var m=new Uint32Array(t.slice(r,r+4))[0];r+=4;var v=new Uint8Array(t.slice(r,r+m));u.push(v),r+=m}}else{var g=pp[i];if(p=t.slice(r,r+s*g),"float32"===i)u=new Float32Array(p);else if("int32"===i)u=new Int32Array(p);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=new Uint8Array(p)}r+=s*g}n[a]=En(u,o,i)},i=0,o=e;i<o.length;i++)a(o[i]);return n}function hp(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),a=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),a),a+=t.byteLength})),r.buffer}var dp="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function mp(t){return dp?Buffer.byteLength(t):new Blob([t]).size}function vp(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function gp(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function yp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:mp(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:mp(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var bp=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var a=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&a.push(n)})),a},t}(),wp="://",xp=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){x(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(wp)&&(e=e.slice(0,e.indexOf(wp))),x(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();x(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function kp(t){if(-1===t.indexOf(wp))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+xp.getSchemes().join(","));return{scheme:t.split(wp)[0],path:t.split(wp)[1]}}function Sp(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,(function(){var r,a,i,o,u,c,l,p,f;return s(this,(function(s){switch(s.label){case 0:return x(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),x((r=bp.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),x(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),a=r[0],x((i=bp.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),x(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),o=i[0],u=kp(t).scheme,c=kp(t).path,l=u===kp(t).scheme,[4,a.load()];case 1:return p=s.sent(),n&&l?[4,xp.getManager(u).removeModel(c)]:[3,3];case 2:s.sent(),s.label=3;case 3:return[4,o.save(p)];case 4:return f=s.sent(),!n||l?[3,6]:[4,xp.getManager(u).removeModel(c)];case 5:s.sent(),s.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var Np="models_store",Ep="model_info_store";function Cp(){if(!c().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Tp(t){var e=t.result;e.createObjectStore(Np,{keyPath:"modelPath"}),e.createObjectStore(Ep,{keyPath:"modelPath"})}var Ip=function(){function t(t){if(this.indexedDB=Cp(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Tp(a)},a.onsuccess=function(){var i=a.result;if(null==e){var o=i.transaction(Np,"readonly"),s=o.objectStore(Np).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=yp(e),l=i.transaction(Ep,"readwrite"),p=l.objectStore(Ep),f=p.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var a=(u=i.transaction(Np,"readwrite")).objectStore(Np).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});a.onsuccess=function(){return t({modelArtifactsInfo:c})},a.onerror=function(t){var e=(p=l.objectStore(Ep)).delete(n.modelPath);e.onsuccess=function(){return i.close(),r(a.error)},e.onerror=function(t){return i.close(),r(a.error)}}},f.onerror=function(t){return i.close(),r(f.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(t){return r(a.error)}}))},t.URL_SCHEME="indexeddb://",t}(),_p=function(t){return c().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ip.URL_SCHEME)?(e=t.slice(Ip.URL_SCHEME.length),new Ip(e)):null;var e};bp.registerSaveRouter(_p),bp.registerLoadRouter(_p);var Ap=function(){function t(){this.indexedDB=Cp()}return t.prototype.listModels=function(){return o(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Tp(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(Ep,"readonly"),i=a.objectStore(Ep).getAll();i.onsuccess=function(){for(var t={},n=0,r=i.result;n<r.length;n++){var a=r[n];t[a.modelPath]=a.modelArtifactsInfo}e(t)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){var r;return t=(r=t).startsWith(Ip.URL_SCHEME)?r.slice(Ip.URL_SCHEME.length):r,[2,new Promise((function(n,r){var a=e.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Tp(a)},a.onsuccess=function(){var e,i=a.result,o=i.transaction(Ep,"readwrite"),s=o.objectStore(Ep),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var a=s.delete(t),o=function(){var a=(e=i.transaction(Np,"readwrite")).objectStore(Np).delete(t);a.onsuccess=function(){return n(u.result.modelArtifactsInfo)},a.onerror=function(t){return r(u.error)}};a.onsuccess=o,a.onerror=function(t){return o(),i.close(),r(u.error)}},u.onerror=function(t){return i.close(),r(u.error)},o.oncomplete=function(){null==e?i.close():e.oncomplete=function(){return i.close()}}},a.onerror=function(t){return r(a.error)}}))]}))}))},t}();if(c().getBool("IS_BROWSER"))try{xp.registerManager(Ip.URL_SCHEME,new Ap)}catch(wt){}var Rp="/",Dp="tensorflowjs_models",Op="info",Mp="model_topology",Fp="weight_specs",zp="weight_data",Bp="model_metadata";function Lp(t){return{info:[Dp,t,Op].join(Rp),topology:[Dp,t,Mp].join(Rp),weightSpecs:[Dp,t,Fp].join(Rp),weightData:[Dp,t,zp].join(Rp),modelMetadata:[Dp,t,Bp].join(Rp)}}function Pp(t){var e=t.split(Rp);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(Rp)}var Vp=function(){function t(t){if(!c().getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Lp(this.modelPath)}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return s(this,(function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=yp(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(i=t.weightData,dp?Buffer.from(i).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(i))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var i;return[2]}))}))},t.prototype.load=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,a,i,o;return s(this,(function(s){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(a),e.format=i.format,e.generatedBy=i.generatedBy,e.convertedBy=i.convertedBy),null==(o=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(dp){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(o),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),Wp=function(t){return c().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Vp.URL_SCHEME)?(e=t.slice(Vp.URL_SCHEME.length),new Vp(e)):null;var e};bp.registerSaveRouter(Wp),bp.registerLoadRouter(Wp);var Up=function(){function t(){x(c().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),x(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,a,i;return s(this,(function(o){for(t={},e=Dp+Rp,n=Rp+Op,r=0;r<this.LS.length;++r)(a=this.LS.key(r)).startsWith(e)&&a.endsWith(n)&&(i=Pp(a),t[i]=JSON.parse(this.LS.getItem(a)));return[2,t]}))}))},t.prototype.removeModel=function(t){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){var a;if(t=(a=t).startsWith(Vp.URL_SCHEME)?a.slice(Vp.URL_SCHEME.length):a,e=Lp(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(c().getBool("IS_BROWSER"))try{xp.registerManager(Vp.URL_SCHEME,new Up)}catch(wt){}function jp(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Hp=function(){function t(e){if(!c().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e,n,r,a,i,o;return s(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,jp((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==t.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=e,[4,jp((function(){return o.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:yp(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),qp=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return o(this,void 0,void 0,(function(){var t,e,n=this;return s(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void a(t)}var l=[],p=[],f=[];u.forEach((function(t){t.paths.forEach((function(t){p.push(t),f.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,a=p.indexOf(t);f[a]=n,-1===f.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:vp(f)})},e.onerror=function(e){return a("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return gp(t.name)})),a={},i=0,o=t;i<o.length;i++)o[i].paths.forEach((function(t){var i=gp(t);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");a[t]=e[r.indexOf(i)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return a},t}();function Gp(t,e,n,r){!function(t){x(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){x(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),x(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),x(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(t.map((function(i){return i.then((function(i){var o=n+ ++a/t.length*(r-n);return e(o),i})),i})))}function Zp(t,e){return o(this,void 0,void 0,(function(){var n,r,a,i,o,u,l,p,f;return s(this,(function(s){switch(s.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?c().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),a=0,i=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=s.sent(),[3,4];case 2:return[4,Gp(r,e.onProgress,a,i)];case 3:o=s.sent(),s.label=4;case 4:return u=o.map((function(t){return t.arrayBuffer()})),l=.5,p=1,null!=e.onProgress?[3,6]:[4,Promise.all(u)];case 5:return f=s.sent(),[3,8];case 6:return[4,Gp(u,e.onProgress,l,p)];case 7:f=s.sent(),s.label=8;case 8:return[2,f]}}))}))}function Kp(t){var e=this;return function(n,r,a){return void 0===r&&(r=""),o(e,void 0,void 0,(function(){var e,i,o,u,c,l,p,f,h,d;return s(this,(function(s){switch(s.label){case 0:if(e=n.map((function(){return!1})),i={},o=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var s="quantization"in t?t.quantization.dtype:t.dtype,c=pp[s]*E(t.shape),l=function(){e[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:t,groupOffset:r,sizeBytes:c})};null!=a?a.forEach((function(e,n){e===t.name&&(l(),o[n]=!0)})):l(),u.push(t.name),r+=c}))})),!o.every((function(t){return t})))throw c=a.filter((function(t,e){return!o[e]})),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");return l=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),p=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;p.push(e)}))})),[4,t(p)];case 1:return f=s.sent(),h={},d=0,l.forEach((function(t){for(var e=n[t].paths.length,r=0,a=0;a<e;a++)r+=f[d+a].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),u=0,c=0;c<e;c++){var l=new Uint8Array(f[d+c]);s.set(l,u),u+=l.byteLength}i[t].forEach((function(t){var e=fp(o.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)h[n]=e[n]})),d+=e})),[2,h]}}))}))}}bp.registerSaveRouter((function(t){return c().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Hp.URL_SCHEME)?(void 0===(e=t.slice(Hp.URL_SCHEME.length))&&(e="model"),new Hp(e)):null;var e}));var Xp=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(x("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=c().platform.fetch,x(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&x(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e,n,r,a;return s(this,(function(i){switch(i.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:yp(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}}))}))},t.prototype.load=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,a,i,o,u;return s(this,(function(s){switch(s.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=s.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");s.label=2;case 2:return s.trys.push([2,4,,5]),[4,t.json()];case 3:return e=s.sent(),[3,5];case 4:throw s.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=e.modelTopology,a=e.weightsManifest,null==r&&null==a)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:u=s.sent(),i=u[0],o=u[1],s.label=7;case 7:return[2,{modelTopology:r,weightSpecs:i,weightData:o}]}}))}))},t.prototype.loadWeights=function(t){return o(this,void 0,void 0,(function(){var e,n,r,a,i,o,u,c,l,p,f;return s(this,(function(s){switch(s.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],a=n[1],i=this.weightPathPrefix||r,o=[],u=0,c=t;u<c.length;u++)l=c[u],o.push.apply(o,l.weights);return p=[],t.forEach((function(t){t.paths.forEach((function(t){p.push(i+t+a)}))})),[4,Zp(p,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=s.sent(),[2,[o,vp(f)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function $p(t){return null!=t.match(Xp.URL_SCHEME_REGEX)}var Yp=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return $p(t)})):$p(t))?Qp(t,{onProgress:e}):null};function Qp(t,e){return new Xp(t,e)}bp.registerSaveRouter(Yp),bp.registerLoadRouter(Yp);var Jp=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),tf=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),ef=Object.freeze({browserFiles:function(t){return new qp(t)},browserHTTPRequest:function(t,e){return Qp(t,e)},concatenateArrayBuffers:vp,decodeWeights:fp,encodeWeights:function(t,e){return o(this,void 0,void 0,(function(){var n,r,a,i,u,c=this;return s(this,(function(l){switch(l.label){case 0:for(n=[],r=[],a=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),i=function(i){var u=a[i],l=Array.isArray(t)?t[i].tensor:t[u];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+u+"': "+l.dtype);var p={name:u,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var f=new Promise((function(t){return o(c,void 0,void 0,(function(){var e,n,r,a,i,o,u;return s(this,(function(s){switch(s.label){case 0:return[4,l.bytes()];case 1:for(e=s.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+4*e.length,r=new Uint8Array(n),a=0,i=0;i<e.length;i++)o=e[i],u=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(u,a),a+=4,r.set(o,a),a+=o.length;return t(r),[2]}}))}))}));r.push(f)}else r.push(l.data());null!=e&&(p.group=e),n.push(p)},u=0;u<a.length;++u)i(u);return[4,Promise.all(r)];case 1:return[2,{data:hp(l.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Jp(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jp({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jp({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return bp.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:yp,getSaveHandlers:function(t){return bp.getSaveHandlers(t)},http:Qp,isHTTPScheme:$p,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),o(this,void 0,void 0,(function(){return s(this,(function(a){return[2,Kp((function(t){return Zp(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return bp.registerLoadRouter(t)},registerSaveRouter:function(t){return bp.registerSaveRouter(t)},weightsLoaderFactory:Kp,withSaveHandler:function(t){return new tf(t)},copyModel:function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Sp(t,e,!1)]}))}))},listModels:function(){return o(this,void 0,void 0,(function(){var t,e,n,r,a,i,o;return s(this,(function(s){switch(s.label){case 0:t=xp.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(a=r[n],[4,xp.getManager(a).listModels()]):[3,4];case 2:for(o in i=s.sent())e[a+wp+o]=i[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,Sp(t,e,!0)]}))}))},removeModel:function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return e=kp(t),[2,xp.getManager(e.scheme).removeModel(e.path)]}))}))}}),nf=xn({confusionMatrix_:function(t,e,n){var r=cn(t,"labels","confusionMatrix"),a=cn(e,"predictions","confusionMatrix");x(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),x(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),x(1===a.rank,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),x(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),x(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=vr(r.asType("int32"),n),o=vr(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}}),rf=Object.freeze({confusionMatrix:nf}),af=xn({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&n&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return Dt.fromPixels(t,e)}}),of=Object.freeze({toPixels:function(t,e){return o(this,void 0,void 0,(function(){var n,r,a,i,o,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k,S,N,E;return s(this,(function(s){switch(s.label){case 0:if(n=cn(t,"img","toPixels"),t instanceof dt||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],i=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return u=s.sent(),c=n.min(),l=n.max(),[4,Promise.all([c.data(),l.data()])];case 2:if(p=s.sent(),f=p[0],h=p[1],d=f[0],m=h[0],c.dispose(),l.dispose(),"float32"===n.dtype){if(d<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+m+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+m+"].")}for(v="float32"===n.dtype?255:1,g=new Uint8ClampedArray(i*a*4),y=0;y<a*i;++y)b=void 0,w=void 0,x=void 0,k=void 0,1===o?(b=u[y]*v,w=u[y]*v,x=u[y]*v,k=255):3===o?(b=u[3*y]*v,w=u[3*y+1]*v,x=u[3*y+2]*v,k=255):4===o&&(b=u[4*y]*v,w=u[4*y+1]*v,x=u[4*y+2]*v,k=u[4*y+3]*v),g[0+(S=4*y)]=Math.round(b),g[S+1]=Math.round(w),g[S+2]=Math.round(x),g[S+3]=Math.round(k);return null!=e&&(e.width=i,e.height=a,N=e.getContext("2d"),E=new ImageData(g,i,a),N.putImageData(E,0,0)),n!==t&&n.dispose(),[2,g]}}))}))},fromPixels:af}),sf=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),uf=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function cf(t){x(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),x("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),x(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),uf.register(t)}var lf=Object.freeze({Serializable:sf,SerializationMap:uf,registerClass:cf});function pf(){return 32===Dt.backend.floatPrecision()?.001:.1}function ff(t,e,n){var r=!0;if((V(t)||V(e))&&(r=!1),V(t)&&V(e)&&(r=!0),r){var a=t.constructor.name,i=e.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(t)&&Array.isArray(e)){var o=sn(t),s=sn(e);if(!C(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=V(t)?t:N(t),c=V(e)?e:N(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var p=u[l],f=c[l];if(!n(p,f))throw new Error("Arrays differ: actual["+l+"] = "+p+", expected["+l+"] = "+f+".\nActual:   "+u+".\nExpected: "+c+".")}}function hf(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}var df=Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=pf()),ff(t,e,(function(t,e){return hf(t,e,n)}))},testEpsilon:pf,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return j(t)||j(t[0])||j(e)||j(e[0])?ff(t,n,(function(t,e){return t==e})):ff(t,e,(function(t,e){return hf(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=pf()),!hf(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),mf="1.3.1",vf=Object.freeze({gpgpu_util:ho,webgl_util:ze,forceHalfFloat:function(){c().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:ws,setWebGLContext:Vt,GPGPUContext:mo}),gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:i[t.name]}}));this.applyGradients(o)}else this.applyGradients(i);return Ze(i),e?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return ta(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&Ze(this.iterations_)},e.prototype.saveIterations=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:Tn(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(sf);Object.defineProperty(gf,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var yf=function(t){function e(e,n,r){void 0===r&&(r=null);var a=t.call(this)||this;return a.learningRate=e,a.rho=n,a.epsilon=r,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==r&&(a.epsilon=Dt.backend.epsilon()),a}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Dt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:Ge((function(){return Wn(a).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:Ge((function(){return Wn(a).variable(!1)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;Ge((function(){var t=o.mul(e.rho).add(i.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(o.add(e.epsilon).sqrt()).mul(i),r=s.mul(e.rho).add(n.square().mul(1-e.rho));o.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(a);a.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Ze(this.accumulatedGrads.map((function(t){return t.variable}))),Ze(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(gf);cf(yf);var bf=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Dt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:Ge((function(){return Bn(a.shape,e.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedGrads[r].variable;Ge((function(){var t=o.add(i.square());o.assign(t);var n=i.div(t.add(Dt.backend.epsilon()).sqrt()).mul(-e.learningRate).add(a);a.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&Ze(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(gf);cf(bf);var wf=function(t){function e(e,n,r,a){void 0===a&&(a=null);var i=t.call(this)||this;return i.learningRate=e,i.beta1=n,i.beta2=r,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Ge((function(){i.accBeta1=Tn(n).variable(),i.accBeta2=Tn(r).variable()})),null==a&&(i.epsilon=Dt.backend.epsilon()),i}return i(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Ge((function(){var r=Wu(1,e.accBeta1),a=Wu(1,e.accBeta2);n.forEach((function(n,i){var o=Dt.registeredVariables[n];null==e.accumulatedFirstMoment[i]&&(e.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Ge((function(){return Wn(o).variable(!1)}))}),null==e.accumulatedSecondMoment[i]&&(e.accumulatedSecondMoment[i]={originalName:n+"/v",variable:Ge((function(){return Wn(o).variable(!1)}))});var s=Array.isArray(t)?t[i].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[i].variable,c=e.accumulatedSecondMoment[i].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),p=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),f=l.div(r),h=p.div(a);u.assign(l),c.assign(p);var d=f.div(h.sqrt().add(e.epsilon)).mul(-e.learningRate).add(o);o.assign(d)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Ze(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Ze(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){var e,n=this;return s(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),Ge((function(){n.accBeta1.assign(Bu(n.beta1,n.iterations_+1)),n.accBeta2.assign(Bu(n.beta2,n.iterations_+1))})),e=t.length/2,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(gf);cf(wf);var xf=function(t){function e(e,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=a,o.decay=i,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Ge((function(){o.iteration=Tn(0).variable(),o.accBeta1=Tn(n).variable()})),null==a&&(o.epsilon=Dt.backend.epsilon()),o}return i(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Ge((function(){var r=Wu(1,e.accBeta1),a=Cu(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,i){var o=Dt.registeredVariables[n];null==e.accumulatedFirstMoment[i]&&(e.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Wn(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[i]&&(e.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:Wn(o).variable(!1)});var s=Array.isArray(t)?t[i].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[i].variable,c=e.accumulatedWeightedInfNorm[i].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),p=c.mul(e.beta2),f=s.abs(),h=p.maximum(f);u.assign(l),c.assign(h);var d=a.div(r).mul(l.div(h.add(e.epsilon))).add(o);o.assign(d)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Ze(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Ze(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(gf);cf(xf);var kf=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var i=Dt.registeredVariables[n];Ge((function(){var t=e.c.mul(a).add(i);i.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Ke(Tn(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(gf);cf(kf);var Sf=function(t){function e(e,n,r){void 0===r&&(r=!1);var a=t.call(this,e)||this;return a.learningRate=e,a.momentum=n,a.useNesterov=r,a.accumulations=[],a.m=Tn(a.momentum),a}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Dt.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:Ge((function(){return Wn(a).variable(!1)}))});var i=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&Ge((function(){var t,n=e.m.mul(i).add(o);t=e.useNesterov?e.c.mul(o.add(n.mul(e.m))).add(a):e.c.mul(n).add(a),i.assign(n),a.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Ze(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(kf);cf(Sf);var Nf=function(t){function e(e,n,r,a,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===a&&(a=null),void 0===i&&(i=!1);var o=t.call(this)||this;return o.learningRate=e,o.decay=n,o.momentum=r,o.epsilon=a,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=i,null==a&&(o.epsilon=Dt.backend.epsilon()),o}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Dt.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:Ge((function(){return Wn(a).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:Ge((function(){return Wn(a).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:Ge((function(){return Wn(a).variable(!1)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;Ge((function(){var t=o.mul(e.decay).add(i.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(i.mul(1-e.decay)),c=s.mul(e.momentum).add(i.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));o.assign(t),n.assign(u),s.assign(c);var l=a.sub(c);a.assign(l)}else{var p=o.mul(e.decay).add(i.square().mul(1-e.decay));c=s.mul(e.momentum).add(i.mul(e.learningRate).div(p.add(e.epsilon).sqrt())),o.assign(p),s.assign(c),l=a.sub(c),a.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Ze(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Ze(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Ze(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(gf);cf(Nf);var Ef=function(){function t(){}return t.sgd=function(t){return new kf(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new Sf(t,e,n)},t.rmsprop=function(t,e,n,r,a){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===a&&(a=!1),new Nf(t,e,n,r,a)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new wf(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new yf(t,e,n)},t.adamax=function(t,e,n,r,a){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===a&&(a=0),new xf(t,e,n,r,a)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new bf(t,e)},t}(),Cf={sgd:Ef.sgd,momentum:Ef.momentum,adadelta:Ef.adadelta,adagrad:Ef.adagrad,rmsprop:Ef.rmsprop,adamax:Ef.adamax,adam:Ef.adam},Tf="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(t){return t()};function If(){return new Promise((function(t){return Tf((function(){return t()}))}))}ft=ap;var _f=function(t,e){return(_f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Af(t,e){function n(){this.constructor=t}_f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Rf,Df=function(){return(Df=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function Of(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function Mf(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function Ff(){return null==Rf&&(Rf=rn().epsilon()),Rf}var zf=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Af(e,t),e}(Error),Bf=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Af(e,t),e}(Error),Lf=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Af(e,t),e}(Error),Pf=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Af(e,t),e}(Error),Vf=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Af(e,t),e}(Error);!function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}Af(e,t)}(Error);function Wf(t,e){if(Array.isArray(t)){for(var n=[],r=0;r<e;r++)n=n.concat(t);return n}return(n=new Array(e)).fill(t),n}function Uf(t,e){if(!t)throw new Vf(e)}function jf(t,e){for(var n=0,r=0,a=t;r<a.length;r++)a[r]===e&&n++;return n}function Hf(t){return 1===t.length?t[0]:t}function qf(t){return Array.isArray(t)?t:[t]}function Gf(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function Zf(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(function(t,e){return e.toUpperCase()}))}var Kf={};function Xf(t){if(null===t||void 0===t)return null;var e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function $f(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach((function(t){return $f(t)}));else for(var e=0,n=Object.keys(t);e<n.length;e++){var r=n[e],a=t[r];null!=a&&"object"==typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!=typeof a.value?$f(a):t[r]=a.value)}}function Yf(t,e,n,r,a){var i,o,s;if(void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r="object"),void 0===a&&(a=!1),"string"==typeof t){var u=t,c=void 0;if(u in n)c=n[u];else if(u in Kf)c=Kf[u];else if(null==(c=e[u]))throw new Lf("Unknown "+r+": "+t+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return c}var l=t;if(null==l.className||null==l.config)throw new Lf(r+": Improper config format: "+JSON.stringify(l)+".\n'className' and 'config' must set.");var p=l.className,f=void 0,h=void 0;if(p in n?(f=(i=n[p])[0],h=i[1]):p in Kf?(f=(o=Kf.className)[0],h=o[1]):p in e&&(f=(s=e[p])[0],h=s[1]),null==f)throw new Lf("Unknown "+r+": "+p+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(null!=h){for(var d={},m=0,v=Object.keys(Kf);m<v.length;m++)d[k=v[m]]=Kf[k];for(var g=0,y=Object.keys(n);g<y.length;g++)d[k=y[g]]=n[k];l.config.customObjects=d;for(var b=Df({},Kf),w=0,x=Object.keys(n);w<x.length;w++){var k=x[w];Kf[k]=n[k]}$f(l.config);var S=h(f,l.config,n,a);return Kf=Df({},b),S}b=Df({},Kf);for(var N=0,E=Object.keys(n);N<E.length;N++)k=E[N],Kf[k]=n[k];return S=new f(l.config),Kf=Df({},b),S}function Qf(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function Jf(t){if(null==t)return t;for(var e=[],n=0,r=t;n<r.length;n++){var a=r[n];-1===e.indexOf(a)&&e.push(a)}return e}function th(t){if(null==t)throw new Lf("Invalid value in obj: "+JSON.stringify(t));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function eh(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new Lf(n+" is not a valid "+e+".  Valid values are "+t+" or null/undefined.")}function nh(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=1/0),Uf(n>=0),Uf(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((function(t){return typeof t===e}))}function rh(t,e){Array.isArray(t)?(at.assert(t.length>0,(function(){return e+" is unexpectedly an empty array."})),t.forEach((function(t,n){return rh(t,"element "+(n+1)+" of "+e)}))):at.assert(Number.isInteger(t)&&t>0,(function(){return"Expected "+e+" to be a positive integer, but got "+ah(t)+"."}))}function ah(t){return null===t?"null":Array.isArray(t)?"["+t.map((function(t){return ah(t)})).join(",")+"]":"string"==typeof t?'"'+t+'"':""+t}function ih(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function oh(t,e){return Ge((function(){return Qs($c(zu(t,t),e,!0))}))}var sh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.getConfig=function(){return{}},e}(lf.Serializable),uh=function(t){function e(e){var n=t.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return Af(e,t),e.prototype.apply=function(t){var e=this;return Ge((function(){var n=oh(t,e.axis),r=As(n,0,e.maxValue);return Fu(t,Cu(r,ku(Ff(),n)))}))},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e.className="MaxNorm",e}(sh);lf.registerClass(uh);var ch=function(t){function e(e){var n=t.call(this)||this;return n.defaultAxis=0,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return Af(e,t),e.prototype.apply=function(t){var e=this;return Ge((function(){return Cu(t,ku(Ff(),oh(t,e.axis)))}))},e.prototype.getConfig=function(){return{axis:this.axis}},e.className="UnitNorm",e}(sh);lf.registerClass(ch);var lh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return el(t)},e.className="NonNeg",e}(sh);lf.registerClass(lh);var ph=function(t){function e(e){var n=t.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=e.minValue?e.minValue:n.defaultMinValue,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.rate=null!=e.rate?e.rate:n.defaultRate,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return Af(e,t),e.prototype.apply=function(t){var e=this;return Ge((function(){var n=oh(t,e.axis),r=ku(Fu(e.rate,As(n,e.minValue,e.maxValue)),Fu(1-e.rate,n));return Fu(t,Cu(r,ku(Ff(),n)))}))},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e.className="MinMaxNorm",e}(sh);lf.registerClass(ph);var fh={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hh(t){return Xf(t)}function dh(t,e){return void 0===e&&(e={}),Yf(t,lf.SerializationMap.getMap().classNameMap,e,"constraint")}function mh(t){return null==t?null:"string"==typeof t?dh({className:t in fh?fh[t]:t,config:{}}):t instanceof sh?t:dh(t)}var vh=Object.freeze({maxNorm:function(t){return new uh(t)},unitNorm:function(t){return new ch(t)},nonNeg:function(){return new lh},minMaxNorm:function(t){return new ph(t)}}),gh=["channelsFirst","channelsLast"],yh=["valid","same","causal"],bh=["max","avg"],wh=["sum","mul","concat","ave"],xh=new Map;function kh(t){eh(gh,"DataFormat",t)}function Sh(t){eh(yh,"PaddingMode",t)}function Nh(t){eh(bh,"PoolMode",t)}var Eh=[];function Ch(t,e){Eh.push(t);try{var n=e();return Eh.pop(),n}catch(t){throw Eh.pop(),t}}function Th(t){if(!Ah(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===Eh.length?"":Eh.join("/")+"/")+t}function Ih(t){if(!Ah(t))throw new Error("Not a valid tensor name: '"+t+"'");xh.has(t)||xh.set(t,0);var e=xh.get(t);if(xh.set(t,xh.get(t)+1),e>0){var n=t+"_"+e;return xh.set(n,1),n}return t}var _h=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Ah(t){return!!t.match(_h)}function Rh(t){return t===parseInt(t.toString(),10)}function Dh(t,e,n){null==e&&(e=0),null==n&&(n=t.length);for(var r=1,a=e;a<n;++a)r*=t[a];return r}function Oh(t){return In(t=Array.isArray(t)?new Float32Array(t):t)}function Mh(t){return Kc(Oh(t)).dataSync()[0]}function Fh(t){return Gc(Oh(t)).dataSync()[0]}function zh(t,e){if(e<t)throw new Lf("end ("+e+") < begin ("+t+") is forbidden.");for(var n=[],r=t;r<e;++r)n.push(r);return n}function Bh(t,e){return t.asType(e)}function Lh(t,e){void 0===e&&(e=-1);var n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function Ph(t,e,n){return Ge((function(){switch(t.rank){case 1:return zc(t,e,n);case 2:return Bc(t,[e,0],[n,t.shape[1]]);case 3:return Lc(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Pc(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Fc(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Fc(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Lf("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}))}function Vh(t,e,n){return Ge((function(){switch(t.rank){case 1:return zc(t,e,n);case 2:return Bc(t,[0,e],[t.shape[0],n]);case 3:return Lc(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Pc(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Lf("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}}))}function Wh(t,e,n,r){return Ge((function(){switch(t.rank){case 1:return zc(t,e,n);case 2:switch(r){case 1:return Ph(t,e,n);case 2:return Vh(t,e,n);default:throw new Lf("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return Ph(t,e,n);case 2:return Lc(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Vh(t,e,n);default:throw new Lf("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return Ph(t,e,n);case 2:return Pc(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Pc(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Vh(t,e,n);default:throw new Lf("The axis is not within the rank of the tensor "+r)}default:throw new Lf("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}}))}function Uh(t,e){var n;return void 0===e&&(e=-1),e<0&&(e=0!==(n=t[0].rank)?n:0),e===t[0].rank&&(e=-1),Un(t,e)}function jh(t,e){switch(t.rank){case 1:return jn([t,e]);case 2:return Hn([t,e],0);case 3:return qn([t,e],0);case 4:return Gn([t,e],0);default:throw new Lf("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function Hh(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Lf("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+t.rank+")");return Ar(t,e)}function qh(t,e,n,r,a){return void 0===e&&(e=0),void 0===n&&(n=1),Sr(t,e,n,r,a)}function Gh(t,e,n,r){if(t.rank<2||e.rank<2)throw new Pf("dot requires both inputs to be rank >= 2 but got x shape = "+t.shape+" and y shape = "+e.shape);if(e.rank>=3&&t.shape.slice(-1)[0]!==(l=e.shape.slice(-2)[0]))throw new Pf("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+t.shape+" and  y shape = "+e.shape);if(2===t.rank&&2===e.rank){var a=!1,i=!1;return rp.matMul({a:t,b:e,transposeA:a,transposeB:i,bias:r?Xh(t.rank,r,"channelsLast"):null,activation:n})}var o=t.shape.slice(),s=o.pop();t=t.reshape([-1,s]);var u=e.shape.slice(),c=u.pop(),l=u.pop(),p=u.concat([c]),f=Array.from({length:e.rank},(function(t,n){return 0===n?e.rank-2:n<=e.rank-2?n-1:n}));e=e.transpose(f).reshape([l,-1]);var h=o.concat(p);return a=!1,i=!1,rp.matMul({a:t,b:e,transposeA:a,transposeB:i,bias:r?Xh(t.rank,r,"channelsLast"):null,activation:n}).reshape(h)}function Zh(t,e,n){return Ge((function(){return e=Array.isArray(e)?In(e,"int32"):e.toInt(),rc(t,e,n)}))}function Kh(t){return zu(t,t)}function Xh(t,e,n){var r=e.shape;if(1!==e.rank&&e.rank!==t)throw new Lf("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return 1===r.length?e.reshape([1,r[0],1,1,1]):e.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?e.reshape([1,1,1,1,r[0]]):e.reshape([1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?e.reshape([1,r[0],1,1]):e.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?e.reshape([1,1,1,r[0]]):e.reshape([1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?e.reshape([1,r[0],1]):e.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?e.reshape([1,1,r[0]]):e.reshape([1].concat(r))}else if(t<3)return e;throw new Lf("Unsupported input rank by biasAdd: "+e.rank)}function $h(t,e,n){return Ge((function(){return null==n&&(n="channelsLast"),kh(n),t.add(Xh(t.rank,e,n))}))}function Yh(t,e,n,r){return Ge((function(){return xl(t,e,n,r)}))}function Qh(t,e,n){return void 0===n&&(n=!1),n?t():e()}var Jh=["fanIn","fanOut","fanAvg"],td=["normal","uniform","truncatedNormal"];var ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e}(lf.Serializable),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t,e){return zn(t,e)},e.className="Zeros",e}(ed);lf.registerClass(nd);var rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t,e){return Fn(t,e)},e.className="Ones",e}(ed);lf.registerClass(rd);var ad=function(t){function e(e){var n=t.call(this)||this;if("object"!=typeof e)throw new Lf("Expected argument of type ConstantConfig but got "+e);if(void 0===e.value)throw new Lf("config must have value set but got "+e);return n.value=e.value,n}return Af(e,t),e.prototype.apply=function(t,e){var n=this;return Ge((function(){return Fu(Tn(n.value),Fn(t,e))}))},e.prototype.getConfig=function(){return{value:this.value}},e.className="Constant",e}(ed);lf.registerClass(ad);var id=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=e.minval||n.DEFAULT_MINVAL,n.maxval=e.maxval||n.DEFAULT_MAXVAL,n.seed=e.seed,n}return Af(e,t),e.prototype.apply=function(t,e){return Er(t,this.minval,this.maxval,e)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e.className="RandomUniform",e}(ed);lf.registerClass(id);var od=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return Af(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Pf("randomNormal does not support dType "+e+".");return qh(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="RandomNormal",e}(ed);lf.registerClass(od);var sd=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return Af(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Pf("truncatedNormal does not support dType "+e+".");return Rr(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="TruncatedNormal",e}(ed);lf.registerClass(sd);var ud=function(t){function e(e){var n=t.call(this)||this;return n.gain=null!=e.gain?e.gain:1,n}return Af(e,t),e.prototype.apply=function(t,e){var n=this;return Ge((function(){if(2!==t.length||t[0]!==t[1])throw new Lf("Identity matrix initializer can only be used for 2D square matrices.");return Fu(n.gain,dr(t[0]))}))},e.prototype.getConfig=function(){return{gain:this.gain}},e.className="Identity",e}(ed);lf.registerClass(ud);var cd=function(t){function e(e){var n=t.call(this)||this;if(e.scale<0)throw new Lf("scale must be a positive float. Got: "+e.scale);return n.scale=null==e.scale?1:e.scale,n.mode=null==e.mode?"fanIn":e.mode,function(t){eh(Jh,"FanMode",t)}(n.mode),n.distribution=null==e.distribution?"normal":e.distribution,function(t){eh(td,"Distribution",t)}(n.distribution),n.seed=e.seed,n}return Af(e,t),e.prototype.apply=function(t,e){var n=function(t,e){var n,r;if(void 0===e&&(e="channelsLast"),kh(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length))if("channelsFirst"===e){var a=Dh(t,2);n=t[1]*a,r=t[0]*a}else"channelsLast"===e&&(a=Dh(t,0,t.length-2),n=t[t.length-2]*a,r=t[t.length-1]*a);else{var i=Dh(t);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}(t),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Pf(this.getClassName()+" does not support dType "+e+".");return Rr(t,0,o,e,this.seed)}var s=Math.sqrt(3*i);return Er(t,-s,s,e)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e.className="VarianceScaling",e}(ed);lf.registerClass(cd);var ld=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})||this}return Af(e,t),e.prototype.getClassName=function(){return cd.className},e.className="GlorotUniform",e}(cd);lf.registerClass(ld);var pd=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})||this}return Af(e,t),e.prototype.getClassName=function(){return cd.className},e.className="GlorotNormal",e}(cd);lf.registerClass(pd);var fd=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return Af(e,t),e.prototype.getClassName=function(){return cd.className},e.className="HeNormal",e}(cd);lf.registerClass(fd);var hd=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return Af(e,t),e.prototype.getClassName=function(){return cd.className},e.className="HeUniform",e}(cd);lf.registerClass(hd);var dd=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return Af(e,t),e.prototype.getClassName=function(){return cd.className},e.className="LeCunNormal",e}(cd);lf.registerClass(dd);var md=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return Af(e,t),e.prototype.getClassName=function(){return cd.className},e.className="LeCunNormal",e}(cd);lf.registerClass(md);var vd=function(t){function e(e){var n=t.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==e.gain?n.DEFAULT_GAIN:e.gain,n.seed=e.seed,null!=n.seed)throw new Pf("Random seed is not implemented for Orthogonal Initializer yet.");return n}return Af(e,t),e.prototype.apply=function(t,e){var n=this;return Ge((function(){if(2!==t.length)throw new Pf("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var e=qh(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),r=jl.gramSchmidt(e);return t[0]>t[1]&&(r=r.transpose()),Fu(n.gain,r)}))},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e.className="Orthogonal",e}(ed);lf.registerClass(vd);var gd={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yd(t,e){return void 0===e&&(e={}),Yf(t,lf.SerializationMap.getMap().classNameMap,e,"initializer")}function bd(t){return Xf(t)}function wd(t){if("string"==typeof t){var e=t in gd?gd[t]:t;if("GlorotNormal"===e)return new pd;if("GlorotUniform"===e)return new ld;if("HeNormal"===e)return new fd;if("HeUniform"===e)return new hd;if("LeCunNormal"===e)return new dd;if("LeCunUniform"===e)return new md;var n={};return n.className=e,n.config={},yd(n)}return t instanceof ed?t:yd(t)}var xd=Object.freeze({zeros:function(){return new nd},ones:function(){return new rd},constant:function(t){return new ad(t)},randomUniform:function(t){return new id(t)},randomNormal:function(t){return new od(t)},truncatedNormal:function(t){return new sd(t)},identity:function(t){return new ud(t)},varianceScaling:function(t){return new cd(t)},glorotUniform:function(t){return new ld(t)},glorotNormal:function(t){return new pd(t)},heNormal:function(t){return new fd(t)},heUniform:function(t){return new hd(t)},leCunNormal:function(t){return new dd(t)},leCunUniform:function(t){return new md(t)},orthogonal:function(t){return new vd(t)}}),kd=0;function Sd(){return kd++}var Nd={};function Ed(t){return void 0===t&&(t=""),t in Nd||(Nd[t]=0),Nd[t]+=1,t+Nd[t].toString()}function Cd(t){return Array.isArray(t)&&Array.isArray(t[0])}function Td(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function Id(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new Lf("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function _d(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new Lf("Expected exactly 1 Shape; got "+t.length)}return t}function Ad(t){for(var e=0,n=0,r=t;n<r.length;n++){var a=r[n];0===a.shape.length?e+=1:e+=a.shape.reduce((function(t,e){return t*e}))}return e}var Rd="Variable",Dd=function(){function t(t,e,n,r,a){void 0===e&&(e="float32"),void 0===n&&(n=Rd),void 0===r&&(r=!0),void 0===a&&(a=null),this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=Sd(),n=null==n?Rd:n,this.originalName=Th(n),this.name=Ih(this.originalName),this.trainable_=r,this.constraint=a,this.val=Mn(t,this.trainable_,this.name,this.dtype)}return t.prototype.read=function(){return this.assertNotDisposed(),this.val},t.prototype.write=function(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},t.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},t.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),t}();function Od(t){return t.map((function(t){return t.read()}))}function Md(t){t.forEach((function(t){t[0].write(t[1])}))}var Fd=function(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},zd=function(t,e,n,r,a,i,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=Sd(),null!=i&&(this.originalName=Th(i),this.name=Ih(this.originalName)),this.rank=e.length},Bd=0,Ld=function(){function t(t,e){this.callArgs=e,this.id=Bd++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var n=0,r=t.inboundLayers;n<r.length;n++){var a=r[n];null!=a&&a.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return t.prototype.getConfig=function(){for(var t=[],e=0,n=this.inboundLayers;e<n.length;e++){var r=n[e];null!=r?t.push(r.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},t}(),Pd=0,Vd=function(t){function e(e){var n=t.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=Pd++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=e.name;if(!r){var a=n.getClassName();r=Gf(a)+"_"+Ed(a)}if(n.name=r,n.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){var i=void 0;if(null!=e.batchInputShape)i=e.batchInputShape;else if(null!=e.inputShape){var o=null;null!=e.batchSize&&(o=e.batchSize),i=[o].concat(e.inputShape)}n.batchInputShape=i;var s=e.dtype;null==s&&(s=e.inputDType),null==s&&(s="float32"),n.dtype=s}return null!=e.weights?n.initialWeights=e.weights:n.initialWeights=null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return Af(e,t),e.nodeKey=function(t,e){return t.name+"_ib-"+e.toString()},e.prototype.getNodeAtIndex=function(t,e){if(0===this.inboundNodes.length)throw new Bf("The layer has never been called and thus has no defined "+e+".");if(this.inboundNodes.length<=t)throw new Lf("Asked to get "+e+" at node "+t+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return Hf(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return Hf(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new zf("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new zf("Layer "+this.name+" is not connected, no input to return.");return Hf(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new zf("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new zf("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Hf(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map((function(t){return t()}))},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach((function(e){return e.trainable=t})),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter((function(t){return t.trainable})):[]},set:function(t){this._trainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter((function(t){return!t.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){if(t=qf(t),null!=this.inputSpec&&0!==this.inputSpec.length){var e=qf(this.inputSpec);if(t.length!==e.length)throw new Lf("Layer "+this.name+" expects "+e.length+" inputs, but it received "+t.length+" input tensors. Input received: "+t);for(var n=0;n<t.length;n++){var r=t[n],a=e[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new Lf("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+a.ndim+", found ndim="+i);if(null!=a.maxNDim&&i>a.maxNDim)throw new Lf("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+a.maxNDim+", found ndim="+i);if(null!=a.minNDim&&i<a.minNDim)throw new Lf("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+a.minNDim+", found ndim="+i+".");if(null!=a.dtype&&r.dtype!==a.dtype)throw new Lf("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+a.dtype+", found dtype="+r.dtype+".");if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new Lf("Input "+n+" is incompatible with layer "+this.name+": expected axis "+u+" of input shape to have value "+c+" but got shape "+o+".")}}if(null!=a.shape)for(var p=0;p<a.shape.length;++p){var f=a.shape[p],h=r.shape[p];if(null!=f&&null!=h&&f!==h)throw new Lf("Input "+n+" is incompatible with layer "+this.name+": expected shape="+a.shape+", found shape="+r.shape+".")}}}}},e.prototype.call=function(t,e){return t},e.prototype.invokeCallHook=function(t,e){null!=this._callHook&&this._callHook(t,e)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,e){var n=this;e=e||{},this.assertNotDisposed();for(var r=qf(t),a=!0,i=0,o=r;i<o.length;i++)if(!(o[i]instanceof zd)){a=!1;break}for(var s=!0,u=0,c=r;u<c.length;u++)if(c[u]instanceof zd){s=!1;break}if(a===s)throw new Lf("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ch(this.name,(function(){if(!n.built){n.assertInputCompatibility(t);for(var a=[],i=0,o=qf(t);i<o.length;i++){var u=o[i];a.push(u.shape)}n.build(Hf(a)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&s&&(n._refCount=1)}if(n.assertInputCompatibility(t),s){for(var c=[],l=0,p=qf(m=n.call(t,e));l<p.length;l++){var f=p[l];-1!==r.indexOf(f)&&(f=f.clone()),c.push(f)}if(m=Hf(c),null!=n.activityRegularizer)throw new Pf("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m}var h=function(t){for(var e=[],n=0,r=t=qf(t);n<r.length;n++){var a=r[n];e.push(a.shape)}return Hf(e)}(t),d=n.computeOutputShape(h),m=void 0,v="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(t)?h[0]:h),m=null!=d&&d.length>0&&Array.isArray(d[0])?d.map((function(r,a){return new zd(v,r,n,qf(t),e,n.name,a)})):new zd(v,d,n,qf(t),e,n.name),n.addInboundNode(t,m,null,null,h,d,e),n._refCount++,null!=n.activityRegularizer)throw new Pf("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m}))},e.prototype.warnOnIncompatibleInputShape=function(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var e=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor ("+JSON.stringify(t)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new zf("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var t=[],e=0,n=this.inboundNodes;e<n.length;e++){var r=n[e],a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new zf("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new Bf("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return Ad(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return void 0===t&&(t=!1),Od(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var e=this;Ge((function(){var n=e.weights;if(n.length!==t.length)throw new Lf('You called setWeights(weights) on layer "'+e.name+'" with a weight list of length '+t.length+", but the layer was expecting "+n.length+" weights. Provided weights: "+t+"...");if(0!==n.length){for(var r=[],a=Od(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=t[i];if(!at.arraysEqual(o.shape,u.shape))throw new Lf("Layer weight shape "+o.shape+" not compatible with provided weight shape "+u.shape);r.push([s,u])}Md(r)}}))},e.prototype.addWeight=function(t,e,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(t))throw new Lf("Duplicate weight name "+t+" for layer "+this.name);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=wd("zeros"));var s=r.apply(e,n),u=new Dd(s,n,t,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(u.read())})),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var e;null==t||Array.isArray(t)&&0===t.length||(t=qf(t),void 0!==this._losses&&null!==this._losses&&(e=this.losses).push.apply(e,t))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,e){var n=this;if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");e.forEach((function(t){if(null!=t)throw new TypeError("Layer "+n.name+" does not support masking, but was passed an inputMask.")}))}return null}return e},e.prototype.addInboundNode=function(t,e,n,r,a,i,o){void 0===o&&(o=null);var s=qf(t);e=qf(e),n=qf(n),r=qf(r),a=Td(a),i=Td(i);for(var u=[],c=[],l=[],p=0,f=s;p<f.length;p++){var h=f[p];u.push(h.sourceLayer),c.push(h.nodeIndex),l.push(h.tensorIndex)}new Ld({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:l,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var d=0;d<e.length;d++)e[d].sourceLayer=this,e[d].nodeIndex=this.inboundNodes.length-1,e[d].tensorIndex=d},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach((function(t){return t.dispose()})),this.weights.length},e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e}(lf.Serializable);function Wd(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];var r=e.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++)for(var o=0,s=Wd(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]);o<s.length;o++){var u=s[o];-1===a.indexOf(u)&&a.push(u)}return a}var Ud,jd=function(t){function e(e){var n=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:Ed("input").toString()})||this;if(null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Lf("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new Lf("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Lf("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=e.dtype||"float32";n.batchInputShape=r,n.dtype=a,n.inputSpec=[{shape:r}];var i=new zd(n.dtype,n.batchInputShape,n,[],{},n.name);return i.nodeIndex=0,i.tensorIndex=0,new Ld({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return Af(e,t),e.prototype.apply=function(t,e){throw new Lf("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e.className="InputLayer",e}(Vd);function Hd(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new Lf("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));var n=t.dtype;return null==n&&(n="float32"),new jd({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function qd(t){return Of(this,void 0,void 0,(function(){var e,n,r,a,i,o,s,u;return Mf(this,(function(c){switch(c.label){case 0:if(null==t)return[2];for(a in e=[],n=[],r=[],t)"number"!=typeof(i=t[a])&&(o=i,e.push(o.data()),n.push(a),r.push(o));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(s=c.sent(),u=0;u<s.length;++u)t[n[u]]=s[u][0];Ze(r),c.label=2;case 2:return[2]}}))}))}function Gd(t){if(null!=t)for(var e in t){var n=t[e];"number"!=typeof n&&n.dispose()}}lf.registerClass(jd),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(Ud||(Ud={}));var Zd=function(){function t(){this.validationData=null}return t.prototype.setParams=function(t){this.params=t},t.prototype.onEpochBegin=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return[2]}))}))},t.prototype.onEpochEnd=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return[2]}))}))},t.prototype.onBatchBegin=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return[2]}))}))},t.prototype.onBatchEnd=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return[2]}))}))},t.prototype.onTrainBegin=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return[2]}))}))},t.prototype.onTrainEnd=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return[2]}))}))},t.prototype.setModel=function(t){},t}(),Kd=function(){function t(t,e){void 0===e&&(e=10),null==t&&(t=[]),this.callbacks=t,this.queueLength=e}return t.prototype.append=function(t){this.callbacks.push(t)},t.prototype.setParams=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setParams(t)},t.prototype.setModel=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setModel(t)},t.prototype.onEpochBegin=function(t,e){return Of(this,void 0,void 0,(function(){var n,r;return Mf(this,(function(a){switch(a.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,a.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(t,e)]:[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onEpochEnd=function(t,e){return Of(this,void 0,void 0,(function(){var n,r;return Mf(this,(function(a){switch(a.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,a.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(t,e)]:[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onBatchBegin=function(t,e){return Of(this,void 0,void 0,(function(){var n,r;return Mf(this,(function(a){switch(a.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,a.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(t,e)]:[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onBatchEnd=function(t,e){return Of(this,void 0,void 0,(function(){var n,r;return Mf(this,(function(a){switch(a.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,a.label=1;case 1:return n<r.length?[4,r[n].onBatchEnd(t,e)]:[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onTrainBegin=function(t){return Of(this,void 0,void 0,(function(){var e,n;return Mf(this,(function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainBegin(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t.prototype.onTrainEnd=function(t){return Of(this,void 0,void 0,(function(){var e,n;return Mf(this,(function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainEnd(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t}(),Xd=function(t){function e(){return t.call(this)||this}return Af(e,t),e.prototype.onEpochBegin=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return this.seen=0,this.totals={},[2]}))}))},e.prototype.onBatchEnd=function(t,e){return Of(this,void 0,void 0,(function(){var t,n,r,a,i=this;return Mf(this,(function(o){for(a in null==e&&(e={}),t=null==e.size?0:e.size,this.seen+=t,n=function(n){var a=e[n];if("number"==typeof a)r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+a*t;else{var o=void 0;n in r.totals?o=r.totals[n]:r.totals[n]=0;var s=Ge((function(){return ku(i.totals[n],Fu(a,t))}));r.totals[n]=s,null!=o&&o.dispose()}},r=this,e)n(a);return[2]}))}))},e.prototype.onEpochEnd=function(t,e){return Of(this,void 0,void 0,(function(){var t,n,r,a,i,o=this;return Mf(this,(function(s){if(null!=e)for(t=function(t){if(null==n.totals[t])return"continue";"number"==typeof n.totals[t]?e[t]=n.totals[t]/n.seen:Ge((function(){var n=Fu(Cu(1,o.seen),o.totals[t]);e[t]=n,o.totals[t].dispose(),Ke(e[t])}))},n=this,r=0,a=this.params.metrics;r<a.length;r++)i=a[r],t(i);return[2]}))}))},e}(Zd),$d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.onTrainBegin=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return this.epoch=[],this.history={},[2]}))}))},e.prototype.onEpochEnd=function(t,e){return Of(this,void 0,void 0,(function(){var n;return Mf(this,(function(r){for(n in null==e&&(e={}),this.epoch.push(t),e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n]);return[2]}))}))},e.prototype.syncData=function(){return Of(this,void 0,void 0,(function(){var t,e,n,r,a,i,o,s,u;return Mf(this,(function(c){switch(c.label){case 0:for(r in t=[],e=[],n=[],this.history)for(a=this.history[r],i=0;i<a.length;++i)"number"!=typeof a[i]&&(o=a[i],t.push(o.data()),e.push(r),n.push(i));return[4,Promise.all(t)];case 1:for(s=c.sent(),u=0;u<s.length;++u)this.history[e[u]][n[u]].dispose(),this.history[e[u]][n[u]]=s[u][0];return[2]}}))}))},e}(Zd),Yd=function(t){function e(e,n){var r=t.call(this)||this;if(r.currentEpoch=0,r.yieldEvery=n||"auto","auto"===r.yieldEvery&&(r.yieldEvery=125),"never"===r.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return at.isNumber(r.yieldEvery)&&(r.maybeWait=function(t,e){var n,r=at.now();return function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var o=at.now();return o-r<e?n:(r=o,n=t.apply(void 0,a))}}(r.maybeWait.bind(r),r.yieldEvery)),r.trainBegin=e.onTrainBegin,r.trainEnd=e.onTrainEnd,r.epochBegin=e.onEpochBegin,r.epochEnd=e.onEpochEnd,r.batchBegin=e.onBatchBegin,r.batchEnd=e.onBatchEnd,r.yield=e.onYield,r}return Af(e,t),e.prototype.maybeWait=function(t,e,n){return Of(this,void 0,void 0,(function(){var r;return Mf(this,(function(a){switch(a.label){case 0:return r=[],null==this.yield?[3,2]:[4,qd(n)];case 1:a.sent(),r.push(this.yield(t,e,n)),a.label=2;case 2:return r.push(If()),[4,Promise.all(r)];case 3:return a.sent(),[2]}}))}))},e.prototype.onEpochBegin=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){switch(n.label){case 0:return this.currentEpoch=t,null==this.epochBegin?[3,3]:[4,qd(e)];case 1:return n.sent(),[4,this.epochBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onEpochEnd=function(t,e){return Of(this,void 0,void 0,(function(){var n;return Mf(this,(function(r){switch(r.label){case 0:return n=[],null==this.epochEnd?[3,2]:[4,qd(e)];case 1:r.sent(),n.push(this.epochEnd(t,e)),r.label=2;case 2:return"epoch"===this.yieldEvery&&n.push(If()),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onBatchBegin=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,qd(e)];case 1:return n.sent(),[4,this.batchBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onBatchEnd=function(t,e){return Of(this,void 0,void 0,(function(){var n;return Mf(this,(function(r){switch(r.label){case 0:return n=[],null==this.batchEnd?[3,2]:[4,qd(e)];case 1:r.sent(),n.push(this.batchEnd(t,e)),r.label=2;case 2:return"batch"===this.yieldEvery?n.push(If()):at.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onTrainBegin=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(e){switch(e.label){case 0:return null==this.trainBegin?[3,3]:[4,qd(t)];case 1:return e.sent(),[4,this.trainBegin(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype.onTrainEnd=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(e){switch(e.label){case 0:return null==this.trainEnd?[3,3]:[4,qd(t)];case 1:return e.sent(),[4,this.trainEnd(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e}(Zd);function Qd(t,e){return null==t&&(t={}),t instanceof Zd?[t]:Array.isArray(t)&&t[0]instanceof Zd?t:qf(t).map((function(t){return new Yd(t,e)}))}var Jd=function(){function t(){}return t.registerCallbackConstructor=function(e,n){at.assert(e>=0&&Number.isInteger(e),(function(){return"Verbosity level is expected to be an integer >= 0, but got "+e})),t.checkForDuplicate(n),null==t.constructors[e]&&(t.constructors[e]=[]),t.constructors[e].push(n)},t.checkForDuplicate=function(e){for(var n in t.constructors)t.constructors[+n].forEach((function(t){if(t===e)throw new Lf("Duplicate callback constructor.")}))},t.clear=function(){t.constructors={}},t.createCallbacks=function(e){var n=[];for(var r in t.constructors){var a=+r;e>=a&&n.push.apply(n,t.constructors[a])}return n.map((function(t){return new t}))},t.constructors={},t}();function tm(t,e,n,r,a,i,o,s,u){var c=new $d,l=[new Xd].concat(Jd.createCallbacks(e));null!=t&&l.push.apply(l,t),l.push(c);var p=new Kd(l);return p.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:e,doValidation:s,metrics:u}),{callbackList:p,history:c}}function em(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=!1),Yf(t,lf.SerializationMap.getMap().classNameMap,e,"layer",n)}function nm(t,e){return Ge((function(){"float32"!==t.dtype&&(t=t.asType("float32"));var n=$c(Kh(t),e,!0),r=Bn(n.shape,Ff()),a=Qs(_u(n,r));return Cu(t,a)}))}function rm(t,e){return Ge((function(){return Zc(Kh(Wu(e,t)),-1)}))}function am(t,e){return Ge((function(){return Zc(ks(Wu(e,t)),-1)}))}function im(t,e){return Ge((function(){var n=Wu(t,e),r=As(ks(t),Ff(),Number.MAX_VALUE),a=ks(Cu(n,r));return Fu(100,Zc(a,-1))}))}function om(t,e,n){return void 0===n&&(n=!1),Ge((function(){if(n)e=ra(e);else{var r=$c(e,e.shape.length-1,!0);e=Cu(e,r)}return e=As(e,Ff(),1-Ff()),Vs($c(Fu(t.toFloat(),Bs(e)),e.shape.length-1))}))}function sm(t,e){return Ge((function(){var n=zs(function(t){var e=[Dh(t.shape)];return t.reshape(e)}(t)).toInt(),r=(e=As(e,Ff(),1-Ff())).shape;return om(vr(n,r[r.length-1]).reshape(r),e,!1)}))}function um(t,e){return Ge((function(){var n;return n=As(e,Ff(),1-Ff()),n=Bs(Cu(n,Wu(1,n))),Zc(function(t,e){if(!at.arraysEqual(t.shape,e.shape))throw new Lf("logits and labels must have the same shape, but got shapes "+JSON.stringify(t.shape)+" and "+JSON.stringify(e.shape));return Ge((function(){var n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())}))}(t,n),-1)}))}function cm(t,e){return Ge((function(){var n=nm(t,-1),r=nm(e,-1),a=Fu(n,r);return Vs($c(a,-1))}))}var lm={meanSquaredError:rm,meanAbsoluteError:am,meanAbsolutePercentageError:im,meanSquaredLogarithmicError:function(t,e){return Ge((function(){var n=As(e,Ff(),Number.MAX_VALUE),r=Bs(ku(1,n)),a=As(t,Ff(),Number.MAX_VALUE),i=Bs(ku(1,a));return Zc(Kh(Wu(r,i)),-1)}))},squaredHinge:function(t,e){return Ge((function(){var n=_u(0,Wu(1,Fu(t,e)));return Zc(Kh(n),-1)}))},hinge:function(t,e){return Ge((function(){var n=_u(0,Wu(1,Fu(t,e)));return Zc(n,-1)}))},categoricalHinge:function(t,e){return Ge((function(){var n=$c(Fu(t,e),-1),r=Gc(Fu(Wu(1,t),e),-1);return _u(0,ku(1,Wu(r,n)))}))},logcosh:function(t,e){return Ge((function(){var n=Math.log(2),r=Wu(e,t),a=Wu(ku(r,Ys(Fu(-2,r))),n);return Zc(a,-1)}))},categoricalCrossentropy:om,sparseCategoricalCrossentropy:sm,binaryCrossentropy:um,kullbackLeiblerDivergence:function(t,e){return Ge((function(){var n=As(t,Ff(),1),r=As(e,Ff(),1);return $c(Fu(t,Bs(Cu(n,r))),-1)}))},poisson:function(t,e){return Ge((function(){var n=Bs(ku(Ff(),e));return Zc(Wu(e,Fu(t,n)),-1)}))},cosineProximity:cm};function pm(t){if("string"==typeof t){if(t in lm)return lm[t];var e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss "+t+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Lf(e)}return t}function fm(t,e){return Ge((function(){var n=Fu(.5,Vn(e)),r=Bh(qu(e,n),t.dtype);return Zc(ju(t,r),-1)}))}function hm(t,e){return Ge((function(){return Bh(ju(jc(t,-1),jc(e,-1)),"float32")}))}function dm(t,e){return Ge((function(){return vu(t.equal(1),e.equal(1)).sum().cast("float32")}))}function mm(t,e){return Ge((function(){var n=dm(t,e),r=function(t,e){return Ge((function(){return vu(t.equal(0),e.equal(1)).sum().cast("float32")}))}(t,e),a=n.add(r);return wu(qu(a,0),n.div(a),0).cast("float32")}))}function vm(t,e){return Ge((function(){var n=dm(t,e),r=function(t,e){return Ge((function(){return vu(t.equal(1),e.equal(0)).sum().cast("float32")}))}(t,e),a=n.add(r);return wu(qu(a,0),n.div(a),0).cast("float32")}))}function gm(t,e){return um(t,e)}function ym(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),ju(t,e).asType("float32")}var bm=om,wm=sm,xm={binaryAccuracy:fm,categoricalAccuracy:hm,precision:mm,categoricalCrossentropy:bm,sparseCategoricalCrossentropy:wm,mse:rm,MSE:rm,mae:am,MAE:am,mape:im,MAPE:im,cosine:cm};function km(t){if(Uf(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;for(var e=void 0,n=0,r=Object.keys(lm);n<r.length;n++){var a=r[n];if(lm[a]===t){e=a;break}}if(void 0!==e)return e;for(var i=0,o=Object.keys(xm);i<o.length;i++)if(a=o[i],xm[a]===t){e=a;break}return void 0!==e?e:t.name}var Sm=1048576;function Nm(t,e,n){if(void 0===n&&(n=!1),null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!Em(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(t);r.length>Sm&&console.warn('User-defined metadata of model "'+e+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"1048576.")}}function Em(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){for(var e=0,n=Object.keys(t);e<n.length;e++){var r=n[e];if("string"!=typeof r)return!1;if(!Em(t[r]))return!1}return!0}if(Array.isArray(t)){for(var a=0,i=t;a<i.length;a++)if(!Em(i[a]))return!1;return!0}return!1}var o=typeof t;return"string"===o||"number"===o||"boolean"===o}function Cm(t,e,n,r){void 0===r&&(r=console.log);var a,i=function(t){var e=!0,n=[],r=[];for(var a in t.nodesByDepth)n.push(t.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){e=!1;break}r.push.apply(r,s)}if(e)for(var u=0,c=t.layers;u<c.length;u++){for(var l=!1,p=0,f=c[u].inboundNodes;p<f.length;p++){var h=f[p];if(-1!==r.indexOf(h)){if(l){e=!1;break}l=!0}}if(!e)break}return e}(t),o=["Layer (type)","Output shape","Param #"];if(i?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(t){return Math.floor(e*t)}))),!i)for(var s in o.push("Receives inputs"),a=[],t.nodesByDepth)a.push.apply(a,t.nodesByDepth[s]);r("_".repeat(e)),Tm(o,n,r),r("=".repeat(e));for(var u=t.layers,c=0;c<u.length;++c)i?Im(u[c],n,r):_m(u[c],n,a,r),r((c===u.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();var l=function(t){return null!=t.collectedTrainableWeights?Ad(t.collectedTrainableWeights):Ad(t.trainableWeights)}(t),p=Ad(t.nonTrainableWeights);r("Total params: "+(l+p)),r("Trainable params: "+l),r("Non-trainable params: "+p),r("_".repeat(e))}function Tm(t,e,n){void 0===n&&(n=console.log);for(var r="",a=0;a<t.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[a]).slice(0,e[a]),r+=" ".repeat(e[a]-r.length);n(r)}function Im(t,e,n){var r;try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}Tm([t.name+" ("+t.getClassName()+")",r,t.countParams().toString()],e,n)}function _m(t,e,n,r){var a;try{a=JSON.stringify(t.outputShape)}catch(t){a="multiple"}for(var i=[],o=0,s=t.inboundNodes;o<s.length;o++){var u=s[o];if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var c=0;c<u.inboundLayers.length;++c){var l=u.inboundLayers[c].name,p=u.nodeIndices[c],f=u.tensorIndices[c];i.push(l+"["+p+"]["+f+"]")}}var h=t.name,d=t.getClassName(),m=0===i.length?"":i[0];for(Tm([h+" ("+d+")",a,t.countParams().toString(),m],e,r),c=1;c<i.length;++c)Tm(["","","",i[c]],e,r)}function Am(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function Rm(t,e){if(null===t)return null;if("string"==typeof t)return Zf(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var n=[],r=t.length,a=0;a<r;++a){var i=t[a];Am(e,a,i)?n.push(i):n.push(Rm(i,e))}return n}for(var o={},s=0,u=Object.keys(t);s<u.length;s++){var c=u[s],l=t[c];if("name"===c&&"string"==typeof l)o[c]=l;else{var p=Zf(c);o[p]=Rm(l,p)}}return o}function Dm(t,e){if(null===t||void 0===t)return null;if("string"==typeof t)return Gf(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var n=[],r=t.length,a=0;a<r;++a){var i=t[a];Am(e,a,i)?n.push(i):n.push(Dm(i,e))}return n}for(var o={},s=0,u=Object.keys(t);s<u.length;s++){var c=u[s],l=t[c];o[Gf(c)]="name"!==c&&"className"!==c||"string"!=typeof l?Dm(l,c):l}return o}var Om="1.3.1";var Mm=function(){function t(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof t)for(var n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(null==e)return;for(var r=0,a=e;r<a.length;r++){var i=a[r];this.add(i.key,i.value)}}}return t.prototype.add=function(t,e,n){if(null!=this.id2Value[t.id])throw new Lf("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return cr(e,t.dtype)}catch(n){throw new Lf("The dtype of the feed ("+e.dtype+") can not be cast to the dtype of the key '"+t.name+"' ("+t.dtype+").")}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this},t.prototype.addFeed=function(t){this.add(t.key,t.value)},t.prototype.hasKey=function(t){return null!=this.id2Value[t.id]},t.prototype.names=function(){return Object.keys(this.name2Id)},t.prototype.getValue=function(t){if(t instanceof zd){if(null==this.id2Value[t.id])throw new Lf("Nonexistent key: "+t.name);return this.id2Value[t.id]}var e=this.name2Id[t];if(null==e)throw new Lf("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]},t.prototype.getMask=function(t){if(t instanceof zd){if(null==this.id2Value[t.id])throw new Lf("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var e=this.name2Id[t];if(null==e)throw new Lf("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]},t.prototype.disposeMasks=function(){null!=this.id2Mask&&Ze(this.id2Mask)},t}(),Fm={},zm={};function Bm(t,e,n,r){for(var a=null!=n&&n.training,i=Array.isArray(t),o=i?t:[t],s=o.map((function(t){return t.name})),u=[],c=e.names(),l=0,p=s;l<p.length;l++){var f=p[l];-1!==c.indexOf(f)?u.push(e.getValue(f)):u.push(null)}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,d,m=s.join(",")+"|"+e.names().join(",");if(null==Fm[m]){var v=function(t,e){at.assert(null!=t&&t.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===t.length){var a=Pm(t[0],e);n=a.sorted,r=a.recipientMap}else for(var i=new Set,o=0,s=t;o<s.length;o++){for(var u=Pm(s[o],e),c=u.sorted,l=u.recipientMap,p=0,f=c;p<f.length;p++){var h=f[p];i.has(h.name)||(n.push(h),i.add(h.name))}var d=function(t){null==r[t]&&(r[t]=new Set),l[t].forEach((function(e){return r[t].add(e)}))};for(var m in l)d(m)}return{sorted:n,recipientCounts:Lm(r)}}(o,e);h=v.sorted,d=v.recipientCounts,Fm[m]=h,zm[m]=d}h=Fm[m],d={},a||Object.assign(d,zm[m]);for(var g=new Mm(e),y=0;y<h.length;++y){if(null!=r){var b=He().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var w=h[y],x=w.sourceLayer;if(!(x instanceof jd)){for(var k=[],S=[],N=[],E=!1,C=0,T=w.inputs;C<T.length;C++){var I=T[C],_=g.getValue(I),A=g.getMask(I);k.push(_),S.push(A),null!=A&&(E=!0),a||(d[I.name]--,0!==d[I.name]||e.hasKey(I)||-1!==s.indexOf(I.name)||_.isDisposed||!0===I.sourceLayer.stateful||N.push(_))}E&&((n=n||{}).mask=S[0]);var R=qf(x.apply(k,n)),D=null;x.supportsMasking&&(D=x.computeMask(k,S));for(var O=Vm(w),M=Array.isArray(O)?O:[O],F=0;F<M.length;++F){g.hasKey(M[F])||g.add(M[F],R[F],Array.isArray(D)?D[0]:D);var z=s.indexOf(M[F].name);-1!==z&&(u[z]=R[F])}a||Ze(N)}}return g.disposeMasks(),i?u:u[0]}function Lm(t){var e={};for(var n in t)e[n]=t[n].size;return e}function Pm(t,e){for(var n=new Set,r=[],a={},i=0,o=e.names();i<o.length;i++){var s=o[i];n.add(s)}var u=[],c=[];for(u.push(t);u.length>0;){var l=u[u.length-1];if(n.has(l.name))u.pop();else{var p=c[c.length-1]===u.length-1;if(0===l.inputs.length||p)u.pop(),r.push(l),n.add(l.name),p&&c.pop();else{c.push(u.length-1);for(var f=0,h=l.inputs;f<h.length;f++){var d=h[f];null==a[d.name]&&(a[d.name]=new Set),a[d.name].add(l.name),n.has(d.name)||u.push(d)}}}}return{sorted:r,recipientMap:a}}function Vm(t){var e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{for(var n=null,r=0;r<t.sourceLayer.inboundNodes.length;++r)for(var a=0,i=t.sourceLayer.inboundNodes[r].outputTensors;a<i.length;a++)if(i[a].id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}var Wm=function(t){function e(n){var r=t.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=Ed(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],Jf(r.inputs).length!==r.inputs.length)throw new Lf("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map((function(t){return t.name})));Jf(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map((function(t){return t.name}))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var i=0,o=r.outputs;i<o.length;i++){var s=(C=o[i]).sourceLayer,u=C.nodeIndex,c=C.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(c)}for(var l=0,p=r.inputs;l<p.length;l++)s=(C=p[l]).sourceLayer,u=C.nodeIndex,c=C.tensorIndex,Uf(0===u,"input layer has >1 nodes"),Uf(0===c,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(c);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var f=0;f<r.inputLayers.length;f++){if(!((s=r.inputLayers[f])instanceof jd))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+f+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var h=0,d=r.outputLayers;h<d.length;h++)s=d[h],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map((function(t){return t.shape})),r.internalOutputShapes=r.outputs.map((function(t){return t.shape}));for(var m={},v={},g={},y={},b={},w=[],x=function t(n,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=n.sourceLayer,s=n.nodeIndex,u=n.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new Bf("The tensor "+n.name+' at layer "'+o.name+'" is part of a cycle.');if(-1===a.indexOf(c)){r.containerNodes.add(e.nodeKey(o,s)),o.id in b||(b[o.id]=Object.keys(b).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,p=0;p<l;p++){t(c.inputTensors[p],a,i,c.inboundLayers[p],c.nodeIndices[p],c.tensorIndices[p])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);w.push(c)}},k=[],S=[],N=0,E=r.outputs;N<E.length;N++){var C=E[N];x(C,k,S)}for(var T=0,I=w.slice().reverse();T<I.length;T++){v[($=I[T]).id]=$,$.id in m||(m[$.id]=0);var _=m[$.id],A=null==g[$.outboundLayer.id]?0:g[$.outboundLayer.id];for(_=Math.max(_,A),g[$.outboundLayer.id]=_,y[$.outboundLayer.id]=$.outboundLayer,m[$.id]=_,f=0;f<$.inboundLayers.length;f++){var R=$.inboundLayers[f],D=(u=$.nodeIndices[f],R.inboundNodes[u]),O=null==m[D.id]?0:m[D.id];m[D.id]=Math.max(_+1,O),v[D.id]=D}}var M={};for(var F in m)(_=m[F])in M||(M[_]=[]),M[_].push(v[F]);var z={};for(var B in g)(_=g[B])in z||(z[_]=[]),z[_].push(y[B]);var L=Object.keys(z).map((function(t){return parseInt(t,10)})).sort(Qf);r.layers=[];for(var P=0,V=L;P<V.length;P++){var W=z[_=V[P]];W.sort((function(t,e){var n=b[t.id],r=b[e.id];return n<r?-1:n>r?1:0}));for(var U=0,j=W;U<j.length;U++)(s=j[U])instanceof e&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=z,L=Object.keys(M).map((function(t){return parseInt(t,10)})).sort(Qf);for(var H=r.inputs.slice(),q=[],G=0,Z=L;G<Z.length;G++)for(var K=0,X=M[_=Z[G]];K<X.length;K++){var $;if(null!=(s=($=X[K]).outboundLayer)){for(var Y=0,Q=$.inputTensors;Y<Q.length;Y++)if(C=Q[Y],-1===H.indexOf(C))throw new Bf("Graph disconnected: cannot obtain value for tensor "+C+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+q);for(var J=0,tt=$.outputTensors;J<tt.length;J++)C=tt[J],H.push(C);q.push(s.name)}}r.nodesByDepth=M;for(var et=r.layers.map((function(t){return t.name})),nt=function(t){var e=et.filter((function(e){return e===t})).length;if(1!==e)throw new Bf('The name "'+t+'" is used '+e+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(et))},rt=0,at=et;rt<at.length;rt++)nt(at[rt]);return r.outboundNodes=[],r.inboundNodes=[],new Ld({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(t){return null})),outputMasks:r.outputs.map((function(t){return null})),inputShapes:r.inputs.map((function(t){return t.shape})),outputShapes:r.outputs.map((function(t){return t.shape}))}),r.built=!0,r._refCount=1,r}return Af(e,t),e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(var e=0,n=this.layers;e<n.length;e++){var r=n[e];t.numDisposedVariables+=r.dispose().numDisposedVariables}for(var a=0,i=this.internalContainerRefs;a<i.length;a++){var o=i[a];t.numDisposedVariables+=o.dispose().numDisposedVariables}}return t.refCountAfterDispose=this._refCount,t},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach((function(e){e._trainableWeights.forEach((function(e){return e.trainable=t}))})),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new Lf("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e];t=t.concat(r.trainableWeights)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var a=[],i=0,o=this.layers;i<o.length;i++)r=o[i],a.push.apply(a,r.trainableWeights);return a.concat(t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.loadWeights=function(t,e){void 0===e&&(e=!0);for(var n={},r=0,a=0,i=this.layers;a<i.length;a++)for(var o=0,s=i[a].weights;o<s.length;o++){var u=s[o];if(null!=n[u.originalName])throw new Lf("Duplicate weight name: "+u.originalName);n[u.originalName]=u,r++}var c=[];for(var l in t){if(null!=n[l])c.push([n[l],t[l]]);else if(e)throw new Lf("Provided weight data has no target variable: "+l);delete n[l]}if(e){var p=[];for(var f in n)p.push(f);if(p.length>0)throw new Lf(p.length+" of "+r+" weights are not set: "+p)}Md(c)},e.prototype.updatedConfig=function(){var t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers "+Om,e.backend="TensorFlow.js",e},e.prototype.toJSON=function(t,e){void 0===e&&(e=!0);var n=Dm(this.updatedConfig());return e?JSON.stringify(n):n},e.prototype.call=function(t,e){var n=this;return Ge((function(){t=qf(t);for(var r=new Mm,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],t[a]);return Bm(n.outputs,r,e)}))},e.prototype.computeMask=function(t,e){var n=this;return Ge((function(){var r;return t=qf(t),r=null==e?Wf(null,t.length):qf(e),n.runInternalGraph(t,r)[1]}))},e.prototype.computeOutputShape=function(t){var e=Td(t);if(e.length!==this.inputLayers.length)throw new Lf("Invalid inputShape argument "+t+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},r=0;r<e.length;r++){var a=this.inputLayers[r],i=e[r];n[S=a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(Qf);if(o.length>1)for(var s=0,u=o;s<u.length;s++)for(var c=u[s],l=0,p=this.nodesByDepth[c];l<p.length;l++){var f=p[l];if(a=f.outboundLayer,-1===this.inputLayers.map((function(t){return t.id})).indexOf(a.id)){for(var h=[],d=0;d<f.inboundLayers.length;d++){var m=f.inboundLayers[d],v=f.nodeIndices[d],g=f.tensorIndices[d],y=n[S=m.name+"_"+v+"_"+g];h.push(y)}var b=Td(a.computeOutputShape(Hf(h))),w=a.inboundNodes.indexOf(f);for(d=0;d<b.length;d++)n[S=a.name+"_"+w+"_"+d]=b[d]}}var x=[],k=[];for(r=0;r<this.outputLayers.length;r++){a=this.outputLayers[r],w=this.outputLayersNodeIndices[r],g=this.outputLayersTensorIndices[r];var S=a.name+"_"+w+"_"+g;k.push(S)}for(r=0;r<k.length;r++){var N=k[r];Uf(N in n),x.push(n[N])}return Hf(x)},e.prototype.runInternalGraph=function(t,e){null==e&&(e=Wf(null,t.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=t[r],o=e[r];n[a.id]=[i,o]}for(var s=0,u=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(Qf);s<u.length;s++)for(var c=u[s],l=0,p=this.nodesByDepth[c];l<p.length;l++){for(var f=p[l],h=f.outboundLayer,d=f.inputTensors,m=f.outputTensors,v=new Array,g=0,y=d;g<y.length;g++)(a=y[g]).id in n&&v.push(n[a.id]);if(v.length===d.length){var b={},w=void 0,x=void 0,k=void 0,S=void 0;if(null!=f.callArgs&&(b=f.callArgs),1===v.length){var N=v[0],E=N[0],C=N[1];null==b.mask&&(b.mask=C),k=qf(h.call(E,b)),S=qf(h.computeMask(E,C)),w=[E],x=[C]}else w=v.map((function(t){return t[0]})),x=v.map((function(t){return t[1]})),null==b.mask&&(b.mask=x),k=qf(h.call(w,b)),S=qf(h.computeMask(w,x));if(h.activityRegularizer)throw new Pf("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(r=0;r<m.length;++r)a=m[r],i=k[r],o=S[r],n[a.id]=[i,o]}}for(var T=[],I=[],_=[],A=0,R=this.outputs;A<R.length;A++){Uf((a=R[A]).id in n,"Could not compute output "+a.name+" : "+a.id);var D=n[a.id],O=D[0];o=D[1],_.push(O.shape),T.push(O),I.push(o)}return[T,I,_]},e.prototype.buildNodeConversionMap=function(t){for(var n,r={},a=0,i=this.layers;a<i.length;a++){var o=i[a];n=o instanceof e?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=e.nodeKey(o,s);this.containerNodes.has(u)&&(r[u]=n,n+=1)}}return r},e.prototype.getLayer=function(t,e){if(null!=e){if(this.layers.length<=e)throw new Lf("Was asked to retrieve layer at index "+e+", but model only has "+this.layers.length+" layer(s).");return this.layers[e]}if(null==t)throw new Lf("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var a=r[n];if(a.name===t)return a}throw new Lf("No such layer: "+t)},e.prototype.calculateLosses=function(){var t=this;return Ge((function(){for(var n=[],r=0,a=t.layers;r<a.length;r++)for(var i=a[r],o=0;o<i.inboundNodes.length;++o){var s=e.nodeKey(i,o);t.containerNodes.has(s)&&n.push.apply(n,i.calculateLosses())}return n}))},e.prototype.getConfig=function(){for(var t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],a=0,i=this.layers;a<i.length;a++){for(var o=(w=i[a]).getClassName(),s=w.getConfig(),u=[],c=0;c<w.inboundNodes.length;c++){var l=w.inboundNodes[c],p=e.nodeKey(w,c),f={};if(this.containerNodes.has(p)){if(l.callArgs)try{JSON.stringify(l.callArgs),f=l.callArgs}catch(t){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+l.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),f={}}if(l.inboundLayers.length>0){for(var h=[],d=0;d<l.inboundLayers.length;d++){var m=l.inboundLayers[d],v=l.nodeIndices[d],g=l.tensorIndices[d];null==(k=n[e.nodeKey(m,v)])&&(k=0),h.push([m.name,k,g,f])}u.push(h)}}}var y={};y.name=w.name,y.className=o,y.config=s,y.inboundNodes=u,r.push(y)}t.layers=r;var b=[];for(d=0;d<this.inputLayers.length;d++){var w=this.inputLayers[d];v=this.inputLayersNodeIndices[d],p=e.nodeKey(w,v),this.containerNodes.has(p)&&(null!==(k=n[p])&&void 0!==k||(k=0),g=this.inputLayersTensorIndices[d],b.push([w.name,k,g]))}t.inputLayers=b;var x=[];for(d=0;d<this.outputLayers.length;d++){var k;if(w=this.outputLayers[d],v=this.outputLayersNodeIndices[d],p=e.nodeKey(w,v),this.containerNodes.has(p))null!==(k=n[p])&&void 0!==k||(k=0),g=this.outputLayersTensorIndices[d],x.push([w.name,k,g])}return t.outputLayers=x,t},e.fromConfig=function(t,e,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var a={},i={};function o(t,e){t.name in i?i[t.name].push(e):i[t.name]=[e]}function s(t,e){for(var n,r=[],i=0,s=e;i<s.length;i++){var u=s[i],c=u[0],l=u[1],p=u[2];if(n=null==u[3]?{}:u[3],!(c in a))return void o(t,e);var f=a[c];if(f.inboundNodes.length<=l)return void o(t,e);var h=f.inboundNodes[l];r.push(h.outputTensors[p])}r.length>0&&t.apply(Hf(r),n)}function u(t){var n=t.name,i=em(t,null!=e.customObjects?e.customObjects:{});i.setFastWeightInitDuringBuild(r),a[n]=i,t.inboundNodes.forEach((function(t){if(!(t instanceof Array))throw new Lf("Corrupted configuration, expected array for nodeData: "+t);o(i,t)}))}for(var c=e.name,l=e.layers,p=0,f=l;p<f.length;p++)u(m=f[p]);for(;!th(i);)for(var h=0,d=l;h<d.length;h++){var m=d[h];if((_=a[m.name]).name in i){var v=i[_.name];delete i[_.name];for(var g=0,y=v;g<y.length;g++)s(_,y[g])}}for(var b=[],w=[],x=0,k=e.inputLayers;x<k.length;x++){var S=(m=k[x])[0],N=m[1],E=m[2];Uf(S in a);var C=(_=a[S]).inboundNodes[N].outputTensors;b.push(C[E])}for(var T=0,I=e.outputLayers;T<I.length;T++){var _;S=(m=I[T])[0],N=m[1],E=m[2],Uf(S in a),C=(_=a[S]).inboundNodes[N].outputTensors,w.push(C[E])}return new t({inputs:b,outputs:w,name:c})},Object.defineProperty(e.prototype,"stateful",{get:function(){if(this._stateful)throw new Lf("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var t=0,e=this.layers;t<e.length;t++)if(e[t].stateful)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){var t=this;Ge((function(){t.layers.forEach((function(t){t.stateful&&t.resetStates()}))}))},e}(Vd);function Um(t,e){return function(t,e,n){var r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return null}));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided "+n+" is an array of "+t.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){var a=[];return e.forEach((function(e){e in t?a.push(t[e]):a.push(null)})),a}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+e+" keys. Provided "+n+" not understood: "+JSON.stringify(t))}(t,e,"classWeight")}function jm(t,e,n,r){return Of(this,void 0,void 0,(function(){var a,i,o,s,u;return Mf(this,(function(c){switch(c.label){case 0:if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");return null==n?[3,2]:(a=Ge((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+t.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+t.rank+") during handling of class weights. The rank is expected to be 1 or 2.")})),s=(o=Array).from,[4,a.data()]);case 1:return i=s.apply(o,[c.sent()]),Ze(a),u=[],i.forEach((function(t){if(null==n[t])throw new Error("classWeight must contain all classes in the training data. The class "+t+" exists in the data but not in classWeight");u.push(n[t])})),[2,In(u,"float32")];case 2:return[2,null]}}))}))}function Hm(t,e){return Fu(t,e)}function qm(t,e){var n,r,a=e;n=a.xs,r=a.ys,at.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e}));var i=Gm("input",t.inputNames,n),o=Gm("output",t.outputNames,r),s=i[0].shape[0];at.assert(i.length===t.inputs.length,(function(){return"LayersModel has "+t.inputs.length+" inputs, but the dataset provides "+i.length+" inputs.  (Expected input keys: "+JSON.stringify(t.inputNames)+")"})),at.assert(o.length===t.outputs.length,(function(){return"LayersModel has "+t.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(t.outputNames)+")"}));var u=function(e){at.assert(i[e].shape[0]===s,(function(){return"Batch size mismatch: input "+t.inputNames[e]+" has "+i[e].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."}))};for(var c in i)u(c);var l=function(e){at.assert(o[e].shape[0]===s,(function(){return"Batch size mismatch: output "+t.outputNames[e]+" has "+o[e].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."}))};for(var p in o)l(p);return{xs:i,ys:o}}function Gm(t,e,n){if(n instanceof dt)return[n];if(Array.isArray(n))return at.assert(n.length===e.length,(function(){return"Received an array of "+n.length+" Tensors, but expected "+e.length+" to match the "+t+" keys "+e+"."})),n;for(var r=[],a=0,i=e;a<i.length;a++){var o=i[a];if(null==n[o])throw new Lf("The feature data generated by the dataset lacks the required "+t+" key '"+o+"'.");r.push(n[o])}return r}function Zm(t,e,n){return Of(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k,S,N,E,C,T,I,_,A,R,D,O,M,F,z;return Mf(this,(function(B){switch(B.label){case 0:if(r=null!=n.batchesPerEpoch,at.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),at.assert(null!=n,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),at.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs})),at.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch})),at.assert(null==n.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,B.label=1;case 1:return B.trys.push([1,,26,27]),a=null!=n.validationData,i=void 0,o=void 0,a&&(Km(n.validationData)?at.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches})):(s=function(t){if(3===t.length)throw new Pf("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData),i=s.xs,o=s.ys)),u=t.makeTrainFunction(),c=t.getDedupedMetricsNames(),void 0,l=a?c.slice().concat(c.map((function(t){return"val_"+t}))):c.slice(),p=Qd(n.callbacks,n.yieldEvery),f=null==n.verbose?1:n.verbose,h=tm(p,f,n.epochs,null,null,function(t,e){var n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,a,l),d=h.callbackList,m=h.history,d.setModel(t),t.history=m,[4,d.onTrainBegin()];case 2:return B.sent(),t.stopTraining_=!1,v=null==n.initialEpoch?0:n.initialEpoch,[4,e.iterator()];case 3:g=B.sent(),B.label=4;case 4:return v<n.epochs?(y={},[4,d.onEpochBegin(v)]):[3,23];case 5:return B.sent(),b=0,w=0,r?[3,7]:[4,e.iterator()];case 6:g=B.sent(),B.label=7;case 7:return!r||b<n.batchesPerEpoch?[4,g.next()]:[3,21];case 8:return x=B.sent(),r&&x.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):null==x.value?[3,15]:(k=qm(t,x.value),S=k.xs,N=k.ys,(E={}).batch=w,E.size=S[0].shape[0],[4,d.onBatchBegin(w,E)]);case 9:if(B.sent(),C=[],null==n.classWeight)return[3,13];T=Um(n.classWeight,t.outputNames),z=0,B.label=10;case 10:return z<T.length?(_=(I=C).push,[4,jm(N[z],null,T[z])]):[3,13];case 11:_.apply(I,[B.sent()]),B.label=12;case 12:return++z,[3,10];case 13:for(A=S.concat(N).concat(C),R=u(A),Ze(A),z=0;z<c.length;++z)D=c[z],O=R[z],E[D]=O,Ke(O);return[4,d.onBatchEnd(w,E)];case 14:B.sent(),Gd(E),w++,b++,B.label=15;case 15:return(r?b>=n.batchesPerEpoch:x.done)?a?(M=void 0,Km(n.validationData)?(F=qf,[4,t.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return M=F.apply(void 0,[B.sent()]),[3,18];case 17:M=qf(t.evaluate(i,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0})),B.label=18;case 18:for(z=0;z<t.metricsNames.length;++z)y["val_"+t.metricsNames[z]]=M[z];B.label=19;case 19:return[3,21];case 20:return t.stopTraining_?[3,21]:[3,7];case 21:return[4,d.onEpochEnd(v,y)];case 22:return B.sent(),v++,t.stopTraining_?[3,23]:[3,4];case 23:return[4,d.onTrainEnd()];case 24:return B.sent(),[4,t.history.syncData()];case 25:return B.sent(),[2,t.history];case 26:return t.isTraining=!1,[7];case 27:return[2]}}))}))}function Km(t){return"function"==typeof t.iterator}function Xm(t,e,n){return Of(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,p,f;return Mf(this,(function(h){switch(h.label){case 0:if(r=null!=(n=n||{}).batches,a=t.testFunction,i=[],n.verbose>0)throw new Pf("Verbose mode is not implemented yet.");return at.assert(!r||n.batches>0&&Number.isInteger(n.batches),(function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)})),function(t){return"function"==typeof t.next}(e)?(s=e,[3,3]):[3,1];case 1:return[4,e.iterator()];case 2:s=h.sent(),h.label=3;case 3:o=s,u=0,c=0,l=function(){var e;return Mf(this,(function(s){switch(s.label){case 0:return[4,o.next()];case 1:return e=s.sent(),i=Ge((function(){if(e.value){var n=qm(t,e.value),r=n.xs,o=n.ys,s=r.concat(o),l=Ge((function(){return a(s)}));if(Ze(s),0===c)for(var p=0;p<l.length;++p)i.push(Tn(0));var f=s[0].shape[0],h=function(t){var e=l[t],n=i[t];i[t]=Ge((function(){return ku(i[t],Fu(f,e))})),c>0&&Ze(n)};for(p=0;p<l.length;++p)h(p);Ze(l),u+=f,++c}return i})),e.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}}))},h.label=4;case 4:return!r||c<n.batches?[5,l()]:[3,6];case 5:return"break"===h.sent()?[3,6]:[3,4];case 6:for(p=0;p<i.length;++p)f=i[p],i[p]=Cu(i[p],u),Ze(f);return[2,Hf(i)]}}))}))}function $m(t){at.assert(t>0&&Number.isInteger(t),(function(){return"batchSize is required to be a positive integer, but got "+t}))}function Ym(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((function(t){return Ph(t,e,n-e)})):Ph(t,e,n-e)}function Qm(t,e){return Ge((function(){return null==t?null:Array.isArray(t)?t.map((function(t){return Qm(t,e)})):Zh(t,"int32"===e.dtype?e:e.toInt())}))}function Jm(t,e){for(var n=[],r=0,a=null;r<t;)(a=r+e)>=t&&(a=t),n.push([r,a]),r=a;return n}function tv(t,e,n,r,a,i,o,s,u,c,l,p,f,h,d){return Of(this,void 0,void 0,(function(){var m,v,g,y,b,w,x,k;return Mf(this,(function(S){switch(S.label){case 0:if(null==a&&(a=32),null==i&&(i=1),null==l&&(l=!0),null==f&&(f=0),m=!1,null!=u&&null!=c&&(m=!0),null!=d&&(m=!0,null==h))throw new Lf("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(v=t.checkNumSamples(n,a,h,"steps_per_epoch"))&&(g=zh(0,v)),null==o&&(o=1),y=tm(s,o,i,f,v,h,a,m,p),b=y.callbackList,w=y.history,b.setModel(t),t.history=w,[4,b.onTrainBegin()];case 1:S.sent(),t.stopTraining_=!1,x=function(i){var o,s,p,f,d;return Mf(this,(function(y){switch(y.label){case 0:return[4,b.onEpochBegin(i)];case 1:if(y.sent(),o={},null==h)return[3,2];throw new Pf("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===l)throw new Pf("batch shuffling is not implemneted yet");l&&at.shuffle(g),s=In(g),p=Jm(v,a),f=function(i){var l;return Mf(this,(function(f){switch(f.label){case 0:return l={},[4,b.onBatchBegin(i,l)];case 1:return f.sent(),Ge((function(){var f=p[i][0],h=p[i][1],d=Ph(s,f,h-f);l.batch=i,l.size=h-f;for(var v=Qm(n,d),g=e(v),y=0;y<r.length;++y){var b=r[y],w=g[y];l[b]=w,Ke(w)}if(i===p.length-1&&m){var x=t.testLoop(u,c,a);for(y=0;y<r.length;++y)b=r[y],Ke(w=x[y]),o["val_"+b]=w}})),[4,b.onBatchEnd(i,l)];case 2:return f.sent(),Gd(l),t.stopTraining_?[2,"break"]:[2]}}))},d=0,y.label=3;case 3:return d<p.length?[5,f(d)]:[3,6];case 4:if("break"===y.sent())return[3,6];y.label=5;case 5:return++d,[3,3];case 6:s.dispose(),y.label=7;case 7:return[4,b.onEpochEnd(i,o)];case 8:return y.sent(),t.stopTraining_?[2,"break"]:[2]}}))},k=f,S.label=2;case 2:return k<i?[5,x(k)]:[3,5];case 3:if("break"===S.sent())return[3,5];S.label=4;case 4:return++k,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return S.sent(),[4,t.history.syncData()];case 7:return S.sent(),[2,t.history]}}))}))}function ev(t,e,n,r){return void 0===r&&(r={}),Of(this,void 0,void 0,(function(){var a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k,S;return Mf(this,(function(N){switch(N.label){case 0:if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,N.label=1;case 1:return N.trys.push([1,,7,8]),$m(p=null==r.batchSize?32:r.batchSize),!1,[4,t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,false,p)];case 2:if(f=N.sent(),a=f[0],i=f[1],l=f[2],h=!1,d=void 0,!(null!=r.validationData&&r.validationData.length>0))return[3,4];if(h=!0,2!==r.validationData.length)throw 3===r.validationData.length?new Pf("validationData including sample weights is not supported yet."):new Lf("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return o=r.validationData[0],s=r.validationData[1],!0,[4,t.standardizeUserData(o,s,null,null,true,p)];case 3:return m=N.sent(),u=m[0],c=m[1],d=u.concat(c),[3,5];case 4:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(h=!0,v=Math.floor(a[0].shape[0]*(1-r.validationSplit)),g=a[0].shape[0],u=Ym(a,v,g),a=Ym(a,0,v),c=Ym(i,v,g),i=Ym(i,0,v),d=u.concat(c)):null!=r.validationSteps&&(h=!0),N.label=5;case 5:return y=a.concat(i).concat(l),t.checkTrainableWeightsConsistency(),b=t.makeTrainFunction(),w=t.getDedupedMetricsNames(),x=void 0,k=void 0,h?(t.makeTestFunction(),x=t.testFunction,k=w.slice().concat(w.map((function(t){return"val_"+t})))):(x=null,d=[],k=w.slice()),S=Qd(r.callbacks,r.yieldEvery),[4,tv(t,b,y,w,p,r.epochs,r.verbose,S,x,d,r.shuffle,k,r.initialEpoch,null,null)];case 6:return[2,N.sent()];case 7:return t.isTraining=!1,rv(a,e),rv(i,n),rv(u,o),rv(c,s),null!=l&&Ze(l),[7];case 8:return[2]}}))}))}function nv(t){var e=[];t instanceof dt&&(t=[t]);for(var n=0;n<t.length;++n){var r=t[n];if(1===r.rank)e.push(Lh(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function rv(t,e){if(null!=t){var n=[];if(e instanceof dt)n.push(e.id);else if(Array.isArray(e))e.forEach((function(t){return n.push(t.id)}));else if(null!=e)for(var r in e){var a=e[r];n.push(a.id)}var i=[];if(t instanceof dt)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach((function(t){-1===n.indexOf(t.id)&&i.push(t)}));else if(null!=t)for(var o in t){var s=t[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach((function(t){t.isDisposed||t.dispose()}))}}function av(t){return Array.isArray(t)}function iv(t){return!function(t){return t instanceof dt}(t)&&!av(t)}function ov(t,e,n,r,a){if(void 0===r&&(r=!0),void 0===a&&(a=""),null==e||0===e.length){if(null!=t){var i=!1;if(av(t)&&t.length>0)i=!0;else if(iv(t)){for(var o in t)if(t.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new Lf("Error when checking model "+a+" expected no data, but got "+t)}return[]}if(null==t)return e.map((function(t){return null}));var s;if(iv(t)){s=[];for(var u=0,c=e;u<c.length;u++){var l=c[u];if(null==t[l])throw new Lf('No data provided for "'+l+'". Need data for each key in: '+e);s.push(t[l])}}else if(av(t)){if(t.length!==e.length)throw new Lf("Error when checking model "+a+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+t);s=t}else{if(e.length>1)throw new Lf("The model "+a+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+t.shape);s=[t]}if(s=nv(s),null!=n)for(var p=0;p<e.length;++p)if(null!=n[p]){var f=s[p];if(f.shape.length!==n[p].length)throw new Lf("Error when checking "+a+": expected "+e[p]+" to have "+n[p].length+" dimension(s). but got array with shape "+f.shape);for(var h=0;h<n[p].length;++h)if(0!==h||r){var d=f.shape[h],m=n[p][h];if(null!=m&&m>=0&&d!==m)throw new Lf("Error when checking "+a+": expected "+e[p]+" to have shape ["+n[p]+"], but got array with shape ["+f.shape+"].")}}return s}function sv(t,e,n,r,a){var i;if(void 0===r&&(r=!0),void 0===a&&(a=""),Array.isArray(t)){if(t.length!==e.length)throw new Lf("Error when checking model "+a+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+t.length+" Tensors(s).");i=t}else{if(e.length>1)throw new Lf("The model expects "+e.length+" "+a+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(t.shape)+".");i=[t]}if(null!=n)for(var o=0;o<e.length;++o)if(null!=n[o]){var s=i[o];if(s.shape.length!==n[o].length)throw new Lf("Error when checking "+a+": expected "+e[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(0!==u||r){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new Lf("Error when checking "+a+": expected "+e[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}var uv=function(t){function e(e){var n=t.call(this,e)||this;return n.isTraining=!1,n}return Af(e,t),e.prototype.summary=function(t,e,n){if(void 0===n&&(n=console.log),!this.built)throw new Lf("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Cm(this,t,e,n)},e.prototype.compile=function(t){var e=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){var e={Adagrad:function(){return Cf.adagrad(.01)},Adadelta:function(){return Cf.adadelta(1,.95,Ff())},Adam:function(){return Cf.adam(.001,.9,.999,Ff())},Adamax:function(){return Cf.adamax(.002,.9,.999,Ff(),0)},RMSProp:function(){return Cf.rmsprop(.001,.9,0,Ff())},SGD:function(){return Cf.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new Lf("Unknown Optimizer "+t)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof gf))throw new Lf("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Lf("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");var r=t.loss;n=r.map((function(t){return pm(t)}))}else{var a=pm(t.loss);this.outputs.forEach((function(t){n.push(a)}))}else{for(var i in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(i))throw new Lf('Unknown entry in loss dictionary: "'+i+'". Only expected the following keys: '+this.outputNames);for(var o=0,s=this.outputNames;o<s.length;o++){var u=s[o];null==t.loss[u]&&console.warn('Output "'+u+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+u+" during training"),n.push(pm(t.loss[u]))}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],p=this.outputNames[c];this.feedOutputNames.push(p),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var f=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ch("loss",(function(){for(var t=0;t<e.outputs.length;++t)if(-1===f.indexOf(t)){var n=e.lossFunctions[t];e.outputs.length>1&&(e.metricsTensors.push([n,t]),e.metricsNames.push(e.outputNames[t]+"_loss"))}}));var h=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return[]}));var n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map((function(t){return n}));for(var r=[],a=0,i=e;a<i.length;a++){var o=i[a],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}(t.metrics,this.outputNames);Ch("metric",(function(){for(var t=function(t){if(-1!==f.indexOf(t))return"continue";!function(n){for(var r,a,i,o=function(n){if("string"==typeof n&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(n)){var o=e.internalOutputShapes[t];1===o[o.length-1]||e.lossFunctions[t]===um?-1!==["accuracy","acc"].indexOf(n)?a=fm:-1!==["crossentropy","ce"].indexOf(n)&&(a=gm):e.lossFunctions[t]===sm?-1!==["accuracy","acc"].indexOf(n)?a=ym:-1!==["crossentropy","ce"].indexOf(n)&&(a=wm):-1!==["accuracy","acc"].indexOf(n)?a=hm:-1!==["crossentropy","ce"].indexOf(n)&&(a=bm);var s=void 0;-1!==["accuracy","acc"].indexOf(n)?s="acc":-1!==["crossentropy","ce"].indexOf(n)&&(s="ce"),i=a,r=""+s}else{var u=function(t){if("string"==typeof t&&t in xm)return xm[t];if("string"!=typeof t&&null!=t)return t;throw new Lf("Unknown metric "+t)}(n);i=u,r=""+km(n)}var c;Ch(r,(function(){c=i})),function(t,n,r){e.outputNames.length>1&&(n=e.outputNames[t]+"_"+n),e.metricsNames.push(n),e.metricsTensors.push([r,t])}(t,r,c)},s=0,u=n;s<u.length;s++)o(u[s])}(h[t])},n=0;n<e.outputs.length;++n)t(n)})),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,e,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize;$m(r);var a=this.standardizeUserDataXY(t,e,!0,r);try{var i=a[0].concat(a[1]);this.makeTestFunction();var o=this.testFunction;return Hf(this.testLoop(o,i,r,n.verbose,n.steps))}finally{rv(a[0],t),rv(a[1],e)}},e.prototype.evaluateDataset=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){return this.makeTestFunction(),[2,Xm(this,t,e)]}))}))},e.prototype.checkNumSamples=function(t,e,n,r){var a;if(void 0===r&&(r="steps"),null!=n){if(a=null,null!=e)throw new Lf("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+e)}else{if(null==t)throw new Lf("Either the input data should have a defined shape, or "+r+" shoud be specified.");a=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return a},e.prototype.execute=function(t,e){if(Array.isArray(e)&&0===e.length)throw new Lf("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(e),r=n?e:[e],a=this.retrieveSymbolicTensors(r),i=new Mm;if(t instanceof dt&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Lf("The number of inputs provided ("+t.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],t[o])}else for(var s=0,u=this.inputs;s<u.length;s++){var c=u[s],l=t[c.name];if(null==l)throw new Lf("No value is provided for the model's input "+c.name);i.add(c,l)}var p=Bm(a,i);return n?p:p[0]},e.prototype.retrieveSymbolicTensors=function(t){for(var e=Wf(null,t.length),n=t.length,r=0,a=this.layers;r<a.length;r++){for(var i=a[r],o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(t){return t.name})),u=0;u<t.length;++u){var c=s.indexOf(t[u]);if(-1!==c&&(e[u]=o[c],n--),0===n)break}if(0===n)break}if(n>0){var l=[];throw e.forEach((function(e,n){null==e&&l.push(t[n])})),new Lf("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(l))}return e},e.prototype.predictLoop=function(t,e,n){var r=this;return void 0===e&&(e=32),void 0===n&&(n=!1),Ge((function(){var a=r.checkNumSamples(t);if(n)throw new Pf("Verbose predictLoop() is not implemented yet.");for(var i=Jm(a,e),o=r.outputs.map((function(t){return[]})),s=function(e){Ge((function(){var n=i[e][0],a=i[e][1],o=Ym(t,n,a),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:r.inputs[u],value:o[u]});else s.push({key:r.inputs[0],value:o});var c=new Mm(s);return Bm(r.outputs,c)})).forEach((function(t,e){return o[e].push(t)}))},u=0;u<i.length;++u)s(u);return Hf(o.map((function(t){return Un(t,0)})))}))},e.prototype.predict=function(t,e){void 0===e&&(e={});var n=nv(t);sv(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==e.batchSize?32:e.batchSize;return $m(r),this.predictLoop(n,r)}finally{rv(n,t)}},e.prototype.predictOnBatch=function(t){sv(t,this.inputNames,this.feedInputShapes,!0);var e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)},e.prototype.standardizeUserDataXY=function(t,e,n,r){if(void 0===n&&(n=!0),null==this.optimizer_)throw new Bf("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var a=[],i=0;i<this.feedOutputShapes.length;++i){var o=this.feedOutputShapes[i];this.feedLossFns[i]===sm?a.push(o.slice(0,o.length-1).concat([1])):a.push(o)}if(function(t,e,n){var r=Jf(t.map((function(t){return t.shape[0]})));r.sort();var a=Jf(e.map((function(t){return t.shape[0]})));if(a.sort(),r.length>1)throw new Lf("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map((function(t){return t.shape}))));if(a.length>1)throw new Lf("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(t){return t.shape}))));if(r.length>0&&a.length>0&&!at.arraysEqual(r,a))throw new Lf("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+a[0]+" target sample(s).")}(t=ov(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=ov(e,this.feedOutputNames,a,!1,"target")),function(t,e,n){for(var r=[rm,um,om],a=0;a<t.length;++a){var i=t[a],o=e[a],s=n[a];if(null!=o){if(o===om&&1===i.shape[i.shape.length-1])throw new Lf("You are passing a target array of shape "+i.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var p=u[l],f=c[l];if(null!=f&&p!==f)throw new Lf("A target Tensor with shape "+i.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new Lf("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+t[0].shape[0]+" sample(s).");return[t,e]},e.prototype.standardizeUserData=function(t,e,n,r,a,i){return void 0===a&&(a=!0),Of(this,void 0,void 0,(function(){var o,s,u,c,l,p,f,h;return Mf(this,(function(d){switch(d.label){case 0:if(o=this.standardizeUserDataXY(t,e,a,i),s=o[0],u=o[1],null!=n)throw new Error("sample weight is not supported yet.");if(c=null,null==r)return[3,4];l=Um(r,this.outputNames),c=[],p=0,d.label=1;case 1:return p<l.length?(h=(f=c).push,[4,jm(u[p],null,l[p])]):[3,4];case 2:h.apply(f,[d.sent()]),d.label=3;case 3:return++p,[3,1];case 4:return[2,[s,u,c]]}}))}))},e.prototype.testLoop=function(t,e,n,r,a){var i=this;return void 0===r&&(r=0),Ge((function(){var o=i.checkNumSamples(e,n,a,"steps"),s=[];if(r>0)throw new Pf("Verbose mode is not implemented yet.");if(null!=a)throw new Pf("steps mode in testLoop() is not implemented yet");for(var u=Jm(o,n),c=In(zh(0,o)),l=0;l<u.length;++l){var p=u[l][0],f=u[l][1],h=Ph(c,p,f-p),d=Qm(e,h),m=t(d);if(0===l)for(var v=0;v<m.length;++v)s.push(Tn(0));for(v=0;v<m.length;++v){var g=m[v];s[v]=ku(s[v],Fu(f-p,g))}}for(v=0;v<s.length;++v)s[v]=Cu(s[v],o);return s}))},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,e=[],n=0;n<t.length;++n){var r=t[n],a=r;jf(t,r)>1&&(a+="_"+jf(t.slice(0,n),r)),e.push(a)}return e},e.prototype.makeTrainFunction=function(){var t=this;return function(e){var n=[],r=e.slice(0,t.inputs.length),a=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),i=e.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),o=[],s=t.collectedTrainableWeights.map((function(t){return t.read()}));return[t.optimizer_.minimize((function(){for(var e=[],s=0;s<t.inputs.length;++s)e.push({key:t.inputs[s],value:r[s]});var u,c=new Mm(e),l=Bm(t.outputs,c,{training:!0});for(s=0;s<t.lossFunctions.length;++s){var p=(0,t.lossFunctions[s])(a[s],l[s]);null!=i[s]&&(p=Hm(p,i[s]));var f=Zc(p);n.push(f),u=0===s?p:ku(u,p)}for(s=0;s<t.metricsTensors.length;++s){var h=void 0;if(t.outputs.length>1&&s<t.outputs.length)h=n[s];else{var d=t.metricsTensors[s][0],m=t.metricsTensors[s][1];h=Zc(d(a[m],l[m]))}Ke(h),o.push(h)}return u=Zc(u),t.calculateLosses().forEach((function(t){u=ku(u,t)})),u}),!0,s)].concat(o)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(e){return Ge((function(){for(var n,r=[],a=e.slice(0,t.inputs.length),i=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),o=[],s=0;s<t.inputs.length;++s)o.push({key:t.inputs[s],value:a[s]});var u=new Mm(o),c=Bm(t.outputs,u);for(s=0;s<t.lossFunctions.length;++s){var l=t.lossFunctions[s],p=Zc(l(i[s],c[s]));n=0===s?p:ku(n,p),r.push(n)}for(s=0;s<t.metricsTensors.length;++s){var f=t.metricsTensors[s][0],h=t.metricsTensors[s][1],d=Zc(f(i[h],c[h]));r.push(d)}return r}))}},e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),Of(this,void 0,void 0,(function(){return Mf(this,(function(r){return[2,ev(this,t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){return[2,Zm(this,t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return Of(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l;return Mf(this,(function(p){switch(p.label){case 0:return[4,this.standardizeUserData(t,e)];case 1:n=p.sent(),r=n[0],a=n[1],i=this.makeTrainFunction(),o=i(r.concat(a)),s=[],u=0,c=o,p.label=2;case 2:return u<c.length?[4,c[u].data()]:[3,5];case 3:l=p.sent(),s.push(l[0]),p.label=4;case 4:return u++,[3,2];case 5:return Ze(o),[2,Hf(s)]}}))}))},e.prototype.getNamedWeights=function(t){for(var e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||e.push({name:r[i].originalName,tensor:a[i]});return e},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=t.prototype.dispose.call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var n=He().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-He().numTensors}return e},e.prototype.getLossIdentifiers=function(){var t;if("string"==typeof this.loss)t=Gf(this.loss);else if(Array.isArray(this.loss)){for(var e=0,n=this.loss;e<n.length;e++)if("string"!=typeof n[e])throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((function(t){return Gf(t)}))}else{var r=Object.keys(this.loss);t={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!=typeof a[s])throw new Error("Serialization of non-string loss is not supported.");t[s]=Gf(a[s])}}return t},e.prototype.getMetricIdentifiers=function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[Gf(km(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(t){return Gf(km(t))}));var t={};for(var e in this.metrics)t[e]=Gf(km(this.metrics[e]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var e,n,r=em(Rm(t.optimizer_config));if("string"==typeof t.loss)e=Zf(t.loss);else if(Array.isArray(t.loss))e=t.loss.map((function(t){return Zf(t)}));else if(null!=t.loss)for(var a in e={},t.loss)e[a]=Zf(t.loss[a]);if(Array.isArray(t.metrics))n=t.metrics.map((function(t){return Zf(t)}));else if(null!=t.metrics)for(var a in n={},t.metrics)n[a]=Zf(t.metrics[a]);this.compile({loss:e,metrics:n,optimizer:r})},e.prototype.save=function(t,e){return Of(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,p,f;return Mf(this,(function(h){switch(h.label){case 0:if("string"==typeof t){if(0===(n=ef.getSaveHandlers(t)).length)throw new Lf("Cannot find any save handlers for URL '"+t+"'");if(n.length>1)throw new Lf("Found more than one ("+n.length+") save handlers for URL '"+t+"'");t=n[0]}if(null==t.save)throw new Lf("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,ef.encodeWeights(this.getNamedWeights(e))];case 1:return r=h.sent(),!1,null,a=this.toJSON(null,false),i={modelTopology:a,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v"+Om,convertedBy:null},null!=e&&e.includeOptimizer&&null!=this.optimizer?(i.trainingConfig=this.getTrainingConfig(),o="optimizer",p=(l=ef).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,p.apply(l,[h.sent(),o])];case 3:s=h.sent(),u=s.data,c=s.specs,(f=r.specs).push.apply(f,c),r.data=ef.concatenateArrayBuffers([r.data,u]),h.label=4;case 4:return null!=this.userDefinedMetadata&&(!0,Nm(this.userDefinedMetadata,this.name,true),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=r.data,i.weightSpecs=r.specs,[2,t.save(i)]}}))}))},e.prototype.setUserDefinedMetadata=function(t){Nm(t,this.name),this.userDefinedMetadata=t},e.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},e.className="Model",e}(Wm);function cv(t,e,n){return Of(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,p;return Mf(this,(function(f){switch(f.label){case 0:if(null==n&&(n={}),null==t.load)throw new Lf("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,t.load()];case 1:if(r=f.sent(),null!=(a=r.modelTopology).model_config&&(a=a.model_config),i=null==n.strict||n.strict,o=null!=r.weightData&&null!=r.weightSpecs&&i,s=em(Rm(a),e,o),null!=(u=r.trainingConfig)&&s.loadTrainingConfig(u),null!=r.userDefinedMetadata&&s.setUserDefinedMetadata(r.userDefinedMetadata),null==r.weightData)return[3,4];if(null==r.weightSpecs)throw new Lf("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return c=function(t,e){var n=ef.decodeWeights(t,e),r={},a=[];return e.forEach((function(t){"optimizer"===t.group?a.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:a}}(r.weightData,r.weightSpecs),l=c.modelWeights,p=c.optimizerWeights,s.loadWeights(l,i),null!=s.optimizer&&p.length>0?[4,s.optimizer.setWeights(p)]:[3,3];case 2:f.sent(),f.label=3;case 3:Ze(l),Ze(p.map((function(t){return t.tensor}))),f.label=4;case 4:return[2,s]}}))}))}lf.registerClass(uv);var lv=function(t){function e(e){var n=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},n.trainable=!0,n.built=!1,n.name=null!=e.name?e.name:Ed("sequential_"),null!=e.layers)for(var r=0,a=e.layers;r<a.length;r++){var i=a[r];n.add(i)}return n}return Af(e,t),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some((function(t){return t<0})))throw new Lf("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")},e.prototype.add=function(t){var n,r=t instanceof e||t instanceof uv;if(r){if(1!==(n=t).outputs.length)throw new Lf("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new Lf("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new Lf("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=Hd({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(a)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new Lf("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new Lf("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Wd(this.outputs[0])}this.inboundNodes=[],new Ld({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Wf(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(t){return t.shape})),outputShapes:this.outputs[0].shape})}else{var i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,e){return null==this.model&&this.build(),this.model.call(t,e)},e.prototype.build=function(t){if(_d(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new uv({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),t.prototype.countParams.call(this)},e.prototype.summary=function(e,n,r){void 0===r&&(r=console.log),this.built||this.build(),t.prototype.summary.call(this,e,n,r)},e.prototype.setWeights=function(t){null==this.model&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,e,n){if(void 0===n&&(n={}),!this.built)throw new Bf("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)},e.prototype.evaluateDataset=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){if(!this.built)throw new Bf("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,e)]}))}))},e.prototype.predict=function(t,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(t,e)},e.prototype.predictOnBatch=function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return null==this.model?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!0,configurable:!0}),e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),Of(this,void 0,void 0,(function(){return Mf(this,(function(r){if(!this.built)throw new Bf("The model needs to be compiled before being used.");return[2,this.model.fit(t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){if(!this.built)throw new Bf("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return Of(this,void 0,void 0,(function(){return Mf(this,(function(n){return[2,this.model.trainOnBatch(t,e)]}))}))},e.fromConfig=function(t,n,r,a){var i;void 0===r&&(r={}),void 0===a&&(a=!1);var o={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new Lf("Legacy serialization format not supported yet.");i=n}else at.assert(null!=n.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),i=n.layers,delete n.layers,o=n;var s=new t(o);if(!(s instanceof e))throw new Pf("Sequential.fromConfig called on non-Sequential input: "+s);for(var u=0,c=i;u<c.length;u++){var l=em(c[u],void 0,a);a&&l.setFastWeightInitDuringBuild(!0),s.add(l)}return s},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(null==this.model)throw new Lf("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(null==this.model)throw new Lf("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e],a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}return{name:this.name,layers:t}},e.className="Sequential",e}(uv);function pv(t){return new uv(t)}function fv(t){return new lv(t)}function hv(t,e){return null==e&&(e={}),function(t,e){return Of(this,void 0,void 0,(function(){var n;return Mf(this,(function(r){if(null==e&&(e={}),"string"==typeof t){if(0===(n=ef.getLoadHandlers(t,e.onProgress)).length)n.push(ef.browserHTTPRequest(t,e));else if(n.length>1)throw new Lf("Found more than one ("+n.length+") load handlers for URL '"+t+"'");t=n[0]}return[2,cv(t,void 0,e)]}))}))}(t,e)}function dv(t){return Hd(t)}function mv(t,e){Jd.registerCallbackConstructor(t,e)}lf.registerClass(lv);var vv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.getConfig=function(){return{}},e}(lf.Serializable),gv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=1),function(t,e){if(void 0===e&&(e=1),1!==e)throw new Pf("Support for alpha values other than 1 ("+e+") is not implemented yet.");return Qc(t)}(t,e)},e.className="elu",e}(vv);lf.registerClass(gv);var yv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return rl(t)},e.className="selu",e}(vv);lf.registerClass(yv);var bv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return el(t)},e.className="relu",e}(vv);lf.registerClass(bv);var wv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return Ge((function(){return Ru(6,el(t))}))},e.className="relu6",e}(vv);lf.registerClass(wv);var xv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return t},e.className="linear",e}(vv);lf.registerClass(xv);var kv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return Hs(t)},e.className="sigmoid",e}(vv);lf.registerClass(kv);var Sv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return function(t){return Ge((function(){var e=ku(.5,Fu(.2,t));return As(e,0,1)}))}(t)},e.className="hardSigmoid",e}(vv);lf.registerClass(Sv);var Nv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return Ys(t)},e.className="softplus",e}(vv);lf.registerClass(Nv);var Ev=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return function(t){return Ge((function(){return Cu(t,ks(t).add(1))}))}(t)},e.className="softsign",e}(vv);lf.registerClass(Ev);var Cv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t){return eu(t)},e.className="tanh",e}(vv);lf.registerClass(Cv);var Tv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),ra(t,e)},e.className="softmax",e}(vv);lf.registerClass(Tv);var Iv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),aa(t,e)},e.className="logSoftmax",e}(vv);function _v(t){return t.getClassName()}function Av(t,e){return void 0===e&&(e={}),Yf(t,lf.SerializationMap.getMap().classNameMap,e,"activation")}function Rv(t){var e;return null==t?Av(e={className:"linear",config:{}}):"string"==typeof t?((e={}).className=t,e.config={},Av(e)):t instanceof vv?t:Av(t)}function Dv(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}lf.registerClass(Iv);var Ov=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e}(lf.Serializable),Mv=function(t){function e(e){var n=t.call(this)||this;return Dv(e),n.l1=null==e||null==e.l1?.01:e.l1,n.l2=null==e||null==e.l2?.01:e.l2,n.hasL1=0!==n.l1,n.hasL2=0!==n.l2,n}return Af(e,t),e.prototype.apply=function(t){var e=this;return Ge((function(){var n=zn([1]);return e.hasL1&&(n=ku(n,$c(Fu(e.l1,ks(t))))),e.hasL2&&(n=ku(n,$c(Fu(e.l2,Kh(t))))),n.asScalar()}))},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,e){return new t({l1:e.l1,l2:e.l2})},e.className="L1L2",e}(Ov);lf.registerClass(Mv);var Fv={l1l2:"L1L2"};function zv(t){return Xf(t)}function Bv(t,e){return void 0===e&&(e={}),Yf(t,lf.SerializationMap.getMap().classNameMap,e,"regularizer")}function Lv(t){return null==t?null:"string"==typeof t?Bv({className:t in Fv?Fv[t]:t,config:{}}):t instanceof Ov?t:Bv(t)}var Pv=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,null!=e&&(n.maxValue=e.maxValue),n}return Af(e,t),e.prototype.call=function(t,e){t=Id(t);var n=el(t);return null!=this.maxValue&&(n=As(n,0,this.maxValue)),n},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={maxValue:this.maxValue},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ReLU",e}(Vd);lf.registerClass(Pv);var Vv=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_ALPHA=.3,null==e&&(e={}),n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return Af(e,t),e.prototype.call=function(t,e){var n=Id(t);return Jc(n,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LeakyReLU",e}(Vd);lf.registerClass(Vv);var Wv=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),n.supportsMasking=!0,n.alphaInitializer=wd(e.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=Lv(e.alphaRegularizer),n.alphaConstraint=mh(e.alphaConstraint),null==e.sharedAxes)n.sharedAxes=null;else if(Array.isArray(e.sharedAxes))n.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new Lf("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);n.sharedAxes=[e.sharedAxes]}return n}return Af(e,t),e.prototype.build=function(t){var e=(t=_d(t)).slice(1);if(null!=this.sharedAxes)for(var n=0,r=this.sharedAxes;n<r.length;n++)e[(i=r[n])-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<t.length;++i)a[i]=t[i];this.inputSpec=[new Fd({ndim:t.length,axes:a})],this.built=!0},e.prototype.call=function(t,e){return t=Id(t),tl(t,this.alpha.read())},e.prototype.getConfig=function(){var e={alphaInitializer:bd(this.alphaInitializer),alphaRegularizer:zv(this.alphaRegularizer),alphaConstraint:hh(this.alphaConstraint),sharedAxes:this.sharedAxes},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="PReLU",e}(Vd);lf.registerClass(Wv);var Uv=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==n.DEFAULT_ALPHA)throw new Pf("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return Af(e,t),e.prototype.call=function(t,e){var n=Id(t);return Qc(n)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ELU",e}(Vd);lf.registerClass(Uv);var jv=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_THETA=1,null==e&&(e={}),n.theta=null==e.theta?n.DEFAULT_THETA:e.theta,n}return Af(e,t),e.prototype.call=function(t,e){var n=Id(t);return n.mul(Bh(n.greater(this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={theta:this.theta},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ThresholdedReLU",e}(Vd);lf.registerClass(jv);var Hv=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_AXIS=1,null==e&&(e={}),n.softmax=(new Tv).apply,n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n}return Af(e,t),e.prototype.call=function(t,e){var n=Id(t);return this.softmax(n,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Softmax",e}(Vd);function qv(t,e,n){if("number"==typeof t)return Wf(t,e);if(t.length!==e)throw new Lf("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+t.length+" elements.");for(var r=0;r<e;++r){var a=t[r];if(!Rh(a))throw new Lf("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+JSON.stringify(t)+" including a non-integer number "+a)}return t}function Gv(t,e,n,r,a){return void 0===a&&(a=1),null==t?t:(i="same"===n?t:t-(e+(e-1)*(a-1))+1,Math.floor((i+r-1)/r));var i}function Zv(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+Fh([n-e,0]);else{if("same"!==r)throw new Lf("Unsupport padding mode: "+r+".");t*=e}return t}function Kv(t,e){return Ge((function(){return kh(e),"channelsFirst"===e?al(t,[0,2,3,1]):t}))}function Xv(t,e){return Ge((function(){return kh(e),"channelsFirst"===e?al(t,[0,2,3,4,1]):t}))}function $v(t,e,n,r,a,i,o,s){return void 0===r&&(r=[1,1]),void 0===a&&(a="valid"),void 0===s&&(s=null),Ge((function(){if(null==i&&(i="channelsLast"),kh(i),3!==t.rank&&4!==t.rank)throw new Lf("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+t.rank+".");if(3!==e.rank&&4!==e.rank)throw new Lf("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+t.rank+".");var u=Kv(t,i);if("causal"===a)throw new Pf("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=rp.conv2d({x:u,filter:e,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=al(u,[0,3,1,2])),u}))}lf.registerClass(Hv);var Yv=function(t){function e(n,r){var a=t.call(this,r)||this;if(a.bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(r),a.rank=n,rh(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new Pf("Convolution layer for rank other than 1, 2, or 3 ("+a.rank+") is not implemented yet.");if(a.kernelSize=qv(r.kernelSize,n,"kernelSize"),a.strides=qv(null==r.strides?1:r.strides,n,"strides"),a.padding=null==r.padding?"valid":r.padding,Sh(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,kh(a.dataFormat),a.activation=Rv(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=wd(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=mh(r.biasConstraint),a.biasRegularizer=Lv(r.biasRegularizer),a.activityRegularizer=Lv(r.activityRegularizer),a.dilationRate=qv(null==r.dilationRate?1:r.dilationRate,n,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new Lf("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(a.dilationRate));if(2===a.rank){if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new Lf("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(a.dilationRate))}else if(3===a.rank)if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new Lf("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(a.dilationRate));return a}return Af(e,t),e.verifyArgs=function(t){if(Uf("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!nh(t.kernelSize,"number",1,3))throw new Lf("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(t.kernelSize)+".")},e.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:_v(this.activation),useBias:this.useBias,biasInitializer:bd(this.biasInitializer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),biasConstraint:hh(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(Vd),Qv=function(t){function e(n,r){var a=t.call(this,n,r)||this;return a.kernel=null,e.verifyArgs(r),a.filters=r.filters,rh(a.filters,"filters"),a.kernelInitializer=wd(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=mh(r.kernelConstraint),a.kernelRegularizer=Lv(r.kernelRegularizer),a}return Af(e,t),e.prototype.build=function(t){var e;t=_d(t);var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Lf("The channel dimension of the input should be defined. Found "+t[n]);var r=t[n],a=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(e={},e[n]=r,e)}],this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){var e;t=Id(t);var r=null==n.bias?null:n.bias.read(),a=ih(n.activation.getClassName());if(null!=a&&2===n.rank)e=$v(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)e=function(t,e,n,r,a,i,o){return void 0===r&&(r=1),void 0===a&&(a="valid"),void 0===o&&(o=1),Ge((function(){if(null==i&&(i="channelsLast"),kh(i),3!==t.shape.length)throw new Lf("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new Lf("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new Lf("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===i&&(t=al(t,[0,2,1])),"causal"===a)throw new Pf("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=cc(t,e,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=$h(s,n)),s}))}(t,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)e=$v(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Pf("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r,a,i,o){return void 0===r&&(r=[1,1,1]),void 0===a&&(a="valid"),Ge((function(){if(null==i&&(i="channelsLast"),kh(i),4!==t.rank&&5!==t.rank)throw new Lf("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new Lf("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");var s=Xv(t,i);if("causal"===a)throw new Pf("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=pc(s,e,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=$h(s,n)),"channelsFirst"===i&&(s=al(s,[0,4,1,2,3])),s}))}(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(e=n.activation.apply(e))}return e}))},e.prototype.computeOutputShape=function(t){t=_d(t);for(var e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<n.length;++r){var a=Gv(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(a)}var i=[t[0]];return"channelsLast"===this.dataFormat?(i=i.concat(e)).push(this.filters):(i.push(this.filters),i=i.concat(e)),i},e.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:bd(this.kernelInitializer),kernelRegularizer:zv(this.kernelRegularizer),kernelConstraint:hh(this.kernelConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.verifyArgs=function(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new Lf("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))},e}(Yv),Jv=function(t){function e(n){var r=t.call(this,2,n)||this;return e.verifyArgs(n),r}return Af(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!nh(t.kernelSize,"number",1,2))throw new Lf("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv2D",e}(Qv);lf.registerClass(Jv);var tg=function(t){function e(n){var r=t.call(this,3,n)||this;return e.verifyArgs(n),r}return Af(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new Lf("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv3D",e}(Qv);lf.registerClass(tg);var eg=function(t){function e(e){var n=t.call(this,e)||this;if(n.inputSpec=[new Fd({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new Lf("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return Af(e,t),e.prototype.build=function(t){var e;if(4!==(t=_d(t)).length)throw new Lf("Input should have rank 4; Received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Lf("The channel dimension of the inputs should be defined. Found `None`.");var r=t[n],a=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fd({ndim:4,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){var e=Id(t);if(4!==e.shape.length)throw new Lf("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);var r,a,i=e.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var s=i[r],u=i[a],c=n.kernelSize[0],l=n.kernelSize[1],p=n.strides[0],f=n.strides[1],h=[o,Zv(s,p,c,n.padding),Zv(u,f,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=al(e,[0,2,3,1]));var d=yc(e,n.kernel.read(),h,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(d=al(d,[0,3,1,2])),null!=n.bias&&(d=$h(d,n.bias.read(),n.dataFormat)),null!=n.activation&&(d=n.activation.apply(d)),d}))},e.prototype.computeOutputShape=function(t){var e,n,r,a=(t=_d(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3):(e=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[e]=this.filters,a[n]=Zv(a[n],s,i,this.padding),a[r]=Zv(a[r],u,o,this.padding),a},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e.className="Conv2DTranspose",e}(Jv);lf.registerClass(eg);var ng=function(t){function e(e,n){var r=t.call(this,e,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new Lf("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new Lf("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new Lf("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=wd(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=Lv(n.depthwiseRegularizer),r.depthwiseConstraint=mh(n.depthwiseConstraint),r.pointwiseInitializer=wd(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=Lv(n.pointwiseRegularizer),r.pointwiseConstraint=mh(n.pointwiseConstraint),r}return Af(e,t),e.prototype.build=function(t){var e;if((t=_d(t)).length<this.rank+2)throw new Lf("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n]||t[n]<0)throw new Lf("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[n]));for(var r=t[n],a=this.kernelSize.concat([r,this.depthMultiplier]),i=[],o=0;o<this.rank;++o)i.push(1);i.push(r*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Fd({ndim:this.rank+2,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){var e;if(t=Id(t),1===n.rank)throw new Pf("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=al(t,[0,2,3,1])),e=gc(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=$h(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=al(e,[0,3,1,2])),e}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=bd(this.depthwiseInitializer),e.pointwiseInitializer=bd(this.pointwiseInitializer),e.depthwiseRegularizer=zv(this.depthwiseRegularizer),e.pointwiseRegularizer=zv(this.pointwiseRegularizer),e.depthwiseConstraint=hh(this.depthwiseConstraint),e.pointwiseConstraint=hh(this.pointwiseConstraint),e},e.className="SeparableConv",e}(Qv),rg=function(t){function e(e){return t.call(this,2,e)||this}return Af(e,t),e.className="SeparableConv2D",e}(ng);lf.registerClass(rg);var ag=function(t){function e(n){var r=t.call(this,1,n)||this;return e.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return Af(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!nh(t.kernelSize,"number",1,1))throw new Lf("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv1D",e}(Qv);lf.registerClass(ag);var ig=function(t){function e(e){var n=t.call(this,e)||this;return"number"==typeof e.cropping?n.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?n.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:n.cropping=e.cropping,n.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,n.inputSpec=[{ndim:4}],n}return Af(e,t),e.prototype.computeOutputShape=function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,e){var n=this;return Ge((function(){return t=Id(t),"channelsLast"===n.dataFormat?Wh(Wh(t,n.cropping[0][0],t.shape[1]-n.cropping[0][0]-n.cropping[0][1],2),n.cropping[1][0],t.shape[2]-n.cropping[1][1]-n.cropping[1][0],3):Wh(Wh(t,n.cropping[0][0],t.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),n.cropping[1][0],t.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))},e.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Cropping2D",e}(Vd);lf.registerClass(ig);var og=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=null==e.size?n.DEFAULT_SIZE:e.size,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,n}return Af(e,t),e.prototype.computeOutputShape=function(t){if("channelsFirst"===this.dataFormat){var e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}return e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2],[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return Ge((function(){var e=Id(t),r=e.shape;if("channelsFirst"===n.dataFormat){e=al(e,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o=e.resizeNearestNeighbor([a,i]);return al(o,[0,3,1,2])}return a=n.size[0]*r[1],i=n.size[1]*r[2],e.resizeNearestNeighbor([a,i])}))},e.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="UpSampling2D",e}(Vd);lf.registerClass(og);var sg=function(t){function e(e){var n=t.call(this,2,e)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,n.depthwiseInitializer=wd(e.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=mh(e.depthwiseConstraint),n.depthwiseRegularizer=Lv(e.depthwiseRegularizer),n}return Af(e,t),e.prototype.build=function(t){if((t=_d(t)).length<4)throw new Lf("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");var e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new Lf("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[e]+").");var n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){var e=function(t,e,n,r,a,i){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),Ge((function(){null==a&&(a="channelsLast"),kh(a);var o=Kv(t,a);if(4!==t.rank)throw new Lf("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new Lf("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return o=dc(o,e,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=al(o,[0,3,1,2])),o}))}(t=Id(t),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(e=$h(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),e}))},e.prototype.computeOutputShape=function(t){t=_d(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=Gv(e,this.kernelSize[0],this.padding,this.strides[0]),i=Gv(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,a,i]:[t[0],a,i,r]},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=bd(this.depthwiseInitializer),e.depthwiseRegularizer=zv(this.depthwiseRegularizer),e.depthwiseConstraint=hh(this.depthwiseRegularizer),e},e.className="DepthwiseConv2D",e}(Yv);lf.registerClass(sg);var ug=function(t){function e(e){var n=t.call(this,e)||this;return n.rate=Math.max(Math.min(e.rate,1),0),n.noiseShape=e.noiseShape,n.seed=e.seed,n.supportsMasking=!0,n}return Af(e,t),e.prototype.getNoiseShape=function(t){if(null==this.noiseShape)return this.noiseShape;for(var e=t.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t);if(0<n.rate&&n.rate<1){var a=null!=e.training&&e.training,i=n.getNoiseShape(r);return Qh((function(){return Yh(r,n.rate,i,n.seed)}),(function(){return r}),a)}return t}))},e.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.dispose=function(){return t.prototype.dispose.call(this)},e.className="Dropout",e}(Vd);lf.registerClass(ug);var cg=function(t){function e(e){var n=t.call(this,e)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=[r,e.inputDim]}return n.units=e.units,rh(n.units,"units"),n.activation=Rv(e.activation),null!=e.useBias&&(n.useBias=e.useBias),n.kernelInitializer=wd(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=wd(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=mh(e.kernelConstraint),n.biasConstraint=mh(e.biasConstraint),n.kernelRegularizer=Lv(e.kernelRegularizer),n.biasRegularizer=Lv(e.biasRegularizer),n.activityRegularizer=Lv(e.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return Af(e,t),e.prototype.build=function(t){var e,n=(t=_d(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(e={},e[-1]=n,e)}],this.built=!0},e.prototype.computeOutputShape=function(t){var e=(t=_d(t)).slice();return e[e.length-1]=this.units,e},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r,a=Id(t),i=ih(n.activation.getClassName());return null!=i?r=Gh(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=Gh(a,n.kernel.read()),null!=n.bias&&(r=$h(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))},e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),biasInitializer:bd(this.biasInitializer),kernelRegularizer:zv(this.kernelRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),biasConstraint:hh(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dense",e}(Vd);lf.registerClass(cg);var lg=function(t){function e(e){var n=t.call(this,e||{})||this;return n.inputSpec=[{minNDim:3}],n}return Af(e,t),e.prototype.computeOutputShape=function(t){for(var e=0,n=(t=_d(t)).slice(1);e<n.length;e++)if(null==n[e])throw new Lf('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],Dh(t,1)]},e.prototype.call=function(t,e){var n=this;return Ge((function(){return n.invokeCallHook(t,e),function(t){if(t.rank<=1)throw new Lf("batchFlatten requires a minimum rank of 2. Got rank: "+t.rank+".");var e=[t.shape[0],Dh(t.shape,1)];return t.reshape(e)}(Id(t))}))},e.className="Flatten",e}(Vd);lf.registerClass(lg);var pg=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.activation=Rv(e.activation),n}return Af(e,t),e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t);return n.activation.apply(r)}))},e.prototype.getConfig=function(){var e={activation:_v(this.activation)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Activation",e}(Vd);lf.registerClass(pg);var fg=function(t){function e(e){var n=t.call(this,e)||this;return n.n=e.n,n.inputSpec=[{ndim:2}],n}return Af(e,t),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,e){var n=this;return Ge((function(){return function(t,e){return Ge((function(){if(2!==t.shape.length)throw new Lf("repeat() expects a rank-2 tensor, but received a rank-"+t.shape.length+" tensor.");return Hh(Lh(t,1),[1,e,1])}))}(t=Id(t),n.n)}))},e.prototype.getConfig=function(){var e={n:this.n},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="RepeatVector",e}(Vd);lf.registerClass(fg);var hg=function(t){function e(e){var n=t.call(this,e)||this;n.targetShape=e.targetShape;for(var r=0;r<n.targetShape.length;++r)n.isUnknown(n.targetShape[r])&&(n.targetShape[r]=null);return n}return Af(e,t),e.prototype.isUnknown=function(t){return t<0||null==t},e.prototype.fixUnknownDimension=function(t,e){for(var n="Total size of new array must be unchanged.",r=e.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new Lf("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=Dh(t);if(null!==i){if(0===a||u%a!=0)throw new Lf(n);r[i]=u/a}else if(u!==a)throw new Lf(n);return r},e.prototype.computeOutputShape=function(t){for(var e=!1,n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))},e.prototype.getConfig=function(){var e={targetShape:this.targetShape},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Reshape",e}(Vd);lf.registerClass(hg);var dg=function(t){function e(e){var n=t.call(this,e)||this;if(null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var r=zh(1,e.dims.length+1);if(!at.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=e.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new Fd({ndim:n.dims.length+1})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){var e=(t=_d(t)).slice();return this.dims.forEach((function(n,r){e[r+1]=t[n]})),e},e.prototype.call=function(t,e){return al(Id(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var e={dims:this.dims},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Permute",e}(Vd);lf.registerClass(dg);var mg=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,n.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,n}return Af(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,e),n},e.prototype.computeMask=function(t,e){var n=Id(t);return Uc(Ju(n,this.maskValue),-1)},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t),a=Uc(Ju(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))},e.className="Masking",e}(Vd);lf.registerClass(mg);var vg=function(t){function e(e){var n=t.call(this,e)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var r=null;null!=e.batchSize&&(r=e.batchSize),null==e.inputLength?n.batchInputShape=[r,null]:n.batchInputShape=[r].concat(qf(e.inputLength))}return n.inputDim=e.inputDim,rh(n.inputDim,"inputDim"),n.outputDim=e.outputDim,rh(n.outputDim,"outputDim"),n.embeddingsInitializer=wd(e.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=Lv(e.embeddingsRegularizer),n.activityRegularizer=Lv(e.activityRegularizer),n.embeddingsConstraint=mh(e.embeddingsConstraint),n.maskZero=e.maskZero,n.supportsMasking=e.maskZero,n.inputLength=e.inputLength,n}return Af(e,t),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,e){var n=this;return Ge((function(){return n.maskZero?(t=Id(t),Ju(t,Wn(t))):null}))},e.prototype.computeOutputShape=function(t){if(t=_d(t),null==this.inputLength)return t.concat([this.outputDim]);var e=qf(this.inputLength);if(e.length!==t.length-1)throw new Lf('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(var n=0,r=0;r<e.length;++r){var a=e[r],i=t[r+1];if(null!=a&&null!=i&&a!==i)throw new Lf('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);null==a&&(e[n]=i),n++}return[t[0]].concat(e,[this.outputDim])},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t);return"int32"!==r.dtype&&(r=Bh(r,"int32")),Zh(n.embeddings.read(),r.as1D()).reshape(_d(n.computeOutputShape(r.shape)))}))},e.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:bd(this.embeddingsInitializer),embeddingsRegularizer:zv(this.embeddingsRegularizer),activityRegularizer:zv(this.activityRegularizer),embeddingsConstraint:hh(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Embedding",e}(Vd);lf.registerClass(vg);var gg=function(t){function e(e){var n=t.call(this,e||{})||this;return n.supportsMasking=!0,n}return Af(e,t),e.prototype.mergeFunction=function(t){throw new Pf},e.prototype.computeElementwiseOpOutputShape=function(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(var n=t.slice(0,t.length-e.length),r=0;r<e.length;++r){var a=t[t.length-e.length+r],i=e[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new Lf("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(a)}}return n},e.prototype.build=function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[_d(t)]),t.length<2)throw new Lf("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(var e=[],n=0,r=t;n<r.length;n++)null!=(o=r[n])&&null!==o[0]&&e.push(o[0]);if((e=Jf(e)).length>1)throw new Lf("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(var a=null==t[0]?null:t[0].slice(1),i=1;i<t.length;++i){var o=null==t[i]?null:t[i].slice(1);a=this.computeElementwiseOpOutputShape(a,o)}var s=t.map((function(t){return t.length}));-1===t.indexOf(null)&&1===Jf(s).length?this.reshapeRequired=!1:this.reshapeRequired=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){if(n.reshapeRequired){var e=[],r=t.map((function(t){return t.rank}));if(-1===r.indexOf(null)){for(var a=Fh(r),i=0,o=t;i<o.length;i++){for(var s=(f=o[i]).rank,u=0;u<a-s;++u)f=Lh(f,1);e.push(f)}return n.mergeFunction(e)}for(var c=!1,l=0,p=t;l<p.length;l++){var f;if(null==(s=(f=p[l]).rank)){var h=f.shape,d=h[0],m=h.slice(1).concat([d]),v=f.reshape([d].concat(Dh(h.slice(1))));v=(v=al(v,[1,0])).reshape(m),e.push(v),c=!0}else if(s>1){var g=zh(1,s).concat([0]);e.push(al(f,g)),c=!0}else e.push(f)}var y=n.mergeFunction(e),b=y.rank;if(c)if(null==b){var w=y.shape;m=[d=w[w.length-1]].concat(w.slice(0,w.length-1)),y=al(y.reshape([-1,d]),[1,0]).reshape(m)}else b>1&&(g=[b-1].concat(zh(0,b-1)),y=al(y,g));return y}return n.mergeFunction(t)}))},e.prototype.computeOutputShape=function(t){var e;e=null==t[0]?null:t[0].slice(1);for(var n=1;n<t.length;++n){var r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}for(var a=[],i=0,o=t;i<o.length;i++)null!=(r=o[i])&&null!==r[0]&&a.push(r[0]);return 1===(a=Jf(a)).length?a.concat(e):[null].concat(e)},e.prototype.computeMask=function(t,e){return Ge((function(){if(null==e)return null;if(!Array.isArray(e))throw new Lf("`mask` should be an Array");if(!Array.isArray(t))throw new Lf("`inputs` should be an Array");if(e.length!==t.length)throw new Lf("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+t.length+" vs "+e.length+")");if(e.every((function(t){return null==t})))return null;for(var n=(e=e.map((function(t){return null==t?t:hr(t,0)})))[0],r=1;r<e.length-1;++r)n=vu(n,e[r]);return n}))},e}(Vd),yg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.mergeFunction=function(t){return Ge((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=ku(e,t[n]);return e}))},e.className="Add",e}(gg);lf.registerClass(yg);var bg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.mergeFunction=function(t){return Ge((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Fu(e,t[n]);return e}))},e.className="Multiply",e}(gg);lf.registerClass(bg);var wg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.mergeFunction=function(t){return Ge((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=ku(e,t[n]);return Fu(1/t.length,e)}))},e.className="Average",e}(gg);lf.registerClass(wg);var xg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.mergeFunction=function(t){return Ge((function(){for(var e=t[0],n=1;n<t.length;++n)e=_u(e,t[n]);return e}))},e.className="Maximum",e}(gg);lf.registerClass(xg);var kg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.mergeFunction=function(t){return Ge((function(){for(var e=t[0],n=1;n<t.length;++n)e=Ru(e,t[n]);return e}))},e.className="Minimum",e}(gg);lf.registerClass(kg);var Sg=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_AXIS=-1,null==e&&(e={}),n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return Af(e,t),e.prototype.build=function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new Lf("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var e=!0,n=0,r=t;n<r.length;n++)if(null!=(l=r[n])){e=!1;break}if(!e){for(var a=[],i=0;i<t.length;++i){var o=t[i].slice();o.splice(this.axis,1);for(var s=!1,u=0,c=a;u<c.length;u++){var l=c[u];if(at.arraysEqual(l,o)){s=!0;break}}s||a.push(o)}if(a.length>1)throw new Lf("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var e=this;return Ge((function(){return Uh(t,e.axis)}))},e.prototype.computeOutputShape=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Lf("A `Concatenate` layer should be called on a list of inputs.");for(var e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,a=0,i=e.slice(1);a<i.length;a++){var o=i[a];if(null==n[r]||null==o[r]){n[r]=null;break}n[r]+=o[r]}return n},e.prototype.computeMask=function(t,e){var n=this;if(null==e)return null;if(!Array.isArray(e))throw new Lf("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Lf("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new Lf("Mismatch in the length of mask ("+e.length+") and the legnth of inputs ("+t.length+")");return Ge((function(){var r=!0;if(e.forEach((function(t){null==t||(r=!1)})),r)return null;for(var a=[],i=0;i<t.length;++i)null==e[i]?a.push(Vn(t[i]).asType("bool")):e[i].rank<t[i].rank?a.push(hr(e[i],-1)):a.push(e[i]);var o=Un(a,n.axis);return Wc(o,-1,!1)}))},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Concatenate",e}(gg);function Ng(t,e){for(;t<0;)t+=e;return t}lf.registerClass(Sg);var Eg=function(t){function e(e){var n=t.call(this,e)||this;return n.axes=e.axes,n.normalize=null!=e.normalize&&e.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return Af(e,t),e.prototype.build=function(t){at.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0],n=t[1];if(e.length>3||n.length>3)throw new Pf("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new Lf("Dimension incompatibility: "+e[r[0]]+" !== "+n[r[1]])},e.prototype.mergeFunction=function(t){if(2!==t.length)throw new Lf("A `Dot` layer must be called on exactly 2 inputs, but received "+t.length+" input(s).");var e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((function(e,n){return Ng(e,t[n].shape.length)})):[Ng(this.axes,n.shape.length),Ng(this.axes,r.shape.length)],this.normalize&&(n=nm(n,e[0]),r=nm(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Pf("batchDot is not implemented for tensors of 4D or higher rank yet");if(at.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, but got "+t.shape.length})),at.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, but got "+e.shape.length})),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new Pf("batchDot is not implemented for complex64-type Tensors yet.");var r=t.shape.length,a=e.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return Ge((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);e=e.reshape(e.shape.concat(s))}else if(a>r){for(n=a-r,s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else n=0;if(2===t.shape.length&&2===e.shape.length)o=i[0]===i[1]?t.mulStrict(e).sum(i[0]):t.transpose([1,0]).mulStrict(e).sum(i[1]);else{var c=i[0]!==t.shape.length-1,l=i[1]===e.shape.length-1;o=t.matMul(e,c,l)}if(n>0){var p,f=[];for(u=p=r>a?r+a-3:r-1;u<p+n;++u)f.push(u);o=o.squeeze(f)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,r,e)},e.prototype.interpretAxes=function(t,e){return Array.isArray(this.axes)?this.axes:[Ng(this.axes,t.length),Ng(this.axes,e.length)]},e.prototype.computeOutputShape=function(t){at.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new Pf("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=e.concat(n);return 1===a.length&&a.push(1),a},e.prototype.computeMask=function(t,e){return null},e.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dot",e}(gg);lf.registerClass(Eg);var Cg=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.stddev=e.stddev,n}return Af(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t);return Qh((function(){return qh(r.shape,0,n.stddev).add(r)}),(function(){return r}),e.training||!1)}))},e.className="GaussianNoise",e}(Vd);lf.registerClass(Cg);var Tg=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n}return Af(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e);var r=Id(t);return n.rate>0&&n.rate<1?Qh((function(){var t=Math.sqrt(n.rate/(1-n.rate));return r.mul(qh(r.shape,1,t))}),(function(){return r}),e.training||!1):r}))},e.className="GaussianDropout",e}(Vd);lf.registerClass(Tg);var Ig=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n.noiseShape=e.noiseShape,n}return Af(e,t),e.prototype._getNoiseShape=function(t){return this.noiseShape||Id(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Ge((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(t);return Qh((function(){var e=Id(t),a=-1.7580993408473766,i=Gu(Er(r),n.rate);i=Bh(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate;return e.mul(i).add(i.add(-1).mul(a)).mul(o).add(s)}),(function(){return Id(t)}),e.training||!1)}return t}))},e.className="AlphaDropout",e}(Vd);function _g(t,e,n,r,a,i){var o;if(void 0===i&&(i=.001),2===t.rank)o=hu(t,e,n,r,a,i);else if(3===t.rank)o=du(t,e,n,r,a,i);else{if(4!==t.rank)throw new Pf("batchNormalization is not implemented for array of rank "+t.rank+" yet");o=mu(t,e,n,r,a,i)}return o}function Ag(t,e,n,r,a){return void 0===a&&(a=.001),at.arraysEqual(r.slice().sort(),zh(0,t.rank-1))?function(t,e,n,r,a){return void 0===a&&(a=.001),Ge((function(){var i=Xc(t,r),o=i.mean,s=i.variance;return[_g(t,o,s,n,e,a),o,s]}))}(t,e,n,r,a):function(t,e,n,r,a){return void 0===a&&(a=.001),Ge((function(){for(var i=Xc(t,r),o=i.mean,s=i.variance,u=[],c=0,l=zh(0,t.rank);c<l.length;c++){var p=l[c];-1!==r.indexOf(p)?u.push(1):u.push(t.shape[p])}var f=o.reshape(u),h=s.reshape(u),d=null==e?null:e.reshape(u),m=null==n?null:n.reshape(u);return[_g(t,f,h,m,d,a),o,s]}))}(t,e,n,r,a)}lf.registerClass(Ig);var Rg=function(t){function e(e){var n=this;return null==e&&(e={}),(n=t.call(this,e)||this).supportsMasking=!0,n.axis=null==e.axis?-1:e.axis,n.momentum=null==e.momentum?.99:e.momentum,n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=wd(e.betaInitializer||"zeros"),n.gammaInitializer=wd(e.gammaInitializer||"ones"),n.movingMeanInitializer=wd(e.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=wd(e.movingVarianceInitializer||"ones"),n.betaConstraint=mh(e.betaConstraint),n.gammaConstraint=mh(e.gammaConstraint),n.betaRegularizer=Lv(e.betaRegularizer),n.gammaRegularizer=Lv(e.gammaRegularizer),n}return Af(e,t),e.prototype.build=function(t){var e;t=_d(t);var n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(null==r)throw new Lf("Axis "+n+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new Fd({ndim:t.length,axes:(e={},e[n]=r,e)})];var a=[r];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){var r=null!=e.training&&e.training,a=Id(t),i=a.shape,o=i.length,s=zh(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var c=Wf(1,o);c[u]=i[u];var l=s.slice();l.sort();var p=!at.arraysEqual(l,zh(0,o).slice(0,o-1));if(!r)return function(){if(p){var t=n.movingMean.read().reshape(c),e=n.movingVariance.read().reshape(c),r=n.center?n.beta.read().reshape(c):null,i=n.scale?n.gamma.read().reshape(c):null;return _g(a,t,e,r,i,n.epsilon)}return _g(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var f=Ag(a,n.gamma.read(),n.beta.read(),s,n.epsilon),h=f[0],d=f[1],m=f[2],v=function(t,e,n){Ge((function(){var r=1-n,a=t.read(),i=a.sub(e).mul(r);t.write(a.sub(i))}))};return v(n.movingMean,d,n.momentum),v(n.movingVariance,m,n.momentum),h}))},e.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:bd(this.betaInitializer),gammaInitializer:bd(this.gammaInitializer),movingMeanInitializer:bd(this.movingMeanInitializer),movingVarianceInitializer:bd(this.movingVarianceInitializer),betaRegularizer:zv(this.betaRegularizer),gammaRegularizer:zv(this.gammaRegularizer),betaConstraint:hh(this.betaConstraint),gammaConstraint:hh(this.gammaConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="BatchNormalization",e}(Vd);lf.registerClass(Rg);var Dg=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).axis=null==e.axis?-1:e.axis,"number"==typeof n.axis){if(!Number.isInteger(n.axis))throw new Error("Expected axis to be an integer, but received "+n.axis)}else{if(!Array.isArray(n.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(n.axis));for(var r=0,a=n.axis;r<a.length;r++){var i=a[r];if(!Number.isInteger(i))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(n.axis))}}return n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=wd(e.betaInitializer||"zeros"),n.gammaInitializer=wd(e.gammaInitializer||"ones"),n.betaRegularizer=Lv(e.betaRegularizer),n.gammaRegularizer=Lv(e.gammaRegularizer),n.supportsMasking=!0,n}return Af(e,t),e.prototype.build=function(t){var e=(t=_d(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=e);for(var r=0,a=this.axis;r<a.length;r++){var i=a[r];if(i<0||i>=e)throw new Error("Invalid axis: "+i)}if(this.axis.length!==Jf(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var o=this.axis.map((function(e){return t[e]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},e.prototype.call=function(t,e){var n=this,r=Id(t),a=r.shape,i=a.length;return Ge((function(){for(var t=Xc(r,n.axis,!0),e=t.mean,o=t.variance,s=Wf(1,i),u=0,c=n.axis;u<c.length;u++){var l=c[u];s[l]=a[l]}for(var p=function(t){return null!=t&&t.shape.length!==i&&n.axis!==[i-1]?t.reshape(s):t},f=p(n.gamma.read()),h=p(n.beta.read()),d=[],m=[],v=0;v<i;++v)-1!==n.axis.indexOf(v)?(d.push(a[v]),m.push(1)):(d.push(1),m.push(a[v]));return e=e.tile(d),o=o.tile(d),f=f.tile(m),h=h.tile(m),_g(r,e,o,h,f,n.epsilon)}))},e.prototype.getConfig=function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:bd(this.betaInitializer),gammaInitializer:bd(this.gammaInitializer),betaRegularizer:zv(this.betaRegularizer),gammaRegularizer:zv(this.gammaRegularizer)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LayerNormalization",e}(Vd);lf.registerClass(Dg);var Og=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)n.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Lf("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");var r=void 0,a=void 0;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],a=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Lf("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(r=e.padding[0],2!==e.padding[1].length)throw new Lf("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");a=e.padding[1]}n.padding=[r,a]}return n.inputSpec=[new Fd({ndim:4})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){var e,n;return t=_d(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])},e.prototype.call=function(t,e){var n=this;return Ge((function(){return function(t,e,n){return Ge((function(){if(4!==t.rank)throw new Lf("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new Lf("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new Lf("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],gr(t,r)}))}(Id(t),n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ZeroPadding2D",e}(Vd);function Mg(t,e,n,r,a,i){return Ge((function(){var o;kh(a),Nh(i),Sh(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),t=Kv(t,a);var s="same"===r?"same":"valid";return o="max"===i?Ac(t,e,n,s):Rc(t,e,n,s),"channelsFirst"===a&&(o=al(o,[0,3,1,2])),o}))}function Fg(t,e,n,r,a,i){return Ge((function(){var o;kh(a),Nh(i),Sh(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),t=Xv(t,a);var s="same"===r?"same":"valid";return o="max"===i?Oc(t,e,n,s):Mc(t,e,n,s),"channelsFirst"===a&&(o=al(o,[0,4,1,2,3])),o}))}lf.registerClass(Og);var zg=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=2),n=t.call(this,e)||this,"number"==typeof e.poolSize)n.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new Lf("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));n.poolSize=e.poolSize}if(rh(n.poolSize,"poolSize"),null==e.strides)n.strides=n.poolSize;else if("number"==typeof e.strides)n.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new Lf("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));n.strides=e.strides}return rh(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,Sh(n.padding),n.inputSpec=[new Fd({ndim:3})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){var e=Gv((t=_d(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]},e.prototype.call=function(t,e){var n=this;return Ge((function(){n.invokeCallHook(t,e),t=Lh(Id(t),2);var r=n.poolingFunction(Id(t),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Ir(r,[2])}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(Vd),Bg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.poolingFunction=function(t,e,n,r,a){return kh(a),Sh(r),Mg(t,e,n,r,a,"max")},e.className="MaxPooling1D",e}(zg);lf.registerClass(Bg);var Lg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.poolingFunction=function(t,e,n,r,a){return kh(a),Sh(r),Mg(t,e,n,r,a,"avg")},e.className="AveragePooling1D",e}(zg);lf.registerClass(Lg);var Pg=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Lf("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides];return rh(n.poolSize,"poolSize"),rh(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kh(n.dataFormat),Sh(n.padding),n.inputSpec=[new Fd({ndim:4})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){t=_d(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Gv(e,this.poolSize[0],this.padding,this.strides[0]),n=Gv(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return Ge((function(){return n.invokeCallHook(t,e),n.poolingFunction(Id(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(Vd),Vg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.poolingFunction=function(t,e,n,r,a){return kh(a),Sh(r),Mg(t,e,n,r,a,"max")},e.className="MaxPooling2D",e}(Pg);lf.registerClass(Vg);var Wg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.poolingFunction=function(t,e,n,r,a){return kh(a),Sh(r),Mg(t,e,n,r,a,"avg")},e.className="AveragePooling2D",e}(Pg);lf.registerClass(Wg);var Ug=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Lf("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides,e.strides];return rh(n.poolSize,"poolSize"),rh(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kh(n.dataFormat),Sh(n.padding),n.inputSpec=[new Fd({ndim:5})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){t=_d(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Gv(e,this.poolSize[0],this.padding,this.strides[0]),n=Gv(n,this.poolSize[1],this.padding,this.strides[1]),r=Gv(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]},e.prototype.call=function(t,e){var n=this;return Ge((function(){return n.invokeCallHook(t,e),n.poolingFunction(Id(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(Vd),jg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.poolingFunction=function(t,e,n,r,a){return kh(a),Sh(r),Fg(t,e,n,r,a,"max")},e.className="MaxPooling3D",e}(Ug);lf.registerClass(jg);var Hg=function(t){function e(e){return t.call(this,e)||this}return Af(e,t),e.prototype.poolingFunction=function(t,e,n,r,a){return kh(a),Sh(r),Fg(t,e,n,r,a,"avg")},e.className="AveragePooling3D",e}(Ug);lf.registerClass(Hg);var qg=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[new Fd({ndim:3})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,e){throw new Pf},e}(Vd),Gg=function(t){function e(e){return t.call(this,e||{})||this}return Af(e,t),e.prototype.call=function(t,e){return Ge((function(){var e=Id(t);return Zc(e,1)}))},e.className="GlobalAveragePooling1D",e}(qg);lf.registerClass(Gg);var Zg=function(t){function e(e){return t.call(this,e||{})||this}return Af(e,t),e.prototype.call=function(t,e){return Ge((function(){var e=Id(t);return Gc(e,1)}))},e.className="GlobalMaxPooling1D",e}(qg);lf.registerClass(Zg);var Kg=function(t){function e(e){var n=t.call(this,e)||this;return n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kh(n.dataFormat),n.inputSpec=[new Fd({ndim:4})],n}return Af(e,t),e.prototype.computeOutputShape=function(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,e){throw new Pf},e.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(Vd),Xg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.call=function(t,e){var n=this;return Ge((function(){var e=Id(t);return"channelsLast"===n.dataFormat?Zc(e,[1,2]):Zc(e,[2,3])}))},e.className="GlobalAveragePooling2D",e}(Kg);lf.registerClass(Xg);var $g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.call=function(t,e){var n=this;return Ge((function(){var e=Id(t);return"channelsLast"===n.dataFormat?Gc(e,[1,2]):Gc(e,[2,3])}))},e.className="GlobalMaxPooling2D",e}(Kg);function Yg(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new Lf("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function a(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=a(e),constants:n=a(n)}}function Qg(t,e,n,r,a,i,o,s){return void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),Ge((function(){var u=e.shape.length;if(u<3)throw new Lf("Input should be at least 3D, but is "+u+"D.");var c=[1,0].concat(zh(2,u));if(e=al(e,c),null!=i)throw new Pf("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===u-1&&(a=hr(a,-1)),a=al(a,c)),r&&(e=Sc(e,0),null!=a&&(a=Sc(a,0)));var l,p,f=[],h=n,d=e.shape[0],m=Dr(e);null!=a&&(p=Dr(a));for(var v,g=function(e){var n=m[e],r=Ge((function(){return t(n,h)}));if(null==a)l=r[0],h=r[1];else{var i=Ge((function(){var t=p[e],n=Vn(t).sub(t);return{output:r[0].mul(t).addStrict(h[0].mul(n)),newStates:h.map((function(e,a){return r[1][a].mul(t).addStrict(e.mul(n))}))}}));l=i.output,h=i.newStates}s&&f.push(l)},y=0;y<d;++y)g(y);return s&&(v=_r(f,1)),[l,v,h]}))}lf.registerClass($g);var Jg=function(t){function e(e){var n,r=t.call(this,e)||this;if(null==e.cell)throw new Lf("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(e.cell)?new sy({cells:e.cell}):e.cell).stateSize)throw new Lf("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new Fd({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return Af(e,t),e.prototype.getStates=function(){return null==this.states_?zh(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(t){return null})):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){Cd(t)&&(t=t[0]);var e=this.cell.stateSize;Array.isArray(e)||(e=[e]);var n,r=e[0];if(n=this.returnSequences?[t[0],t[1],r]:[t[0],r],this.returnState){for(var a=[],i=0,o=e;i<o.length;i++){var s=o[i];a.push([t[0],s])}return[n].concat(a)}return n},e.prototype.computeMask=function(t,e){var n=this;return Ge((function(){Array.isArray(e)&&(e=e[0]);var t=n.returnSequences?e:null;if(n.returnState){var r=n.states.map((function(t){return null}));return[t].concat(r)}return t}))},Object.defineProperty(e.prototype,"states",{get:function(){if(null==this.states_){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[],n=0;n<t;++n)e.push(null);return e}return this.states_},set:function(t){this.states_=t},enumerable:!0,configurable:!0}),e.prototype.build=function(t){if(null!=this.numConstants)throw new Pf("Constants support is not implemented in RNN yet.");Cd(t)&&(t=t[0]);var e=this.stateful?t[0]:null,n=t[t.length-1];this.inputSpec[0]=new Fd({shape:[e,null,n]});var r,a=[t[0]].concat(t.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!at.arraysEqual(this.stateSpec.map((function(t){return t.shape[t.shape.length-1]})),r))throw new Lf("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=r.map((function(t){return new Fd({shape:[null,t]})}));this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,e){var n=this;void 0===e&&(e=!1),Ge((function(){if(!n.stateful)throw new zf("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new Lf("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states_)Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(t){return zn([r,t])})):n.states_=[zn([r,n.cell.stateSize])];else if(null==t)Ze(n.states_),null!=n.keptStates&&(Ze(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(t){return zn([r,t])})):n.states_[0]=zn([r,n.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==n.states_.length)throw new Lf("Layer "+n.name+" expects "+n.states_.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);!0===e?n.keptStates.push(n.states_.slice()):Ze(n.states_);for(var a=0;a<n.states_.length;++a){var i=t[a],o=Array.isArray(n.cell.stateSize)?n.cell.stateSize[a]:n.cell.stateSize,s=[r,o];if(!at.arraysEqual(i.shape,s))throw new Lf("State "+a+" is incompatible with layer "+n.name+": expected shape="+s+", received shape="+i.shape);n.states_[a]=i}}n.states_=n.states_.map((function(t){return Ke(t.clone())}))}))},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,a=null==n?null:n.constants;null==n&&(n={});var i=Yg(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(var u=0,c=r;u<c.length;u++){var l=c[u];this.stateSpec.push(new Fd({shape:l.shape}))}s=s.concat(this.stateSpec)}if(null!=a&&(n.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof zd){var p=[e].concat(o),f=this.inputSpec.concat(s),h=this.inputSpec;this.inputSpec=f;var d=t.prototype.apply.call(this,p,n);return this.inputSpec=h,d}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return Ge((function(){var r=null==e?null:e.mask,a=null==e?null:e.training,i=null==e?null:e.initialState;t=Id(t),null==i&&(i=n.stateful?n.states_:n.getInitialState(t));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new Lf("RNN Layer has "+o+" state(s) but was passed "+i.length+" initial state(s).");n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=Qg((function(t,e){var r=n.cell.call([t].concat(e),s);return[r[0],r.slice(1)]}),t,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],p=u[2];n.stateful&&n.resetStates(p,a);var f=n.returnSequences?l:c;return n.returnState?[f].concat(p):f}))},e.prototype.getInitialState=function(t){var e=this;return Ge((function(){var n=zn(t.shape);return n=Lh(n=$c(n,[1,2])),Array.isArray(e.cell.stateSize)?e.cell.stateSize.map((function(t){return t>1?Hh(n,[1,t]):n})):e.cell.stateSize>1?[Hh(n,[1,e.cell.stateSize])]:[n]}))},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var n=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:n};var r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=em(e.cell,n);return new t(Object.assign(e,{cell:r}))},e.className="RNN",e}(Vd);lf.registerClass(Jg);var ty=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e}(Vd),ey=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,rh(n.units,"units"),n.activation=Rv(null==e.activation?n.DEFAULT_ACTIVATION:e.activation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=wd(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=wd(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=wd(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=Lv(e.kernelRegularizer),n.recurrentRegularizer=Lv(e.recurrentRegularizer),n.biasRegularizer=Lv(e.biasRegularizer),n.kernelConstraint=mh(e.kernelConstraint),n.recurrentConstraint=mh(e.recurrentConstraint),n.biasConstraint=mh(e.biasConstraint),n.dropout=Mh([1,Fh([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=Mh([1,Fh([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Af(e,t),e.prototype.build=function(t){t=_d(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){if(2!==t.length)throw new Lf("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");var r=t[1];t=t[0];var a,i=null!=e.training&&e.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=uy((function(){return Vn(t)}),n.dropout,i)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=uy((function(){return Vn(r)}),n.recurrentDropout,i));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=Gh(null!=o?Fu(t,o):t,n.kernel.read()),null!=n.bias&&(a=$h(a,n.bias.read())),null!=s&&(r=Fu(r,s));var u=ku(a,Gh(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),recurrentInitializer:bd(this.recurrentInitializer),biasInitializer:bd(this.biasInitializer),kernelRegularizer:zv(this.kernelRegularizer),recurrentRegularizer:zv(this.recurrentRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),recurrentConstraint:hh(this.recurrentConstraint),biasConstraint:hh(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="SimpleRNNCell",e}(ty);lf.registerClass(ey);var ny=function(t){function e(e){return e.cell=new ey(e),t.call(this,e)||this}return Af(e,t),e.prototype.call=function(e,n){var r=this;return Ge((function(){null!=r.cell.dropoutMask&&(Ze(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ze(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==n?null:n.mask,i=null==n?null:n.training,o=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:a,training:i,initialState:o})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),recurrentInitializer:bd(this.recurrentInitializer),biasInitializer:bd(this.biasInitializer),kernelRegularizer:zv(this.kernelRegularizer),recurrentRegularizer:zv(this.recurrentRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),recurrentConstraint:hh(this.recurrentConstraint),biasConstraint:hh(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return new t(e)},e.className="SimpleRNN",e}(Jg);lf.registerClass(ny);var ry=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,rh(n.units,"units"),n.activation=Rv(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=Rv(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=wd(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=wd(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=wd(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=Lv(e.kernelRegularizer),n.recurrentRegularizer=Lv(e.recurrentRegularizer),n.biasRegularizer=Lv(e.biasRegularizer),n.kernelConstraint=mh(e.kernelConstraint),n.recurrentConstraint=mh(e.recurrentConstraint),n.biasConstraint=mh(e.biasConstraint),n.dropout=Mh([1,Fh([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=Mh([1,Fh([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Af(e,t),e.prototype.build=function(t){var e=(t=_d(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){if(2!==t.length)throw new Lf("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");var r=null!=e.training&&e.training,a=t[1];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=uy((function(){return Vn(t)}),n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=uy((function(){return Vn(a)}),n.recurrentDropout,r,3));var i,o,s,u=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=Fu(t,u[0]));var l=Gh(t,n.kernel.read());n.useBias&&(l=$h(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Fu(a,c[0]));var p=n.recurrentKernel.read(),f=Zn(p,[2*n.units,n.units],p.rank-1),h=f[0],d=f[1],m=Gh(a,h),v=Zn(l,3,l.rank-1),g=v[0],y=v[1],b=v[2],w=Zn(m,2,m.rank-1),x=w[0],k=w[1];i=n.recurrentActivation.apply(ku(g,x)),o=n.recurrentActivation.apply(ku(y,k));var S=Gh(Fu(o,a),d);s=n.activation.apply(ku(b,S));var N=ku(Fu(i,a),Fu(ku(1,Vs(i)),s));return[N,N]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),recurrentActivation:_v(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),recurrentInitializer:bd(this.recurrentInitializer),biasInitializer:bd(this.biasInitializer),kernelRegularizer:zv(this.kernelRegularizer),recurrentRegularizer:zv(this.recurrentRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),recurrentConstraint:hh(this.recurrentConstraint),biasConstraint:hh(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="GRUCell",e}(ty);lf.registerClass(ry);var ay=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ry(e),t.call(this,e)||this}return Af(e,t),e.prototype.call=function(e,n){var r=this;return Ge((function(){null!=r.cell.dropoutMask&&(Ze(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ze(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==n?null:n.mask,i=null==n?null:n.training,o=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:a,training:i,initialState:o})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),recurrentActivation:_v(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),recurrentInitializer:bd(this.recurrentInitializer),biasInitializer:bd(this.biasInitializer),kernelRegularizer:zv(this.kernelRegularizer),recurrentRegularizer:zv(this.recurrentRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),recurrentConstraint:hh(this.recurrentConstraint),biasConstraint:hh(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="GRU",e}(Jg);lf.registerClass(ay);var iy=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,rh(n.units,"units"),n.activation=Rv(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=Rv(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=wd(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=wd(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=wd(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=e.unitForgetBias,n.kernelRegularizer=Lv(e.kernelRegularizer),n.recurrentRegularizer=Lv(e.recurrentRegularizer),n.biasRegularizer=Lv(e.biasRegularizer),n.kernelConstraint=mh(e.kernelConstraint),n.recurrentConstraint=mh(e.recurrentConstraint),n.biasConstraint=mh(e.biasConstraint),n.dropout=Mh([1,Fh([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=Mh([1,Fh([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return Af(e,t),e.prototype.build=function(t){var e,n,r=(t=_d(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new((e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Af(e,t),e.prototype.apply=function(t,e){var n=a.apply([i]),r=(new rd).apply([i]),o=a.apply([2*i]);return jh(jh(n,r),o)},e}(ed)).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,e){var n=this;return Ge((function(){var r=null!=e.training&&e.training;if(3!==t.length)throw new Lf("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");var a=t[1],i=t[2];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=uy((function(){return Vn(t)}),n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=uy((function(){return Vn(a)}),n.recurrentDropout,r,4));var o,s,u,c,l=n.dropoutMask,p=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=Fu(t,l[0]));var f=Gh(t,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Fu(a,p[0])),f=ku(f,Gh(a,n.recurrentKernel.read())),n.useBias&&(f=$h(f,n.bias.read()));var h=Zn(f,4,f.rank-1),d=h[0],m=h[1],v=h[2],g=h[3];o=n.recurrentActivation.apply(d),s=n.recurrentActivation.apply(m),u=ku(Fu(s,i),Fu(o,n.activation.apply(v))),c=n.recurrentActivation.apply(g);var y=Fu(c,n.activation.apply(u));return[y,y,u]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),recurrentActivation:_v(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),recurrentInitializer:bd(this.recurrentInitializer),biasInitializer:bd(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:zv(this.kernelRegularizer),recurrentRegularizer:zv(this.recurrentRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),recurrentConstraint:hh(this.recurrentConstraint),biasConstraint:hh(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LSTMCell",e}(ty);lf.registerClass(iy);var oy=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new iy(e),t.call(this,e)||this}return Af(e,t),e.prototype.call=function(e,n){var r=this;return Ge((function(){null!=r.cell.dropoutMask&&(Ze(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Ze(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==n?null:n.mask,i=null==n?null:n.training,o=null==n?null:n.initialState;return t.prototype.call.call(r,e,{mask:a,training:i,initialState:o})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:_v(this.activation),recurrentActivation:_v(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bd(this.kernelInitializer),recurrentInitializer:bd(this.recurrentInitializer),biasInitializer:bd(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:zv(this.kernelRegularizer),recurrentRegularizer:zv(this.recurrentRegularizer),biasRegularizer:zv(this.biasRegularizer),activityRegularizer:zv(this.activityRegularizer),kernelConstraint:hh(this.kernelConstraint),recurrentConstraint:hh(this.recurrentConstraint),biasConstraint:hh(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="LSTM",e}(Jg);lf.registerClass(oy);var sy=function(t){function e(e){var n=t.call(this,e)||this;return n.cells=e.cells,n}return Af(e,t),Object.defineProperty(e.prototype,"stateSize",{get:function(){for(var t=[],e=0,n=this.cells.slice().reverse();e<n.length;e++){var r=n[e];Array.isArray(r.stateSize)?t.push.apply(t,r.stateSize):t.push(r.stateSize)}return t},enumerable:!0,configurable:!0}),e.prototype.call=function(t,e){var n=this;return Ge((function(){for(var r=t.slice(1),a=[],i=0,o=n.cells.slice().reverse();i<o.length;i++){var s=o[i];Array.isArray(s.stateSize)?a.push(r.splice(0,s.stateSize.length)):a.push(r.splice(0,1))}a.reverse();for(var u,c=[],l=0;l<n.cells.length;++l)s=n.cells[l],r=a[l],u=0===l?[t[0]].concat(r):[u[0]].concat(r),u=s.call(u,e),c.push(u.slice(1));r=[];for(var p=0,f=c.slice().reverse();p<f.length;p++){var h=f[p];r.push.apply(r,h)}return[u[0]].concat(r)}))},e.prototype.build=function(t){var e;Cd(t)&&(t=t[0]),this.cells.forEach((function(n,r){Ch("RNNCell_"+r,(function(){n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0},e.prototype.getConfig=function(){for(var e=[],n=0,r=this.cells;n<r.length;n++){var a=r[n];e.push({className:a.getClassName(),config:a.getConfig()})}var i={cells:e},o=t.prototype.getConfig.call(this);return Object.assign(i,o),i},e.fromConfig=function(t,e,n){void 0===n&&(n={});for(var r=[],a=0,i=e.cells;a<i.length;a++){var o=i[a];r.push(em(o,n))}return new t({cells:r})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var t=[],e=0,n=this.cells;e<n.length;e++){var r=n[e];t.push.apply(t,r.trainableWeights)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.cells;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var a=[],i=0,o=this.cells;i<o.length;i++)r=o[i],a.push.apply(a,r.trainableWeights);return a.concat(t)}return t},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){for(var t=[],e=0,n=this.cells;e<n.length;e++){var r=n[e];t.push.apply(t,r.weights)}return Od(t)},e.prototype.setWeights=function(t){for(var e=[],n=0,r=this.cells;n<r.length;n++)for(var a=r[n],i=a.weights.length,o=t.splice(i),s=0;s<a.weights.length;++s)e.push([a.weights[s],o[s]]);Md(e)},e.className="StackedRNNCells",e}(ty);function uy(t,e,n,r){function a(){return Yh(t(),e)}if(void 0===n&&(n=null),void 0===r&&(r=1),r>1){for(var i=[],o=0;o<r;o++)i.push(Qh(a,t,n));return i.map((function(t){return Ke(t.clone())}))}return Ke(Qh(a,t,n).clone())}lf.registerClass(sy);var cy=function(t){function e(e){var n=t.call(this,e)||this;return n.layer=e.layer,n}return Af(e,t),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=em(e.layer,n);delete e.layer;var a={layer:r};return Object.assign(a,e),new t(a)},e}(Vd),ly=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n}return Af(e,t),e.prototype.build=function(e){if((e=_d(e)).length<3)throw new Lf("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),t.prototype.build.call(this,e)},e.prototype.computeOutputShape=function(t){var e=[(t=_d(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))},e.prototype.call=function(t,e){var n=this;return Ge((function(){return Qg((function(t,r){return[Id(n.layer.call(t,e)),[]]}),t=Id(t),[],!1,null,null,!1,!0)[1]}))},e.className="TimeDistributed",e}(cy);lf.registerClass(ly);var py=function(t){function e(e){var n=t.call(this,e)||this,r=e.layer.getConfig(),a={};a.className=e.layer.getClassName(),a.config=r,n.forwardLayer=em(a),r.goBackwards=!0!==r.goBackwards;var i={};if(i.className=e.layer.getClassName(),i.config=r,n.backwardLayer=em(i),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(t){eh(wh,"BidirectionalMergeMode",t)}(n.mergeMode),e.weights)throw new Pf("weights support is not implemented for Bidirectional layer yet.");return n._stateful=e.layer.stateful,n.returnSequences=e.layer.returnSequences,n.returnState=e.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=e.layer.inputSpec,n.numConstants=null,n}return Af(e,t),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))},e.prototype.computeOutputShape=function(t){var e,n,r,a=this.forwardLayer.computeOutputShape(t);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),e=a[0]):e=a[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):Hf(n)},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,a=null==n?null:n.constants;null==n&&(n={});var i=Yg(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return t.prototype.apply.call(this,e,n);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new Lf("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push.apply(o,r);var c=r.map((function(t){return new Fd({shape:t.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,c)}if(null!=a)throw new Pf("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof zd,p=0,f=o;p<f.length;p++)if(f[p]instanceof zd!==l)throw new Lf("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){var h=[e].concat(o),d=this.inputSpec.concat(s),m=this.inputSpec;this.inputSpec=d;var v=t.prototype.apply.call(this,h,n);return this.inputSpec=m,v}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return Ge((function(){if(null!=e.mask)throw new Pf("The support for masking is not implemented for Bidirectional layers yet.");var r,a,i,o,s=e.initialState;if(null==s)r=n.forwardLayer.call(t,e),a=n.backwardLayer.call(t,e);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(t,Object.assign(e,{initialState:u})),a=n.backwardLayer.call(t,Object.assign(e,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=Sc(a,1)),"concat"===n.mergeMode?o=Uh([r,a]):"sum"===n.mergeMode?o=ku(r,a):"ave"===n.mergeMode?o=Fu(.5,ku(r,a)):"mul"===n.mergeMode?o=Fu(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var e=this;Ch(this.forwardLayer.name,(function(){e.forwardLayer.build(t)})),Ch(this.backwardLayer.name,(function(){e.backwardLayer.build(t)})),this.built=!0},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.fromConfig=function(t,e){var n=em(e.layer);if(delete e.layer,null!=e.numConstants)throw new Pf("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=e;return r.layer=n,new t(r)},e.className="Bidirectional",e}(cy);function fy(t){return new Lg(t)}function hy(t){return new Wg(t)}function dy(t){return new Hg(t)}function my(t){return new Zg(t)}function vy(t){return new $g(t)}function gy(t){return new Bg(t)}function yy(t){return new Vg(t)}lf.registerClass(py);var by=my,wy=vy,xy=gy,ky=yy;var Sy=Object.freeze({inputLayer:function(t){return new jd(t)},elu:function(t){return new Uv(t)},reLU:function(t){return new Pv(t)},leakyReLU:function(t){return new Vv(t)},prelu:function(t){return new Wv(t)},softmax:function(t){return new Hv(t)},thresholdedReLU:function(t){return new jv(t)},conv1d:function(t){return new ag(t)},conv2d:function(t){return new Jv(t)},conv2dTranspose:function(t){return new eg(t)},conv3d:function(t){return new tg(t)},separableConv2d:function(t){return new rg(t)},cropping2D:function(t){return new ig(t)},upSampling2d:function(t){return new og(t)},depthwiseConv2d:function(t){return new sg(t)},activation:function(t){return new pg(t)},dense:function(t){return new cg(t)},dropout:function(t){return new ug(t)},flatten:function(t){return new lg(t)},repeatVector:function(t){return new fg(t)},reshape:function(t){return new hg(t)},permute:function(t){return new dg(t)},embedding:function(t){return new vg(t)},add:function(t){return new yg(t)},average:function(t){return new wg(t)},concatenate:function(t){return new Sg(t)},maximum:function(t){return new xg(t)},minimum:function(t){return new kg(t)},multiply:function(t){return new bg(t)},dot:function(t){return new Eg(t)},batchNormalization:function(t){return new Rg(t)},layerNormalization:function(t){return new Dg(t)},zeroPadding2d:function(t){return new Og(t)},averagePooling1d:fy,avgPool1d:function(t){return fy(t)},avgPooling1d:function(t){return fy(t)},averagePooling2d:hy,avgPool2d:function(t){return hy(t)},avgPooling2d:function(t){return hy(t)},averagePooling3d:dy,avgPool3d:function(t){return dy(t)},avgPooling3d:function(t){return dy(t)},globalAveragePooling1d:function(t){return new Gg(t)},globalAveragePooling2d:function(t){return new Xg(t)},globalMaxPooling1d:my,globalMaxPooling2d:vy,maxPooling1d:gy,maxPooling2d:yy,maxPooling3d:function(t){return new jg(t)},gru:function(t){return new ay(t)},gruCell:function(t){return new ry(t)},lstm:function(t){return new oy(t)},lstmCell:function(t){return new iy(t)},simpleRNN:function(t){return new ny(t)},simpleRNNCell:function(t){return new ey(t)},rnn:function(t){return new Jg(t)},stackedRNNCells:function(t){return new sy(t)},bidirectional:function(t){return new py(t)},timeDistributed:function(t){return new ly(t)},globalMaxPool1d:by,globalMaxPool2d:wy,maxPool1d:xy,maxPool2d:ky,Layer:Vd,RNN:Jg,RNNCell:ty,input:dv,gaussianNoise:function(t){return new Cg(t)},gaussianDropout:function(t){return new Tg(t)},alphaDropout:function(t){return new Ig(t)},masking:function(t){return new mg(t)}});var Ny=Object.freeze({binaryAccuracy:function(t,e){return fm(t,e)},binaryCrossentropy:function(t,e){return gm(t,e)},sparseCategoricalAccuracy:function(t,e){return ym(t,e)},categoricalAccuracy:function(t,e){return hm(t,e)},categoricalCrossentropy:function(t,e){return bm(t,e)},precision:function(t,e){return mm(t,e)},recall:function(t,e){return vm(t,e)},cosineProximity:function(t,e){return cm(t,e)},meanAbsoluteError:function(t,e){return am(t,e)},meanAbsolutePercentageError:function(t,e){return im(t,e)},MAPE:function(t,e){return im(t,e)},mape:function(t,e){return im(t,e)},meanSquaredError:function(t,e){return rm(t,e)},MSE:function(t,e){return rm(t,e)},mse:function(t,e){return rm(t,e)}}),Ey=Object.freeze({modelFromJSON:function(t,e){return Of(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c;return Mf(this,(function(l){switch(l.label){case 0:return"modelTopology"in t||(t={modelTopology:t}),null!=(n=t.modelTopology).model_config&&(n=n.model_config),r=Rm(n),a=em(r,e),null==t.weightsManifest?[3,2]:[4,ef.loadWeights(t.weightsManifest,t.pathPrefix,a.weights.map((function(t){return t.originalName})))];case 1:for(i=l.sent(),o={},s=0,u=a.weights;s<u.length;s++)c=u[s],o[c.originalName]=i[c.originalName];a.loadWeights(o),Ze(i),l.label=2;case 2:return[2,a]}}))}))}});var Cy=Object.freeze({l1l2:function(t){return new Mv(t)},l1:function(t){return function(t){return Dv(t),new Mv({l1:null!=t?t.l1:null,l2:0})}(t)},l2:function(t){return function(t){return Dv(t),new Mv({l2:null!=t?t.l2:null,l1:0})}(t)}}),Ty=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=null,e}return Af(e,t),e.prototype.setModel=function(t){if(!(t instanceof uv))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e}(Zd);function Iy(t,e){return t<e}function _y(t,e){return t>e}var Ay=function(t){function e(e){var n=t.call(this)||this;if(null==e&&(e={}),e.restoreBestWeights)throw new Pf("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=e.monitor||"val_loss",n.minDelta=Math.abs(e.minDelta||0),n.patience=e.patience||0,n.verbose=e.verbose||0,n.mode=e.mode||"auto",n.baseline=e.baseline,-1===["auto","min","max"].indexOf(n.mode)&&(console.warn("EarlyStopping mode '"+n.mode+"' is invalid. Falling back to mode 'auto'."),n.mode="auto"),"min"===n.mode?n.monitorFunc=Iy:"max"===n.mode||-1!==n.monitor.indexOf("acc")?n.monitorFunc=_y:n.monitorFunc=Iy,n.monitorFunc===Iy&&(n.minDelta*=-1),n}return Af(e,t),e.prototype.onTrainBegin=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===Iy?1/0:-1/0,[2]}))}))},e.prototype.onEpochEnd=function(t,e){return Of(this,void 0,void 0,(function(){var n;return Mf(this,(function(r){switch(r.label){case 0:return[4,qd(e)];case 1:return r.sent(),null==(n=this.getMonitorValue(e))||(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0))),[2]}}))}))},e.prototype.onTrainEnd=function(t){return Of(this,void 0,void 0,(function(){return Mf(this,(function(t){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]}))}))},e.prototype.getMonitorValue=function(t){null==t&&(t={});var e=t[this.monitor];return null==e&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(t)),e},e}(Ty);var Ry,Dy,Oy={earlyStopping:function(t){return new Ay(t)}},My=function(){return(My=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function Fy(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function zy(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(Ry||(Ry={})),function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(Dy||(Dy={}));var By={};function Ly(t,e){var n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};By[t]=n}function Py(t){return By[t]}function Vy(t){delete By[t]}function Wy(t,e,n,r){var a=e.inputParams[t];if(a&&void 0!==a.inputIndexStart){var i=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?i+1:a.inputIndexEnd;if("tensor"===a.type)return Uy(e.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return e.inputNames.slice(i,o).map((function(t){return Uy(t,n,r)}));var s=Array.prototype.slice.call(Uy(e.inputNames.slice(i)[0],n,r).dataSync());return"number"===a.type?s[0]:s}var u=e.attrParams[t];return u&&u.value}function Uy(t,e,n){var r=qy(t),a=r[0],i=r[1],o=n.currentContextIds.find((function(t){return!!e[Hy(a,t)]}));return void 0!==o?e[Hy(a,o)][i]:void 0}function jy(t,e){var n=qy(t),r=n[0],a=n[1];return[Hy(r,e&&e.currentContextId),a]}function Hy(t,e){return e?t+"-"+e:t}function qy(t){var e=t.lastIndexOf(":");return-1===e?[t,0]:[t.substring(0,e),Number(t.substring(e+1))]}function Gy(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}var Zy=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),Ky=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),Xy=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),$y=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),Yy=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),Qy=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),Jy=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),tb=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),eb=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),nb=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),rb=Object.freeze({json:[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),ab=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),ib=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),ob=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),sb=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),ub=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),cb=function(){function t(){var t=[Zy,Ky,Xy,$y,Yy,Qy,Jy,nb,eb,tb,rb,ab,ib,ob,sb,ub],e=[].concat.apply([],t.map((function(t){return t.json})));this.opMappers=e.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(t){var e=this,n=[],r=[],a=t.node.reduce((function(t,a){return t[a.name]=e.mapNode(a),"Placeholder"===a.op&&n.push(t[a.name]),"Const"===a.op&&r.push(t[a.name]),t}),{}),i=[],o=[],s=Object.keys(a);return s.forEach((function(t){var e=a[t];e.inputNames.forEach((function(t){var n=jy(t)[0];e.inputs.push(a[n]),a[n].children.push(e)})),0===e.inputs.length&&i.push(e)})),s.forEach((function(t){var e=a[t];0===e.children.length&&o.push(e)})),{nodes:a,inputs:i,outputs:o,weights:r,placeholders:n}},t.prototype.mapNode=function(t){var e=Py(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.substr(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=fb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=fb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=xb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=xb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=db(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=db(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=wb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=wb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=hb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=hb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=Sb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Sb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=bb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=bb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=kb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=kb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=vb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=vb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=gb(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=gb(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+t.op)}return e[n.name]={value:a,type:r},e}),{})),n},t}();function lb(t){var e=c().global;if(void 0!==e.atob)return e.atob(t);if("undefined"!=typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function pb(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):lb(t);return e?n:n.toLowerCase()}function fb(t,e,n,r){void 0===r&&(r=!1);var a=t[e];return null!=a?pb(a.s,r):n}function hb(t,e,n){var r=t[e];return r?r.b:n}function db(t,e,n){var r=t[e]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function mb(t){switch("string"==typeof t&&(t=Ry[t]),t){case Ry.DT_FLOAT:return"float32";case Ry.DT_INT32:case Ry.DT_INT64:return"int32";case Ry.DT_BOOL:return"bool";case Ry.DT_DOUBLE:return"float32";case Ry.DT_STRING:return"string";default:return null}}function vb(t,e,n){var r=t[e];return r&&r.type?mb(r.type):n}function gb(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return mb(t)})):n}function yb(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)})):[]}function bb(t,e,n){var r=t[e];return r&&r.shape?yb(r.shape):n}function wb(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"==typeof t?t:parseInt(t,10)})):n}function xb(t,e,n,r){void 0===r&&(r=!1);var a=t[e];return a&&a.list&&a.list.s?a.list.s.map((function(t){return pb(t,r)})):n}function kb(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return yb(t)})):n}function Sb(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var Nb=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(t){return r.getInput(t)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(t,e){return t[e]=r.getAttr(e),t}),{}))}return t.prototype.getInput=function(t){return Uy(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return Uy(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return db(this.node.rawAttrs,t,e);if(null!=n.s)return fb(this.node.rawAttrs,t,e);if(null!=n.b)return hb(this.node.rawAttrs,t,e);if(null!=n.shape)return bb(this.node.rawAttrs,t,e);if(null!=n.type)return vb(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return wb(this.node.rawAttrs,t,e);if(null!=n.list.s)return xb(this.node.rawAttrs,t,e);if(null!=n.list.shape)return kb(this.node.rawAttrs,t,e);if(null!=n.list.b)return Sb(this.node.rawAttrs,t,e);if(null!=n.list.type)return gb(this.node.rawAttrs,t,e)}return e},t}(),Eb=function(){function t(e,n,r,a,i,o,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach((function(t){return t.tensor.dispose()})),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map((function(t){return e.read(t)}))},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+",\n          because the value dtype is "+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach((function(t,r){return n.write(t,e[r])}))},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return En([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),_r(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(0===this.size())return En([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),Un(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,Dr(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var r=0,a=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:e.size/r,o=[];Ge((function(){e=e.reshape([1,r,i]);for(var s=0;s<t.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,t[s],i];o[s]=Fc(e,u,c).reshape(n.elementShape)}return o}));for(var s=[],u=0;u<t.length;u++)s[u]=u;this.writeMany(s,o)},t.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){void 0===n&&(n=""),at.assert(this.shapesEqualAllowUndefinedSize(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))},t.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0},t.nextId=0,t}();function Cb(t,e,n){var r=function(t,e,n){switch(t.category){case"arithmetic":return function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[ku(Wy("a",t,e,n),Wy("b",t,e,n))];case"AddN":return[Su(Wy("tensors",t,e,n))];case"FloorMod":case"Mod":return[Ou(Wy("a",t,e,n),Wy("b",t,e,n))];case"Mul":return[Fu(Wy("a",t,e,n),Wy("b",t,e,n))];case"RealDiv":case"Div":return[Cu(Wy("a",t,e,n),Wy("b",t,e,n))];case"FloorDiv":return[Iu(Wy("a",t,e,n),Wy("b",t,e,n))];case"Sub":return[Wu(Wy("a",t,e,n),Wy("b",t,e,n))];case"Minimum":return[Ru(Wy("a",t,e,n),Wy("b",t,e,n))];case"Maximum":return[_u(Wy("a",t,e,n),Wy("b",t,e,n))];case"Pow":return[Bu(Wy("a",t,e,n),Wy("b",t,e,n))];case"SquaredDifference":return[Pu(Wy("a",t,e,n),Wy("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"basic_math":return function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[ks(Wy("x",t,e,n))];case"Acos":return[Ss(Wy("x",t,e,n))];case"Acosh":return[Ns(Wy("x",t,e,n))];case"Asin":return[Es(Wy("x",t,e,n))];case"Asinh":return[Cs(Wy("x",t,e,n))];case"Atan":return[Ts(Wy("x",t,e,n))];case"Atan2":return[Eu(Wy("x",t,e,n),Wy("y",t,e,n))];case"Atanh":return[Is(Wy("x",t,e,n))];case"Ceil":return[_s(Wy("x",t,e,n))];case"Complex":return[kn(Wy("real",t,e,n),Wy("imag",t,e,n))];case"Cos":return[Rs(Wy("x",t,e,n))];case"Cosh":return[Ds(Wy("x",t,e,n))];case"Elu":return[Qc(Wy("x",t,e,n))];case"Erf":return[Os(Wy("x",t,e,n))];case"Exp":return[Ms(Wy("x",t,e,n))];case"Expm1":return[Fs(Wy("x",t,e,n))];case"Floor":return[zs(Wy("x",t,e,n))];case"Log":return[Bs(Wy("x",t,e,n))];case"Log1p":return[Ls(Wy("x",t,e,n))];case"Imag":return[Nn(Wy("x",t,e,n))];case"Neg":return[Vs(Wy("x",t,e,n))];case"Reciprocal":return[Ws(Wy("x",t,e,n))];case"Real":return[Sn(Wy("x",t,e,n))];case"Relu":return[el(Wy("x",t,e,n))];case"Round":return[Us(Wy("x",t,e,n))];case"Selu":return[rl(Wy("x",t,e,n))];case"Sigmoid":return[Hs(Wy("x",t,e,n))];case"Sin":return[Xs(Wy("x",t,e,n))];case"Sign":return[qs(Wy("x",t,e,n))];case"Sinh":return[$s(Wy("x",t,e,n))];case"Softplus":return[Ys(Wy("x",t,e,n))];case"Sqrt":return[Qs(Wy("x",t,e,n))];case"Square":return[xs(Wy("x",t,e,n))];case"Tanh":return[eu(Wy("x",t,e,n))];case"Tan":return[tu(Wy("x",t,e,n))];case"Relu6":case"ClipByValue":return[As(Wy("x",t,e,n),Wy("clipValueMin",t,e,n),Wy("clipValueMax",t,e,n))];case"Rsqrt":return[js(Uy(t.inputNames[0],e,n))];case"Prod":return[Yc(Wy("x",t,e,n),Wy("axes",t,e,n))];case"LeakyRelu":return[Jc(Wy("x",t,e,n),Wy("alpha",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"control":return function(t,e,n){return Fy(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b,w,x,k,S,N,E,C,T,I,_,A,R,D,O,M,F,z;return zy(this,(function(B){switch(B.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[Wy("pred",t,e,n).clone()]];case 2:return r=Wy("pred",t,e,n),a=Wy("data",t,e,n),[4,r.data()];case 3:return[2,B.sent()[0]?[void 0,a.clone()]:[a.clone(),void 0]];case 4:return[2,(i=t.inputNames.find((function(t){return void 0!==Uy(t,e,n)})))?[Uy(i,e,n).clone()]:void 0];case 5:return o=Wy("frameName",t,e,n),s=Wy("tensor",t,e,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=Wy("tensor",t,e,n),n.exitFrame(),[2,[u.clone()]];case 7:return c=Wy("tensor",t,e,n),n.nextIteration(),[2,[c.clone()]];case 8:return l=Wy("size",t,e,n),p=Wy("dtype",t,e,n),f=Wy("elementShape",t,e,n),h=Wy("dynamicSize",t,e,n),d=Wy("clearAfterRead",t,e,n),m=Wy("identicalElementShapes",t,e,n),v=Wy("name",t,e,n),g=new Eb(v,p,l,f,m,h,d),n.addTensorArray(g),[2,[Tn(g.id),Tn(1)]];case 9:return y=Wy("tensorArrayId",t,e,n),b=Wy("index",t,e,n),w=Wy("tensor",t,e,n),n.getTensorArray(y).write(b,w),[2,[Tn(1)]];case 10:return x=Wy("tensorArrayId",t,e,n),k=Wy("index",t,e,n),[2,[n.getTensorArray(x).read(k)]];case 11:return S=Wy("tensorArrayId",t,e,n),N=Wy("indices",t,e,n),E=Wy("dtype",t,e,n),[2,[n.getTensorArray(S).gather(N,E)]];case 12:return C=Wy("tensorArrayId",t,e,n),T=Wy("indices",t,e,n),I=Wy("tensor",t,e,n),n.getTensorArray(C).scatter(T,I),[2,[Tn(1)]];case 13:return _=Wy("tensorArrayId",t,e,n),A=n.getTensorArray(_),R=Wy("dtype",t,e,n),[2,[A.concat(R)]];case 14:return D=Wy("tensorArrayId",t,e,n),O=Wy("tensor",t,e,n),M=Wy("lengths",t,e,n),n.getTensorArray(D).split(M,O),[2,[Tn(1)]];case 15:return F=Wy("tensorArrayId",t,e,n),[2,[Tn(n.getTensorArray(F).size(),"int32")]];case 16:return z=Wy("tensorArrayId",t,e,n),n.getTensorArray(z).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"convolution":return function(t,e,n){var r,a;switch(t.op){case"Conv1D":var i=Wy("stride",t,e,n),o=Wy("pad",t,e,n),s=Wy("dataFormat",t,e,n).toUpperCase(),u=Wy("dilation",t,e,n);return[cc(Wy("x",t,e,n),Wy("filter",t,e,n),i,o,s,u)];case"Conv2D":i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),s=Wy("dataFormat",t,e,n).toUpperCase();var c=Wy("dilations",t,e,n);return[lc(Wy("x",t,e,n),Wy("filter",t,e,n),[i[1],i[2]],o,s,[c[1],c[2]])];case"_FusedConv2D":var l=(r=Wy("fusedOps",t,e,n))[0],p=r[1],f="biasadd"===l,h="prelu"===p,d="fusedbatchnorm"===l,m=Wy("numArgs",t,e,n);if(f){if(h&&2!==m)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!h&&1!==m)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(d)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),s=Wy("dataFormat",t,e,n).toUpperCase(),c=Wy("dilations",t,e,n);var v=(a=Wy("args",t,e,n))[0],g=a[1];return[rp.conv2d({x:Wy("x",t,e,n),filter:Wy("filter",t,e,n),strides:[i[1],i[2]],pad:o,dataFormat:s,dilations:[c[1],c[2]],bias:v,activation:p,preluActivationWeights:g})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=Wy("outputShape",t,e,n);return i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),[yc(Wy("x",t,e,n),Wy("filter",t,e,n),y,[i[1],i[2]],o)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),c=Wy("dilations",t,e,n),s=Wy("dataFormat",t,e,n).toUpperCase(),[dc(Wy("input",t,e,n),Wy("filter",t,e,n),[i[1],i[2]],o,s,[c[1],c[2]])];case"Conv3D":return i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),s=Wy("dataFormat",t,e,n).toUpperCase(),c=Wy("dilations",t,e,n),[pc(Wy("x",t,e,n),Wy("filter",t,e,n),[i[1],i[2],i[3]],o,s,[c[1],c[2],c[3]])];case"AvgPool":i=Wy("strides",t,e,n),o=Wy("pad",t,e,n);var b=Wy("kernelSize",t,e,n);return[Rc(Wy("x",t,e,n),[b[1],b[2]],[i[1],i[2]],o)];case"MaxPool":return i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),b=Wy("kernelSize",t,e,n),[Ac(Wy("x",t,e,n),[b[1],b[2]],[i[1],i[2]],o)];case"AvgPool3D":return i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),b=Wy("kernelSize",t,e,n),[Mc(Wy("x",t,e,n),[b[1],b[2],b[3]],[i[1],i[2],i[3]],o)];case"MaxPool3D":return i=Wy("strides",t,e,n),o=Wy("pad",t,e,n),b=Wy("kernelSize",t,e,n),[Oc(Wy("x",t,e,n),[b[1],b[2],b[3]],[i[1],i[2],i[3]],o)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"creation":return function(t,e,n){switch(t.op){case"Fill":var r=Wy("shape",t,e,n),a=Wy("dtype",t,e,n);return[Bn(r,Wy("value",t,e,n),a)];case"LinSpace":var i=Wy("start",t,e,n);return[Ln(i,Wy("stop",t,e,n),Wy("num",t,e,n))];case"Multinomial":var o=Wy("logits",t,e,n),s=Wy("numSamples",t,e,n),u=Wy("seed",t,e,n);return[mr(o,s,u)];case"OneHot":var c=Wy("indices",t,e,n),l=Wy("depth",t,e,n),p=Wy("onValue",t,e,n),f=Wy("offValue",t,e,n);return[vr(c,l,p,f)];case"Ones":return[Fn(Wy("shape",t,e,n),Wy("dtype",t,e,n))];case"OnesLike":return[Vn(Wy("x",t,e,n))];case"RandomUniform":return[Er(Wy("shape",t,e,n),Wy("minval",t,e,n),Wy("maxval",t,e,n),Wy("dtype",t,e,n))];case"Range":return[Pn(i=Wy("start",t,e,n),Wy("stop",t,e,n),Wy("step",t,e,n),Wy("dtype",t,e,n))];case"TruncatedNormal":r=Wy("shape",t,e,n);var h=Wy("mean",t,e,n),d=Wy("stdDev",t,e,n);return u=Wy("seed",t,e,n),[Rr(r,h,d,Wy("dtype",t,e,n),u)];case"Zeros":return[zn(Wy("shape",t,e,n),Wy("dtype",t,e,n))];case"ZerosLike":return[Wn(Wy("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"dynamic":return function(t,e,n){return Fy(this,void 0,void 0,(function(){var r,a,i,o,s;return zy(this,(function(u){switch(u.label){case 0:switch(t.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return r=Wy("boxes",t,e,n),a=Wy("scores",t,e,n),i=Wy("maxOutputSize",t,e,n),o=Wy("iouThreshold",t,e,n),s=Wy("scoreThreshold",t,e,n),[4,Xl.nonMaxSuppressionAsync(r,a,i,o,s)];case 2:case 4:return[2,[u.sent()]];case 3:return[4,xu(Wy("condition",t,e,n).asType("bool"))];case 5:return[2,Or(Wy("x",t,e,n),Wy("y",t,e,n))];case 6:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"evaluation":return function(t,e,n){if("TopKV2"===t.op){var r=Wy("x",t,e,n),a=Wy("k",t,e,n),i=Wy("sorted",t,e,n),o=pl(r,a,i);return[o.values,o.indices]}throw TypeError("Node type "+t.op+" is not implemented")}(t,e,n);case"image":return function(t,e,n){switch(t.op){case"ResizeBilinear":var r=Wy("images",t,e,n),a=Wy("size",t,e,n),i=Wy("alignCorners",t,e,n);return[Xl.resizeBilinear(r,[a[0],a[1]],i)];case"ResizeNearestNeighbor":return r=Wy("images",t,e,n),a=Wy("size",t,e,n),i=Wy("alignCorners",t,e,n),[Xl.resizeNearestNeighbor(r,[a[0],a[1]],i)];case"CropAndResize":var o=Wy("image",t,e,n),s=Wy("boxes",t,e,n),u=Wy("boxInd",t,e,n),c=Wy("cropSize",t,e,n),l=Wy("method",t,e,n),p=Wy("extrapolationValue",t,e,n);return[Xl.cropAndResize(o,s,u,c,l,p)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"graph":return function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=Wy("default",t,e,n);return[Uy(t.name,e,n)||r];case"Placeholder":return[Uy(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[Wy("x",t,e,n).clone()];case"IdentityN":return Wy("x",t,e,n).map((function(t){return t.clone()}));case"Shape":return[In(Wy("x",t,e,n).shape,"int32")];case"ShapeN":return Wy("x",t,e,n).map((function(t){return In(t.shape)}));case"Size":return[Tn(Wy("x",t,e,n).size,"int32")];case"Rank":return[Tn(Wy("x",t,e,n).rank,"int32")];case"NoOp":return[];case"Print":var a=Wy("x",t,e,n),i=Wy("data",t,e,n),o=Wy("message",t,e,n),s=Wy("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[u].dataSync()).slice(0,s));return[a];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"logical":return function(t,e,n){switch(t.op){case"Equal":return[ju(Wy("a",t,e,n),Wy("b",t,e,n))];case"NotEqual":return[Ju(Wy("a",t,e,n),Wy("b",t,e,n))];case"Greater":return[qu(Wy("a",t,e,n),Wy("b",t,e,n))];case"GreaterEqual":return[Gu(Wy("a",t,e,n),Wy("b",t,e,n))];case"Less":return[Xu(Wy("a",t,e,n),Wy("b",t,e,n))];case"LessEqual":return[$u(Wy("a",t,e,n),Wy("b",t,e,n))];case"LogicalAnd":return[vu(Wy("a",t,e,n),Wy("b",t,e,n))];case"LogicalNot":return[gu(Wy("a",t,e,n))];case"LogicalOr":return[yu(Wy("a",t,e,n),Wy("b",t,e,n))];case"Select":return[wu(Wy("condition",t,e,n),Wy("a",t,e,n),Wy("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"matrices":return function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[wc(Wy("a",t,e,n),Wy("b",t,e,n),Wy("transposeA",t,e,n),Wy("transposeB",t,e,n))];case"Transpose":return[al(Wy("x",t,e,n),Wy("perm",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"normalization":return function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[fu(Wy("x",t,e,n),Wy("mean",t,e,n),Wy("variance",t,e,n),Wy("offset",t,e,n),Wy("scale",t,e,n),Wy("epsilon",t,e,n))];case"LRN":return[il(Wy("x",t,e,n),Wy("radius",t,e,n),Wy("bias",t,e,n),Wy("alpha",t,e,n),Wy("beta",t,e,n))];case"Softmax":return[ra(Wy("x",t,e,n))];case"LogSoftmax":return[aa(Wy("x",t,e,n))];case"SparseToDense":return[yl(Wy("sparseIndices",t,e,n),Wy("outputShape",t,e,n),Wy("sparseValues",t,e,n),Wy("defaultValue",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"reduction":return function(t,e,n){switch(t.op){case"Max":var r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n);return[Gc(Wy("x",t,e,n),r,a)];case"Mean":return r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n),[Zc(Wy("x",t,e,n),r,a)];case"Min":return r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n),[Kc(Wy("x",t,e,n),r,a)];case"Sum":return r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n),[$c(Wy("x",t,e,n),r,a)];case"All":return r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n),[Wc(Wy("x",t,e,n),r,a)];case"Any":return r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n),[Uc(Wy("x",t,e,n),r,a)];case"ArgMax":return r=Wy("axis",t,e,n),[jc(Wy("x",t,e,n),r)];case"ArgMin":return r=Wy("axis",t,e,n),[Hc(Wy("x",t,e,n),r)];case"Prod":return r=Wy("axis",t,e,n),a=Wy("keepDims",t,e,n),[Yc(Wy("x",t,e,n),r,a)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"slice_join":return function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=Wy("axis",t,e,n),a=Wy("tensors",t,e,n);return[Un(a,r)];case"GatherV2":case"Gather":r=Wy("axis",t,e,n);var i=Wy("x",t,e,n),o=Wy("indices",t,e,n);return[rc(i,o.asType("int32"),r)];case"ReverseV2":case"Reverse":return r=Wy("axis",t,e,n),i=Wy("x",t,e,n),[Sc(i,r)];case"Slice":var s=Wy("begin",t,e,n),u=Wy("size",t,e,n);return[Fc(Wy("x",t,e,n),s,u)];case"StridedSlice":s=Wy("begin",t,e,n);var c=Wy("end",t,e,n),l=Wy("strides",t,e,n),p=Wy("beginMask",t,e,n),f=Wy("endMask",t,e,n),h=Wy("ellipsisMask",t,e,n),d=Wy("newAxisMask",t,e,n),m=Wy("shrinkAxisMask",t,e,n),v=Wy("x",t,e,n);if(1===s.length&&v.shape.length>1)for(var g=1;g<v.shape.length;g++)s.push(0),c.push(v.shape[g]),l.push(l[0]);return[ll(v,s,c,l,p,f,h,d,m)];case"Pack":return Ge((function(){var r=Wy("axis",t,e,n),a=Wy("tensors",t,e,n),i=a[0].shape,o=a[0].squeeze().shape,s=a.map((function(t){var e=at.arraysEqual(t.shape,i);if(!e&&!at.arraysEqual(t.squeeze().shape,o))throw new Error("the input tensors shape does not match");return e?t:t.reshape(i)}));return[_r(s,r)]}));case"Unpack":return Ge((function(){var r=Wy("axis",t,e,n),a=Wy("tensor",t,e,n);return Dr(a,r)}));case"Tile":var y=Wy("reps",t,e,n);return[Ar(Wy("x",t,e,n),y)];case"Split":case"SplitV":r=Wy("axis",t,e,n);var b=Wy("numOrSizeSplits",t,e,n);return Zn(Wy("x",t,e,n),b,r);case"ScatterNd":o=Wy("indices",t,e,n);var w=Wy("values",t,e,n),x=Wy("shape",t,e,n);return[fl(o,w,x)];case"GatherNd":var k=Wy("x",t,e,n);return o=Wy("indices",t,e,n),[bl(k,o)];case"SparseToDense":o=Wy("sparseIndices",t,e,n),x=Wy("outputShape",t,e,n);var S=Wy("sparseValues",t,e,n),N=Wy("defaultValue",t,e,n);return[yl(o,S,x,S.dtype===N.dtype?N:N.asType(S.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"spectral":return function(t,e,n){switch(t.op){case"FFT":return[hl(Wy("x",t,e,n))];case"IFFT":return[dl(Wy("x",t,e,n))];case"RFFT":return[ml(Wy("x",t,e,n))];case"IRFFT":return[vl(Wy("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"transformation":return function(t,e,n){switch(t.op){case"Cast":return[cr(Wy("x",t,e,n),Wy("dtype",t,e,n))];case"ExpandDims":var r=Wy("axis",t,e,n);return[hr(Wy("x",t,e,n),r)];case"Squeeze":return r=Wy("axis",t,e,n),[Ir(Wy("x",t,e,n),r)];case"Reshape":return[Cr(Wy("x",t,e,n),Wy("shape",t,e,n))];case"PadV2":case"Pad":return[gr(Wy("x",t,e,n),Gy(Wy("padding",t,e,n),2),Wy("constantValue",t,e,n))];case"SpaceToBatchND":var a=Wy("blockShape",t,e,n),i=Gy(Wy("paddings",t,e,n),2);return[Tr(Wy("x",t,e,n),a,i)];case"BatchToSpaceND":a=Wy("blockShape",t,e,n);var o=Gy(Wy("crops",t,e,n),2);return[ur(Wy("x",t,e,n),a,o)];case"DepthToSpace":var s=Wy("blockSize",t,e,n),u=Wy("dataFormat",t,e,n).toUpperCase();return[fr(Wy("x",t,e,n),s,u)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"custom":var r=Py(t.op);if(r&&r.customExecutor)return r.customExecutor(new Nb(t,e,n));throw TypeError("Custom op "+t.op+" is not registered.");default:throw TypeError("Unknown op '"+t.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return r instanceof Promise?r.then((function(t){return[].concat(t)})):[].concat(r)}var Tb=function(){function t(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId})).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t}();function Ib(t,e,n){for(var r=new Set,a=[],i=null,o=null,s=new Set,u=e.slice();u.length>0;){var c=u.pop();(Rb(c)||Db(c))&&null==i&&(o=(i=c).children.map((function(t){return t.name})).filter((function(t){return r.has(t)}))),r.add(c.name),null==n[c.name]&&null==t[c.name]&&(0!==c.inputs.length?c.inputs.forEach((function(t){s.has(t.name)||(s.add(t.name),u.push(t))})):a.push(c.name))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}var _b=["Switch","Merge","Enter","Exit","NextIteration"],Ab=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function Rb(t){return _b.indexOf(t.op)>=0}function Db(t){return Ab.indexOf(t.op)>=0}var Ob=function(){function t(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=t.placeholders,this._outputs=t.outputs}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.placeholders.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.placeholders.map((function(t){return t.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.outputs.map((function(t){return t.name}))},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},t.prototype.compile=function(t,e){var n=Ib(t,e,this.weightMap),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+i+"]");if(r.length>0){var o=e.map((function(t){return t.name})),s=Object.keys(t);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+s+"]. Missing the following inputs: ["+r+"]")}return function(t,e,n){var r=n.usedNodes,a=n.inputs,i=[];Object.keys(a).map((function(e){return t.nodes[e]})).forEach((function(t){r.has(t.name)&&i.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&i.push(t)}));for(var o=new Set,s=[];i.length>0;){var u=i.pop();o.add(u.name),e[u.name]||s.push(u),u.children.forEach((function(t){!o.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return o.has(t.name)}))&&i.push(t)}))}return s}(this.graph,this.weightMap,n)},t.prototype.execute=function(t,e){var n=this,r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e);var a=r.map((function(t){return n.graph.nodes[t]})),i=e.map((function(t){return n.graph.nodes[qy(t)[0]]})),o=this.getCompilationKey(a,i),s=this.compiledMap.get(o);null==s&&(s=this.compile(t,i),this.compiledMap.set(o,s));var u={};return Ge((function(){var r=new Tb(n._weightMap,u),a=My({},n.weightMap);Object.keys(t).forEach((function(e){a[e]=[t[e]]}));for(var i=n.getFrozenTensorIds(a),o={},c=0;c<s.length;c++){var l=s[c];if(!a[l.name]){var p=Cb(l,a,r);if(p instanceof Promise)throw new Error("The execution of the op '"+l.op+"' returned a promise. Please use model.executeAsync() instead.");a[l.name]=p,n.checkTensorForDisposal(l.name,l,a,r,i,e,o)}}return e.map((function(t){return Uy(t,a,r)}))}))},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,a,i,o){"control"!==e.category&&-1===i.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var e=function(t,e,n){return e[Hy(t,n.currentContextId)]}(t.name,n,r);null!=e&&e.forEach((function(t){if(t&&!a.has(t.id)){var e=o[t.id];1===e?(t.dispose(),delete o[t.id]):null!=e&&o[t.id]--}}))}})))},t.prototype.executeAsync=function(t,e){return Fy(this,void 0,void 0,(function(){var n,r,a,i,o,s,u=this;return zy(this,(function(c){switch(c.label){case 0:return this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e),n={},r=new Tb(this._weightMap,n),[4,this.executeWithControlFlow(t,r,e)];case 1:return a=c.sent(),i=e.map((function(t){return Uy(t,a,r)})),o=new Set(i.map((function(t){return t.id}))),s=new Set(Object.keys(t).map((function(e){return t[e].id}))),Object.keys(a).forEach((function(t){a[t].forEach((function(t){!t||t.isDisposed||o.has(t.id)||s.has(t.id)||-1!==u.weightIds.indexOf(t.id)||t.dispose()}))})),[2,i]}}))}))},t.prototype.executeWithControlFlow=function(t,e,n){return Fy(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,p,f,h,d,m,v,g,y,b=this;return zy(this,(function(w){switch(w.label){case 0:r=Object.keys(t),a=r.map((function(t){return b.graph.nodes[t]})),i=n.map((function(t){return b.graph.nodes[qy(t)[0]]})),o=Ib(t,i,this.weightMap),s=o.usedNodes,u=o.missingInputs,c=o.dynamicNode,l=o.syncInputs,p=a.concat(this.graph.weights).map((function(t){return{node:t,contexts:e.currentContext}})),f=My({},this.weightMap),Object.keys(t).forEach((function(e){f[e]=[t[e]]})),h={},d=this.getFrozenTensorIds(f),m={},w.label=1;case 1:return p.length>0?(v=this.processStack(a,p,e,f,m,d,n,h,s),[4,Promise.all(v)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(null==c&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(g=i.filter((function(t){return!Rb(t)&&!Uy(t.name,f,e)})).map((function(t){return t.name}))).length>0)throw y="",null!=c&&(y="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+l+"]"),new Error("Cannot compute the outputs ["+g+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+u+"]. "+y);return[2,f]}}))}))},t.prototype.processStack=function(t,e,n,r,a,i,o,s,u){for(var c=this,l=[],p=function(){var p=e.pop();n.currentContext=p.contexts;var h="";if("Enter"===p.node.op&&Wy("isConstant",p.node,r,n)&&(h=jy(p.node.name,n)[0]),-1===t.indexOf(p.node)){var d=Cb(p.node,r,n);h||(h=jy(p.node.name,n)[0]);var m=n.currentContext;d instanceof Promise?l.push(d.then((function(t){return r[h]=t,n.currentContext=m,c.checkTensorForDisposal(h,p.node,r,n,i,o,s),c.processChildNodes(p.node,e,n,r,a,u),t}))):(r[h]=d,f.checkTensorForDisposal(h,p.node,r,n,i,o,s),f.processChildNodes(p.node,e,n,r,a,u))}else f.processChildNodes(p.node,e,n,r,a,u)},f=this;e.length>0;)p();return l},t.prototype.processChildNodes=function(t,e,n,r,a,i){t.children.forEach((function(t){var o=jy(t.name,n)[0];!a[o]&&i.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!Uy(t,r,n)}))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!Uy(t,r,n)}))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})))}))},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],a=e.graph.nodes[n];if(a.attrParams.shape&&a.attrParams.shape.value){var i=a.attrParams.shape.value,o=i.length===r.shape.length&&r.shape.every((function(t,e){return-1===i[e]||i[e]===t}));at.assert(o,(function(){return"The shape of dict['"+a.name+"'] provided in model.execute(dict) must be ["+i+"], but was ["+r.shape+"]"}))}a.attrParams.dtype&&a.attrParams.dtype.value&&at.assert(r.dtype===a.attrParams.dtype.value,(function(){return"The dtype of dict['"+a.name+"'] provided in model.execute(dict) must be "+a.attrParams.dtype.value+", but was "+r.dtype}))}))},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter((function(t){return!e.graph.nodes[t]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},t.prototype.checkOutputs=function(t){var e=this;t.forEach((function(t){var n=qy(t)[0];if(!e.graph.nodes[n])throw new Error("The output '"+t+"' is not found in the graph")}))},t}(),Mb=function(){function t(t,e){void 0===e&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=ef.browserHTTPRequest(t,this.loadOptions);else{var e=ef.getLoadHandlers(t,this.loadOptions.onProgress);if(0===e.length)e.push(ef.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},t.prototype.load=function(){return Fy(this,void 0,void 0,(function(){var t,e,n;return zy(this,(function(r){switch(r.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return t=r.sent(),e=t.modelTopology,this.version=e.versions.producer+"."+e.versions.minConsumer,n=ef.decodeWeights(t.weightData,t.weightSpecs),this.executor=new Ob(cb.Instance.transformGraph(e)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),[2,!0]}}))}))},t.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},t.prototype.normalizeInputs=function(t){if(!(t instanceof dt||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return Fy(this,void 0,void 0,(function(){var n;return zy(this,(function(r){switch(r.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})},t.prototype.dispose=function(){this.executor.dispose()},t}();function Fb(t,e){return void 0===e&&(e={}),Fy(this,void 0,void 0,(function(){var n;return zy(this,(function(r){switch(r.label){case 0:if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file"),[4,(n=new Mb(t,e)).load()];case 1:return r.sent(),[2,n]}}))}))}var zb="1.3.1",Bb=function(t,e){return(Bb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Lb(t,e){function n(){this.constructor=t}Bb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Pb(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function Vb(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;function Wb(t,e){return t(e={exports:{}},e.exports),e.exports}var Ub=Wb((function(t){!function(t,e,n){function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var n=new function(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}(t),a=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,a&&("object"==typeof a&&r(a,n),i.state=function(){return r(n,{})}),i}e&&e.exports?e.exports=a:this.alea=a}(0,t)})),jb=Wb((function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var n=new function(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&("object"==typeof a&&r(a,n),i.state=function(){return r(n,{})}),i}e&&e.exports?e.exports=a:this.xor128=a}(0,t)})),Hb=Wb((function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&("object"==typeof a&&r(a,n),i.state=function(){return r(n,{})}),i}e&&e.exports?e.exports=a:this.xorwow=a}(0,t)})),qb=Wb((function(t){!function(t,e,n){function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],n=(t^=t>>>7)^t<<24,n^=(t=r[a+1&7])^t>>>10,n^=(t=r[a+3&7])^t>>>3,n^=(t=r[a+4&7])^t<<7,t=r[a+7&7],n^=(t^=t<<13)^t<<9,r[a]=n,e.i=a+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(a.x&&r(a,n),i.state=function(){return r(n,{})}),i}e&&e.exports?e.exports=a:this.xorshift7=a}(0,t)})),Gb=Wb((function(t){!function(t,e,n){function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},function(t,e){var n,r,a,i,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,i=-32;i<u;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}(e,t)}(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&(a.X&&r(a,n),i.state=function(){return r(n,{})}),i}e&&e.exports?e.exports=a:this.xor4096=a}(0,t)})),Zb=Wb((function(t){!function(t,e,n){function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}(t),a=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,a&&("object"==typeof a&&r(a,n),i.state=function(){return r(n,{})}),i}e&&e.exports?e.exports=a:this.tychei=a}(0,t)})),Kb=Wb((function(t){!function(e,r){var a,i=this,o=256,s="random",u=r.pow(o,6),c=r.pow(2,52),l=2*c,p=255;function f(t,n,f){var v=[],g=d(function t(e,n){var r,a=[],i=typeof e;if(n&&"object"==i)for(r in e)try{a.push(t(e[r],n-1))}catch(t){}return a.length?a:"string"==i?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,m(e)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(o):(t=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(e)]}}():t,3),v),y=new function(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=p&i+t[a%n]+(e=s[a])],s[i]=e;(r.g=function(t){for(var e,n=0,a=r.i,i=r.j,s=r.S;t--;)e=s[a=p&a+1],n=n*o+s[p&(s[a]=s[i=p&i+e])+(s[i]=e)];return r.i=a,r.j=i,n})(o)}(v),b=function(){for(var t=y.g(6),e=u,n=0;t<c;)t=(t+n)*o,e*=o,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,d(m(y.S),e),(n.pass||f||function(t,e,n,a){return a&&(a.S&&h(a,y),t.state=function(){return h(y,{})}),n?(r[s]=t,e):t})(b,g,"global"in n?n.global:this==r,n.state)}function h(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){for(var n,r=t+"",a=0;a<r.length;)e[p&a]=p&(n^=19*e[p&a])+r.charCodeAt(a++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(r["seed"+s]=f,d(r.random(),e),t.exports){t.exports=f;try{a=n(4406)}catch(t){}}}([],Math)}));Kb.alea=Ub,Kb.xor128=jb,Kb.xorwow=Hb,Kb.xorshift7=qb,Kb.xor4096=Gb,Kb.tychei=Zb;var Xb=Kb.alea;function $b(t,e,n,r){if(void 0===n&&(n=new Map),void 0===r&&(r=new Set),null==t)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);var a=e(t);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(ew(t)){var i=Array.isArray(t)?[]:{};for(var o in r.add(t),t){var s=$b(t[o],e,n,r);i[o]=s}return r.delete(t),i}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,a.value),a.value}function Yb(t,e){return void 0===e&&(e=Jb),Qb(t,e)}function Qb(t,e,n){void 0===n&&(n=new Set);var r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=e(t);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(ew(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=Qb(t.map((function(t){return t[r]})),e,n);i[r]=a};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: "+r)}return a.value}function Jb(t){return null===t?null:ew(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function tw(t,e){return Pb(this,void 0,void 0,(function(){var n,r,a,i,o,s;return Vb(this,(function(u){switch(u.label){case 0:n=new Map,$b(t,e,n),r=0,a=Array.from(n.keys()),u.label=1;case 1:return r<a.length?(i=a[r],(o=n.get(i))instanceof Promise?[4,o]:[3,3]):[3,4];case 2:s=u.sent(),n.set(i,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,$b(t,e,n)]}}))}))}function ew(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof dt))}function nw(t){return function(t,e){return $b(t,e)}(t,rw)}function rw(t){return t instanceof dt?{value:t.clone(),recurse:!1}:ew(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var aw=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];this.push(r)}},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n},t}(),iw=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return Lb(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),n=this.length(),r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},e.INITIAL_CAPACITY=32,e}(aw);function ow(t){return new fw(t)}function sw(t){return new hw(t)}function uw(t,e){return new Nw(t,e)}function cw(t,e){return void 0===e&&(e=lw.FAIL),new Ew(t,e)}var lw,pw=function(){function t(){}return t.prototype.toArray=function(){return Pb(this,void 0,void 0,(function(){var t,e;return Vb(this,(function(n){switch(n.label){case 0:return t=[],[4,this.next()];case 1:e=n.sent(),n.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=n.sent(),[3,2];case 4:return[2,t]}}))}))},t.prototype.toArrayForTest=function(){return Pb(this,void 0,void 0,(function(){var t,e,n;return Vb(this,(function(r){switch(r.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(e.push(n.value),[4,t.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,e]}}))}))},t.prototype.resolveFully=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}}))}))},t.prototype.resolveWhile=function(t){return Pb(this,void 0,void 0,(function(){var e,n;return Vb(this,(function(r){switch(r.label){case 0:return[4,this.next()];case 1:e=r.sent(),n=t(e.value),r.label=2;case 2:return e.done||!n?[3,4]:[4,this.next()];case 3:return e=r.sent(),n=t(e.value),[3,2];case 4:return[2]}}))}))},t.prototype.handleErrors=function(t){return new ww(this,t)},t.prototype.filter=function(t){return new yw(this,t)},t.prototype.map=function(t){return new bw(this,t)},t.prototype.mapAsync=function(t){return new xw(this,t)},t.prototype.serialMapAsync=function(t){return new xw(this,t).serial()},t.prototype.flatmap=function(t){return new Sw(this,t)},t.prototype.forEachAsync=function(t){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(e){return[2,this.map(t).resolveFully()]}))}))},t.prototype.serialForEach=function(t){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(e){return[2,this.serialMapAsync(t).resolveWhile((function(t){return!0===t}))]}))}))},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new gw(this,t,e)},t.prototype.columnMajorBatch=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=Jb),this.rowMajorBatch(t,e).map((function(t){return Yb(t,n)}))},t.prototype.concatenate=function(t,e){return new Nw(ow([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new vw(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new mw(this,t)},t.prototype.prefetch=function(t){return new Cw(this,t)},t.prototype.shuffle=function(t,e){return new Tw(this,t,e)},t.prototype.serial=function(){return new dw(this)},t}(),fw=function(t){function e(e){var n=t.call(this)||this;return n.items=e,n.trav=0,n}return Lb(e,t),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:nw(t),done:!1}])}))}))},e}(pw),hw=function(t){function e(e){var n=t.call(this)||this;return n.nextFn=e,n}return Lb(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]}))}))},e}(pw),dw=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return[2,this.upstream.next()]}))}))},e}(pw),mw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=e.sent()).done?[2,t]:(Ze(t.value),[3,0]);case 2:return[2,this.upstream.next()]}}))}))},e}(pw),vw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]}))}))},e}(pw),gw=function(t){function e(e,n,r){void 0===r&&(r=!0);var a=t.call(this)||this;return a.upstream=e,a.batchSize=n,a.enableSmallLastBatch=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){var t,e;return Vb(this,(function(n){switch(n.label){case 0:t=[],n.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=n.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}}))}))},e}(pw),yw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.predicate=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){switch(e.label){case 0:return[4,this.upstream.next()];case 1:return(t=e.sent()).done||this.predicate(t.value)?[2,t]:(Ze(t.value),[3,0]);case 2:return[2]}}))}))},e}(pw),bw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r,a,i,o;return Vb(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((t=s.sent()).done)return[2,{value:null,done:!0}];for(e=_t.getTensorsInContainer(t.value),n=this.transform(t.value),r=_t.getTensorsInContainer(n),a=0,i=e;a<i.length;a++)o=i[a],_t.isTensorInList(o,r)||o.dispose();return[2,{value:n,done:!1}]}}))}))},e}(pw),ww=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.handler=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}}))}))},e}(pw),xw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r,a,i,o;return Vb(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:return(t=s.sent()).done?[2,{value:null,done:!0}]:(e=_t.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(n=s.sent(),r=_t.getTensorsInContainer(n),a=0,i=e;a<i.length;a++)o=i[a],_t.isTensorInList(o,r)||o.dispose();return[2,{value:n,done:!1}]}}))}))},e}(pw),kw=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new iw,e.lastRead=Promise.resolve({value:null,done:!1}),e}return Lb(e,t),e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}}))}))},e}(pw),Sw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r,a,i,o;return Vb(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((t=s.sent()).done)return[2,!1];for(e=_t.getTensorsInContainer(t.value),n=this.transform(t.value),r=_t.getTensorsInContainer(n),this.outputQueue.pushAll(n),a=0,i=e;a<i.length;a++)o=i[a],_t.isTensorInList(o,r)||o.dispose();return[2,!0]}}))}))},e}(kw),Nw=function(t){function e(e,n){var r=t.call(this)||this;return r.baseErrorHandler=n,r.lastRead=null,r.iterator=null,r.moreIterators=e,r}return Lb(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]}))}))},e.prototype.readFromChain=function(t){return Pb(this,void 0,void 0,(function(){var e,n;return Vb(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return r.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=r.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),r.label=3;case 3:return[4,this.iterator.next()];case 4:return(n=r.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,n]}}))}))},e}(pw);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(lw||(lw={}));var Ew=function(t){function e(e,n){void 0===n&&(n=lw.FAIL);var r=t.call(this)||this;return r.iterators=e,r.mismatchMode=n,r.count=0,r.currentPromise=null,r}return Lb(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return Pb(this,void 0,void 0,(function(){function e(t){return t instanceof pw?{value:t.next().then((function(t){return n++,t.done&&r++,t.value})),recurse:!1}:{value:null,recurse:!0}}var n,r,a;return Vb(this,(function(i){switch(i.label){case 0:return[4,t];case 1:return i.sent(),n=0,r=0,[4,tw(this.iterators,e)];case 2:if(a=i.sent(),n===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case lw.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case lw.SHORTEST:return[2,{value:null,done:!0}];case lw.LONGEST:}return this.count++,[2,{value:a,done:!1}]}}))}))},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]}))}))},e}(pw),Cw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.bufferSize=n,r.buffer=new aw(n),r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(pw),Tw=function(t){function e(e,n,r){var a=t.call(this,e,n)||this;return a.upstream=e,a.windowSize=n,a.upstreamExhausted=!1,a.random=Xb(r||at.now().toString()),a.lastRead=Promise.resolve({value:null,done:!1}),a}return Lb(e,t),e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t=this;return Vb(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return Pb(this,void 0,void 0,(function(){var t,e;return Vb(this,(function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=n.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}}))}))},e}(Cw),Iw=function(){function t(){this.size=null}return t.prototype.batch=function(t,e){var n=this;void 0===e&&(e=!0);var r=this;return at.assert(t>0,(function(){return"batchSize needs to be positive, but it is\n      "+t})),_w((function(){return Pb(n,void 0,void 0,(function(){return Vb(this,(function(n){switch(n.label){case 0:return[4,r.iterator()];case 1:return[2,n.sent().columnMajorBatch(t,e,Dw)]}}))}))}),this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){var e,r;return Vb(this,(function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return r=(e=a.sent()).concatenate,[4,t.iterator()];case 2:return[2,r.apply(e,[a.sent()])]}}))}))}),this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().filter((function(e){return Ge((function(){return t(e)}))}))]}}))}))}),this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}}))}))},t.prototype.forEach=function(t){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(e){return We("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]}))}))},t.prototype.map=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().map((function(e){return Ge((function(){return t(e)}))}))]}}))}))}),this.size)},t.prototype.mapAsync=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().mapAsync(t)]}}))}))}),this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().prefetch(t)]}}))}))}),this.size)},t.prototype.repeat=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){var e=this;return Vb(this,(function(r){return[2,uw(sw((function(){return Pb(e,void 0,void 0,(function(){var t;return Vb(this,(function(e){switch(e.label){case 0:return t={},[4,n.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}}))}))})).take(t))]}))}))}),null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().skip(t)]}}))}))}),null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,e,n){var r=this;if(void 0===n&&(n=!0),null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var a=this,i=Xb(e||at.now().toString());return _w((function(){return Pb(r,void 0,void 0,(function(){var e;return Vb(this,(function(r){switch(r.label){case 0:return e=i.int32(),n&&(e+=i.int32()),[4,a.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}}))}))}),this.size)},t.prototype.take=function(t){var e=this,n=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().take(t)]}}))}))}),null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}}))}))},t.prototype.toArrayForTest=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}}))}))},t.MAX_BUFFER_SIZE=1e4,t}();function _w(t,e){return void 0===e&&(e=null),new(function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.size=e,t}return Lb(r,n),r.prototype.iterator=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(e){return[2,t()]}))}))},r}(Iw))}function Aw(t){var e=this;return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(e){return[2,ow(t)]}))}))}),t.length)}function Rw(t){var e,n=this;if(!ew(t))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var r=0;r<t.length;r++)e=null==e?t[r].size:Math.min(e,t[r].size);else if(t instanceof Object)for(var a in t)e=null==e?t[a].size:Math.min(e,t[a].size);return _w((function(){return Pb(n,void 0,void 0,(function(){return Vb(this,(function(e){switch(e.label){case 0:return[4,tw(t,(function(t){if(t instanceof Iw)return{value:t.iterator(),recurse:!1};if(ew(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}))];case 1:return[2,cw(e.sent(),lw.SHORTEST)]}}))}))}),e)}function Dw(t){return null===t?null:function(t){return null==t||function(t){return null===t||"object"!=typeof t&&"function"!=typeof t}(t)||Array.isArray(t)||"object"==typeof t&&t instanceof dt||at.isTypedArray(t)}(t[0])?{value:Ow(t),recurse:!1}:{value:null,recurse:!0}}function Ow(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof dt?_r(t):En(t)}var Mw=function(t){function e(e){var n=t.call(this)||this;return n.input=e,n}return Lb(e,t),e.prototype.iterator=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){switch(e.label){case 0:return[4,this.input.iterator()];case 1:return t=e.sent(),[2,t.decodeUTF8().split("\n").map((function(t){return t.endsWith("\r")&&(t=t.slice(0,-1)),t}))]}}))}))},e}(Iw),Fw='"',zw=Symbol("out"),Bw=Symbol("field"),Lw=Symbol("quote"),Pw=Symbol("quoteafterquote"),Vw=Symbol("quoteinquote"),Ww=function(t){function e(e,n){var r=t.call(this)||this;return r.input=e,r.hasHeader=!0,r.fullColumnNames=null,r.columnNamesValidated=!1,r.columnConfigs=null,r.configuredColumnsOnly=!1,r.delimiter=",",r.delimWhitespace=!1,r.base=new Mw(e),n||(n={}),r.hasHeader=!1!==n.hasHeader,r.fullColumnNames=n.columnNames,r.columnConfigs=n.columnConfigs,r.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(at.assert(null==n.delimiter,(function(){return"Delimiter should not be provided when delimWhitespace is true."})),r.delimWhitespace=!0,r.delimiter=" "):r.delimiter=n.delimiter?n.delimiter:",",r}return Lb(e,t),e.prototype.columnNames=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}}))}))},e.prototype.setColumnNames=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r,a,i,o=this;return Vb(this,(function(s){switch(s.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=s.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&at.assert(t.length===this.fullColumnNames.length,(function(){return"The length of provided columnNames ("+o.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."})),this.fullColumnNames||(this.fullColumnNames=t),e=this.fullColumnNames.reduce((function(t,e){return t[e]=t[e]+1||1,t}),{}),n=Object.keys(e).filter((function(t){return e[t]>1})),at.assert(0===n.length,(function(){return"Duplicate column names found: "+n.toString()})),this.columnConfigs)for(r=0,a=Object.keys(this.columnConfigs);r<a.length;r++)if(i=a[r],-1===this.fullColumnNames.indexOf(i))throw new Error('The key "'+i+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}}))}))},e.prototype.maybeReadHeaderLine=function(){return Pb(this,void 0,void 0,(function(){var t,e;return Vb(this,(function(n){switch(n.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,n.sent().next()];case 2:if((t=n.sent()).done)throw new Error("No data was found for CSV parsing.");return e=t.value,[2,this.parseRow(e,!1)];case 3:return[2,null]}}))}))},e.prototype.iterator=function(){return Pb(this,void 0,void 0,(function(){var t,e=this;return Vb(this,(function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[4,this.base.iterator()];case 3:return t=n.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map((function(t){return e.makeDataElement(t)}))]}}))}))},e.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),n={},r={},a=0;a<this.fullColumnNames.length;a++){var i=this.fullColumnNames[a],o=this.columnConfigs?this.columnConfigs[i]:null;if(!this.configuredColumnsOnly||o){var s=e[a],u=null;if(""===s)if(o&&void 0!==o.default)u=o.default;else{if(o&&(o.required||o.isLabel))throw new Error("Required column "+i+" is empty in this line: "+t);u=void 0}else{var c=Number(s);if(isNaN(c))u=o&&"bool"===o.dtype?this.getBoolean(s):s;else if(o&&o.dtype)switch(o.dtype){case"float32":default:u=c;break;case"int32":u=Math.floor(c);break;case"bool":u=this.getBoolean(s)}else u=c}o&&o.isLabel?r[i]=u:n[i]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}},e.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},e.prototype.parseRow=function(t,e){void 0===e&&(e=!0);for(var n=[],r=0,a=t.length,i=zw,o=0;o<a;o++)switch(i){case zw:switch(t.charAt(o)){case Fw:r=o+1,i=Lw;break;case this.delimiter:if(r=o+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),i=zw;break;default:i=Bw,r=o}break;case Bw:if(t.charAt(o)===this.delimiter)n.push(t.substring(r,o)),i=zw,r=o+1;break;case Lw:if(t.charAt(o)===Fw)i=Pw;break;case Pw:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(r,o-1)),i=zw,r=o+1;break;case Fw:i=Lw;break;default:i=Vw}break;case Vw:if(t.charAt(o)===Fw)i=Lw}if(i===Pw?n.push(t.substring(r,a-1)):n.push(t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+n);return n},e}(Iw),Uw=function(t){function e(e){var n=t.call(this)||this;n.microphoneConfig=e,n.isClosed=!1,n.fftSize=e.fftSize||1024;var r=Math.log2(n.fftSize);if(n.fftSize<0||r<4||r>14||!Number.isInteger(r))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+n.fftSize);if(n.numFrames=e.numFramesPerSpectrogram||43,n.sampleRateHz=e.sampleRateHz,n.columnTruncateLength=e.columnTruncateLength||n.fftSize,n.audioTrackConstraints=e.audioTrackConstraints,n.smoothingTimeConstant=e.smoothingTimeConstant||0,n.includeSpectrogram=!1!==e.includeSpectrogram,n.includeWaveform=!0===e.includeWaveform,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}return Lb(e,t),e.prototype.summary=function(){return"microphone"},e.create=function(t){return void 0===t&&(t={}),Pb(this,void 0,void 0,(function(){var n;return Vb(this,(function(r){switch(r.label){case 0:if(c().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new e(t)).start()];case 1:return r.sent(),[2,n]}}))}))},e.prototype.start=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r;return Vb(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return t.stream=a.sent(),[3,3];case 2:throw e=a.sent(),new Error("Error thrown while initializing video stream: "+e.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(n=window.AudioContext||window.webkitAudioContext,this.audioContext=new n,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}}))}))},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r,a;return Vb(this,(function(i){switch(i.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return n=i.sent(),this.includeSpectrogram&&(r=this.flattenQueue(n.freqDataQueue),t=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(a=this.flattenQueue(n.timeDataQueue),e=this.getTensorFromAudioDataArray(a,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:e},done:!1}]}}))}))},e.prototype.capture=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.getAudioData=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r=this;return Vb(this,(function(a){return t=[],e=[],n=0,[2,new Promise((function(a){var i=setInterval((function(){r.includeSpectrogram&&(r.analyser.getFloatFrequencyData(r.freqData),r.freqData[0]===-1/0&&a({freqDataQueue:t,timeDataQueue:e}),t.push(r.freqData.slice(0,r.columnTruncateLength))),r.includeWaveform&&(r.analyser.getFloatTimeDomainData(r.timeData),e.push(r.timeData.slice())),++n===r.numFrames&&(clearInterval(i),a({freqDataQueue:t,timeDataQueue:e}))}),r.fftSize/r.sampleRateHz*1e3)}))]}))}))},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((function(t,r){return n.set(t,r*e)})),n},e.prototype.getTensorFromAudioDataArray=function(t,e){var n=new Float32Array(at.sizeFromShape(e));return n.set(t,n.length-t.length),En(n,e)},e}(pw),jw=function(t){function e(e,n){var r=t.call(this)||this;if(r.webcamVideoElement=e,r.webcamConfig=n,r.isClosed=!0,r.resize=!1,r.needToResize())if(r.resize=!0,r.cropSize=[r.webcamConfig.resizeHeight,r.webcamConfig.resizeWidth],r.cropBoxInd=In([0],"int32"),r.webcamConfig.centerCrop){var a=1*r.webcamConfig.resizeWidth/r.webcamVideoElement.width,i=1*r.webcamConfig.resizeHeight/r.webcamVideoElement.height,o=(1-a)/2,s=(1-i)/2,u=o+a,c=i+s;r.cropBox=_n([s,o,c,u],[1,4])}else r.cropBox=_n([0,0,1,1],[1,4]);return r}return Lb(e,t),e.prototype.summary=function(){return"webcam"},e.create=function(t,n){return void 0===n&&(n={}),Pb(this,void 0,void 0,(function(){var r;return Vb(this,(function(a){switch(a.label){case 0:if(c().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}return[4,(r=new e(t,n)).start()];case 1:return a.sent(),[2,r]}}))}))},e.prototype.start=function(){return Pb(this,void 0,void 0,(function(){var t,e,n=this;return Vb(this,(function(r){switch(r.label){case 0:this.webcamConfig.facingMode&&at.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(function(){return"Invalid webcam facing mode: "+n.webcamConfig.facingMode+". Please provide 'user' or 'environment'"})),r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=r.sent(),[3,4];case 3:throw(e=r.sent()).message="Error thrown while initializing video stream: "+e.message,e;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise((function(t){n.webcamVideoElement.onloadedmetadata=function(){t()}}))]}}))}))},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){if(this.isClosed)return[2,{value:null,done:!0}];try{t=of.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(t))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(t){throw new Error("Error thrown cropping the video: "+t.message)}finally{t.dispose()}return[2]}))}))},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var e=this;return Ge((function(){var n,r=t.toFloat().expandDims(0),a=(n=Xl.cropAndResize(r,e.cropBox,e.cropBoxInd,e.cropSize,"bilinear")).shape;return n.reshape(a.slice(1))}))},e.prototype.capture=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.stop=function(){this.stream.getTracks().forEach((function(t){return t.stop()}));try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},e}(pw),Hw=function(){},qw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lb(e,t),e.prototype.split=function(t){return new Gw(this,t)},e}(pw),Gw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.impl=new Zw(e,n),r}return Lb(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return[2,this.impl.next()]}))}))},e}(qw),Zw=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.separator=n,r.carryover="",r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return Pb(this,void 0,void 0,(function(){var t,e,n,r,a;return Vb(this,(function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:if((t=i.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],n=0,r=e.slice(0,-1);n<r.length;n++)a=r[n],this.outputQueue.push(a);return this.carryover=e[e.length-1],[2,!0]}}))}))},e}(kw),Kw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Lb(e,t),e.prototype.decodeUTF8=function(){return new Xw(this)},e}(pw),Xw=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.impl=new $w(e),n}return Lb(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return[2,this.impl.next()]}))}))},e}(qw),$w=function(t){function e(e){var r=t.call(this)||this;if(r.upstream=e,c().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var a=n(7422).StringDecoder;r.decoder=new a("utf8")}return r}return Lb(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return Pb(this,void 0,void 0,(function(){var t,e,n;return Vb(this,(function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done?[2,!1]:(e=t.value,n=c().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(n),[2,!0])}}))}))},e}(kw),Yw=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.file=e,r.options=n,at.assert(e instanceof Uint8Array||!!c().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),(function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."})),r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return Lb(e,t),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return Pb(this,void 0,void 0,(function(){var t,e,n=this;return Vb(this,(function(r){switch(r.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise((function(t,e){var r=n.offset+n.chunkSize;if(n.file instanceof Uint8Array)t(new Uint8Array(n.file.slice(n.offset,r)));else{var a=new FileReader;a.onload=function(n){var r=a.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},a.onabort=function(t){return e(new Error("Aborted"))},a.onerror=function(t){return e(new Error(t.type))};var i=n.file.slice(n.offset,r);a.readAsArrayBuffer(i)}n.offset=r})),e={},[4,t]);case 1:return[2,(e.value=r.sent(),e.done=!1,e)]}}))}))},e}(Kw);function Qw(t,e){return void 0===e&&(e={}),Pb(this,void 0,void 0,(function(){var n,r,a,i,o;return Vb(this,(function(s){switch(s.label){case 0:return"string"==typeof t?n=t:(n=t.url,r=Jw(t)),[4,at.fetch(n,r)];case 1:return(a=s.sent()).ok?(o=Uint8Array.bind,[4,a.arrayBuffer()]):[3,3];case 2:return i=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new Yw(i,e)];case 3:throw new Error(a.statusText)}}))}))}var Jw=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function tx(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var ex=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.input=e,r.options=n,r}return Lb(e,t),e.prototype.iterator=function(){return Pb(this,void 0,void 0,(function(){var t;return Vb(this,(function(e){return tx(this.input)&&c().get("IS_NODE")&&(t=n(6910),this.input=t.readFileSync(this.input.substr(7))),[2,new Yw(this.input,this.options)]}))}))},e}(Hw),nx=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.url=e,r.fileOptions=n,r}return Lb(e,t),e.prototype.iterator=function(){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(t){return tx(this.url)?[2,new ex(this.url,this.fileOptions).iterator()]:[2,Qw(this.url,this.fileOptions)]}))}))},e}(Hw);function rx(t,e){return void 0===e&&(e={}),new Ww(new nx(t),e)}function ax(t){var e=this,n=sw(t);return _w((function(){return Pb(e,void 0,void 0,(function(){return Vb(this,(function(t){return[2,n]}))}))}))}function ix(t){var e=this;return _w((function(){return Pb(e,void 0,void 0,(function(){var e;return Vb(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return e=n.sent(),[2,sw((function(){return e.next()}))]}}))}))}))}function ox(t,e){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(n){return[2,jw.create(t,e)]}))}))}function sx(t){return Pb(this,void 0,void 0,(function(){return Vb(this,(function(e){return[2,Uw.create(t)]}))}))}var ux="1.3.1",cx={"tfjs-core":mf,"tfjs-data":ux,"tfjs-layers":Om,"tfjs-converter":zb,tfjs:"1.3.1"}},221:function(t,e,n){"use strict";function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e,n){var a=n.value;if("function"!==typeof a)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(r(a)));var i=!1;return{configurable:!0,get:function(){if(i||this===t.prototype||this.hasOwnProperty(e)||"function"!==typeof a)return a;var n=a.bind(this);return i=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return n},set:function(t){a=t,delete this[e]}}),i=!1,n},set:function(t){a=t}}}function i(t){var e;return"undefined"!==typeof Reflect&&"function"===typeof Reflect.ownKeys?e=Reflect.ownKeys(t.prototype):(e=Object.getOwnPropertyNames(t.prototype),"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(t.prototype)))),e.forEach((function(e){if("constructor"!==e){var n=Object.getOwnPropertyDescriptor(t.prototype,e);"function"===typeof n.value&&Object.defineProperty(t.prototype,e,a(t,e,n))}})),t}function o(){return 1===arguments.length?i.apply(void 0,arguments):a.apply(void 0,arguments)}n.r(e),n.d(e,{boundClass:function(){return i},boundMethod:function(){return a},default:function(){return o}})},8987:function(t){t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(E){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(t,e){var n,r,o;return e?(o=0<=(t>>>=0)&&t<256)&&(r=i[t])?r:(n=u(t,(0|t)<0?-1:0,!0),o&&(i[t]=n),n):(o=-128<=(t|=0)&&t<128)&&(r=a[t])?r:(n=u(t,t<0?-1:0,!1),o&&(a[t]=n),n)}function s(t,e){if(isNaN(t))return e?g:v;if(e){if(t<0)return g;if(t>=h)return k}else{if(t<=-d)return S;if(t+1>=d)return x}return t<0?s(-t,e).neg():u(t%f|0,t/f|0,e)}function u(t,e,r){return new n(t,e,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var c=Math.pow;function l(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v;if("number"===typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(t.substring(1),e,n).neg();for(var a=s(c(n,8)),i=v,o=0;o<t.length;o+=8){var u=Math.min(8,t.length-o),p=parseInt(t.substring(o,o+u),n);if(u<8){var f=s(c(n,u));i=i.mul(f).add(s(p))}else i=(i=i.mul(a)).add(s(p))}return i.unsigned=e,i}function p(t,e){return"number"===typeof t?s(t,e):"string"===typeof t?l(t,e):u(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}n.fromString=l,n.fromValue=p;var f=4294967296,h=f*f,d=h/2,m=o(1<<24),v=o(0);n.ZERO=v;var g=o(0,!0);n.UZERO=g;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var w=o(-1);n.NEG_ONE=w;var x=u(-1,2147483647,!1);n.MAX_VALUE=x;var k=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var S=u(0,-2147483648,!1);n.MIN_VALUE=S;var N=n.prototype;N.toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},N.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var e=s(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var a=s(c(t,6),this.unsigned),i=this,o="";;){var u=i.div(a),l=(i.sub(u.mul(a)).toInt()>>>0).toString(t);if((i=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},N.isZero=function(){return 0===this.high&&0===this.low},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return 1===(1&this.low)},N.isEven=function(){return 0===(1&this.low)},N.equals=function(t){return r(t)||(t=p(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},N.eq=N.equals,N.notEquals=function(t){return!this.eq(t)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function(t){return this.comp(t)<0},N.lt=N.lessThan,N.lessThanOrEqual=function(t){return this.comp(t)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function(t){return this.comp(t)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function(t){return this.comp(t)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function(t){if(r(t)||(t=p(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(y)},N.neg=N.negate,N.add=function(t){r(t)||(t=p(t));var e=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=t.high>>>16,s=65535&t.high,c=t.low>>>16,l=0,f=0,h=0,d=0;return h+=(d+=i+(65535&t.low))>>>16,f+=(h+=a+c)>>>16,l+=(f+=n+s)>>>16,l+=e+o,u((h&=65535)<<16|(d&=65535),(l&=65535)<<16|(f&=65535),this.unsigned)},N.subtract=function(t){return r(t)||(t=p(t)),this.add(t.neg())},N.sub=N.subtract,N.multiply=function(t){if(this.isZero())return v;if(r(t)||(t=p(t)),e)return u(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return v;if(this.eq(S))return t.isOdd()?S:v;if(t.eq(S))return this.isOdd()?S:v;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return s(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=t.high>>>16,l=65535&t.high,f=t.low>>>16,h=65535&t.low,d=0,g=0,y=0,b=0;return y+=(b+=o*h)>>>16,g+=(y+=i*h)>>>16,y&=65535,g+=(y+=o*f)>>>16,d+=(g+=a*h)>>>16,g&=65535,d+=(g+=i*f)>>>16,g&=65535,d+=(g+=o*l)>>>16,d+=n*h+a*f+i*l+o*c,u((y&=65535)<<16|(b&=65535),(d&=65535)<<16|(g&=65535),this.unsigned)},N.mul=N.multiply,N.divide=function(t){if(r(t)||(t=p(t)),t.isZero())throw Error("division by zero");var n,a,i;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?u((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:v;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return b;i=g}else{if(this.eq(S))return t.eq(y)||t.eq(w)?S:t.eq(S)?y:(n=this.shr(1).div(t).shl(1)).eq(v)?t.isNegative()?y:w:(a=this.sub(t.mul(n)),i=n.add(a.div(t)));if(t.eq(S))return this.unsigned?g:v;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=v}for(a=this;a.gte(t);){n=Math.max(1,Math.floor(a.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),f=s(n),h=f.mul(t);h.isNegative()||h.gt(a);)h=(f=s(n-=l,this.unsigned)).mul(t);f.isZero()&&(f=y),i=i.add(f),a=a.sub(h)}return i},N.div=N.divide,N.modulo=function(t){return r(t)||(t=p(t)),e?u((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return u(~this.low,~this.high,this.unsigned)},N.and=function(t){return r(t)||(t=p(t)),u(this.low&t.low,this.high&t.high,this.unsigned)},N.or=function(t){return r(t)||(t=p(t)),u(this.low|t.low,this.high|t.high,this.unsigned)},N.xor=function(t){return r(t)||(t=p(t)),u(this.low^t.low,this.high^t.high,this.unsigned)},N.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?u(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):u(0,this.low<<t-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?u(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):u(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?u(this.low>>>t|e<<32-t,e>>>t,this.unsigned):u(32===t?e:e>>>t-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},N.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},N.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},4463:function(t,e,n){"use strict";var r=n(2791),a=n(5296);function i(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(s[t]=e,t=0;t<e.length;t++)o.add(e[t])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),p=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},d={};function m(t,e,n,r,a,i,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){v[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];v[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){v[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){v[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){v[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){v[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){v[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){v[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){v[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(t){return t[1].toUpperCase()}function b(t,e,n,r){var a=v.hasOwnProperty(e)?v[e]:null;(null!==a?0!==a.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,a,r)&&(n=null),r||null===a?function(t){return!!p.call(d,t)||!p.call(h,t)&&(f.test(t)?d[t]=!0:(h[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=null===n?3!==a.type&&"":n:(e=a.attributeName,r=a.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(g,y);v[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(g,y);v[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(g,y);v[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){v[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){v[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),T=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function F(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=M&&t[M]||t["@@iterator"])?t:null}var z,B=Object.assign;function L(t){if(void 0===z)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);z=e&&e[1]||""}return"\n"+z+t}var P=!1;function V(t,e){if(!t||P)return"";P=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}}while(1<=o&&0<=s);break}}}finally{P=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?L(t):""}function W(t){switch(t.tag){case 5:return L(t.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return t=V(t.type,!1);case 11:return t=V(t.type.render,!1);case 1:return t=V(t.type,!0);default:return""}}function U(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case k:return"Portal";case E:return"Profiler";case N:return"StrictMode";case _:return"Suspense";case A:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case T:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case I:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case R:return null!==(e=t.displayName||null)?e:U(t.type)||"Memo";case D:e=t._payload,t=t._init;try{return U(t(e))}catch(n){}}return null}function j(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(e);case 8:return e===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function H(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function q(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function G(t){t._valueTracker||(t._valueTracker=function(t){var e=q(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(t){r=""+t,i.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Z(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=q(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function K(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function X(t,e){var n=e.checked;return B({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function $(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=H(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Y(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function Q(t,e){Y(t,e);var n=H(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,H(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&K(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+H(n),e=null,a=0;a<t.length;a++){if(t[a].value===n)return t[a].selected=!0,void(r&&(t[a].defaultSelected=!0));null!==e||t[a].disabled||(e=t[a])}null!==e&&(e.selected=!0)}}function rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(i(91));return B({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function at(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(i(92));if(et(n)){if(1<n.length)throw Error(i(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:H(n)}}function it(t,e){var n=H(e.value),r=H(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ut(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ct,lt,pt=(lt=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ct=ct||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ct.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return lt(t,e)}))}:lt);function ft(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ht={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dt=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ht.hasOwnProperty(t)&&ht[t]?(""+e).trim():e+"px"}function vt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=mt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}Object.keys(ht).forEach((function(t){dt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ht[e]=ht[t]}))}));var gt=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(t,e){if(e){if(gt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(i(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(i(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(i(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wt=null;function xt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var kt=null,St=null,Nt=null;function Et(t){if(t=ba(t)){if("function"!==typeof kt)throw Error(i(280));var e=t.stateNode;e&&(e=xa(e),kt(t.stateNode,t.type,e))}}function Ct(t){St?Nt?Nt.push(t):Nt=[t]:St=t}function Tt(){if(St){var t=St,e=Nt;if(Nt=St=null,Et(t),e)for(t=0;t<e.length;t++)Et(e[t])}}function It(t,e){return t(e)}function _t(){}var At=!1;function Rt(t,e,n){if(At)return t(e,n);At=!0;try{return It(t,e,n)}finally{At=!1,(null!==St||null!==Nt)&&(_t(),Tt())}}function Dt(t,e){var n=t.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(i(231,e,typeof n));return n}var Ot=!1;if(l)try{var Mt={};Object.defineProperty(Mt,"passive",{get:function(){Ot=!0}}),window.addEventListener("test",Mt,Mt),window.removeEventListener("test",Mt,Mt)}catch(lt){Ot=!1}function Ft(t,e,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(l){this.onError(l)}}var zt=!1,Bt=null,Lt=!1,Pt=null,Vt={onError:function(t){zt=!0,Bt=t}};function Wt(t,e,n,r,a,i,o,s,u){zt=!1,Bt=null,Ft.apply(Vt,arguments)}function Ut(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function jt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Ht(t){if(Ut(t)!==t)throw Error(i(188))}function qt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Ut(t)))throw Error(i(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ht(a),t;if(o===r)return Ht(a),e;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?t:e}(t))?Gt(t):null}function Gt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Gt(t);if(null!==e)return e;t=t.sibling}return null}var Zt=a.unstable_scheduleCallback,Kt=a.unstable_cancelCallback,Xt=a.unstable_shouldYield,$t=a.unstable_requestPaint,Yt=a.unstable_now,Qt=a.unstable_getCurrentPriorityLevel,Jt=a.unstable_ImmediatePriority,te=a.unstable_UserBlockingPriority,ee=a.unstable_NormalPriority,ne=a.unstable_LowPriority,re=a.unstable_IdlePriority,ae=null,ie=null;var oe=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(se(t)/ue|0)|0},se=Math.log,ue=Math.LN2;var ce=64,le=4194304;function pe(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fe(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=pe(s):0!==(i&=o)&&(r=pe(i))}else 0!==(o=n&~a)?r=pe(o):0!==i&&(r=pe(i));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&a)&&((a=r&-r)>=(i=e&-e)||16===a&&0!==(4194240&i)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)a=1<<(n=31-oe(e)),r|=t[n],e&=~a;return r}function he(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function de(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=ce;return 0===(4194240&(ce<<=1))&&(ce=64),t}function ve(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ge(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=n}function ye(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-oe(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var be=0;function we(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var xe,ke,Se,Ne,Ee,Ce=!1,Te=[],Ie=null,_e=null,Ae=null,Re=new Map,De=new Map,Oe=[],Me="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fe(t,e){switch(t){case"focusin":case"focusout":Ie=null;break;case"dragenter":case"dragleave":_e=null;break;case"mouseover":case"mouseout":Ae=null;break;case"pointerover":case"pointerout":Re.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":De.delete(e.pointerId)}}function ze(t,e,n,r,a,i){return null===t||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==e&&(null!==(e=ba(e))&&ke(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==a&&-1===e.indexOf(a)&&e.push(a),t)}function Be(t){var e=ya(t.target);if(null!==e){var n=Ut(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=jt(n)))return t.blockedOn=e,void Ee(t.priority,(function(){Se(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Le(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Xe(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=ba(n))&&ke(e),t.blockedOn=n,!1;var r=new(n=t.nativeEvent).constructor(n.type,n);wt=r,n.target.dispatchEvent(r),wt=null,e.shift()}return!0}function Pe(t,e,n){Le(t)&&n.delete(e)}function Ve(){Ce=!1,null!==Ie&&Le(Ie)&&(Ie=null),null!==_e&&Le(_e)&&(_e=null),null!==Ae&&Le(Ae)&&(Ae=null),Re.forEach(Pe),De.forEach(Pe)}function We(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ve)))}function Ue(t){function e(e){return We(e,t)}if(0<Te.length){We(Te[0],t);for(var n=1;n<Te.length;n++){var r=Te[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Ie&&We(Ie,t),null!==_e&&We(_e,t),null!==Ae&&We(Ae,t),Re.forEach(e),De.forEach(e),n=0;n<Oe.length;n++)(r=Oe[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Oe.length&&null===(n=Oe[0]).blockedOn;)Be(n),null===n.blockedOn&&Oe.shift()}var je=w.ReactCurrentBatchConfig,He=!0;function qe(t,e,n,r){var a=be,i=je.transition;je.transition=null;try{be=1,Ze(t,e,n,r)}finally{be=a,je.transition=i}}function Ge(t,e,n,r){var a=be,i=je.transition;je.transition=null;try{be=4,Ze(t,e,n,r)}finally{be=a,je.transition=i}}function Ze(t,e,n,r){if(He){var a=Xe(t,e,n,r);if(null===a)Hr(t,e,r,Ke,n),Fe(t,r);else if(function(t,e,n,r,a){switch(e){case"focusin":return Ie=ze(Ie,t,e,n,r,a),!0;case"dragenter":return _e=ze(_e,t,e,n,r,a),!0;case"mouseover":return Ae=ze(Ae,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return Re.set(i,ze(Re.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,De.set(i,ze(De.get(i)||null,t,e,n,r,a)),!0}return!1}(a,t,e,n,r))r.stopPropagation();else if(Fe(t,r),4&e&&-1<Me.indexOf(t)){for(;null!==a;){var i=ba(a);if(null!==i&&xe(i),null===(i=Xe(t,e,n,r))&&Hr(t,e,r,Ke,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Hr(t,e,r,null,n)}}var Ke=null;function Xe(t,e,n,r){if(Ke=null,null!==(t=ya(t=xt(r))))if(null===(e=Ut(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=jt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ke=t,null}function $e(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case re:return 536870912;default:return 16}default:return 16}}var Ye=null,Qe=null,Je=null;function tn(){if(Je)return Je;var t,e,n=Qe,r=n.length,a="value"in Ye?Ye.value:Ye.textContent,i=a.length;for(t=0;t<r&&n[t]===a[t];t++);var o=r-t;for(e=1;e<=o&&n[r-e]===a[i-e];e++);return Je=a.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function an(t){function e(e,n,r,a,i){for(var o in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),pn=B({},cn,{view:0,detail:0}),fn=an(pn),hn=B({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==un&&(un&&"mousemove"===t.type?(on=t.screenX-un.screenX,sn=t.screenY-un.screenY):sn=on=0,un=t),on)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),dn=an(hn),mn=an(B({},hn,{dataTransfer:0})),vn=an(B({},pn,{relatedTarget:0})),gn=an(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=B({},cn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(B({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Sn[t])&&!!e[t]}function En(){return Nn}var Cn=B({},pn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?kn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Tn=an(Cn),In=an(B({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=an(B({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),An=an(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=B({},hn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=an(Rn),On=[9,13,27,32],Mn=l&&"CompositionEvent"in window,Fn=null;l&&"documentMode"in document&&(Fn=document.documentMode);var zn=l&&"TextEvent"in window&&!Fn,Bn=l&&(!Mn||Fn&&8<Fn&&11>=Fn),Ln=String.fromCharCode(32),Pn=!1;function Vn(t,e){switch(t){case"keyup":return-1!==On.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Un=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!jn[t.type]:"textarea"===e}function qn(t,e,n,r){Ct(r),0<(e=Gr(e,"onChange")).length&&(n=new ln("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Gn=null,Zn=null;function Kn(t){Lr(t,0)}function Xn(t){if(Z(wa(t)))return t}function $n(t,e){if("change"===t)return e}var Yn=!1;if(l){var Qn;if(l){var Jn="oninput"in document;if(!Jn){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Jn="function"===typeof tr.oninput}Qn=Jn}else Qn=!1;Yn=Qn&&(!document.documentMode||9<document.documentMode)}function er(){Gn&&(Gn.detachEvent("onpropertychange",nr),Zn=Gn=null)}function nr(t){if("value"===t.propertyName&&Xn(Zn)){var e=[];qn(e,Zn,t,xt(t)),Rt(Kn,e)}}function rr(t,e,n){"focusin"===t?(er(),Zn=n,(Gn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function ar(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Xn(Zn)}function ir(t,e){if("click"===t)return Xn(e)}function or(t,e){if("input"===t||"change"===t)return Xn(e)}var sr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function ur(t,e){if(sr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!p.call(e,a)||!sr(t[a],e[a]))return!1}return!0}function cr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lr(t,e){var n,r=cr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=cr(r)}}function pr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?pr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function fr(){for(var t=window,e=K();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=K((t=e.contentWindow).document)}return e}function hr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function dr(t){var e=fr(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&pr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==t.rangeCount||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mr=l&&"documentMode"in document&&11>=document.documentMode,vr=null,gr=null,yr=null,br=!1;function wr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==vr||vr!==K(r)||("selectionStart"in(r=vr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Gr(gr,"onSelect")).length&&(e=new ln("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=vr)))}function xr(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var kr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Sr={},Nr={};function Er(t){if(Sr[t])return Sr[t];if(!kr[t])return t;var e,n=kr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Nr)return Sr[t]=n[e];return t}l&&(Nr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Cr=Er("animationend"),Tr=Er("animationiteration"),Ir=Er("animationstart"),_r=Er("transitionend"),Ar=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(t,e){Ar.set(t,e),u(e,[t])}for(var Or=0;Or<Rr.length;Or++){var Mr=Rr[Or];Dr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Dr(Cr,"onAnimationEnd"),Dr(Tr,"onAnimationIteration"),Dr(Ir,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(_r,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Br(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,a,o,s,u,c){if(Wt.apply(this,arguments),zt){if(!zt)throw Error(i(198));var l=Bt;zt=!1,Bt=null,Lt||(Lt=!0,Pt=l)}}(r,e,void 0,t),t.currentTarget=null}function Lr(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;t:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break t;Br(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break t;Br(a,s,c),i=u}}}if(Lt)throw t=Pt,Lt=!1,Pt=null,t}function Pr(t,e){var n=e[ma];void 0===n&&(n=e[ma]=new Set);var r=t+"__bubble";n.has(r)||(jr(e,t,2,!1),n.add(r))}function Vr(t,e,n){var r=0;e&&(r|=4),jr(n,t,r,e)}var Wr="_reactListening"+Math.random().toString(36).slice(2);function Ur(t){if(!t[Wr]){t[Wr]=!0,o.forEach((function(e){"selectionchange"!==e&&(zr.has(e)||Vr(e,!1,t),Vr(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Wr]||(e[Wr]=!0,Vr("selectionchange",!1,e))}}function jr(t,e,n,r){switch($e(e)){case 1:var a=qe;break;case 4:a=Ge;break;default:a=Ze}n=a.bind(null,e,n,t),a=void 0,!Ot||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(a=!0),r?void 0!==a?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):void 0!==a?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Hr(t,e,n,r,a){var i=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue t}s=s.parentNode}}r=r.return}Rt((function(){var r=i,a=xt(n),o=[];t:{var s=Ar.get(t);if(void 0!==s){var u=ln,c=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":u=Tn;break;case"focusin":c="focus",u=vn;break;case"focusout":c="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=_n;break;case Cr:case Tr:case Ir:u=gn;break;case _r:u=An;break;case"scroll":u=fn;break;case"wheel":u=Dn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=In}var l=0!==(4&e),p=!l&&"scroll"===t,f=l?null!==s?s+"Capture":null:s;l=[];for(var h,d=r;null!==d;){var m=(h=d).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==f&&(null!=(m=Dt(d,f))&&l.push(qr(d,m,h)))),p)break;d=d.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&e)){if(u="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===wt||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[da])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(p=Ut(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=dn,m="onMouseLeave",f="onMouseEnter",d="mouse","pointerout"!==t&&"pointerover"!==t||(l=In,m="onPointerLeave",f="onPointerEnter",d="pointer"),p=null==u?s:wa(u),h=null==c?s:wa(c),(s=new l(m,d+"leave",u,n,a)).target=p,s.relatedTarget=h,m=null,ya(a)===r&&((l=new l(f,d+"enter",c,n,a)).target=h,l.relatedTarget=p,m=l),p=m,u&&c)t:{for(f=c,d=0,h=l=u;h;h=Zr(h))d++;for(h=0,m=f;m;m=Zr(m))h++;for(;0<d-h;)l=Zr(l),d--;for(;0<h-d;)f=Zr(f),h--;for(;d--;){if(l===f||null!==f&&l===f.alternate)break t;l=Zr(l),f=Zr(f)}l=null}else l=null;null!==u&&Kr(o,s,u,l,!1),null!==c&&null!==p&&Kr(o,p,c,l,!0)}if("select"===(u=(s=r?wa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var v=$n;else if(Hn(s))if(Yn)v=or;else{v=ar;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=ir);switch(v&&(v=v(t,r))?qn(o,v,n,a):(g&&g(t,s,r),"focusout"===t&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&tt(s,"number",s.value)),g=r?wa(r):window,t){case"focusin":(Hn(g)||"true"===g.contentEditable)&&(vr=g,gr=r,yr=null);break;case"focusout":yr=gr=vr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(o,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,a)}var y;if(Mn)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Un?Vn(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=tn()):(Qe="value"in(Ye=a)?Ye.value:Ye.textContent,Un=!0)),0<(g=Gr(r,b)).length&&(b=new wn(b,t,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=Wn(n))&&(b.data=y))),(y=zn?function(t,e){switch(t){case"compositionend":return Wn(e);case"keypress":return 32!==e.which?null:(Pn=!0,Ln);case"textInput":return(t=e.data)===Ln&&Pn?null:t;default:return null}}(t,n):function(t,e){if(Un)return"compositionend"===t||!Mn&&Vn(t,e)?(t=tn(),Je=Qe=Ye=null,Un=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Lr(o,e)}))}function qr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Gr(t,e){for(var n=e+"Capture",r=[];null!==t;){var a=t,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Dt(t,n))&&r.unshift(qr(t,i,a)),null!=(i=Dt(t,e))&&r.push(qr(t,i,a))),t=t.return}return r}function Zr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Kr(t,e,n,r,a){for(var i=e._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Dt(n,i))&&o.unshift(qr(n,u,s)):a||null!=(u=Dt(n,i))&&o.push(qr(n,u,s))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}var Xr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Yr(t){return("string"===typeof t?t:""+t).replace(Xr,"\n").replace($r,"")}function Qr(t,e,n){if(e=Yr(e),Yr(t)!==e&&n)throw Error(i(425))}function Jr(){}var ta=null,ea=null;function na(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(t){return ia.resolve(null).then(t).catch(sa)}:ra;function sa(t){setTimeout((function(){throw t}))}function ua(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return t.removeChild(a),void Ue(e);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ue(e)}function ca(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function la(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var pa=Math.random().toString(36).slice(2),fa="__reactFiber$"+pa,ha="__reactProps$"+pa,da="__reactContainer$"+pa,ma="__reactEvents$"+pa,va="__reactListeners$"+pa,ga="__reactHandles$"+pa;function ya(t){var e=t[fa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[da]||n[fa]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=la(t);null!==t;){if(n=t[fa])return n;t=la(t)}return e}n=(t=n).parentNode}return null}function ba(t){return!(t=t[fa]||t[da])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function wa(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(i(33))}function xa(t){return t[ha]||null}var ka=[],Sa=-1;function Na(t){return{current:t}}function Ea(t){0>Sa||(t.current=ka[Sa],ka[Sa]=null,Sa--)}function Ca(t,e){Sa++,ka[Sa]=t.current,t.current=e}var Ta={},Ia=Na(Ta),_a=Na(!1),Aa=Ta;function Ra(t,e){var n=t.type.contextTypes;if(!n)return Ta;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=e[a];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Da(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Oa(){Ea(_a),Ea(Ia)}function Ma(t,e,n){if(Ia.current!==Ta)throw Error(i(168));Ca(Ia,e),Ca(_a,n)}function Fa(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(i(108,j(t)||"Unknown",a));return B({},n,r)}function za(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ta,Aa=Ia.current,Ca(Ia,t),Ca(_a,_a.current),!0}function Ba(t,e,n){var r=t.stateNode;if(!r)throw Error(i(169));n?(t=Fa(t,e,Aa),r.__reactInternalMemoizedMergedChildContext=t,Ea(_a),Ea(Ia),Ca(Ia,t)):Ea(_a),Ca(_a,n)}var La=null,Pa=!1,Va=!1;function Wa(t){null===La?La=[t]:La.push(t)}function Ua(){if(!Va&&null!==La){Va=!0;var t=0,e=be;try{var n=La;for(be=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}La=null,Pa=!1}catch(a){throw null!==La&&(La=La.slice(t+1)),Zt(Jt,Ua),a}finally{be=e,Va=!1}}return null}var ja=[],Ha=0,qa=null,Ga=0,Za=[],Ka=0,Xa=null,$a=1,Ya="";function Qa(t,e){ja[Ha++]=Ga,ja[Ha++]=qa,qa=t,Ga=e}function Ja(t,e,n){Za[Ka++]=$a,Za[Ka++]=Ya,Za[Ka++]=Xa,Xa=t;var r=$a;t=Ya;var a=32-oe(r)-1;r&=~(1<<a),n+=1;var i=32-oe(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,$a=1<<32-oe(e)+a|n<<a|r,Ya=i+t}else $a=1<<i|n<<a|r,Ya=t}function ti(t){null!==t.return&&(Qa(t,1),Ja(t,1,0))}function ei(t){for(;t===qa;)qa=ja[--Ha],ja[Ha]=null,Ga=ja[--Ha],ja[Ha]=null;for(;t===Xa;)Xa=Za[--Ka],Za[Ka]=null,Ya=Za[--Ka],Za[Ka]=null,$a=Za[--Ka],Za[Ka]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(t,e){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function si(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,ni=t,ri=ca(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,ni=t,ri=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Xa?{id:$a,overflow:Ya}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=e,n.return=t,t.child=n,ni=t,ri=null,!0);default:return!1}}function ui(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ci(t){if(ai){var e=ri;if(e){var n=e;if(!si(t,e)){if(ui(t))throw Error(i(418));e=ca(n.nextSibling);var r=ni;e&&si(t,e)?oi(r,n):(t.flags=-4097&t.flags|2,ai=!1,ni=t)}}else{if(ui(t))throw Error(i(418));t.flags=-4097&t.flags|2,ai=!1,ni=t}}}function li(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;ni=t}function pi(t){if(t!==ni)return!1;if(!ai)return li(t),ai=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!na(t.type,t.memoizedProps)),e&&(e=ri)){if(ui(t))throw fi(),Error(i(418));for(;e;)oi(t,e),e=ca(e.nextSibling)}if(li(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(i(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ri=ca(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ri=null}}else ri=ni?ca(t.stateNode.nextSibling):null;return!0}function fi(){for(var t=ri;t;)t=ca(t.nextSibling)}function hi(){ri=ni=null,ai=!1}function di(t){null===ii?ii=[t]:ii.push(t)}var mi=w.ReactCurrentBatchConfig;function vi(t,e){if(t&&t.defaultProps){for(var n in e=B({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var gi=Na(null),yi=null,bi=null,wi=null;function xi(){wi=bi=yi=null}function ki(t){var e=gi.current;Ea(gi),t._currentValue=e}function Si(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ni(t,e){yi=t,wi=bi=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(ws=!0),t.firstContext=null)}function Ei(t){var e=t._currentValue;if(wi!==t)if(t={context:t,memoizedValue:e,next:null},null===bi){if(null===yi)throw Error(i(308));bi=t,yi.dependencies={lanes:0,firstContext:t}}else bi=bi.next=t;return e}var Ci=null;function Ti(t){null===Ci?Ci=[t]:Ci.push(t)}function Ii(t,e,n,r){var a=e.interleaved;return null===a?(n.next=n,Ti(e)):(n.next=a.next,a.next=n),e.interleaved=n,_i(t,r)}function _i(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Ai=!1;function Ri(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Di(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Oi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Mi(t,e,n){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Iu)){var a=r.pending;return null===a?e.next=e:(e.next=a.next,a.next=e),r.pending=e,_i(t,n)}return null===(a=r.interleaved)?(e.next=e,Ti(r)):(e.next=a.next,a.next=e),r.interleaved=e,_i(t,n)}function Fi(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ye(t,n)}}function zi(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=e:i=i.next=e}else a=i=e;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Bi(t,e,n,r){var a=t.updateQueue;Ai=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=t.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var p=a.baseState;for(o=0,l=c=u=null,s=i;;){var f=s.lane,h=s.eventTime;if((r&f)===f){null!==l&&(l=l.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var d=t,m=s;switch(f=e,h=n,m.tag){case 1:if("function"===typeof(d=m.payload)){p=d.call(h,p,f);break t}p=d;break t;case 3:d.flags=-65537&d.flags|128;case 0:if(null===(f="function"===typeof(d=m.payload)?d.call(h,p,f):d)||void 0===f)break t;p=B({},p,f);break t;case 2:Ai=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(f=a.effects)?a.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=h,u=p):l=l.next=h,o|=f;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(f=s).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}if(null===l&&(u=p),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(e=a.shared.interleaved)){a=e;do{o|=a.lane,a=a.next}while(a!==e)}else null===i&&(a.shared.lanes=0);zu|=o,t.lanes=o,t.memoizedState=p}}function Li(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Pi=(new r.Component).refs;function Vi(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:B({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Wi={isMounted:function(t){return!!(t=t._reactInternals)&&Ut(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=tc(),a=ec(t),i=Oi(r,a);i.payload=e,void 0!==n&&null!==n&&(i.callback=n),null!==(e=Mi(t,i,a))&&(nc(e,t,a,r),Fi(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=tc(),a=ec(t),i=Oi(r,a);i.tag=1,i.payload=e,void 0!==n&&null!==n&&(i.callback=n),null!==(e=Mi(t,i,a))&&(nc(e,t,a,r),Fi(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tc(),r=ec(t),a=Oi(n,r);a.tag=2,void 0!==e&&null!==e&&(a.callback=e),null!==(e=Mi(t,a,r))&&(nc(e,t,r,n),Fi(e,t,r))}};function Ui(t,e,n,r,a,i,o){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,i,o):!e.prototype||!e.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function ji(t,e,n){var r=!1,a=Ta,i=e.contextType;return"object"===typeof i&&null!==i?i=Ei(i):(a=Da(e)?Aa:Ia.current,i=(r=null!==(r=e.contextTypes)&&void 0!==r)?Ra(t,a):Ta),e=new e(n,i),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Wi,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function Hi(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Wi.enqueueReplaceState(e,e.state,null)}function qi(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs=Pi,Ri(t);var i=e.contextType;"object"===typeof i&&null!==i?a.context=Ei(i):(i=Da(e)?Aa:Ia.current,a.context=Ra(t,i)),a.state=t.memoizedState,"function"===typeof(i=e.getDerivedStateFromProps)&&(Vi(t,e,i,n),a.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(e=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),e!==a.state&&Wi.enqueueReplaceState(a,a.state,null),Bi(t,n,a,r),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308)}function Gi(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,t));var a=r,o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=a.refs;e===Pi&&(e=a.refs={}),null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!==typeof t)throw Error(i(284));if(!n._owner)throw Error(i(290,t))}return t}function Zi(t,e){throw t=Object.prototype.toString.call(e),Error(i(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ki(t){return(0,t._init)(t._payload)}function Xi(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(t,e){return(t=Oc(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function u(t,e,n,r){return null===e||6!==e.tag?((e=Bc(n,t.mode,r)).return=t,e):((e=a(e,n)).return=t,e)}function c(t,e,n,r){var i=n.type;return i===S?p(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&Ki(i)===e.type)?((r=a(e,n.props)).ref=Gi(t,e,n),r.return=t,r):((r=Mc(n.type,n.key,n.props,null,t.mode,r)).ref=Gi(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Lc(n,t.mode,r)).return=t,e):((e=a(e,n.children||[])).return=t,e)}function p(t,e,n,r,i){return null===e||7!==e.tag?((e=Fc(n,t.mode,r,i)).return=t,e):((e=a(e,n)).return=t,e)}function f(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Bc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Mc(e.type,e.key,e.props,null,t.mode,n)).ref=Gi(t,null,e),n.return=t,n;case k:return(e=Lc(e,t.mode,n)).return=t,e;case D:return f(t,(0,e._init)(e._payload),n)}if(et(e)||F(e))return(e=Fc(e,t.mode,n,null)).return=t,e;Zi(t,e)}return null}function h(t,e,n,r){var a=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?c(t,e,n,r):null;case k:return n.key===a?l(t,e,n,r):null;case D:return h(t,e,(a=n._init)(n._payload),r)}if(et(n)||F(n))return null!==a?null:p(t,e,n,r,null);Zi(t,n)}return null}function d(t,e,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(e,t=t.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(e,t=t.get(null===r.key?n:r.key)||null,r,a);case k:return l(e,t=t.get(null===r.key?n:r.key)||null,r,a);case D:return d(t,e,n,(0,r._init)(r._payload),a)}if(et(r)||F(r))return p(e,t=t.get(n)||null,r,a,null);Zi(e,r)}return null}function m(a,i,s,u){for(var c=null,l=null,p=i,m=i=0,v=null;null!==p&&m<s.length;m++){p.index>m?(v=p,p=null):v=p.sibling;var g=h(a,p,s[m],u);if(null===g){null===p&&(p=v);break}t&&p&&null===g.alternate&&e(a,p),i=o(g,i,m),null===l?c=g:l.sibling=g,l=g,p=v}if(m===s.length)return n(a,p),ai&&Qa(a,m),c;if(null===p){for(;m<s.length;m++)null!==(p=f(a,s[m],u))&&(i=o(p,i,m),null===l?c=p:l.sibling=p,l=p);return ai&&Qa(a,m),c}for(p=r(a,p);m<s.length;m++)null!==(v=d(p,a,m,s[m],u))&&(t&&null!==v.alternate&&p.delete(null===v.key?m:v.key),i=o(v,i,m),null===l?c=v:l.sibling=v,l=v);return t&&p.forEach((function(t){return e(a,t)})),ai&&Qa(a,m),c}function v(a,s,u,c){var l=F(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var p=l=null,m=s,v=s=0,g=null,y=u.next();null!==m&&!y.done;v++,y=u.next()){m.index>v?(g=m,m=null):g=m.sibling;var b=h(a,m,y.value,c);if(null===b){null===m&&(m=g);break}t&&m&&null===b.alternate&&e(a,m),s=o(b,s,v),null===p?l=b:p.sibling=b,p=b,m=g}if(y.done)return n(a,m),ai&&Qa(a,v),l;if(null===m){for(;!y.done;v++,y=u.next())null!==(y=f(a,y.value,c))&&(s=o(y,s,v),null===p?l=y:p.sibling=y,p=y);return ai&&Qa(a,v),l}for(m=r(a,m);!y.done;v++,y=u.next())null!==(y=d(m,a,v,y.value,c))&&(t&&null!==y.alternate&&m.delete(null===y.key?v:y.key),s=o(y,s,v),null===p?l=y:p.sibling=y,p=y);return t&&m.forEach((function(t){return e(a,t)})),ai&&Qa(a,v),l}return function t(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:t:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===S){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break t}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&Ki(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Gi(r,l,o),i.return=r,r=i;break t}n(r,l);break}e(r,l),l=l.sibling}o.type===S?((i=Fc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Mc(o.type,o.key,o.props,null,r.mode,u)).ref=Gi(r,i,o),u.return=r,r=u)}return s(r);case k:t:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break t}n(r,i);break}e(r,i),i=i.sibling}(i=Lc(o,r.mode,u)).return=r,r=i}return s(r);case D:return t(r,i,(l=o._init)(o._payload),u)}if(et(o))return m(r,i,o,u);if(F(o))return v(r,i,o,u);Zi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Bc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var $i=Xi(!0),Yi=Xi(!1),Qi={},Ji=Na(Qi),to=Na(Qi),eo=Na(Qi);function no(t){if(t===Qi)throw Error(i(174));return t}function ro(t,e){switch(Ca(eo,e),Ca(to,t),Ca(Ji,Qi),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ut(null,"");break;default:e=ut(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ea(Ji),Ca(Ji,e)}function ao(){Ea(Ji),Ea(to),Ea(eo)}function io(t){no(eo.current);var e=no(Ji.current),n=ut(e,t.type);e!==n&&(Ca(to,t),Ca(Ji,n))}function oo(t){to.current===t&&(Ea(Ji),Ea(to))}var so=Na(0);function uo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var co=[];function lo(){for(var t=0;t<co.length;t++)co[t]._workInProgressVersionPrimary=null;co.length=0}var po=w.ReactCurrentDispatcher,fo=w.ReactCurrentBatchConfig,ho=0,mo=null,vo=null,go=null,yo=!1,bo=!1,wo=0,xo=0;function ko(){throw Error(i(321))}function So(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function No(t,e,n,r,a,o){if(ho=o,mo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,po.current=null===t||null===t.memoizedState?ss:us,t=n(r,a),bo){o=0;do{if(bo=!1,wo=0,25<=o)throw Error(i(301));o+=1,go=vo=null,e.updateQueue=null,po.current=cs,t=n(r,a)}while(bo)}if(po.current=os,e=null!==vo&&null!==vo.next,ho=0,go=vo=mo=null,yo=!1,e)throw Error(i(300));return t}function Eo(){var t=0!==wo;return wo=0,t}function Co(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?mo.memoizedState=go=t:go=go.next=t,go}function To(){if(null===vo){var t=mo.alternate;t=null!==t?t.memoizedState:null}else t=vo.next;var e=null===go?mo.memoizedState:go.next;if(null!==e)go=e,vo=t;else{if(null===t)throw Error(i(310));t={memoizedState:(vo=t).memoizedState,baseState:vo.baseState,baseQueue:vo.baseQueue,queue:vo.queue,next:null},null===go?mo.memoizedState=go=t:go=go.next=t}return go}function Io(t,e){return"function"===typeof e?e(t):e}function _o(t){var e=To(),n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=t;var r=vo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var p=l.lane;if((ho&p)===p)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var f={lane:p,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=f,s=r):c=c.next=f,mo.lanes|=p,zu|=p}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,e.memoizedState)||(ws=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(null!==(t=n.interleaved)){a=t;do{o=a.lane,mo.lanes|=o,zu|=o,a=a.next}while(a!==t)}else null===a&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ao(t){var e=To(),n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,o=e.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=t(o,s.action),s=s.next}while(s!==a);sr(o,e.memoizedState)||(ws=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Ro(){}function Do(t,e){var n=mo,r=To(),a=e(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,ws=!0),r=r.queue,Ho(Fo.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,Po(9,Mo.bind(null,n,r,a,e),void 0,null),null===_u)throw Error(i(349));0!==(30&ho)||Oo(n,e,a)}return a}function Oo(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=mo.updateQueue)?(e={lastEffect:null,stores:null},mo.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Mo(t,e,n,r){e.value=n,e.getSnapshot=r,zo(e)&&Bo(t)}function Fo(t,e,n){return n((function(){zo(e)&&Bo(t)}))}function zo(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch(r){return!0}}function Bo(t){var e=_i(t,1);null!==e&&nc(e,t,1,-1)}function Lo(t){var e=Co();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:t},e.queue=t,t=t.dispatch=ns.bind(null,mo,t),[e.memoizedState,t]}function Po(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=mo.updateQueue)?(e={lastEffect:null,stores:null},mo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function Vo(){return To().memoizedState}function Wo(t,e,n,r){var a=Co();mo.flags|=t,a.memoizedState=Po(1|e,n,void 0,void 0===r?null:r)}function Uo(t,e,n,r){var a=To();r=void 0===r?null:r;var i=void 0;if(null!==vo){var o=vo.memoizedState;if(i=o.destroy,null!==r&&So(r,o.deps))return void(a.memoizedState=Po(e,n,i,r))}mo.flags|=t,a.memoizedState=Po(1|e,n,i,r)}function jo(t,e){return Wo(8390656,8,t,e)}function Ho(t,e){return Uo(2048,8,t,e)}function qo(t,e){return Uo(4,2,t,e)}function Go(t,e){return Uo(4,4,t,e)}function Zo(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ko(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Uo(4,4,Zo.bind(null,e,t),n)}function Xo(){}function $o(t,e){var n=To();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&So(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Yo(t,e){var n=To();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&So(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Qo(t,e,n){return 0===(21&ho)?(t.baseState&&(t.baseState=!1,ws=!0),t.memoizedState=n):(sr(n,e)||(n=me(),mo.lanes|=n,zu|=n,t.baseState=!0),e)}function Jo(t,e){var n=be;be=0!==n&&4>n?n:4,t(!0);var r=fo.transition;fo.transition={};try{t(!1),e()}finally{be=n,fo.transition=r}}function ts(){return To().memoizedState}function es(t,e,n){var r=ec(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(t))as(e,n);else if(null!==(n=Ii(t,e,n,r))){nc(n,t,r,tc()),is(n,e,r)}}function ns(t,e,n){var r=ec(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(t))as(e,a);else{var i=t.alternate;if(0===t.lanes&&(null===i||0===i.lanes)&&null!==(i=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=e.interleaved;return null===u?(a.next=a,Ti(e)):(a.next=u.next,u.next=a),void(e.interleaved=a)}}catch(c){}null!==(n=Ii(t,e,a,r))&&(nc(n,t,r,a=tc()),is(n,e,r))}}function rs(t){var e=t.alternate;return t===mo||null!==e&&e===mo}function as(t,e){bo=yo=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function is(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ye(t,n)}}var os={readContext:Ei,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},ss={readContext:Ei,useCallback:function(t,e){return Co().memoizedState=[t,void 0===e?null:e],t},useContext:Ei,useEffect:jo,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Wo(4194308,4,Zo.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Wo(4194308,4,t,e)},useInsertionEffect:function(t,e){return Wo(4,2,t,e)},useMemo:function(t,e){var n=Co();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Co();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=es.bind(null,mo,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Co().memoizedState=t},useState:Lo,useDebugValue:Xo,useDeferredValue:function(t){return Co().memoizedState=t},useTransition:function(){var t=Lo(!1),e=t[0];return t=Jo.bind(null,t[1]),Co().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=mo,a=Co();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=e(),null===_u)throw Error(i(349));0!==(30&ho)||Oo(r,e,n)}a.memoizedState=n;var o={value:n,getSnapshot:e};return a.queue=o,jo(Fo.bind(null,r,o,t),[t]),r.flags|=2048,Po(9,Mo.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Co(),e=_u.identifierPrefix;if(ai){var n=Ya;e=":"+e+"R"+(n=($a&~(1<<32-oe($a)-1)).toString(32)+n),0<(n=wo++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=xo++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},us={readContext:Ei,useCallback:$o,useContext:Ei,useEffect:Ho,useImperativeHandle:Ko,useInsertionEffect:qo,useLayoutEffect:Go,useMemo:Yo,useReducer:_o,useRef:Vo,useState:function(){return _o(Io)},useDebugValue:Xo,useDeferredValue:function(t){return Qo(To(),vo.memoizedState,t)},useTransition:function(){return[_o(Io)[0],To().memoizedState]},useMutableSource:Ro,useSyncExternalStore:Do,useId:ts,unstable_isNewReconciler:!1},cs={readContext:Ei,useCallback:$o,useContext:Ei,useEffect:Ho,useImperativeHandle:Ko,useInsertionEffect:qo,useLayoutEffect:Go,useMemo:Yo,useReducer:Ao,useRef:Vo,useState:function(){return Ao(Io)},useDebugValue:Xo,useDeferredValue:function(t){var e=To();return null===vo?e.memoizedState=t:Qo(e,vo.memoizedState,t)},useTransition:function(){return[Ao(Io)[0],To().memoizedState]},useMutableSource:Ro,useSyncExternalStore:Do,useId:ts,unstable_isNewReconciler:!1};function ls(t,e){try{var n="",r=e;do{n+=W(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:t,source:e,stack:a,digest:null}}function ps(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function fs(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var hs="function"===typeof WeakMap?WeakMap:Map;function ds(t,e,n){(n=Oi(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hu||(Hu=!0,qu=r),fs(0,e)},n}function ms(t,e,n){(n=Oi(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){fs(0,e)}}var i=t.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){fs(0,e),"function"!==typeof r&&(null===Gu?Gu=new Set([this]):Gu.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function vs(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new hs;var a=new Set;r.set(e,a)}else void 0===(a=r.get(e))&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=Ec.bind(null,t,e,n),e.then(t,t))}function gs(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ys(t,e,n,r,a){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Oi(-1,1)).tag=2,Mi(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=a,t)}var bs=w.ReactCurrentOwner,ws=!1;function xs(t,e,n,r){e.child=null===t?Yi(e,null,n,r):$i(e,t.child,n,r)}function ks(t,e,n,r,a){n=n.render;var i=e.ref;return Ni(e,a),r=No(t,e,n,r,i,a),n=Eo(),null===t||ws?(ai&&n&&ti(e),e.flags|=1,xs(t,e,r,a),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Hs(t,e,a))}function Ss(t,e,n,r,a){if(null===t){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Mc(n.type,null,r,e,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=i,Ns(t,e,i,r,a))}if(i=t.child,0===(t.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&t.ref===e.ref)return Hs(t,e,a)}return e.flags|=1,(t=Oc(i,r)).ref=e.ref,t.return=e,e.child=t}function Ns(t,e,n,r,a){if(null!==t){var i=t.memoizedProps;if(ur(i,r)&&t.ref===e.ref){if(ws=!1,e.pendingProps=r=i,0===(t.lanes&a))return e.lanes=t.lanes,Hs(t,e,a);0!==(131072&t.flags)&&(ws=!0)}}return Ts(t,e,n,r,a)}function Es(t,e,n){var r=e.pendingProps,a=r.children,i=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Ou,Du),Du|=n;else{if(0===(1073741824&n))return t=null!==i?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ca(Ou,Du),Du|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ca(Ou,Du),Du|=r}else null!==i?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ca(Ou,Du),Du|=r;return xs(t,e,a,n),e.child}function Cs(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ts(t,e,n,r,a){var i=Da(n)?Aa:Ia.current;return i=Ra(e,i),Ni(e,a),n=No(t,e,n,r,i,a),r=Eo(),null===t||ws?(ai&&r&&ti(e),e.flags|=1,xs(t,e,n,a),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Hs(t,e,a))}function Is(t,e,n,r,a){if(Da(n)){var i=!0;za(e)}else i=!1;if(Ni(e,a),null===e.stateNode)js(t,e),ji(e,n,r),qi(e,n,r,a),r=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ei(c):c=Ra(e,c=Da(n)?Aa:Ia.current);var l=n.getDerivedStateFromProps,p="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;p||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Hi(e,o,r,c),Ai=!1;var f=e.memoizedState;o.state=f,Bi(e,r,o,a),u=e.memoizedState,s!==r||f!==u||_a.current||Ai?("function"===typeof l&&(Vi(e,n,l,r),u=e.memoizedState),(s=Ai||Ui(e,n,s,r,f,u,c))?(p||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4194308)):("function"===typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Di(t,e),s=e.memoizedProps,c=e.type===e.elementType?s:vi(e.type,s),o.props=c,p=e.pendingProps,f=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ei(u):u=Ra(e,u=Da(n)?Aa:Ia.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==p||f!==u)&&Hi(e,o,r,u),Ai=!1,f=e.memoizedState,o.state=f,Bi(e,r,o,a);var d=e.memoizedState;s!==p||f!==d||_a.current||Ai?("function"===typeof h&&(Vi(e,n,h,r),d=e.memoizedState),(c=Ai||Ui(e,n,c,r,f,d,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,d,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,d,u)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return _s(t,e,n,r,i,a)}function _s(t,e,n,r,a,i){Cs(t,e);var o=0!==(128&e.flags);if(!r&&!o)return a&&Ba(e,n,!1),Hs(t,e,i);r=e.stateNode,bs.current=e;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&o?(e.child=$i(e,t.child,null,i),e.child=$i(e,null,s,i)):xs(t,e,s,i),e.memoizedState=r.state,a&&Ba(e,n,!0),e.child}function As(t){var e=t.stateNode;e.pendingContext?Ma(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ma(0,e.context,!1),ro(t,e.containerInfo)}function Rs(t,e,n,r,a){return hi(),di(a),e.flags|=256,xs(t,e,n,r),e.child}var Ds,Os,Ms,Fs={dehydrated:null,treeContext:null,retryLane:0};function zs(t){return{baseLanes:t,cachePool:null,transitions:null}}function Bs(t,e,n){var r,a=e.pendingProps,o=so.current,s=!1,u=0!==(128&e.flags);if((r=u)||(r=(null===t||null!==t.memoizedState)&&0!==(2&o)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),Ca(so,1&o),null===t)return ci(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(u=a.children,t=a.fallback,s?(a=e.mode,s=e.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=zc(u,a,0,null),t=Fc(t,a,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=zs(n),e.memoizedState=Fs,t):Ls(e,u));if(null!==(o=t.memoizedState)&&null!==(r=o.dehydrated))return function(t,e,n,r,a,o,s){if(n)return 256&e.flags?(e.flags&=-257,Ps(t,e,s,r=ps(Error(i(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(o=r.fallback,a=e.mode,r=zc({mode:"visible",children:r.children},a,0,null),(o=Fc(o,a,s,null)).flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,0!==(1&e.mode)&&$i(e,t.child,null,s),e.child.memoizedState=zs(s),e.memoizedState=Fs,o);if(0===(1&e.mode))return Ps(t,e,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Ps(t,e,s,r=ps(o=Error(i(419)),r,void 0))}if(u=0!==(s&t.childLanes),ws||u){if(null!==(r=_u)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,_i(t,a),nc(r,t,a,-1))}return mc(),Ps(t,e,s,r=ps(Error(i(421))))}return"$?"===a.data?(e.flags|=128,e.child=t.child,e=Tc.bind(null,t),a._reactRetry=e,null):(t=o.treeContext,ri=ca(a.nextSibling),ni=e,ai=!0,ii=null,null!==t&&(Za[Ka++]=$a,Za[Ka++]=Ya,Za[Ka++]=Xa,$a=t.id,Ya=t.overflow,Xa=e),(e=Ls(e,r.children)).flags|=4096,e)}(t,e,u,a,r,o,n);if(s){s=a.fallback,u=e.mode,r=(o=t.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&e.child!==o?((a=e.child).childLanes=0,a.pendingProps=c,e.deletions=null):(a=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Oc(r,s):(s=Fc(s,u,n,null)).flags|=2,s.return=e,a.return=e,a.sibling=s,e.child=a,a=s,s=e.child,u=null===(u=t.child.memoizedState)?zs(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=t.childLanes&~n,e.memoizedState=Fs,a}return t=(s=t.child).sibling,a=Oc(s,{mode:"visible",children:a.children}),0===(1&e.mode)&&(a.lanes=n),a.return=e,a.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=a,e.memoizedState=null,a}function Ls(t,e){return(e=zc({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Ps(t,e,n,r){return null!==r&&di(r),$i(e,t.child,null,n),(t=Ls(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Vs(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),Si(t.return,e,n)}function Ws(t,e,n,r,a){var i=t.memoizedState;null===i?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Us(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(xs(t,e,r.children,n),0!==(2&(r=so.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Vs(t,n,e);else if(19===t.tag)Vs(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ca(so,r),0===(1&e.mode))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;null!==n;)null!==(t=n.alternate)&&null===uo(t)&&(a=n),n=n.sibling;null===(n=a)?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Ws(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;null!==a;){if(null!==(t=a.alternate)&&null===uo(t)){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Ws(e,!0,n,null,i);break;case"together":Ws(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function js(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Hs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),zu|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(i(153));if(null!==e.child){for(n=Oc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Oc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function qs(t,e){if(!ai)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Gs(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=t,a=a.sibling;else for(a=t.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Zs(t,e,n){var r=e.pendingProps;switch(ei(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(e),null;case 1:case 17:return Da(e.type)&&Oa(),Gs(e),null;case 3:return r=e.stateNode,ao(),Ea(_a),Ea(Ia),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(pi(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==ii&&(oc(ii),ii=null))),Gs(e),null;case 5:oo(e);var a=no(eo.current);if(n=e.type,null!==t&&null!=e.stateNode)Os(t,e,n,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(i(166));return Gs(e),null}if(t=no(Ji.current),pi(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[fa]=e,r[ha]=o,t=0!==(1&e.mode),n){case"dialog":Pr("cancel",r),Pr("close",r);break;case"iframe":case"object":case"embed":Pr("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)Pr(Fr[a],r);break;case"source":Pr("error",r);break;case"img":case"image":case"link":Pr("error",r),Pr("load",r);break;case"details":Pr("toggle",r);break;case"input":$(r,o),Pr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Pr("invalid",r);break;case"textarea":at(r,o),Pr("invalid",r)}for(var u in yt(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,t),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,t),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Pr("scroll",r)}switch(n){case"input":G(r),J(r,o,!0);break;case"textarea":G(r),ot(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=a,e.updateQueue=r,null!==r&&(e.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=u.createElement(n,{is:r.is}):(t=u.createElement(n),"select"===n&&(u=t,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):t=u.createElementNS(t,n),t[fa]=e,t[ha]=r,Ds(t,e),e.stateNode=t;t:{switch(u=bt(n,r),n){case"dialog":Pr("cancel",t),Pr("close",t),a=r;break;case"iframe":case"object":case"embed":Pr("load",t),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)Pr(Fr[a],t);a=r;break;case"source":Pr("error",t),a=r;break;case"img":case"image":case"link":Pr("error",t),Pr("load",t),a=r;break;case"details":Pr("toggle",t),a=r;break;case"input":$(t,r),a=X(t,r),Pr("invalid",t);break;case"option":default:a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=B({},r,{value:void 0}),Pr("invalid",t);break;case"textarea":at(t,r),a=rt(t,r),Pr("invalid",t)}for(o in yt(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?vt(t,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&pt(t,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&ft(t,l):"number"===typeof l&&ft(t,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Pr("scroll",t):null!=l&&b(t,o,l,u))}switch(n){case"input":G(t),J(t,r,!1);break;case"textarea":G(t),ot(t);break;case"option":null!=r.value&&t.setAttribute("value",""+H(r.value));break;case"select":t.multiple=!!r.multiple,null!=(o=r.value)?nt(t,!!r.multiple,o,!1):null!=r.defaultValue&&nt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(t.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Gs(e),null;case 6:if(t&&null!=e.stateNode)Ms(0,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(i(166));if(n=no(eo.current),no(Ji.current),pi(e)){if(r=e.stateNode,n=e.memoizedProps,r[fa]=e,(o=r.nodeValue!==n)&&null!==(t=ni))switch(t.tag){case 3:Qr(r.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&t.mode))}o&&(e.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fa]=e,e.stateNode=r}return Gs(e),null;case 13:if(Ea(so),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&e.mode)&&0===(128&e.flags))fi(),hi(),e.flags|=98560,o=!1;else if(o=pi(e),null!==r&&null!==r.dehydrated){if(null===t){if(!o)throw Error(i(318));if(!(o=null!==(o=e.memoizedState)?o.dehydrated:null))throw Error(i(317));o[fa]=e}else hi(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Gs(e),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&so.current)?0===Mu&&(Mu=3):mc())),null!==e.updateQueue&&(e.flags|=4),Gs(e),null);case 4:return ao(),null===t&&Ur(e.stateNode.containerInfo),Gs(e),null;case 10:return ki(e.type._context),Gs(e),null;case 19:if(Ea(so),null===(o=e.memoizedState))return Gs(e),null;if(r=0!==(128&e.flags),null===(u=o.rendering))if(r)qs(o,!1);else{if(0!==Mu||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(u=uo(t))){for(e.flags|=128,qs(o,!1),null!==(r=u.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;null!==n;)t=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,t=u.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ca(so,1&so.current|2),e.child}t=t.sibling}null!==o.tail&&Yt()>Uu&&(e.flags|=128,r=!0,qs(o,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=uo(u))){if(e.flags|=128,r=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),qs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return Gs(e),null}else 2*Yt()-o.renderingStartTime>Uu&&1073741824!==n&&(e.flags|=128,r=!0,qs(o,!1),e.lanes=4194304);o.isBackwards?(u.sibling=e.child,e.child=u):(null!==(n=o.last)?n.sibling=u:e.child=u,o.last=u)}return null!==o.tail?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Yt(),e.sibling=null,n=so.current,Ca(so,r?1&n|2:1&n),e):(Gs(e),null);case 22:case 23:return pc(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Du)&&(Gs(e),6&e.subtreeFlags&&(e.flags|=8192)):Gs(e),null;case 24:case 25:return null}throw Error(i(156,e.tag))}function Ks(t,e){switch(ei(e),e.tag){case 1:return Da(e.type)&&Oa(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return ao(),Ea(_a),Ea(Ia),lo(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return oo(e),null;case 13:if(Ea(so),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(i(340));hi()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ea(so),null;case 4:return ao(),null;case 10:return ki(e.type._context),null;case 22:case 23:return pc(),null;default:return null}}Ds=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,no(Ji.current);var i,o=null;switch(n){case"input":a=X(t,a),r=X(t,r),o=[];break;case"select":a=B({},a,{value:void 0}),r=B({},r,{value:void 0}),o=[];break;case"textarea":a=rt(t,a),r=rt(t,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(t.onclick=Jr)}for(l in yt(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Pr("scroll",t),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(e.updateQueue=l)&&(e.flags|=4)}},Ms=function(t,e,n,r){n!==r&&(e.flags|=4)};var Xs=!1,$s=!1,Ys="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Js(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Nc(t,e,r)}else n.current=null}function tu(t,e,n){try{n()}catch(r){Nc(t,e,r)}}var eu=!1;function nu(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,void 0!==i&&tu(e,n,i)}a=a.next}while(a!==r)}}function ru(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function au(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function iu(t){var e=t.alternate;null!==e&&(t.alternate=null,iu(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[fa],delete e[ha],delete e[ma],delete e[va],delete e[ga])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ou(t){return 5===t.tag||3===t.tag||4===t.tag}function su(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||ou(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function uu(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Jr));else if(4!==r&&null!==(t=t.child))for(uu(t,e,n),t=t.sibling;null!==t;)uu(t,e,n),t=t.sibling}function cu(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(cu(t,e,n),t=t.sibling;null!==t;)cu(t,e,n),t=t.sibling}var lu=null,pu=!1;function fu(t,e,n){for(n=n.child;null!==n;)hu(t,e,n),n=n.sibling}function hu(t,e,n){if(ie&&"function"===typeof ie.onCommitFiberUnmount)try{ie.onCommitFiberUnmount(ae,n)}catch(s){}switch(n.tag){case 5:$s||Js(n,e);case 6:var r=lu,a=pu;lu=null,fu(t,e,n),pu=a,null!==(lu=r)&&(pu?(t=lu,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):lu.removeChild(n.stateNode));break;case 18:null!==lu&&(pu?(t=lu,n=n.stateNode,8===t.nodeType?ua(t.parentNode,n):1===t.nodeType&&ua(t,n),Ue(t)):ua(lu,n.stateNode));break;case 4:r=lu,a=pu,lu=n.stateNode.containerInfo,pu=!0,fu(t,e,n),lu=r,pu=a;break;case 0:case 11:case 14:case 15:if(!$s&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tu(n,e,o),a=a.next}while(a!==r)}fu(t,e,n);break;case 1:if(!$s&&(Js(n,e),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Nc(n,e,s)}fu(t,e,n);break;case 21:fu(t,e,n);break;case 22:1&n.mode?($s=(r=$s)||null!==n.memoizedState,fu(t,e,n),$s=r):fu(t,e,n);break;default:fu(t,e,n)}}function du(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ys),e.forEach((function(e){var r=Ic.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function mu(t,e){var n=e.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=t,s=e,u=s;t:for(;null!==u;){switch(u.tag){case 5:lu=u.stateNode,pu=!1;break t;case 3:case 4:lu=u.stateNode.containerInfo,pu=!0;break t}u=u.return}if(null===lu)throw Error(i(160));hu(o,s,a),lu=null,pu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Nc(a,e,l)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)vu(e,t),e=e.sibling}function vu(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(mu(e,t),gu(t),4&r){try{nu(3,t,t.return),ru(3,t)}catch(v){Nc(t,t.return,v)}try{nu(5,t,t.return)}catch(v){Nc(t,t.return,v)}}break;case 1:mu(e,t),gu(t),512&r&&null!==n&&Js(n,n.return);break;case 5:if(mu(e,t),gu(t),512&r&&null!==n&&Js(n,n.return),32&t.flags){var a=t.stateNode;try{ft(a,"")}catch(v){Nc(t,t.return,v)}}if(4&r&&null!=(a=t.stateNode)){var o=t.memoizedProps,s=null!==n?n.memoizedProps:o,u=t.type,c=t.updateQueue;if(t.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Y(a,o),bt(u,s);var l=bt(u,o);for(s=0;s<c.length;s+=2){var p=c[s],f=c[s+1];"style"===p?vt(a,f):"dangerouslySetInnerHTML"===p?pt(a,f):"children"===p?ft(a,f):b(a,p,f,l)}switch(u){case"input":Q(a,o);break;case"textarea":it(a,o);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var d=o.value;null!=d?nt(a,!!o.multiple,d,!1):h!==!!o.multiple&&(null!=o.defaultValue?nt(a,!!o.multiple,o.defaultValue,!0):nt(a,!!o.multiple,o.multiple?[]:"",!1))}a[ha]=o}catch(v){Nc(t,t.return,v)}}break;case 6:if(mu(e,t),gu(t),4&r){if(null===t.stateNode)throw Error(i(162));a=t.stateNode,o=t.memoizedProps;try{a.nodeValue=o}catch(v){Nc(t,t.return,v)}}break;case 3:if(mu(e,t),gu(t),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ue(e.containerInfo)}catch(v){Nc(t,t.return,v)}break;case 4:default:mu(e,t),gu(t);break;case 13:mu(e,t),gu(t),8192&(a=t.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Wu=Yt())),4&r&&du(t);break;case 22:if(p=null!==n&&null!==n.memoizedState,1&t.mode?($s=(l=$s)||p,mu(e,t),$s=l):mu(e,t),gu(t),8192&r){if(l=null!==t.memoizedState,(t.stateNode.isHidden=l)&&!p&&0!==(1&t.mode))for(Qs=t,p=t.child;null!==p;){for(f=Qs=p;null!==Qs;){switch(d=(h=Qs).child,h.tag){case 0:case 11:case 14:case 15:nu(4,h,h.return);break;case 1:Js(h,h.return);var m=h.stateNode;if("function"===typeof m.componentWillUnmount){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){Nc(r,n,v)}}break;case 5:Js(h,h.return);break;case 22:if(null!==h.memoizedState){xu(f);continue}}null!==d?(d.return=h,Qs=d):xu(f)}p=p.sibling}t:for(p=null,f=t;;){if(5===f.tag){if(null===p){p=f;try{a=f.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=f.stateNode,s=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=mt("display",s))}catch(v){Nc(t,t.return,v)}}}else if(6===f.tag){if(null===p)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(v){Nc(t,t.return,v)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===t)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===t)break t;for(;null===f.sibling;){if(null===f.return||f.return===t)break t;p===f&&(p=null),f=f.return}p===f&&(p=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:mu(e,t),gu(t),4&r&&du(t);case 21:}}function gu(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(ou(n)){var r=n;break t}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(ft(a,""),r.flags&=-33),cu(t,su(t),a);break;case 3:case 4:var o=r.stateNode.containerInfo;uu(t,su(t),o);break;default:throw Error(i(161))}}catch(s){Nc(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function yu(t,e,n){Qs=t,bu(t,e,n)}function bu(t,e,n){for(var r=0!==(1&t.mode);null!==Qs;){var a=Qs,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Xs;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||$s;s=Xs;var c=$s;if(Xs=o,($s=u)&&!c)for(Qs=a;null!==Qs;)u=(o=Qs).child,22===o.tag&&null!==o.memoizedState?ku(a):null!==u?(u.return=o,Qs=u):ku(a);for(;null!==i;)Qs=i,bu(i,e,n),i=i.sibling;Qs=a,Xs=s,$s=c}wu(t)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Qs=i):wu(t)}}function wu(t){for(;null!==Qs;){var e=Qs;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:$s||ru(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!$s)if(null===n)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:vi(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&Li(e,o,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Li(e,s,n)}break;case 5:var u=e.stateNode;if(null===n&&4&e.flags){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var l=e.alternate;if(null!==l){var p=l.memoizedState;if(null!==p){var f=p.dehydrated;null!==f&&Ue(f)}}}break;default:throw Error(i(163))}$s||512&e.flags&&au(e)}catch(h){Nc(e,e.return,h)}}if(e===t){Qs=null;break}if(null!==(n=e.sibling)){n.return=e.return,Qs=n;break}Qs=e.return}}function xu(t){for(;null!==Qs;){var e=Qs;if(e===t){Qs=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Qs=n;break}Qs=e.return}}function ku(t){for(;null!==Qs;){var e=Qs;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ru(4,e)}catch(u){Nc(e,n,u)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var a=e.return;try{r.componentDidMount()}catch(u){Nc(e,a,u)}}var i=e.return;try{au(e)}catch(u){Nc(e,i,u)}break;case 5:var o=e.return;try{au(e)}catch(u){Nc(e,o,u)}}}catch(u){Nc(e,e.return,u)}if(e===t){Qs=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Qs=s;break}Qs=e.return}}var Su,Nu=Math.ceil,Eu=w.ReactCurrentDispatcher,Cu=w.ReactCurrentOwner,Tu=w.ReactCurrentBatchConfig,Iu=0,_u=null,Au=null,Ru=0,Du=0,Ou=Na(0),Mu=0,Fu=null,zu=0,Bu=0,Lu=0,Pu=null,Vu=null,Wu=0,Uu=1/0,ju=null,Hu=!1,qu=null,Gu=null,Zu=!1,Ku=null,Xu=0,$u=0,Yu=null,Qu=-1,Ju=0;function tc(){return 0!==(6&Iu)?Yt():-1!==Qu?Qu:Qu=Yt()}function ec(t){return 0===(1&t.mode)?1:0!==(2&Iu)&&0!==Ru?Ru&-Ru:null!==mi.transition?(0===Ju&&(Ju=me()),Ju):0!==(t=be)?t:t=void 0===(t=window.event)?16:$e(t.type)}function nc(t,e,n,r){if(50<$u)throw $u=0,Yu=null,Error(i(185));ge(t,n,r),0!==(2&Iu)&&t===_u||(t===_u&&(0===(2&Iu)&&(Bu|=n),4===Mu&&sc(t,Ru)),rc(t,r),1===n&&0===Iu&&0===(1&e.mode)&&(Uu=Yt()+500,Pa&&Ua()))}function rc(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-oe(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=he(s,e)):u<=e&&(t.expiredLanes|=s),i&=~s}}(t,e);var r=fe(t,t===_u?Ru:0);if(0===r)null!==n&&Kt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&Kt(n),1===e)0===t.tag?function(t){Pa=!0,Wa(t)}(uc.bind(null,t)):Wa(uc.bind(null,t)),oa((function(){0===(6&Iu)&&Ua()})),n=null;else{switch(we(r)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=re}n=_c(n,ac.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ac(t,e){if(Qu=-1,Ju=0,0!==(6&Iu))throw Error(i(327));var n=t.callbackNode;if(kc()&&t.callbackNode!==n)return null;var r=fe(t,t===_u?Ru:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=vc(t,r);else{e=r;var a=Iu;Iu|=2;var o=dc();for(_u===t&&Ru===e||(ju=null,Uu=Yt()+500,fc(t,e));;)try{yc();break}catch(u){hc(t,u)}xi(),Eu.current=o,Iu=a,null!==Au?e=0:(_u=null,Ru=0,e=Mu)}if(0!==e){if(2===e&&(0!==(a=de(t))&&(r=a,e=ic(t,a))),1===e)throw n=Fu,fc(t,0),sc(t,r),rc(t,Yt()),n;if(6===e)sc(t,r);else{if(a=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(a)&&(2===(e=vc(t,r))&&(0!==(o=de(t))&&(r=o,e=ic(t,o))),1===e))throw n=Fu,fc(t,0),sc(t,r),rc(t,Yt()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(i(345));case 2:case 5:xc(t,Vu,ju);break;case 3:if(sc(t,r),(130023424&r)===r&&10<(e=Wu+500-Yt())){if(0!==fe(t,0))break;if(((a=t.suspendedLanes)&r)!==r){tc(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=ra(xc.bind(null,t,Vu,ju),e);break}xc(t,Vu,ju);break;case 4:if(sc(t,r),(4194240&r)===r)break;for(e=t.eventTimes,a=-1;0<r;){var s=31-oe(r);o=1<<s,(s=e[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Yt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Nu(r/1960))-r)){t.timeoutHandle=ra(xc.bind(null,t,Vu,ju),r);break}xc(t,Vu,ju);break;default:throw Error(i(329))}}}return rc(t,Yt()),t.callbackNode===n?ac.bind(null,t):null}function ic(t,e){var n=Pu;return t.current.memoizedState.isDehydrated&&(fc(t,e).flags|=256),2!==(t=vc(t,e))&&(e=Vu,Vu=n,null!==e&&oc(e)),t}function oc(t){null===Vu?Vu=t:Vu.push.apply(Vu,t)}function sc(t,e){for(e&=~Lu,e&=~Bu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oe(e),r=1<<n;t[n]=-1,e&=~r}}function uc(t){if(0!==(6&Iu))throw Error(i(327));kc();var e=fe(t,0);if(0===(1&e))return rc(t,Yt()),null;var n=vc(t,e);if(0!==t.tag&&2===n){var r=de(t);0!==r&&(e=r,n=ic(t,r))}if(1===n)throw n=Fu,fc(t,0),sc(t,e),rc(t,Yt()),n;if(6===n)throw Error(i(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xc(t,Vu,ju),rc(t,Yt()),null}function cc(t,e){var n=Iu;Iu|=1;try{return t(e)}finally{0===(Iu=n)&&(Uu=Yt()+500,Pa&&Ua())}}function lc(t){null!==Ku&&0===Ku.tag&&0===(6&Iu)&&kc();var e=Iu;Iu|=1;var n=Tu.transition,r=be;try{if(Tu.transition=null,be=1,t)return t()}finally{be=r,Tu.transition=n,0===(6&(Iu=e))&&Ua()}}function pc(){Du=Ou.current,Ea(Ou)}function fc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,aa(n)),null!==Au)for(n=Au.return;null!==n;){var r=n;switch(ei(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oa();break;case 3:ao(),Ea(_a),Ea(Ia),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ea(so);break;case 10:ki(r.type._context);break;case 22:case 23:pc()}n=n.return}if(_u=t,Au=t=Oc(t.current,null),Ru=Du=e,Mu=0,Fu=null,Lu=Bu=zu=0,Vu=Pu=null,null!==Ci){for(e=0;e<Ci.length;e++)if(null!==(r=(n=Ci[e]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ci=null}return t}function hc(t,e){for(;;){var n=Au;try{if(xi(),po.current=os,yo){for(var r=mo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(ho=0,go=vo=mo=null,bo=!1,wo=0,Cu.current=null,null===n||null===n.return){Mu=1,Fu=e,Au=null;break}t:{var o=t,s=n.return,u=n,c=e;if(e=Ru,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,p=u,f=p.tag;if(0===(1&p.mode)&&(0===f||11===f||15===f)){var h=p.alternate;h?(p.updateQueue=h.updateQueue,p.memoizedState=h.memoizedState,p.lanes=h.lanes):(p.updateQueue=null,p.memoizedState=null)}var d=gs(s);if(null!==d){d.flags&=-257,ys(d,s,u,0,e),1&d.mode&&vs(o,l,e),c=l;var m=(e=d).updateQueue;if(null===m){var v=new Set;v.add(c),e.updateQueue=v}else m.add(c);break t}if(0===(1&e)){vs(o,l,e),mc();break t}c=Error(i(426))}else if(ai&&1&u.mode){var g=gs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ys(g,s,u,0,e),di(ls(c,u));break t}}o=c=ls(c,u),4!==Mu&&(Mu=2),null===Pu?Pu=[o]:Pu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e,zi(o,ds(0,c,e));break t;case 1:u=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Gu||!Gu.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e,zi(o,ms(o,u,e));break t}}o=o.return}while(null!==o)}wc(n)}catch(w){e=w,Au===n&&null!==n&&(Au=n=n.return);continue}break}}function dc(){var t=Eu.current;return Eu.current=os,null===t?os:t}function mc(){0!==Mu&&3!==Mu&&2!==Mu||(Mu=4),null===_u||0===(268435455&zu)&&0===(268435455&Bu)||sc(_u,Ru)}function vc(t,e){var n=Iu;Iu|=2;var r=dc();for(_u===t&&Ru===e||(ju=null,fc(t,e));;)try{gc();break}catch(a){hc(t,a)}if(xi(),Iu=n,Eu.current=r,null!==Au)throw Error(i(261));return _u=null,Ru=0,Mu}function gc(){for(;null!==Au;)bc(Au)}function yc(){for(;null!==Au&&!Xt();)bc(Au)}function bc(t){var e=Su(t.alternate,t,Du);t.memoizedProps=t.pendingProps,null===e?wc(t):Au=e,Cu.current=null}function wc(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Zs(n,e,Du)))return void(Au=n)}else{if(null!==(n=Ks(n,e)))return n.flags&=32767,void(Au=n);if(null===t)return Mu=6,void(Au=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Au=e);Au=e=t}while(null!==e);0===Mu&&(Mu=5)}function xc(t,e,n){var r=be,a=Tu.transition;try{Tu.transition=null,be=1,function(t,e,n,r){do{kc()}while(null!==Ku);if(0!==(6&Iu))throw Error(i(327));n=t.finishedWork;var a=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(i(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-oe(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}(t,o),t===_u&&(Au=_u=null,Ru=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Zu||(Zu=!0,_c(ee,(function(){return kc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tu.transition,Tu.transition=null;var s=be;be=1;var u=Iu;Iu|=4,Cu.current=null,function(t,e){if(ta=He,hr(t=fr())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break t}var s=0,u=-1,c=-1,l=0,p=0,f=t,h=null;e:for(;;){for(var d;f!==n||0!==a&&3!==f.nodeType||(u=s+a),f!==o||0!==r&&3!==f.nodeType||(c=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(d=f.firstChild);)h=f,f=d;for(;;){if(f===t)break e;if(h===n&&++l===a&&(u=s),h===o&&++p===r&&(c=s),null!==(d=f.nextSibling))break;h=(f=h).parentNode}f=d}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ea={focusedElem:t,selectionRange:n},He=!1,Qs=e;null!==Qs;)if(t=(e=Qs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Qs=t;else for(;null!==Qs;){e=Qs;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var v=m.memoizedProps,g=m.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:vi(e.type,v),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(x){Nc(e,e.return,x)}if(null!==(t=e.sibling)){t.return=e.return,Qs=t;break}Qs=e.return}m=eu,eu=!1}(t,n),vu(n,t),dr(ea),He=!!ta,ea=ta=null,t.current=n,yu(n,t,a),$t(),Iu=u,be=s,Tu.transition=o}else t.current=n;if(Zu&&(Zu=!1,Ku=t,Xu=a),0===(o=t.pendingLanes)&&(Gu=null),function(t){if(ie&&"function"===typeof ie.onCommitFiberRoot)try{ie.onCommitFiberRoot(ae,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),rc(t,Yt()),null!==e)for(r=t.onRecoverableError,n=0;n<e.length;n++)r((a=e[n]).value,{componentStack:a.stack,digest:a.digest});if(Hu)throw Hu=!1,t=qu,qu=null,t;0!==(1&Xu)&&0!==t.tag&&kc(),0!==(1&(o=t.pendingLanes))?t===Yu?$u++:($u=0,Yu=t):$u=0,Ua()}(t,e,n,r)}finally{Tu.transition=a,be=r}return null}function kc(){if(null!==Ku){var t=we(Xu),e=Tu.transition,n=be;try{if(Tu.transition=null,be=16>t?16:t,null===Ku)var r=!1;else{if(t=Ku,Ku=null,Xu=0,0!==(6&Iu))throw Error(i(331));var a=Iu;for(Iu|=4,Qs=t.current;null!==Qs;){var o=Qs,s=o.child;if(0!==(16&Qs.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Qs=l;null!==Qs;){var p=Qs;switch(p.tag){case 0:case 11:case 15:nu(8,p,o)}var f=p.child;if(null!==f)f.return=p,Qs=f;else for(;null!==Qs;){var h=(p=Qs).sibling,d=p.return;if(iu(p),p===l){Qs=null;break}if(null!==h){h.return=d,Qs=h;break}Qs=d}}}var m=o.alternate;if(null!==m){var v=m.child;if(null!==v){m.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(null!==v)}}Qs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Qs=s;else t:for(;null!==Qs;){if(0!==(2048&(o=Qs).flags))switch(o.tag){case 0:case 11:case 15:nu(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Qs=y;break t}Qs=o.return}}var b=t.current;for(Qs=b;null!==Qs;){var w=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Qs=w;else t:for(s=b;null!==Qs;){if(0!==(2048&(u=Qs).flags))try{switch(u.tag){case 0:case 11:case 15:ru(9,u)}}catch(k){Nc(u,u.return,k)}if(u===s){Qs=null;break t}var x=u.sibling;if(null!==x){x.return=u.return,Qs=x;break t}Qs=u.return}}if(Iu=a,Ua(),ie&&"function"===typeof ie.onPostCommitFiberRoot)try{ie.onPostCommitFiberRoot(ae,t)}catch(k){}r=!0}return r}finally{be=n,Tu.transition=e}}return!1}function Sc(t,e,n){t=Mi(t,e=ds(0,e=ls(n,e),1),1),e=tc(),null!==t&&(ge(t,1,e),rc(t,e))}function Nc(t,e,n){if(3===t.tag)Sc(t,t,n);else for(;null!==e;){if(3===e.tag){Sc(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gu||!Gu.has(r))){e=Mi(e,t=ms(e,t=ls(n,t),1),1),t=tc(),null!==e&&(ge(e,1,t),rc(e,t));break}}e=e.return}}function Ec(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=tc(),t.pingedLanes|=t.suspendedLanes&n,_u===t&&(Ru&n)===n&&(4===Mu||3===Mu&&(130023424&Ru)===Ru&&500>Yt()-Wu?fc(t,0):Lu|=n),rc(t,e)}function Cc(t,e){0===e&&(0===(1&t.mode)?e=1:(e=le,0===(130023424&(le<<=1))&&(le=4194304)));var n=tc();null!==(t=_i(t,e))&&(ge(t,e,n),rc(t,n))}function Tc(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Cc(t,n)}function Ic(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(e),Cc(t,n)}function _c(t,e){return Zt(t,e)}function Ac(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(t,e,n,r){return new Ac(t,e,n,r)}function Dc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Oc(t,e){var n=t.alternate;return null===n?((n=Rc(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Mc(t,e,n,r,a,o){var s=2;if(r=t,"function"===typeof t)Dc(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case S:return Fc(n.children,a,o,e);case N:s=8,a|=8;break;case E:return(t=Rc(12,n,e,2|a)).elementType=E,t.lanes=o,t;case _:return(t=Rc(13,n,e,a)).elementType=_,t.lanes=o,t;case A:return(t=Rc(19,n,e,a)).elementType=A,t.lanes=o,t;case O:return zc(n,a,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:s=10;break t;case T:s=9;break t;case I:s=11;break t;case R:s=14;break t;case D:s=16,r=null;break t}throw Error(i(130,null==t?t:typeof t,""))}return(e=Rc(s,n,e,a)).elementType=t,e.type=r,e.lanes=o,e}function Fc(t,e,n,r){return(t=Rc(7,t,r,e)).lanes=n,t}function zc(t,e,n,r){return(t=Rc(22,t,r,e)).elementType=O,t.lanes=n,t.stateNode={isHidden:!1},t}function Bc(t,e,n){return(t=Rc(6,t,null,e)).lanes=n,t}function Lc(t,e,n){return(e=Rc(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Pc(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ve(0),this.expirationTimes=ve(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ve(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vc(t,e,n,r,a,i,o,s,u){return t=new Pc(t,e,n,s,u),1===e?(e=1,!0===i&&(e|=8)):e=0,i=Rc(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ri(i),t}function Wc(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Uc(t){if(!t)return Ta;t:{if(Ut(t=t._reactInternals)!==t||1!==t.tag)throw Error(i(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Da(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(i(171))}if(1===t.tag){var n=t.type;if(Da(n))return Fa(t,n,e)}return e}function jc(t,e,n,r,a,i,o,s,u){return(t=Vc(n,r,!0,t,0,i,0,s,u)).context=Uc(null),n=t.current,(i=Oi(r=tc(),a=ec(n))).callback=void 0!==e&&null!==e?e:null,Mi(n,i,a),t.current.lanes=a,ge(t,a,r),rc(t,r),t}function Hc(t,e,n,r){var a=e.current,i=tc(),o=ec(a);return n=Uc(n),null===e.context?e.context=n:e.pendingContext=n,(e=Oi(i,o)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=Mi(a,e,o))&&(nc(t,a,o,i),Fi(t,a,o)),o}function qc(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Gc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Zc(t,e){Gc(t,e),(t=t.alternate)&&Gc(t,e)}Su=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||_a.current)ws=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return ws=!1,function(t,e,n){switch(e.tag){case 3:As(e),hi();break;case 5:io(e);break;case 1:Da(e.type)&&za(e);break;case 4:ro(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;Ca(gi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(Ca(so,1&so.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Bs(t,e,n):(Ca(so,1&so.current),null!==(t=Hs(t,e,n))?t.sibling:null);Ca(so,1&so.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return Us(t,e,n);e.flags|=128}if(null!==(a=e.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(so,so.current),r)break;return null;case 22:case 23:return e.lanes=0,Es(t,e,n)}return Hs(t,e,n)}(t,e,n);ws=0!==(131072&t.flags)}else ws=!1,ai&&0!==(1048576&e.flags)&&Ja(e,Ga,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;js(t,e),t=e.pendingProps;var a=Ra(e,Ia.current);Ni(e,n),a=No(null,e,r,t,a,n);var o=Eo();return e.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Da(r)?(o=!0,za(e)):o=!1,e.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ri(e),a.updater=Wi,e.stateNode=a,a._reactInternals=e,qi(e,r,t,n),e=_s(null,e,r,!0,o,n)):(e.tag=0,ai&&o&&ti(e),xs(null,e,a,n),e=e.child),e;case 16:r=e.elementType;t:{switch(js(t,e),t=e.pendingProps,r=(a=r._init)(r._payload),e.type=r,a=e.tag=function(t){if("function"===typeof t)return Dc(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===I)return 11;if(t===R)return 14}return 2}(r),t=vi(r,t),a){case 0:e=Ts(null,e,r,t,n);break t;case 1:e=Is(null,e,r,t,n);break t;case 11:e=ks(null,e,r,t,n);break t;case 14:e=Ss(null,e,r,vi(r.type,t),n);break t}throw Error(i(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,Ts(t,e,r,a=e.elementType===r?a:vi(r,a),n);case 1:return r=e.type,a=e.pendingProps,Is(t,e,r,a=e.elementType===r?a:vi(r,a),n);case 3:t:{if(As(e),null===t)throw Error(i(387));r=e.pendingProps,a=(o=e.memoizedState).element,Di(t,e),Bi(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=Rs(t,e,r,n,a=ls(Error(i(423)),e));break t}if(r!==a){e=Rs(t,e,r,n,a=ls(Error(i(424)),e));break t}for(ri=ca(e.stateNode.containerInfo.firstChild),ni=e,ai=!0,ii=null,n=Yi(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hi(),r===a){e=Hs(t,e,n);break t}xs(t,e,r,n)}e=e.child}return e;case 5:return io(e),null===t&&ci(e),r=e.type,a=e.pendingProps,o=null!==t?t.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(e.flags|=32),Cs(t,e),xs(t,e,s,n),e.child;case 6:return null===t&&ci(e),null;case 13:return Bs(t,e,n);case 4:return ro(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=$i(e,null,r,n):xs(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,ks(t,e,r,a=e.elementType===r?a:vi(r,a),n);case 7:return xs(t,e,e.pendingProps,n),e.child;case 8:case 12:return xs(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,a=e.pendingProps,o=e.memoizedProps,s=a.value,Ca(gi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!_a.current){e=Hs(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Oi(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var p=(l=l.shared).pending;null===p?c.next=c:(c.next=p.next,p.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Si(o.return,n,e),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Si(s,n,e),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}xs(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,Ni(e,n),r=r(a=Ei(a)),e.flags|=1,xs(t,e,r,n),e.child;case 14:return a=vi(r=e.type,e.pendingProps),Ss(t,e,r,a=vi(r.type,a),n);case 15:return Ns(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:vi(r,a),js(t,e),e.tag=1,Da(r)?(t=!0,za(e)):t=!1,Ni(e,n),ji(e,r,a),qi(e,r,a,n),_s(null,e,r,!0,t,n);case 19:return Us(t,e,n);case 22:return Es(t,e,n)}throw Error(i(156,e.tag))};var Kc="function"===typeof reportError?reportError:function(t){console.error(t)};function Xc(t){this._internalRoot=t}function $c(t){this._internalRoot=t}function Yc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Qc(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Jc(){}function tl(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var t=qc(o);s.call(t)}}Hc(e,o,t,a)}else o=function(t,e,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var t=qc(o);i.call(t)}}var o=jc(e,r,t,0,null,!1,0,"",Jc);return t._reactRootContainer=o,t[da]=o.current,Ur(8===t.nodeType?t.parentNode:t),lc(),o}for(;a=t.lastChild;)t.removeChild(a);if("function"===typeof r){var s=r;r=function(){var t=qc(u);s.call(t)}}var u=Vc(t,0,!1,null,0,!1,0,"",Jc);return t._reactRootContainer=u,t[da]=u.current,Ur(8===t.nodeType?t.parentNode:t),lc((function(){Hc(e,u,n,r)})),u}(n,e,t,a,r);return qc(o)}$c.prototype.render=Xc.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(i(409));Hc(t,e,null,null)},$c.prototype.unmount=Xc.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;lc((function(){Hc(null,t,null,null)})),e[da]=null}},$c.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ne();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oe.length&&0!==e&&e<Oe[n].priority;n++);Oe.splice(n,0,t),0===n&&Be(t)}},xe=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=pe(e.pendingLanes);0!==n&&(ye(e,1|n),rc(e,Yt()),0===(6&Iu)&&(Uu=Yt()+500,Ua()))}break;case 13:lc((function(){var e=_i(t,1);if(null!==e){var n=tc();nc(e,t,1,n)}})),Zc(t,1)}},ke=function(t){if(13===t.tag){var e=_i(t,134217728);if(null!==e)nc(e,t,134217728,tc());Zc(t,134217728)}},Se=function(t){if(13===t.tag){var e=ec(t),n=_i(t,e);if(null!==n)nc(n,t,e,tc());Zc(t,e)}},Ne=function(){return be},Ee=function(t,e){var n=be;try{return be=t,e()}finally{be=n}},kt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=xa(r);if(!a)throw Error(i(90));Z(r),Q(r,a)}}}break;case"textarea":it(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},It=cc,_t=lc;var el={usingClientEntryPoint:!1,Events:[ba,wa,xa,Ct,Tt,cc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=qt(t))?null:t.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{ae=al.inject(rl),ie=al}catch(lt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=el,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(e))throw Error(i(200));return Wc(t,e,null,n)},e.createRoot=function(t,e){if(!Yc(t))throw Error(i(299));var n=!1,r="",a=Kc;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(a=e.onRecoverableError)),e=Vc(t,1,!1,null,0,n,0,r,a),t[da]=e.current,Ur(8===t.nodeType?t.parentNode:t),new Xc(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(i(188));throw t=Object.keys(t).join(","),Error(i(268,t))}return t=null===(t=qt(e))?null:t.stateNode},e.flushSync=function(t){return lc(t)},e.hydrate=function(t,e,n){if(!Qc(e))throw Error(i(200));return tl(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Yc(t))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=jc(e,null,t,1,null!=n?n:null,a,0,o,s),t[da]=e.current,Ur(t),r)for(t=0;t<r.length;t++)a=(a=(n=r[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new $c(e)},e.render=function(t,e,n){if(!Qc(e))throw Error(i(200));return tl(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Qc(t))throw Error(i(40));return!!t._reactRootContainer&&(lc((function(){tl(null,null,t,!1,(function(){t._reactRootContainer=null,t[da]=null}))})),!0)},e.unstable_batchedUpdates=cc,e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qc(n))throw Error(i(200));if(null==t||void 0===t._reactInternals)throw Error(i(38));return tl(t,e,n,!1,r)},e.version="18.2.0-next-9e3b772b8-20220608"},1250:function(t,e,n){"use strict";var r=n(4164);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},4164:function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(4463)},6374:function(t,e,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(l=e.ref),e)o.call(e,r)&&!u.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===i[r]&&(i[r]=e[r]);return{$$typeof:a,type:t,key:c,ref:l,props:i,_owner:s.current}}e.Fragment=i,e.jsx=c,e.jsxs=c},9117:function(t,e){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator;var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,v={};function g(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||d}function y(){}function b(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||d}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=g.prototype;var w=b.prototype=new y;w.constructor=b,m(w,g.prototype),w.isPureReactComponent=!0;var x=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function E(t,e,r){var a,i={},o=null,s=null;if(null!=e)for(a in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)k.call(e,a)&&!N.hasOwnProperty(a)&&(i[a]=e[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(a in u=t.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:t,key:o,ref:s,props:i,_owner:S.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var T=/\/+/g;function I(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function _(t,e,a,i,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var u=!1;if(null===t)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=t),t=""===i?"."+I(u,0):i,x(o)?(a="",null!=t&&(a=t.replace(T,"$&/")+"/"),_(o,e,a,"",(function(t){return t}))):null!=o&&(C(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+t)),e.push(o)),1;if(u=0,i=""===i?".":i+":",x(t))for(var c=0;c<t.length;c++){var l=i+I(s=t[c],c);u+=_(s,e,a,l,o)}else if(l=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=h&&t[h]||t["@@iterator"])?t:null}(t),"function"===typeof l)for(t=l.call(t),c=0;!(s=t.next()).done;)u+=_(s=s.value,e,a,l=i+I(s,c++),o);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return u}function A(t,e,n){if(null==t)return t;var r=[],a=0;return _(t,r,"","",(function(t){return e.call(n,t,a++)})),r}function R(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var D={current:null},O={transition:null},M={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};e.Children={map:A,forEach:function(t,e,n){A(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=g,e.Fragment=a,e.Profiler=o,e.PureComponent=b,e.StrictMode=i,e.Suspense=l,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var a=m({},t.props),i=t.key,o=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,s=S.current),void 0!==e.key&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)k.call(e,c)&&!N.hasOwnProperty(c)&&(a[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:t.type,key:i,ref:o,props:a,_owner:s}},e.createContext=function(t){return(t={$$typeof:u,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=E,e.createFactory=function(t){var e=E.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:f,_payload:{_status:-1,_result:t},_init:R}},e.memo=function(t,e){return{$$typeof:p,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=O.transition;O.transition={};try{t()}finally{O.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return D.current.useCallback(t,e)},e.useContext=function(t){return D.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return D.current.useDeferredValue(t)},e.useEffect=function(t,e){return D.current.useEffect(t,e)},e.useId=function(){return D.current.useId()},e.useImperativeHandle=function(t,e,n){return D.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return D.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return D.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return D.current.useMemo(t,e)},e.useReducer=function(t,e,n){return D.current.useReducer(t,e,n)},e.useRef=function(t){return D.current.useRef(t)},e.useState=function(t){return D.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return D.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return D.current.useTransition()},e.version="18.2.0"},2791:function(t,e,n){"use strict";t.exports=n(9117)},184:function(t,e,n){"use strict";t.exports=n(6374)},6813:function(t,e){"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,a=t[r];if(!(0<i(a,e)))break t;t[r]=e,t[n]=a,n=r}}function r(t){return 0===t.length?null:t[0]}function a(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,a=t.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=t[s],c=s+1,l=t[c];if(0>i(u,n))c<a&&0>i(l,u)?(t[r]=l,t[c]=n,r=c):(t[r]=u,t[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break t;t[r]=l,t[c]=n,r=c}}}return e}function i(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();e.unstable_now=function(){return s.now()-u}}var c=[],l=[],p=1,f=null,h=3,d=!1,m=!1,v=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(t){for(var e=r(l);null!==e;){if(null===e.callback)a(l);else{if(!(e.startTime<=t))break;a(l),e.sortIndex=e.expirationTime,n(c,e)}e=r(l)}}function x(t){if(v=!1,w(t),!m)if(null!==r(c))m=!0,O(k);else{var e=r(l);null!==e&&M(x,e.startTime-t)}}function k(t,n){m=!1,v&&(v=!1,y(C),C=-1),d=!0;var i=h;try{for(w(n),f=r(c);null!==f&&(!(f.expirationTime>n)||t&&!_());){var o=f.callback;if("function"===typeof o){f.callback=null,h=f.priorityLevel;var s=o(f.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?f.callback=s:f===r(c)&&a(c),w(n)}else a(c);f=r(c)}if(null!==f)var u=!0;else{var p=r(l);null!==p&&M(x,p.startTime-n),u=!1}return u}finally{f=null,h=i,d=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,N=!1,E=null,C=-1,T=5,I=-1;function _(){return!(e.unstable_now()-I<T)}function A(){if(null!==E){var t=e.unstable_now();I=t;var n=!0;try{n=E(!0,t)}finally{n?S():(N=!1,E=null)}}else N=!1}if("function"===typeof b)S=function(){b(A)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,D=R.port2;R.port1.onmessage=A,S=function(){D.postMessage(null)}}else S=function(){g(A,0)};function O(t){E=t,N||(N=!0,S())}function M(t,n){C=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,O(k))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(t){switch(h){case 1:case 2:case 3:var e=3;break;default:e=h}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_scheduleCallback=function(t,a,i){var o=e.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:p++,callback:a,priorityLevel:t,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(t.sortIndex=i,n(l,t),null===r(c)&&t===r(l)&&(v?(y(C),C=-1):v=!0,M(x,i-o))):(t.sortIndex=s,n(c,t),m||d||(m=!0,O(k))),t},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(t){var e=h;return function(){var n=h;h=e;try{return t.apply(this,arguments)}finally{h=n}}}},5296:function(t,e,n){"use strict";t.exports=n(6813)},6699:function(t,e,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),s=n(4113),u=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,t.exports=c},2501:function(t,e,n){var r;!function(t,a,i){function o(t){var e=this,n=function(){var t=4022871197;return function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)}}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new o(t),r=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.alea=u}(0,t=n.nmd(t),n.amdD)},1725:function(t,e,n){var r;!function(t,a,i){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.tychei=u}(0,t=n.nmd(t),n.amdD)},9112:function(t,e,n){var r;!function(t,a,i){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xor128=u}(0,t=n.nmd(t),n.amdD)},4113:function(t,e,n){var r;!function(t,a,i){function o(t){var e=this;e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},function(t,e){var n,r,a,i,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,i=-32;i<u;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xor4096=u}(0,t=n.nmd(t),n.amdD)},890:function(t,e,n){var r;!function(t,a,i){function o(t){var e=this;e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],n=(t^=t>>>7)^t<<24,n^=(t=r[a+1&7])^t>>>10,n^=(t=r[a+3&7])^t>>>3,n^=(t=r[a+4&7])^t<<7,t=r[a+7&7],n^=(t^=t<<13)^t<<9,r[a]=n,e.i=a+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xorshift7=u}(0,t=n.nmd(t),n.amdD)},2132:function(t,e,n){var r;!function(t,a,i){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(e,n,e,a))||(a.exports=r):this.xorwow=u}(0,t=n.nmd(t),n.amdD)},3411:function(t,e,n){var r;!function(a,i,o){var s,u=256,c=o.pow(u,6),l=o.pow(2,52),p=2*l,f=255;function h(t,e,n){var r=[],f=g(v((e=1==e?{entropy:!0}:e||{}).entropy?[t,y(i)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(u):(t=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(t)),y(t)}catch(r){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,y(i)]}}():t,3),r),h=new d(r),b=function(){for(var t=h.g(6),e=c,n=0;t<l;)t=(t+n)*u,e*=u,n=h.g(1);for(;t>=p;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|h.g(4)},b.quick=function(){return h.g(4)/4294967296},b.double=b,g(y(h.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&m(r,h),t.state=function(){return m(h,{})}),n?(o.random=t,e):t})(b,f,"global"in e?e.global:this==o,e.state)}function d(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=f&i+t[a%n]+(e=o[a])],o[i]=e;(r.g=function(t){for(var e,n=0,a=r.i,i=r.j,o=r.S;t--;)e=o[a=f&a+1],n=n*u+o[f&(o[a]=o[i=f&i+e])+(o[i]=e)];return r.i=a,r.j=i,n})(u)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){var n,r=[],a=typeof t;if(e&&"object"==a)for(n in t)try{r.push(v(t[n],e-1))}catch(i){}return r.length?r:"string"==a?t:t+"\0"}function g(t,e){for(var n,r=t+"",a=0;a<r.length;)e[f&a]=f&(n^=19*e[f&a])+r.charCodeAt(a++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(g(o.random(),i),t.exports){t.exports=h;try{s=n(5042)}catch(b){}}else void 0===(r=function(){return h}.call(e,n,e,t))||(t.exports=r)}("undefined"!==typeof self?self:this,[],Math)},5410:function(){},8628:function(){},7806:function(){},9086:function(){},9319:function(){},4406:function(){},6910:function(){},7422:function(){},5042:function(){},907:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{Z:function(){return r}})},3878:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,{Z:function(){return r}})},5861:function(t,e,n){"use strict";function r(t,e,n,r,a,i,o){try{var s=t[i](o),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,a)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function s(t){r(o,a,i,s,u,"next",t)}function u(t){r(o,a,i,s,u,"throw",t)}s(void 0)}))}}n.d(e,{Z:function(){return a}})},5671:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return r}})},3144:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{Z:function(){return a}})},7762:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(181);function a(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(0,r.Z)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}},2882:function(t,e,n){"use strict";function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}n.d(e,{Z:function(){return o}});var a=n(1002);function i(t,e){if(e&&("object"===(0,a.Z)(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function o(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=r(t);if(e){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}}},9340:function(t,e,n){"use strict";function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function a(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}n.d(e,{Z:function(){return a}})},9199:function(t,e,n){"use strict";function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}n.d(e,{Z:function(){return r}})},5267:function(t,e,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(e,{Z:function(){return r}})},4165:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(1002);function a(){a=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(I){c=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof h?e:h,i=Object.create(a.prototype),o=new E(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return T()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=k(o,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=p(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,o),i}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(I){return{type:"throw",arg:I}}}t.wrap=l;var f={};function h(){}function d(){}function m(){}var v={};c(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(C([])));y&&y!==e&&n.call(y,o)&&(v=y);var b=m.prototype=h.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function a(i,o,s,u){var c=p(t[i],t,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==(0,r.Z)(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){a("next",t,s,u)}),(function(t){a("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return a("throw",t,s,u)}))}u(c.arg)}var i;this._invoke=function(t,n){function r(){return new e((function(e,r){a(t,n,e,r)}))}return i=i?i.then(r,r):r()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=p(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,f;var a=r.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return d.prototype=m,c(b,"constructor",m),c(m,"constructor",d),d.displayName=c(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},w(x.prototype),c(x.prototype,s,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new x(l(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},w(b),c(b,u,"Generator"),c(b,o,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=C,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(N),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}},9439:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(3878);var a=n(181),i=n(5267);function o(t,e){return(0,r.Z)(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(u){s=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(t,e)||(0,a.Z)(t,e)||(0,i.Z)()}},3433:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(907);var a=n(9199),i=n(181);function o(t){return function(t){if(Array.isArray(t))return(0,r.Z)(t)}(t)||(0,a.Z)(t)||(0,i.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},1002:function(t,e,n){"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n.d(e,{Z:function(){return r}})},181:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(907);function a(t,e){if(t){if("string"===typeof t)return(0,r.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(t,e):void 0}}}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){"use strict";var t,e=n(2791),r=n(1250),a=n(9439);function i(){return i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(t||(t={}));var o=function(t){return t};var s="beforeunload",u="popstate";function c(t){t.preventDefault(),t.returnValue=""}function l(){var t=[];return{get length(){return t.length},push:function(e){return t.push(e),function(){t=t.filter((function(t){return t!==e}))}},call:function(e){t.forEach((function(t){return t&&t(e)}))}}}function p(){return Math.random().toString(36).substr(2,8)}function f(t){var e=t.pathname,n=void 0===e?"/":e,r=t.search,a=void 0===r?"":r,i=t.hash,o=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function h(t){var e={};if(t){var n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));var r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}var d=(0,e.createContext)(null);var m=(0,e.createContext)(null);var v=(0,e.createContext)({outlet:null,matches:[]});function g(t,e){if(!t)throw new Error(e)}function y(t,e,n){void 0===n&&(n="/");var r=C(("string"===typeof e?h(e):e).pathname||"/",n);if(null==r)return null;var a=b(t);!function(t){t.sort((function(t,e){return t.score!==e.score?e.score-t.score:function(t,e){var n=t.length===e.length&&t.slice(0,-1).every((function(t,n){return t===e[n]}));return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map((function(t){return t.childrenIndex})),e.routesMeta.map((function(t){return t.childrenIndex})))}))}(a);for(var i=null,o=0;null==i&&o<a.length;++o)i=S(a[o],r);return i}function b(t,e,n,r){return void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=""),t.forEach((function(t,a){var i={relativePath:t.path||"",caseSensitive:!0===t.caseSensitive,childrenIndex:a,route:t};i.relativePath.startsWith("/")&&(i.relativePath.startsWith(r)||g(!1),i.relativePath=i.relativePath.slice(r.length));var o=T([r,i.relativePath]),s=n.concat(i);t.children&&t.children.length>0&&(!0===t.index&&g(!1),b(t.children,e,s,o)),(null!=t.path||t.index)&&e.push({path:o,score:k(o,t.index),routesMeta:s})})),e}var w=/^:\w+$/,x=function(t){return"*"===t};function k(t,e){var n=t.split("/"),r=n.length;return n.some(x)&&(r+=-2),e&&(r+=2),n.filter((function(t){return!x(t)})).reduce((function(t,e){return t+(w.test(e)?3:""===e?1:10)}),r)}function S(t,e){for(var n=t.routesMeta,r={},a="/",i=[],o=0;o<n.length;++o){var s=n[o],u=o===n.length-1,c="/"===a?e:e.slice(a.length)||"/",l=N({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},c);if(!l)return null;Object.assign(r,l.params);var p=s.route;i.push({params:r,pathname:T([a,l.pathname]),pathnameBase:I(T([a,l.pathnameBase])),route:p}),"/"!==l.pathnameBase&&(a=T([a,l.pathnameBase]))}return i}function N(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});var n=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);var r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(t,e){return r.push(e),"([^\\/]+)"}));t.endsWith("*")?(r.push("*"),a+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):a+=n?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)";return[new RegExp(a,e?void 0:"i"),r]}(t.path,t.caseSensitive,t.end),r=(0,a.Z)(n,2),i=r[0],o=r[1],s=e.match(i);if(!s)return null;var u=s[0],c=u.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:o.reduce((function(t,e,n){if("*"===e){var r=l[n]||"";c=u.slice(0,u.length-r.length).replace(/(.)\/+$/,"$1")}return t[e]=function(t,e){try{return decodeURIComponent(t)}catch(n){return t}}(l[n]||""),t}),{}),pathname:u,pathnameBase:c,pattern:t}}function E(t,e,n){var r,a="string"===typeof t?h(t):t,i=""===t||""===a.pathname?"/":a.pathname;if(null==i)r=n;else{var o=e.length-1;if(i.startsWith("..")){for(var s=i.split("/");".."===s[0];)s.shift(),o-=1;a.pathname=s.join("/")}r=o>=0?e[o]:"/"}var u=function(t,e){void 0===e&&(e="/");var n="string"===typeof t?h(t):t,r=n.pathname,a=n.search,i=void 0===a?"":a,o=n.hash,s=void 0===o?"":o,u=r?r.startsWith("/")?r:function(t,e){var n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach((function(t){".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)})),n.length>1?n.join("/"):"/"}(r,e):e;return{pathname:u,search:_(i),hash:A(s)}}(a,r);return i&&"/"!==i&&i.endsWith("/")&&!u.pathname.endsWith("/")&&(u.pathname+="/"),u}function C(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;var n=t.charAt(e.length);return n&&"/"!==n?null:t.slice(e.length)||"/"}var T=function(t){return t.join("/").replace(/\/\/+/g,"/")},I=function(t){return t.replace(/\/+$/,"").replace(/^\/*/,"/")},_=function(t){return t&&"?"!==t?t.startsWith("?")?t:"?"+t:""},A=function(t){return t&&"#"!==t?t.startsWith("#")?t:"#"+t:""};function R(t){D()||g(!1);var n=(0,e.useContext)(d),r=n.basename,a=n.navigator,i=F(t),o=i.hash,s=i.pathname,u=i.search,c=s;if("/"!==r){var l=function(t){return""===t||""===t.pathname?"/":"string"===typeof t?h(t).pathname:t.pathname}(t),p=null!=l&&l.endsWith("/");c="/"===s?r+(p?"/":""):T([r,s])}return a.createHref({pathname:c,search:u,hash:o})}function D(){return null!=(0,e.useContext)(m)}function O(){return D()||g(!1),(0,e.useContext)(m).location}function M(){D()||g(!1);var t=(0,e.useContext)(d),n=t.basename,r=t.navigator,a=(0,e.useContext)(v).matches,i=O().pathname,o=JSON.stringify(a.map((function(t){return t.pathnameBase}))),s=(0,e.useRef)(!1);return(0,e.useEffect)((function(){s.current=!0})),(0,e.useCallback)((function(t,e){if(void 0===e&&(e={}),s.current)if("number"!==typeof t){var a=E(t,JSON.parse(o),i);"/"!==n&&(a.pathname=T([n,a.pathname])),(e.replace?r.replace:r.push)(a,e.state)}else r.go(t)}),[n,r,o,i])}function F(t){var n=(0,e.useContext)(v).matches,r=O().pathname,a=JSON.stringify(n.map((function(t){return t.pathnameBase})));return(0,e.useMemo)((function(){return E(t,JSON.parse(a),r)}),[t,a,r])}function z(t,n){return void 0===n&&(n=[]),null==t?null:t.reduceRight((function(r,a,i){return(0,e.createElement)(v.Provider,{children:void 0!==a.route.element?a.route.element:r,value:{outlet:r,matches:n.concat(t.slice(0,i+1))}})}),null)}function B(t){g(!1)}function L(n){var r=n.basename,a=void 0===r?"/":r,i=n.children,o=void 0===i?null:i,s=n.location,u=n.navigationType,c=void 0===u?t.Pop:u,l=n.navigator,p=n.static,f=void 0!==p&&p;D()&&g(!1);var v=I(a),y=(0,e.useMemo)((function(){return{basename:v,navigator:l,static:f}}),[v,l,f]);"string"===typeof s&&(s=h(s));var b=s,w=b.pathname,x=void 0===w?"/":w,k=b.search,S=void 0===k?"":k,N=b.hash,E=void 0===N?"":N,T=b.state,_=void 0===T?null:T,A=b.key,R=void 0===A?"default":A,O=(0,e.useMemo)((function(){var t=C(x,v);return null==t?null:{pathname:t,search:S,hash:E,state:_,key:R}}),[v,x,S,E,_,R]);return null==O?null:(0,e.createElement)(d.Provider,{value:y},(0,e.createElement)(m.Provider,{children:o,value:{location:O,navigationType:c}}))}function P(t){var n=t.children,r=t.location;return function(t,n){D()||g(!1);var r,a=(0,e.useContext)(v).matches,i=a[a.length-1],o=i?i.params:{},s=(i&&i.pathname,i?i.pathnameBase:"/"),u=(i&&i.route,O());if(n){var c,l="string"===typeof n?h(n):n;"/"===s||(null==(c=l.pathname)?void 0:c.startsWith(s))||g(!1),r=l}else r=u;var p=r.pathname||"/",f=y(t,{pathname:"/"===s?p:p.slice(s.length)||"/"});return z(f&&f.map((function(t){return Object.assign({},t,{params:Object.assign({},o,t.params),pathname:T([s,t.pathname]),pathnameBase:"/"===t.pathnameBase?s:T([s,t.pathnameBase])})})),a)}(V(n),r)}function V(t){var n=[];return e.Children.forEach(t,(function(t){if((0,e.isValidElement)(t))if(t.type!==e.Fragment){t.type!==B&&g(!1);var r={caseSensitive:t.props.caseSensitive,element:t.props.element,index:t.props.index,path:t.props.path};t.props.children&&(r.children=V(t.props.children)),n.push(r)}else n.push.apply(n,V(t.props.children))})),n}function W(){return W=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},W.apply(this,arguments)}function U(t,e){if(null==t)return{};var n,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}var j=["onClick","reloadDocument","replace","state","target","to"],H=["aria-current","caseSensitive","className","end","style","to","children"];function q(n){var r=n.basename,d=n.children,m=n.window,v=(0,e.useRef)();null==v.current&&(v.current=function(e){void 0===e&&(e={});var n=e.window,r=void 0===n?document.defaultView:n,a=r.history;function d(){var t=r.location,e=t.pathname,n=t.search,i=t.hash,s=a.state||{};return[s.idx,o({pathname:e,search:n,hash:i,state:s.usr||null,key:s.key||"default"})]}var m=null;r.addEventListener(u,(function(){if(m)x.call(m),m=null;else{var e=t.Pop,n=d(),r=n[0],a=n[1];if(x.length){if(null!=r){var i=y-r;i&&(m={action:e,location:a,retry:function(){T(-1*i)}},T(i))}}else C(e)}}));var v=t.Pop,g=d(),y=g[0],b=g[1],w=l(),x=l();function k(t){return"string"===typeof t?t:f(t)}function S(t,e){return void 0===e&&(e=null),o(i({pathname:b.pathname,hash:"",search:""},"string"===typeof t?h(t):t,{state:e,key:p()}))}function N(t,e){return[{usr:t.state,key:t.key,idx:e},k(t)]}function E(t,e,n){return!x.length||(x.call({action:t,location:e,retry:n}),!1)}function C(t){v=t;var e=d();y=e[0],b=e[1],w.call({action:v,location:b})}function T(t){a.go(t)}null==y&&(y=0,a.replaceState(i({},a.state,{idx:y}),""));var I={get action(){return v},get location(){return b},createHref:k,push:function e(n,i){var o=t.Push,s=S(n,i);if(E(o,s,(function(){e(n,i)}))){var u=N(s,y+1),c=u[0],l=u[1];try{a.pushState(c,"",l)}catch(p){r.location.assign(l)}C(o)}},replace:function e(n,r){var i=t.Replace,o=S(n,r);if(E(i,o,(function(){e(n,r)}))){var s=N(o,y),u=s[0],c=s[1];a.replaceState(u,"",c),C(i)}},go:T,back:function(){T(-1)},forward:function(){T(1)},listen:function(t){return w.push(t)},block:function(t){var e=x.push(t);return 1===x.length&&r.addEventListener(s,c),function(){e(),x.length||r.removeEventListener(s,c)}}};return I}({window:m}));var g=v.current,y=(0,e.useState)({action:g.action,location:g.location}),b=(0,a.Z)(y,2),w=b[0],x=b[1];return(0,e.useLayoutEffect)((function(){return g.listen(x)}),[g]),(0,e.createElement)(L,{basename:r,children:d,location:w.location,navigationType:w.action,navigator:g})}var G=(0,e.forwardRef)((function(t,n){var r=t.onClick,a=t.reloadDocument,i=t.replace,o=void 0!==i&&i,s=t.state,u=t.target,c=t.to,l=U(t,j),p=R(c),h=function(t,n){var r=void 0===n?{}:n,a=r.target,i=r.replace,o=r.state,s=M(),u=O(),c=F(t);return(0,e.useCallback)((function(e){if(0===e.button&&(!a||"_self"===a)&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(e)){e.preventDefault();var n=!!i||f(u)===f(c);s(t,{replace:n,state:o})}}),[u,s,c,i,o,a,t])}(c,{replace:o,state:s,target:u});return(0,e.createElement)("a",W({},l,{href:p,onClick:function(t){r&&r(t),t.defaultPrevented||a||h(t)},ref:n,target:u}))}));var Z=(0,e.forwardRef)((function(t,n){var r=t["aria-current"],a=void 0===r?"page":r,i=t.caseSensitive,o=void 0!==i&&i,s=t.className,u=void 0===s?"":s,c=t.end,l=void 0!==c&&c,p=t.style,f=t.to,h=t.children,d=U(t,H),m=O(),v=F(f),g=m.pathname,y=v.pathname;o||(g=g.toLowerCase(),y=y.toLowerCase());var b,w=g===y||!l&&g.startsWith(y)&&"/"===g.charAt(y.length),x=w?a:void 0;b="function"===typeof u?u({isActive:w}):[u,w?"active":null].filter(Boolean).join(" ");var k="function"===typeof p?p({isActive:w}):p;return(0,e.createElement)(G,W({},d,{"aria-current":x,className:b,ref:n,style:k,to:f}),"function"===typeof h?h({isActive:w}):h)}));var K=n(184);function X(t){var e=t.workout,n="./"+e+".jpg";return(0,K.jsx)("div",{className:"workoutCard",children:(0,K.jsxs)(Z,{to:"/workout",className:function(t){return t.isActive?"active":""},children:[(0,K.jsx)("img",{className:"workoutImage",src:n,alt:"Placeholder",width:"300",height:"200"}),(0,K.jsx)("div",{className:"workoutCardDesc",children:(0,K.jsx)("h2",{children:e})})]})})}var $=function(){return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{className:"header",children:(0,K.jsx)("h1",{children:"Spot-On Posture"})}),(0,K.jsx)("div",{className:"page home",children:(0,K.jsxs)("center",{children:[(0,K.jsx)("h1",{className:"title",children:"Welcome back, Ananya!"}),(0,K.jsx)("div",{className:"workoutCardContainer",children:["Deadlift","Squats","Bench Press"].map((function(t){return(0,K.jsx)(X,{workout:t})}))})]})})]})},Y=function(){return(0,K.jsx)("div",{class:"container",children:(0,K.jsxs)("div",{class:"form-box",children:[(0,K.jsx)("h1",{id:"title",children:"Sign Up"}),(0,K.jsxs)("form",{id:"main_form",children:[(0,K.jsxs)("div",{class:"input-group",children:[(0,K.jsxs)("div",{class:"input-field",id:"nameField",children:[(0,K.jsx)("i",{class:"fa-solid fa-user"}),(0,K.jsx)("input",{type:"text",id:"fullname",placeholder:"Name"})]}),(0,K.jsxs)("div",{class:"input-field",children:[(0,K.jsx)("i",{class:"fa-solid fa-envelope"}),(0,K.jsx)("input",{type:"email",id:"email",placeholder:"Email"})]}),(0,K.jsxs)("div",{class:"input-field",children:[(0,K.jsx)("i",{class:"fa-solid fa-lock"}),(0,K.jsx)("input",{type:"password",id:"password",placeholder:"Password"})]}),(0,K.jsx)("a",{href:"#",children:"Forgot password?"})]}),(0,K.jsxs)("div",{class:"btn-field",children:[(0,K.jsx)("button",{type:"button",id:"signupBtn",class:"submit",children:"Sign up"}),(0,K.jsx)("button",{type:"button",id:"signinBtn",class:"disable",children:"Sign in"})]})]})]})})},Q=n(4165),J=n(5861),tt=(n(7803),n(6342)),et=function(){var t,n,r,a,i,o="./my_model/";function s(){return u.apply(this,arguments)}function u(){return(u=(0,J.Z)((0,Q.Z)().mark((function e(){var s,u,l;return(0,Q.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o+"model.json",o+"metadata.json",e.next=4,tt.zD("./my_model/model.json","./my_model/metadata.json");case 4:return t=e.sent,i=t.getTotalClasses(),s=200,!1,n=new tt.bb(s,s,false),e.next=11,n.setup();case 11:return e.next=13,n.play();case 13:for(window.requestAnimationFrame(c),(u=document.getElementById("canvas")).width=s,u.height=s,r=u.getContext("2d"),a=document.getElementById("label-container"),n.canvas=u,l=0;l<i;l++)a.appendChild(document.createElement("div")),a.appendChild(document.createElement("div"));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(t){return l.apply(this,arguments)}function l(){return(l=(0,J.Z)((0,Q.Z)().mark((function t(e){return(0,Q.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.update(),t.next=3,p();case 3:window.requestAnimationFrame(c);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(){return f.apply(this,arguments)}function f(){return(f=(0,J.Z)((0,Q.Z)().mark((function e(){var r,o,s,u,c,l;return(0,Q.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("hey"),console.log(n),e.next=4,t.estimatePose(n.canvas);case 4:return r=e.sent,o=r.pose,s=r.posenetOutput,console.log("the other hey"),e.next=10,t.predict(s);case 10:for(u=e.sent,c=0;c<i;c++)l=u[c].className+": "+u[c].probability.toFixed(2),a.childNodes[c].innerHTML=l;h(o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(t){if(n.canvas&&(r.drawImage(n.canvas,0,0),t)){tt.kp(t.keypoints,.5,r),tt.iZ(t.keypoints,.5,r)}}return(0,e.useEffect)((function(){setInterval((function(){return s()}),1e3)}),[s]),(0,K.jsxs)("div",{className:"page workout",children:[(0,K.jsx)("div",{children:"Teachable Machine Pose Model"}),(0,K.jsx)("button",{type:"button",onClick:s,children:"Start"}),(0,K.jsx)("div",{children:(0,K.jsx)("canvas",{id:"canvas"})}),(0,K.jsx)("div",{id:"label-container"})]})};var nt=function(){return(0,K.jsx)(q,{basename:"",children:(0,K.jsxs)(P,{children:[(0,K.jsx)(B,{path:"/",element:(0,K.jsx)($,{})}),(0,K.jsx)(B,{path:"/login",element:(0,K.jsx)(Y,{})}),(0,K.jsx)(B,{path:"/workout",element:(0,K.jsx)(et,{})})]})})};r.createRoot(document.getElementById("root")).render((0,K.jsx)(e.StrictMode,{children:(0,K.jsx)(nt,{})}))}()}();
//# sourceMappingURL=main.127eba7a.js.map